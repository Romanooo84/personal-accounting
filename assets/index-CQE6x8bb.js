var H$=Object.defineProperty;var YR=p=>{throw TypeError(p)};var B$=(p,t,e)=>t in p?H$(p,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[t]=e;var lt=(p,t,e)=>B$(p,typeof t!="symbol"?t+"":t,e),C1=(p,t,e)=>t.has(p)||YR("Cannot "+e);var r=(p,t,e)=>(C1(p,t,"read from private field"),e?e.call(p):t.get(p)),E=(p,t,e)=>t.has(p)?YR("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(p):t.set(p,e),v=(p,t,e,n)=>(C1(p,t,"write to private field"),n?n.call(p,e):t.set(p,e),e),b=(p,t,e)=>(C1(p,t,"access private method"),e);var le=(p,t,e,n)=>({set _(i){v(p,t,i,e)},get _(){return r(p,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function TI(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}function z$(p){if(p.__esModule)return p;var t=p.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(p).forEach(function(n){var i=Object.getOwnPropertyDescriptor(p,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return p[n]}})}),e}var T1={exports:{}},iy={},k1={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KR;function U$(){if(KR)return Vt;KR=1;var p=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function m(M){return M===null||typeof M!="object"?null:(M=g&&M[g]||M["@@iterator"],typeof M=="function"?M:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function C(M,B,Y){this.props=M,this.context=B,this.refs=S,this.updater=Y||A}C.prototype.isReactComponent={},C.prototype.setState=function(M,B){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,B,"setState")},C.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function T(){}T.prototype=C.prototype;function k(M,B,Y){this.props=M,this.context=B,this.refs=S,this.updater=Y||A}var P=k.prototype=new T;P.constructor=k,_(P,C.prototype),P.isPureReactComponent=!0;var L=Array.isArray,I=Object.prototype.hasOwnProperty,D={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function H(M,B,Y){var it,dt={},at=null,nt=null;if(B!=null)for(it in B.ref!==void 0&&(nt=B.ref),B.key!==void 0&&(at=""+B.key),B)I.call(B,it)&&!F.hasOwnProperty(it)&&(dt[it]=B[it]);var yt=arguments.length-2;if(yt===1)dt.children=Y;else if(1<yt){for(var ut=Array(yt),St=0;St<yt;St++)ut[St]=arguments[St+2];dt.children=ut}if(M&&M.defaultProps)for(it in yt=M.defaultProps,yt)dt[it]===void 0&&(dt[it]=yt[it]);return{$$typeof:p,type:M,key:at,ref:nt,props:dt,_owner:D.current}}function j(M,B){return{$$typeof:p,type:M.type,key:B,ref:M.ref,props:M.props,_owner:M._owner}}function Q(M){return typeof M=="object"&&M!==null&&M.$$typeof===p}function W(M){var B={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(Y){return B[Y]})}var tt=/\/+/g;function Z(M,B){return typeof M=="object"&&M!==null&&M.key!=null?W(""+M.key):B.toString(36)}function et(M,B,Y,it,dt){var at=typeof M;(at==="undefined"||at==="boolean")&&(M=null);var nt=!1;if(M===null)nt=!0;else switch(at){case"string":case"number":nt=!0;break;case"object":switch(M.$$typeof){case p:case t:nt=!0}}if(nt)return nt=M,dt=dt(nt),M=it===""?"."+Z(nt,0):it,L(dt)?(Y="",M!=null&&(Y=M.replace(tt,"$&/")+"/"),et(dt,B,Y,"",function(St){return St})):dt!=null&&(Q(dt)&&(dt=j(dt,Y+(!dt.key||nt&&nt.key===dt.key?"":(""+dt.key).replace(tt,"$&/")+"/")+M)),B.push(dt)),1;if(nt=0,it=it===""?".":it+":",L(M))for(var yt=0;yt<M.length;yt++){at=M[yt];var ut=it+Z(at,yt);nt+=et(at,B,Y,ut,dt)}else if(ut=m(M),typeof ut=="function")for(M=ut.call(M),yt=0;!(at=M.next()).done;)at=at.value,ut=it+Z(at,yt++),nt+=et(at,B,Y,ut,dt);else if(at==="object")throw B=String(M),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return nt}function ht(M,B,Y){if(M==null)return M;var it=[],dt=0;return et(M,it,"","",function(at){return B.call(Y,at,dt++)}),it}function J(M){if(M._status===-1){var B=M._result;B=B(),B.then(function(Y){(M._status===0||M._status===-1)&&(M._status=1,M._result=Y)},function(Y){(M._status===0||M._status===-1)&&(M._status=2,M._result=Y)}),M._status===-1&&(M._status=0,M._result=B)}if(M._status===1)return M._result.default;throw M._result}var G={current:null},q={transition:null},U={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:q,ReactCurrentOwner:D};function N(){throw Error("act(...) is not supported in production builds of React.")}return Vt.Children={map:ht,forEach:function(M,B,Y){ht(M,function(){B.apply(this,arguments)},Y)},count:function(M){var B=0;return ht(M,function(){B++}),B},toArray:function(M){return ht(M,function(B){return B})||[]},only:function(M){if(!Q(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Vt.Component=C,Vt.Fragment=e,Vt.Profiler=i,Vt.PureComponent=k,Vt.StrictMode=n,Vt.Suspense=h,Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,Vt.act=N,Vt.cloneElement=function(M,B,Y){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var it=_({},M.props),dt=M.key,at=M.ref,nt=M._owner;if(B!=null){if(B.ref!==void 0&&(at=B.ref,nt=D.current),B.key!==void 0&&(dt=""+B.key),M.type&&M.type.defaultProps)var yt=M.type.defaultProps;for(ut in B)I.call(B,ut)&&!F.hasOwnProperty(ut)&&(it[ut]=B[ut]===void 0&&yt!==void 0?yt[ut]:B[ut])}var ut=arguments.length-2;if(ut===1)it.children=Y;else if(1<ut){yt=Array(ut);for(var St=0;St<ut;St++)yt[St]=arguments[St+2];it.children=yt}return{$$typeof:p,type:M.type,key:dt,ref:at,props:it,_owner:nt}},Vt.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:s,_context:M},M.Consumer=M},Vt.createElement=H,Vt.createFactory=function(M){var B=H.bind(null,M);return B.type=M,B},Vt.createRef=function(){return{current:null}},Vt.forwardRef=function(M){return{$$typeof:l,render:M}},Vt.isValidElement=Q,Vt.lazy=function(M){return{$$typeof:f,_payload:{_status:-1,_result:M},_init:J}},Vt.memo=function(M,B){return{$$typeof:u,type:M,compare:B===void 0?null:B}},Vt.startTransition=function(M){var B=q.transition;q.transition={};try{M()}finally{q.transition=B}},Vt.unstable_act=N,Vt.useCallback=function(M,B){return G.current.useCallback(M,B)},Vt.useContext=function(M){return G.current.useContext(M)},Vt.useDebugValue=function(){},Vt.useDeferredValue=function(M){return G.current.useDeferredValue(M)},Vt.useEffect=function(M,B){return G.current.useEffect(M,B)},Vt.useId=function(){return G.current.useId()},Vt.useImperativeHandle=function(M,B,Y){return G.current.useImperativeHandle(M,B,Y)},Vt.useInsertionEffect=function(M,B){return G.current.useInsertionEffect(M,B)},Vt.useLayoutEffect=function(M,B){return G.current.useLayoutEffect(M,B)},Vt.useMemo=function(M,B){return G.current.useMemo(M,B)},Vt.useReducer=function(M,B,Y){return G.current.useReducer(M,B,Y)},Vt.useRef=function(M){return G.current.useRef(M)},Vt.useState=function(M){return G.current.useState(M)},Vt.useSyncExternalStore=function(M,B,Y){return G.current.useSyncExternalStore(M,B,Y)},Vt.useTransition=function(){return G.current.useTransition()},Vt.version="18.3.1",Vt}var QR;function kn(){return QR||(QR=1,k1.exports=U$()),k1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JR;function G$(){if(JR)return iy;JR=1;var p=kn(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,h,u){var f,g={},m=null,A=null;u!==void 0&&(m=""+u),h.key!==void 0&&(m=""+h.key),h.ref!==void 0&&(A=h.ref);for(f in h)n.call(h,f)&&!s.hasOwnProperty(f)&&(g[f]=h[f]);if(l&&l.defaultProps)for(f in h=l.defaultProps,h)g[f]===void 0&&(g[f]=h[f]);return{$$typeof:t,type:l,key:m,ref:A,props:g,_owner:i.current}}return iy.Fragment=e,iy.jsx=o,iy.jsxs=o,iy}var ZR;function Er(){return ZR||(ZR=1,T1.exports=G$()),T1.exports}var ce=Er(),fc=kn(),a_={},P1={exports:{}},Qi={},R1={exports:{}},L1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tL;function W$(){return tL||(tL=1,function(p){function t(q,U){var N=q.length;q.push(U);t:for(;0<N;){var M=N-1>>>1,B=q[M];if(0<i(B,U))q[M]=U,q[N]=B,N=M;else break t}}function e(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var U=q[0],N=q.pop();if(N!==U){q[0]=N;t:for(var M=0,B=q.length,Y=B>>>1;M<Y;){var it=2*(M+1)-1,dt=q[it],at=it+1,nt=q[at];if(0>i(dt,N))at<B&&0>i(nt,dt)?(q[M]=nt,q[at]=N,M=at):(q[M]=dt,q[it]=N,M=it);else if(at<B&&0>i(nt,N))q[M]=nt,q[at]=N,M=at;else break t}}return U}function i(q,U){var N=q.sortIndex-U.sortIndex;return N!==0?N:q.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;p.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();p.unstable_now=function(){return o.now()-l}}var h=[],u=[],f=1,g=null,m=3,A=!1,_=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(q){for(var U=e(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=q)n(u),U.sortIndex=U.expirationTime,t(h,U);else break;U=e(u)}}function L(q){if(S=!1,P(q),!_)if(e(h)!==null)_=!0,J(I);else{var U=e(u);U!==null&&G(L,U.startTime-q)}}function I(q,U){_=!1,S&&(S=!1,T(H),H=-1),A=!0;var N=m;try{for(P(U),g=e(h);g!==null&&(!(g.expirationTime>U)||q&&!W());){var M=g.callback;if(typeof M=="function"){g.callback=null,m=g.priorityLevel;var B=M(g.expirationTime<=U);U=p.unstable_now(),typeof B=="function"?g.callback=B:g===e(h)&&n(h),P(U)}else n(h);g=e(h)}if(g!==null)var Y=!0;else{var it=e(u);it!==null&&G(L,it.startTime-U),Y=!1}return Y}finally{g=null,m=N,A=!1}}var D=!1,F=null,H=-1,j=5,Q=-1;function W(){return!(p.unstable_now()-Q<j)}function tt(){if(F!==null){var q=p.unstable_now();Q=q;var U=!0;try{U=F(!0,q)}finally{U?Z():(D=!1,F=null)}}else D=!1}var Z;if(typeof k=="function")Z=function(){k(tt)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,ht=et.port2;et.port1.onmessage=tt,Z=function(){ht.postMessage(null)}}else Z=function(){C(tt,0)};function J(q){F=q,D||(D=!0,Z())}function G(q,U){H=C(function(){q(p.unstable_now())},U)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(q){q.callback=null},p.unstable_continueExecution=function(){_||A||(_=!0,J(I))},p.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<q?Math.floor(1e3/q):5},p.unstable_getCurrentPriorityLevel=function(){return m},p.unstable_getFirstCallbackNode=function(){return e(h)},p.unstable_next=function(q){switch(m){case 1:case 2:case 3:var U=3;break;default:U=m}var N=m;m=U;try{return q()}finally{m=N}},p.unstable_pauseExecution=function(){},p.unstable_requestPaint=function(){},p.unstable_runWithPriority=function(q,U){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var N=m;m=q;try{return U()}finally{m=N}},p.unstable_scheduleCallback=function(q,U,N){var M=p.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?M+N:M):N=M,q){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=N+B,q={id:f++,callback:U,priorityLevel:q,startTime:N,expirationTime:B,sortIndex:-1},N>M?(q.sortIndex=N,t(u,q),e(h)===null&&q===e(u)&&(S?(T(H),H=-1):S=!0,G(L,N-M))):(q.sortIndex=B,t(h,q),_||A||(_=!0,J(I))),q},p.unstable_shouldYield=W,p.unstable_wrapCallback=function(q){var U=m;return function(){var N=m;m=U;try{return q.apply(this,arguments)}finally{m=N}}}}(L1)),L1}var eL;function V$(){return eL||(eL=1,R1.exports=W$()),R1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nL;function q$(){if(nL)return Qi;nL=1;var p=kn(),t=V$();function e(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(i[a]=c,a=0;a<c.length;a++)n.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function m(a){return h.call(g,a)?!0:h.call(f,a)?!1:u.test(a)?g[a]=!0:(f[a]=!0,!1)}function A(a,c,d,y){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function _(a,c,d,y){if(c===null||typeof c>"u"||A(a,c,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function S(a,c,d,y,w,x,R){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=w,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=x,this.removeEmptyString=R}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){C[a]=new S(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];C[c]=new S(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){C[a]=new S(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){C[a]=new S(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){C[a]=new S(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){C[a]=new S(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){C[a]=new S(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){C[a]=new S(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){C[a]=new S(a,5,!1,a.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function k(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){C[a]=new S(a,1,!1,a.toLowerCase(),null,!1,!1)}),C.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){C[a]=new S(a,1,!1,a.toLowerCase(),null,!0,!0)});function P(a,c,d,y){var w=C.hasOwnProperty(c)?C[c]:null;(w!==null?w.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(_(c,d,w,y)&&(d=null),y||w===null?m(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):w.mustUseProperty?a[w.propertyName]=d===null?w.type===3?!1:"":d:(c=w.attributeName,y=w.attributeNamespace,d===null?a.removeAttribute(c):(w=w.type,d=w===3||w===4&&d===!0?"":""+d,y?a.setAttributeNS(y,c,d):a.setAttribute(c,d))))}var L=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),Q=Symbol.for("react.provider"),W=Symbol.for("react.context"),tt=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),et=Symbol.for("react.suspense_list"),ht=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),q=Symbol.iterator;function U(a){return a===null||typeof a!="object"?null:(a=q&&a[q]||a["@@iterator"],typeof a=="function"?a:null)}var N=Object.assign,M;function B(a){if(M===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);M=c&&c[1]||""}return`
`+M+a}var Y=!1;function it(a,c){if(!a||Y)return"";Y=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(K){var y=K}Reflect.construct(a,[],c)}else{try{c.call()}catch(K){y=K}a.call(c.prototype)}else{try{throw Error()}catch(K){y=K}a()}}catch(K){if(K&&y&&typeof K.stack=="string"){for(var w=K.stack.split(`
`),x=y.stack.split(`
`),R=w.length-1,O=x.length-1;1<=R&&0<=O&&w[R]!==x[O];)O--;for(;1<=R&&0<=O;R--,O--)if(w[R]!==x[O]){if(R!==1||O!==1)do if(R--,O--,0>O||w[R]!==x[O]){var $=`
`+w[R].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=R&&0<=O);break}}}finally{Y=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?B(a):""}function dt(a){switch(a.tag){case 5:return B(a.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return a=it(a.type,!1),a;case 11:return a=it(a.type.render,!1),a;case 1:return a=it(a.type,!0),a;default:return""}}function at(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case F:return"Fragment";case D:return"Portal";case j:return"Profiler";case H:return"StrictMode";case Z:return"Suspense";case et:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case W:return(a.displayName||"Context")+".Consumer";case Q:return(a._context.displayName||"Context")+".Provider";case tt:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ht:return c=a.displayName||null,c!==null?c:at(a.type)||"Memo";case J:c=a._payload,a=a._init;try{return at(a(c))}catch{}}return null}function nt(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return at(c);case 8:return c===H?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function yt(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function ut(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function St(a){var c=ut(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var w=d.get,x=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return w.call(this)},set:function(R){y=""+R,x.call(this,R)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function(R){y=""+R},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Kt(a){a._valueTracker||(a._valueTracker=St(a))}function Ee(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),y="";return a&&(y=ut(a)?a.checked?"true":"false":a.value),a=y,a!==d?(c.setValue(a),!0):!1}function Me(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Se(a,c){var d=c.checked;return N({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function rn(a,c){var d=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;d=yt(c.value!=null?c.value:d),a._wrapperState={initialChecked:y,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function oi(a,c){c=c.checked,c!=null&&P(a,"checked",c,!1)}function li(a,c){oi(a,c);var d=yt(c.value),y=c.type;if(d!=null)y==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?an(a,c.type,d):c.hasOwnProperty("defaultValue")&&an(a,c.type,yt(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Sr(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function an(a,c,d){(c!=="number"||Me(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var qs=Array.isArray;function Pi(a,c,d,y){if(a=a.options,c){c={};for(var w=0;w<d.length;w++)c["$"+d[w]]=!0;for(d=0;d<a.length;d++)w=c.hasOwnProperty("$"+a[d].value),a[d].selected!==w&&(a[d].selected=w),w&&y&&(a[d].defaultSelected=!0)}else{for(d=""+yt(d),c=null,w=0;w<a.length;w++){if(a[w].value===d){a[w].selected=!0,y&&(a[w].defaultSelected=!0);return}c!==null||a[w].disabled||(c=a[w])}c!==null&&(c.selected=!0)}}function ds(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(e(91));return N({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function pa(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(e(92));if(qs(d)){if(1<d.length)throw Error(e(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:yt(d)}}function xr(a,c){var d=yt(c.value),y=yt(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),y!=null&&(a.defaultValue=""+y)}function uo(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function fo(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hl(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?fo(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Bl,Cr=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,y,w){MSApp.execUnsafeLocalFunction(function(){return a(c,d,y,w)})}:a}(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Bl=Bl||document.createElement("div"),Bl.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Bl.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function me(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zl=["Webkit","ms","Moz","O"];Object.keys(Tr).forEach(function(a){zl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Tr[c]=Tr[a]})});function ci(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Tr.hasOwnProperty(a)&&Tr[a]?(""+c).trim():c+"px"}function fs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var y=d.indexOf("--")===0,w=ci(d,c[d],y);d==="float"&&(d="cssFloat"),y?a.setProperty(d,w):a[d]=w}}var ga=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wn(a,c){if(c){if(ga[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(e(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(e(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(e(61))}if(c.style!=null&&typeof c.style!="object")throw Error(e(62))}}function Ih(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ke=null;function Vn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ri=null,Pn=null,ps=null;function Ul(a){if(a=zm(a)){if(typeof Ri!="function")throw Error(e(280));var c=a.stateNode;c&&(c=_0(c),Ri(a.stateNode,a.type,c))}}function Kb(a){Pn?ps?ps.push(a):ps=[a]:Pn=a}function Qb(){if(Pn){var a=Pn,c=ps;if(ps=Pn=null,Ul(a),c)for(a=0;a<c.length;a++)Ul(c[a])}}function Jb(a,c){return a(c)}function po(){}var Gl=!1;function Dh(a,c,d){if(Gl)return a(c,d);Gl=!0;try{return Jb(a,c,d)}finally{Gl=!1,(Pn!==null||ps!==null)&&(po(),Qb())}}function go(a,c){var d=a.stateNode;if(d===null)return null;var y=_0(d);if(y===null)return null;d=y[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break t;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(e(231,c,typeof d));return d}var GE=!1;if(l)try{var wm={};Object.defineProperty(wm,"passive",{get:function(){GE=!0}}),window.addEventListener("test",wm,wm),window.removeEventListener("test",wm,wm)}catch{GE=!1}function qN(a,c,d,y,w,x,R,O,$){var K=Array.prototype.slice.call(arguments,3);try{c.apply(d,K)}catch(rt){this.onError(rt)}}var Em=!1,Zb=null,t0=!1,WE=null,XN={onError:function(a){Em=!0,Zb=a}};function YN(a,c,d,y,w,x,R,O,$){Em=!1,Zb=null,qN.apply(XN,arguments)}function KN(a,c,d,y,w,x,R,O,$){if(YN.apply(this,arguments),Em){if(Em){var K=Zb;Em=!1,Zb=null}else throw Error(e(198));t0||(t0=!0,WE=K)}}function Fh(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,c.flags&4098&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function vk(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Ak(a){if(Fh(a)!==a)throw Error(e(188))}function QN(a){var c=a.alternate;if(!c){if(c=Fh(a),c===null)throw Error(e(188));return c!==a?null:a}for(var d=a,y=c;;){var w=d.return;if(w===null)break;var x=w.alternate;if(x===null){if(y=w.return,y!==null){d=y;continue}break}if(w.child===x.child){for(x=w.child;x;){if(x===d)return Ak(w),a;if(x===y)return Ak(w),c;x=x.sibling}throw Error(e(188))}if(d.return!==y.return)d=w,y=x;else{for(var R=!1,O=w.child;O;){if(O===d){R=!0,d=w,y=x;break}if(O===y){R=!0,y=w,d=x;break}O=O.sibling}if(!R){for(O=x.child;O;){if(O===d){R=!0,d=x,y=w;break}if(O===y){R=!0,y=x,d=w;break}O=O.sibling}if(!R)throw Error(e(189))}}if(d.alternate!==y)throw Error(e(190))}if(d.tag!==3)throw Error(e(188));return d.stateNode.current===d?a:c}function bk(a){return a=QN(a),a!==null?_k(a):null}function _k(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=_k(a);if(c!==null)return c;a=a.sibling}return null}var wk=t.unstable_scheduleCallback,Ek=t.unstable_cancelCallback,JN=t.unstable_shouldYield,ZN=t.unstable_requestPaint,Qe=t.unstable_now,t2=t.unstable_getCurrentPriorityLevel,VE=t.unstable_ImmediatePriority,Sk=t.unstable_UserBlockingPriority,e0=t.unstable_NormalPriority,e2=t.unstable_LowPriority,xk=t.unstable_IdlePriority,n0=null,ma=null;function n2(a){if(ma&&typeof ma.onCommitFiberRoot=="function")try{ma.onCommitFiberRoot(n0,a,void 0,(a.current.flags&128)===128)}catch{}}var kr=Math.clz32?Math.clz32:r2,i2=Math.log,s2=Math.LN2;function r2(a){return a>>>=0,a===0?32:31-(i2(a)/s2|0)|0}var i0=64,s0=4194304;function Sm(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function r0(a,c){var d=a.pendingLanes;if(d===0)return 0;var y=0,w=a.suspendedLanes,x=a.pingedLanes,R=d&268435455;if(R!==0){var O=R&~w;O!==0?y=Sm(O):(x&=R,x!==0&&(y=Sm(x)))}else R=d&~w,R!==0?y=Sm(R):x!==0&&(y=Sm(x));if(y===0)return 0;if(c!==0&&c!==y&&!(c&w)&&(w=y&-y,x=c&-c,w>=x||w===16&&(x&4194240)!==0))return c;if(y&4&&(y|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)d=31-kr(c),w=1<<d,y|=a[d],c&=~w;return y}function a2(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function o2(a,c){for(var d=a.suspendedLanes,y=a.pingedLanes,w=a.expirationTimes,x=a.pendingLanes;0<x;){var R=31-kr(x),O=1<<R,$=w[R];$===-1?(!(O&d)||O&y)&&(w[R]=a2(O,c)):$<=c&&(a.expiredLanes|=O),x&=~O}}function qE(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Ck(){var a=i0;return i0<<=1,!(i0&4194240)&&(i0=64),a}function XE(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function xm(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-kr(c),a[c]=d}function l2(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<d;){var w=31-kr(d),x=1<<w;c[w]=0,y[w]=-1,a[w]=-1,d&=~x}}function YE(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var y=31-kr(d),w=1<<y;w&c|a[y]&c&&(a[y]|=c),d&=~w}}var oe=0;function Tk(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var kk,KE,Pk,Rk,Lk,QE=!1,a0=[],Wl=null,Vl=null,ql=null,Cm=new Map,Tm=new Map,Xl=[],c2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mk(a,c){switch(a){case"focusin":case"focusout":Wl=null;break;case"dragenter":case"dragleave":Vl=null;break;case"mouseover":case"mouseout":ql=null;break;case"pointerover":case"pointerout":Cm.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tm.delete(c.pointerId)}}function km(a,c,d,y,w,x){return a===null||a.nativeEvent!==x?(a={blockedOn:c,domEventName:d,eventSystemFlags:y,nativeEvent:x,targetContainers:[w]},c!==null&&(c=zm(c),c!==null&&KE(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),a)}function h2(a,c,d,y,w){switch(c){case"focusin":return Wl=km(Wl,a,c,d,y,w),!0;case"dragenter":return Vl=km(Vl,a,c,d,y,w),!0;case"mouseover":return ql=km(ql,a,c,d,y,w),!0;case"pointerover":var x=w.pointerId;return Cm.set(x,km(Cm.get(x)||null,a,c,d,y,w)),!0;case"gotpointercapture":return x=w.pointerId,Tm.set(x,km(Tm.get(x)||null,a,c,d,y,w)),!0}return!1}function Ik(a){var c=Oh(a.target);if(c!==null){var d=Fh(c);if(d!==null){if(c=d.tag,c===13){if(c=vk(d),c!==null){a.blockedOn=c,Lk(a.priority,function(){Pk(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function o0(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=ZE(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var y=new d.constructor(d.type,d);Ke=y,d.target.dispatchEvent(y),Ke=null}else return c=zm(d),c!==null&&KE(c),a.blockedOn=d,!1;c.shift()}return!0}function Dk(a,c,d){o0(a)&&d.delete(c)}function u2(){QE=!1,Wl!==null&&o0(Wl)&&(Wl=null),Vl!==null&&o0(Vl)&&(Vl=null),ql!==null&&o0(ql)&&(ql=null),Cm.forEach(Dk),Tm.forEach(Dk)}function Pm(a,c){a.blockedOn===c&&(a.blockedOn=null,QE||(QE=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,u2)))}function Rm(a){function c(w){return Pm(w,a)}if(0<a0.length){Pm(a0[0],a);for(var d=1;d<a0.length;d++){var y=a0[d];y.blockedOn===a&&(y.blockedOn=null)}}for(Wl!==null&&Pm(Wl,a),Vl!==null&&Pm(Vl,a),ql!==null&&Pm(ql,a),Cm.forEach(c),Tm.forEach(c),d=0;d<Xl.length;d++)y=Xl[d],y.blockedOn===a&&(y.blockedOn=null);for(;0<Xl.length&&(d=Xl[0],d.blockedOn===null);)Ik(d),d.blockedOn===null&&Xl.shift()}var wf=L.ReactCurrentBatchConfig,l0=!0;function d2(a,c,d,y){var w=oe,x=wf.transition;wf.transition=null;try{oe=1,JE(a,c,d,y)}finally{oe=w,wf.transition=x}}function f2(a,c,d,y){var w=oe,x=wf.transition;wf.transition=null;try{oe=4,JE(a,c,d,y)}finally{oe=w,wf.transition=x}}function JE(a,c,d,y){if(l0){var w=ZE(a,c,d,y);if(w===null)mS(a,c,y,c0,d),Mk(a,y);else if(h2(w,a,c,d,y))y.stopPropagation();else if(Mk(a,y),c&4&&-1<c2.indexOf(a)){for(;w!==null;){var x=zm(w);if(x!==null&&kk(x),x=ZE(a,c,d,y),x===null&&mS(a,c,y,c0,d),x===w)break;w=x}w!==null&&y.stopPropagation()}else mS(a,c,y,null,d)}}var c0=null;function ZE(a,c,d,y){if(c0=null,a=Vn(y),a=Oh(a),a!==null)if(c=Fh(a),c===null)a=null;else if(d=c.tag,d===13){if(a=vk(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return c0=a,null}function Fk(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t2()){case VE:return 1;case Sk:return 4;case e0:case e2:return 16;case xk:return 536870912;default:return 16}default:return 16}}var Yl=null,tS=null,h0=null;function Ok(){if(h0)return h0;var a,c=tS,d=c.length,y,w="value"in Yl?Yl.value:Yl.textContent,x=w.length;for(a=0;a<d&&c[a]===w[a];a++);var R=d-a;for(y=1;y<=R&&c[d-y]===w[x-y];y++);return h0=w.slice(a,1<y?1-y:void 0)}function u0(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function d0(){return!0}function Nk(){return!1}function gs(a){function c(d,y,w,x,R){this._reactName=d,this._targetInst=w,this.type=y,this.nativeEvent=x,this.target=R,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(d=a[O],this[O]=d?d(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?d0:Nk,this.isPropagationStopped=Nk,this}return N(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=d0)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=d0)},persist:function(){},isPersistent:d0}),c}var Ef={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eS=gs(Ef),Lm=N({},Ef,{view:0,detail:0}),p2=gs(Lm),nS,iS,Mm,f0=N({},Lm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rS,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Mm&&(Mm&&a.type==="mousemove"?(nS=a.screenX-Mm.screenX,iS=a.screenY-Mm.screenY):iS=nS=0,Mm=a),nS)},movementY:function(a){return"movementY"in a?a.movementY:iS}}),$k=gs(f0),g2=N({},f0,{dataTransfer:0}),m2=gs(g2),y2=N({},Lm,{relatedTarget:0}),sS=gs(y2),v2=N({},Ef,{animationName:0,elapsedTime:0,pseudoElement:0}),A2=gs(v2),b2=N({},Ef,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),_2=gs(b2),w2=N({},Ef,{data:0}),jk=gs(w2),E2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C2(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=x2[a])?!!c[a]:!1}function rS(){return C2}var T2=N({},Lm,{key:function(a){if(a.key){var c=E2[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=u0(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?S2[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rS,charCode:function(a){return a.type==="keypress"?u0(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?u0(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),k2=gs(T2),P2=N({},f0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hk=gs(P2),R2=N({},Lm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rS}),L2=gs(R2),M2=N({},Ef,{propertyName:0,elapsedTime:0,pseudoElement:0}),I2=gs(M2),D2=N({},f0,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),F2=gs(D2),O2=[9,13,27,32],aS=l&&"CompositionEvent"in window,Im=null;l&&"documentMode"in document&&(Im=document.documentMode);var N2=l&&"TextEvent"in window&&!Im,Bk=l&&(!aS||Im&&8<Im&&11>=Im),zk=" ",Uk=!1;function Gk(a,c){switch(a){case"keyup":return O2.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wk(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Sf=!1;function $2(a,c){switch(a){case"compositionend":return Wk(c);case"keypress":return c.which!==32?null:(Uk=!0,zk);case"textInput":return a=c.data,a===zk&&Uk?null:a;default:return null}}function j2(a,c){if(Sf)return a==="compositionend"||!aS&&Gk(a,c)?(a=Ok(),h0=tS=Yl=null,Sf=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Bk&&c.locale!=="ko"?null:c.data;default:return null}}var H2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vk(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!H2[a.type]:c==="textarea"}function qk(a,c,d,y){Kb(y),c=v0(c,"onChange"),0<c.length&&(d=new eS("onChange","change",null,d,y),a.push({event:d,listeners:c}))}var Dm=null,Fm=null;function B2(a){uP(a,0)}function p0(a){var c=Pf(a);if(Ee(c))return a}function z2(a,c){if(a==="change")return c}var Xk=!1;if(l){var oS;if(l){var lS="oninput"in document;if(!lS){var Yk=document.createElement("div");Yk.setAttribute("oninput","return;"),lS=typeof Yk.oninput=="function"}oS=lS}else oS=!1;Xk=oS&&(!document.documentMode||9<document.documentMode)}function Kk(){Dm&&(Dm.detachEvent("onpropertychange",Qk),Fm=Dm=null)}function Qk(a){if(a.propertyName==="value"&&p0(Fm)){var c=[];qk(c,Fm,a,Vn(a)),Dh(B2,c)}}function U2(a,c,d){a==="focusin"?(Kk(),Dm=c,Fm=d,Dm.attachEvent("onpropertychange",Qk)):a==="focusout"&&Kk()}function G2(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return p0(Fm)}function W2(a,c){if(a==="click")return p0(c)}function V2(a,c){if(a==="input"||a==="change")return p0(c)}function q2(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Pr=typeof Object.is=="function"?Object.is:q2;function Om(a,c){if(Pr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),y=Object.keys(c);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var w=d[y];if(!h.call(c,w)||!Pr(a[w],c[w]))return!1}return!0}function Jk(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Zk(a,c){var d=Jk(a);a=0;for(var y;d;){if(d.nodeType===3){if(y=a+d.textContent.length,a<=c&&y>=c)return{node:d,offset:c-a};a=y}t:{for(;d;){if(d.nextSibling){d=d.nextSibling;break t}d=d.parentNode}d=void 0}d=Jk(d)}}function tP(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?tP(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function eP(){for(var a=window,c=Me();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Me(a.document)}return c}function cS(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function X2(a){var c=eP(),d=a.focusedElem,y=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&tP(d.ownerDocument.documentElement,d)){if(y!==null&&cS(d)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var w=d.textContent.length,x=Math.min(y.start,w);y=y.end===void 0?x:Math.min(y.end,w),!a.extend&&x>y&&(w=y,y=x,x=w),w=Zk(d,x);var R=Zk(d,y);w&&R&&(a.rangeCount!==1||a.anchorNode!==w.node||a.anchorOffset!==w.offset||a.focusNode!==R.node||a.focusOffset!==R.offset)&&(c=c.createRange(),c.setStart(w.node,w.offset),a.removeAllRanges(),x>y?(a.addRange(c),a.extend(R.node,R.offset)):(c.setEnd(R.node,R.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Y2=l&&"documentMode"in document&&11>=document.documentMode,xf=null,hS=null,Nm=null,uS=!1;function nP(a,c,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;uS||xf==null||xf!==Me(y)||(y=xf,"selectionStart"in y&&cS(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Nm&&Om(Nm,y)||(Nm=y,y=v0(hS,"onSelect"),0<y.length&&(c=new eS("onSelect","select",null,c,d),a.push({event:c,listeners:y}),c.target=xf)))}function g0(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var Cf={animationend:g0("Animation","AnimationEnd"),animationiteration:g0("Animation","AnimationIteration"),animationstart:g0("Animation","AnimationStart"),transitionend:g0("Transition","TransitionEnd")},dS={},iP={};l&&(iP=document.createElement("div").style,"AnimationEvent"in window||(delete Cf.animationend.animation,delete Cf.animationiteration.animation,delete Cf.animationstart.animation),"TransitionEvent"in window||delete Cf.transitionend.transition);function m0(a){if(dS[a])return dS[a];if(!Cf[a])return a;var c=Cf[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in iP)return dS[a]=c[d];return a}var sP=m0("animationend"),rP=m0("animationiteration"),aP=m0("animationstart"),oP=m0("transitionend"),lP=new Map,cP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kl(a,c){lP.set(a,c),s(c,[a])}for(var fS=0;fS<cP.length;fS++){var pS=cP[fS],K2=pS.toLowerCase(),Q2=pS[0].toUpperCase()+pS.slice(1);Kl(K2,"on"+Q2)}Kl(sP,"onAnimationEnd"),Kl(rP,"onAnimationIteration"),Kl(aP,"onAnimationStart"),Kl("dblclick","onDoubleClick"),Kl("focusin","onFocus"),Kl("focusout","onBlur"),Kl(oP,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $m="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J2=new Set("cancel close invalid load scroll toggle".split(" ").concat($m));function hP(a,c,d){var y=a.type||"unknown-event";a.currentTarget=d,KN(y,c,void 0,a),a.currentTarget=null}function uP(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var y=a[d],w=y.event;y=y.listeners;t:{var x=void 0;if(c)for(var R=y.length-1;0<=R;R--){var O=y[R],$=O.instance,K=O.currentTarget;if(O=O.listener,$!==x&&w.isPropagationStopped())break t;hP(w,O,K),x=$}else for(R=0;R<y.length;R++){if(O=y[R],$=O.instance,K=O.currentTarget,O=O.listener,$!==x&&w.isPropagationStopped())break t;hP(w,O,K),x=$}}}if(t0)throw a=WE,t0=!1,WE=null,a}function Te(a,c){var d=c[wS];d===void 0&&(d=c[wS]=new Set);var y=a+"__bubble";d.has(y)||(dP(c,a,2,!1),d.add(y))}function gS(a,c,d){var y=0;c&&(y|=4),dP(d,a,y,c)}var y0="_reactListening"+Math.random().toString(36).slice(2);function jm(a){if(!a[y0]){a[y0]=!0,n.forEach(function(d){d!=="selectionchange"&&(J2.has(d)||gS(d,!1,a),gS(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[y0]||(c[y0]=!0,gS("selectionchange",!1,c))}}function dP(a,c,d,y){switch(Fk(c)){case 1:var w=d2;break;case 4:w=f2;break;default:w=JE}d=w.bind(null,c,d,a),w=void 0,!GE||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),y?w!==void 0?a.addEventListener(c,d,{capture:!0,passive:w}):a.addEventListener(c,d,!0):w!==void 0?a.addEventListener(c,d,{passive:w}):a.addEventListener(c,d,!1)}function mS(a,c,d,y,w){var x=y;if(!(c&1)&&!(c&2)&&y!==null)t:for(;;){if(y===null)return;var R=y.tag;if(R===3||R===4){var O=y.stateNode.containerInfo;if(O===w||O.nodeType===8&&O.parentNode===w)break;if(R===4)for(R=y.return;R!==null;){var $=R.tag;if(($===3||$===4)&&($=R.stateNode.containerInfo,$===w||$.nodeType===8&&$.parentNode===w))return;R=R.return}for(;O!==null;){if(R=Oh(O),R===null)return;if($=R.tag,$===5||$===6){y=x=R;continue t}O=O.parentNode}}y=y.return}Dh(function(){var K=x,rt=Vn(d),ot=[];t:{var st=lP.get(a);if(st!==void 0){var mt=eS,Et=a;switch(a){case"keypress":if(u0(d)===0)break t;case"keydown":case"keyup":mt=k2;break;case"focusin":Et="focus",mt=sS;break;case"focusout":Et="blur",mt=sS;break;case"beforeblur":case"afterblur":mt=sS;break;case"click":if(d.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=$k;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=m2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=L2;break;case sP:case rP:case aP:mt=A2;break;case oP:mt=I2;break;case"scroll":mt=p2;break;case"wheel":mt=F2;break;case"copy":case"cut":case"paste":mt=_2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=Hk}var xt=(c&4)!==0,Je=!xt&&a==="scroll",V=xt?st!==null?st+"Capture":null:st;xt=[];for(var z=K,X;z!==null;){X=z;var ct=X.stateNode;if(X.tag===5&&ct!==null&&(X=ct,V!==null&&(ct=go(z,V),ct!=null&&xt.push(Hm(z,ct,X)))),Je)break;z=z.return}0<xt.length&&(st=new mt(st,Et,null,d,rt),ot.push({event:st,listeners:xt}))}}if(!(c&7)){t:{if(st=a==="mouseover"||a==="pointerover",mt=a==="mouseout"||a==="pointerout",st&&d!==Ke&&(Et=d.relatedTarget||d.fromElement)&&(Oh(Et)||Et[mo]))break t;if((mt||st)&&(st=rt.window===rt?rt:(st=rt.ownerDocument)?st.defaultView||st.parentWindow:window,mt?(Et=d.relatedTarget||d.toElement,mt=K,Et=Et?Oh(Et):null,Et!==null&&(Je=Fh(Et),Et!==Je||Et.tag!==5&&Et.tag!==6)&&(Et=null)):(mt=null,Et=K),mt!==Et)){if(xt=$k,ct="onMouseLeave",V="onMouseEnter",z="mouse",(a==="pointerout"||a==="pointerover")&&(xt=Hk,ct="onPointerLeave",V="onPointerEnter",z="pointer"),Je=mt==null?st:Pf(mt),X=Et==null?st:Pf(Et),st=new xt(ct,z+"leave",mt,d,rt),st.target=Je,st.relatedTarget=X,ct=null,Oh(rt)===K&&(xt=new xt(V,z+"enter",Et,d,rt),xt.target=X,xt.relatedTarget=Je,ct=xt),Je=ct,mt&&Et)e:{for(xt=mt,V=Et,z=0,X=xt;X;X=Tf(X))z++;for(X=0,ct=V;ct;ct=Tf(ct))X++;for(;0<z-X;)xt=Tf(xt),z--;for(;0<X-z;)V=Tf(V),X--;for(;z--;){if(xt===V||V!==null&&xt===V.alternate)break e;xt=Tf(xt),V=Tf(V)}xt=null}else xt=null;mt!==null&&fP(ot,st,mt,xt,!1),Et!==null&&Je!==null&&fP(ot,Je,Et,xt,!0)}}t:{if(st=K?Pf(K):window,mt=st.nodeName&&st.nodeName.toLowerCase(),mt==="select"||mt==="input"&&st.type==="file")var Ct=z2;else if(Vk(st))if(Xk)Ct=V2;else{Ct=G2;var Lt=U2}else(mt=st.nodeName)&&mt.toLowerCase()==="input"&&(st.type==="checkbox"||st.type==="radio")&&(Ct=W2);if(Ct&&(Ct=Ct(a,K))){qk(ot,Ct,d,rt);break t}Lt&&Lt(a,st,K),a==="focusout"&&(Lt=st._wrapperState)&&Lt.controlled&&st.type==="number"&&an(st,"number",st.value)}switch(Lt=K?Pf(K):window,a){case"focusin":(Vk(Lt)||Lt.contentEditable==="true")&&(xf=Lt,hS=K,Nm=null);break;case"focusout":Nm=hS=xf=null;break;case"mousedown":uS=!0;break;case"contextmenu":case"mouseup":case"dragend":uS=!1,nP(ot,d,rt);break;case"selectionchange":if(Y2)break;case"keydown":case"keyup":nP(ot,d,rt)}var Mt;if(aS)t:{switch(a){case"compositionstart":var Dt="onCompositionStart";break t;case"compositionend":Dt="onCompositionEnd";break t;case"compositionupdate":Dt="onCompositionUpdate";break t}Dt=void 0}else Sf?Gk(a,d)&&(Dt="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Dt="onCompositionStart");Dt&&(Bk&&d.locale!=="ko"&&(Sf||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&Sf&&(Mt=Ok()):(Yl=rt,tS="value"in Yl?Yl.value:Yl.textContent,Sf=!0)),Lt=v0(K,Dt),0<Lt.length&&(Dt=new jk(Dt,a,null,d,rt),ot.push({event:Dt,listeners:Lt}),Mt?Dt.data=Mt:(Mt=Wk(d),Mt!==null&&(Dt.data=Mt)))),(Mt=N2?$2(a,d):j2(a,d))&&(K=v0(K,"onBeforeInput"),0<K.length&&(rt=new jk("onBeforeInput","beforeinput",null,d,rt),ot.push({event:rt,listeners:K}),rt.data=Mt))}uP(ot,c)})}function Hm(a,c,d){return{instance:a,listener:c,currentTarget:d}}function v0(a,c){for(var d=c+"Capture",y=[];a!==null;){var w=a,x=w.stateNode;w.tag===5&&x!==null&&(w=x,x=go(a,d),x!=null&&y.unshift(Hm(a,x,w)),x=go(a,c),x!=null&&y.push(Hm(a,x,w))),a=a.return}return y}function Tf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function fP(a,c,d,y,w){for(var x=c._reactName,R=[];d!==null&&d!==y;){var O=d,$=O.alternate,K=O.stateNode;if($!==null&&$===y)break;O.tag===5&&K!==null&&(O=K,w?($=go(d,x),$!=null&&R.unshift(Hm(d,$,O))):w||($=go(d,x),$!=null&&R.push(Hm(d,$,O)))),d=d.return}R.length!==0&&a.push({event:c,listeners:R})}var Z2=/\r\n?/g,t$=/\u0000|\uFFFD/g;function pP(a){return(typeof a=="string"?a:""+a).replace(Z2,`
`).replace(t$,"")}function A0(a,c,d){if(c=pP(c),pP(a)!==c&&d)throw Error(e(425))}function b0(){}var yS=null,vS=null;function AS(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var bS=typeof setTimeout=="function"?setTimeout:void 0,e$=typeof clearTimeout=="function"?clearTimeout:void 0,gP=typeof Promise=="function"?Promise:void 0,n$=typeof queueMicrotask=="function"?queueMicrotask:typeof gP<"u"?function(a){return gP.resolve(null).then(a).catch(i$)}:bS;function i$(a){setTimeout(function(){throw a})}function _S(a,c){var d=c,y=0;do{var w=d.nextSibling;if(a.removeChild(d),w&&w.nodeType===8)if(d=w.data,d==="/$"){if(y===0){a.removeChild(w),Rm(c);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=w}while(d);Rm(c)}function Ql(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function mP(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var kf=Math.random().toString(36).slice(2),ya="__reactFiber$"+kf,Bm="__reactProps$"+kf,mo="__reactContainer$"+kf,wS="__reactEvents$"+kf,s$="__reactListeners$"+kf,r$="__reactHandles$"+kf;function Oh(a){var c=a[ya];if(c)return c;for(var d=a.parentNode;d;){if(c=d[mo]||d[ya]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=mP(a);a!==null;){if(d=a[ya])return d;a=mP(a)}return c}a=d,d=a.parentNode}return null}function zm(a){return a=a[ya]||a[mo],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Pf(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(e(33))}function _0(a){return a[Bm]||null}var ES=[],Rf=-1;function Jl(a){return{current:a}}function ke(a){0>Rf||(a.current=ES[Rf],ES[Rf]=null,Rf--)}function xe(a,c){Rf++,ES[Rf]=a.current,a.current=c}var Zl={},hi=Jl(Zl),Vi=Jl(!1),Nh=Zl;function Lf(a,c){var d=a.type.contextTypes;if(!d)return Zl;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var w={},x;for(x in d)w[x]=c[x];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=w),w}function qi(a){return a=a.childContextTypes,a!=null}function w0(){ke(Vi),ke(hi)}function yP(a,c,d){if(hi.current!==Zl)throw Error(e(168));xe(hi,c),xe(Vi,d)}function vP(a,c,d){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var w in y)if(!(w in c))throw Error(e(108,nt(a)||"Unknown",w));return N({},d,y)}function E0(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Zl,Nh=hi.current,xe(hi,a),xe(Vi,Vi.current),!0}function AP(a,c,d){var y=a.stateNode;if(!y)throw Error(e(169));d?(a=vP(a,c,Nh),y.__reactInternalMemoizedMergedChildContext=a,ke(Vi),ke(hi),xe(hi,a)):ke(Vi),xe(Vi,d)}var yo=null,S0=!1,SS=!1;function bP(a){yo===null?yo=[a]:yo.push(a)}function a$(a){S0=!0,bP(a)}function tc(){if(!SS&&yo!==null){SS=!0;var a=0,c=oe;try{var d=yo;for(oe=1;a<d.length;a++){var y=d[a];do y=y(!0);while(y!==null)}yo=null,S0=!1}catch(w){throw yo!==null&&(yo=yo.slice(a+1)),wk(VE,tc),w}finally{oe=c,SS=!1}}return null}var Mf=[],If=0,x0=null,C0=0,Xs=[],Ys=0,$h=null,vo=1,Ao="";function jh(a,c){Mf[If++]=C0,Mf[If++]=x0,x0=a,C0=c}function _P(a,c,d){Xs[Ys++]=vo,Xs[Ys++]=Ao,Xs[Ys++]=$h,$h=a;var y=vo;a=Ao;var w=32-kr(y)-1;y&=~(1<<w),d+=1;var x=32-kr(c)+w;if(30<x){var R=w-w%5;x=(y&(1<<R)-1).toString(32),y>>=R,w-=R,vo=1<<32-kr(c)+w|d<<w|y,Ao=x+a}else vo=1<<x|d<<w|y,Ao=a}function xS(a){a.return!==null&&(jh(a,1),_P(a,1,0))}function CS(a){for(;a===x0;)x0=Mf[--If],Mf[If]=null,C0=Mf[--If],Mf[If]=null;for(;a===$h;)$h=Xs[--Ys],Xs[Ys]=null,Ao=Xs[--Ys],Xs[Ys]=null,vo=Xs[--Ys],Xs[Ys]=null}var ms=null,ys=null,Ie=!1,Rr=null;function wP(a,c){var d=Zs(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function EP(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,ms=a,ys=Ql(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,ms=a,ys=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=$h!==null?{id:vo,overflow:Ao}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Zs(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,ms=a,ys=null,!0):!1;default:return!1}}function TS(a){return(a.mode&1)!==0&&(a.flags&128)===0}function kS(a){if(Ie){var c=ys;if(c){var d=c;if(!EP(a,c)){if(TS(a))throw Error(e(418));c=Ql(d.nextSibling);var y=ms;c&&EP(a,c)?wP(y,d):(a.flags=a.flags&-4097|2,Ie=!1,ms=a)}}else{if(TS(a))throw Error(e(418));a.flags=a.flags&-4097|2,Ie=!1,ms=a}}}function SP(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;ms=a}function T0(a){if(a!==ms)return!1;if(!Ie)return SP(a),Ie=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!AS(a.type,a.memoizedProps)),c&&(c=ys)){if(TS(a))throw xP(),Error(e(418));for(;c;)wP(a,c),c=Ql(c.nextSibling)}if(SP(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(e(317));t:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){ys=Ql(a.nextSibling);break t}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}ys=null}}else ys=ms?Ql(a.stateNode.nextSibling):null;return!0}function xP(){for(var a=ys;a;)a=Ql(a.nextSibling)}function Df(){ys=ms=null,Ie=!1}function PS(a){Rr===null?Rr=[a]:Rr.push(a)}var o$=L.ReactCurrentBatchConfig;function Um(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(e(309));var y=d.stateNode}if(!y)throw Error(e(147,a));var w=y,x=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(R){var O=w.refs;R===null?delete O[x]:O[x]=R},c._stringRef=x,c)}if(typeof a!="string")throw Error(e(284));if(!d._owner)throw Error(e(290,a))}return a}function k0(a,c){throw a=Object.prototype.toString.call(c),Error(e(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function CP(a){var c=a._init;return c(a._payload)}function TP(a){function c(V,z){if(a){var X=V.deletions;X===null?(V.deletions=[z],V.flags|=16):X.push(z)}}function d(V,z){if(!a)return null;for(;z!==null;)c(V,z),z=z.sibling;return null}function y(V,z){for(V=new Map;z!==null;)z.key!==null?V.set(z.key,z):V.set(z.index,z),z=z.sibling;return V}function w(V,z){return V=lc(V,z),V.index=0,V.sibling=null,V}function x(V,z,X){return V.index=X,a?(X=V.alternate,X!==null?(X=X.index,X<z?(V.flags|=2,z):X):(V.flags|=2,z)):(V.flags|=1048576,z)}function R(V){return a&&V.alternate===null&&(V.flags|=2),V}function O(V,z,X,ct){return z===null||z.tag!==6?(z=b1(X,V.mode,ct),z.return=V,z):(z=w(z,X),z.return=V,z)}function $(V,z,X,ct){var Ct=X.type;return Ct===F?rt(V,z,X.props.children,ct,X.key):z!==null&&(z.elementType===Ct||typeof Ct=="object"&&Ct!==null&&Ct.$$typeof===J&&CP(Ct)===z.type)?(ct=w(z,X.props),ct.ref=Um(V,z,X),ct.return=V,ct):(ct=J0(X.type,X.key,X.props,null,V.mode,ct),ct.ref=Um(V,z,X),ct.return=V,ct)}function K(V,z,X,ct){return z===null||z.tag!==4||z.stateNode.containerInfo!==X.containerInfo||z.stateNode.implementation!==X.implementation?(z=_1(X,V.mode,ct),z.return=V,z):(z=w(z,X.children||[]),z.return=V,z)}function rt(V,z,X,ct,Ct){return z===null||z.tag!==7?(z=qh(X,V.mode,ct,Ct),z.return=V,z):(z=w(z,X),z.return=V,z)}function ot(V,z,X){if(typeof z=="string"&&z!==""||typeof z=="number")return z=b1(""+z,V.mode,X),z.return=V,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case I:return X=J0(z.type,z.key,z.props,null,V.mode,X),X.ref=Um(V,null,z),X.return=V,X;case D:return z=_1(z,V.mode,X),z.return=V,z;case J:var ct=z._init;return ot(V,ct(z._payload),X)}if(qs(z)||U(z))return z=qh(z,V.mode,X,null),z.return=V,z;k0(V,z)}return null}function st(V,z,X,ct){var Ct=z!==null?z.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Ct!==null?null:O(V,z,""+X,ct);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case I:return X.key===Ct?$(V,z,X,ct):null;case D:return X.key===Ct?K(V,z,X,ct):null;case J:return Ct=X._init,st(V,z,Ct(X._payload),ct)}if(qs(X)||U(X))return Ct!==null?null:rt(V,z,X,ct,null);k0(V,X)}return null}function mt(V,z,X,ct,Ct){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return V=V.get(X)||null,O(z,V,""+ct,Ct);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case I:return V=V.get(ct.key===null?X:ct.key)||null,$(z,V,ct,Ct);case D:return V=V.get(ct.key===null?X:ct.key)||null,K(z,V,ct,Ct);case J:var Lt=ct._init;return mt(V,z,X,Lt(ct._payload),Ct)}if(qs(ct)||U(ct))return V=V.get(X)||null,rt(z,V,ct,Ct,null);k0(z,ct)}return null}function Et(V,z,X,ct){for(var Ct=null,Lt=null,Mt=z,Dt=z=0,Mn=null;Mt!==null&&Dt<X.length;Dt++){Mt.index>Dt?(Mn=Mt,Mt=null):Mn=Mt.sibling;var ie=st(V,Mt,X[Dt],ct);if(ie===null){Mt===null&&(Mt=Mn);break}a&&Mt&&ie.alternate===null&&c(V,Mt),z=x(ie,z,Dt),Lt===null?Ct=ie:Lt.sibling=ie,Lt=ie,Mt=Mn}if(Dt===X.length)return d(V,Mt),Ie&&jh(V,Dt),Ct;if(Mt===null){for(;Dt<X.length;Dt++)Mt=ot(V,X[Dt],ct),Mt!==null&&(z=x(Mt,z,Dt),Lt===null?Ct=Mt:Lt.sibling=Mt,Lt=Mt);return Ie&&jh(V,Dt),Ct}for(Mt=y(V,Mt);Dt<X.length;Dt++)Mn=mt(Mt,V,Dt,X[Dt],ct),Mn!==null&&(a&&Mn.alternate!==null&&Mt.delete(Mn.key===null?Dt:Mn.key),z=x(Mn,z,Dt),Lt===null?Ct=Mn:Lt.sibling=Mn,Lt=Mn);return a&&Mt.forEach(function(cc){return c(V,cc)}),Ie&&jh(V,Dt),Ct}function xt(V,z,X,ct){var Ct=U(X);if(typeof Ct!="function")throw Error(e(150));if(X=Ct.call(X),X==null)throw Error(e(151));for(var Lt=Ct=null,Mt=z,Dt=z=0,Mn=null,ie=X.next();Mt!==null&&!ie.done;Dt++,ie=X.next()){Mt.index>Dt?(Mn=Mt,Mt=null):Mn=Mt.sibling;var cc=st(V,Mt,ie.value,ct);if(cc===null){Mt===null&&(Mt=Mn);break}a&&Mt&&cc.alternate===null&&c(V,Mt),z=x(cc,z,Dt),Lt===null?Ct=cc:Lt.sibling=cc,Lt=cc,Mt=Mn}if(ie.done)return d(V,Mt),Ie&&jh(V,Dt),Ct;if(Mt===null){for(;!ie.done;Dt++,ie=X.next())ie=ot(V,ie.value,ct),ie!==null&&(z=x(ie,z,Dt),Lt===null?Ct=ie:Lt.sibling=ie,Lt=ie);return Ie&&jh(V,Dt),Ct}for(Mt=y(V,Mt);!ie.done;Dt++,ie=X.next())ie=mt(Mt,V,Dt,ie.value,ct),ie!==null&&(a&&ie.alternate!==null&&Mt.delete(ie.key===null?Dt:ie.key),z=x(ie,z,Dt),Lt===null?Ct=ie:Lt.sibling=ie,Lt=ie);return a&&Mt.forEach(function(j$){return c(V,j$)}),Ie&&jh(V,Dt),Ct}function Je(V,z,X,ct){if(typeof X=="object"&&X!==null&&X.type===F&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case I:t:{for(var Ct=X.key,Lt=z;Lt!==null;){if(Lt.key===Ct){if(Ct=X.type,Ct===F){if(Lt.tag===7){d(V,Lt.sibling),z=w(Lt,X.props.children),z.return=V,V=z;break t}}else if(Lt.elementType===Ct||typeof Ct=="object"&&Ct!==null&&Ct.$$typeof===J&&CP(Ct)===Lt.type){d(V,Lt.sibling),z=w(Lt,X.props),z.ref=Um(V,Lt,X),z.return=V,V=z;break t}d(V,Lt);break}else c(V,Lt);Lt=Lt.sibling}X.type===F?(z=qh(X.props.children,V.mode,ct,X.key),z.return=V,V=z):(ct=J0(X.type,X.key,X.props,null,V.mode,ct),ct.ref=Um(V,z,X),ct.return=V,V=ct)}return R(V);case D:t:{for(Lt=X.key;z!==null;){if(z.key===Lt)if(z.tag===4&&z.stateNode.containerInfo===X.containerInfo&&z.stateNode.implementation===X.implementation){d(V,z.sibling),z=w(z,X.children||[]),z.return=V,V=z;break t}else{d(V,z);break}else c(V,z);z=z.sibling}z=_1(X,V.mode,ct),z.return=V,V=z}return R(V);case J:return Lt=X._init,Je(V,z,Lt(X._payload),ct)}if(qs(X))return Et(V,z,X,ct);if(U(X))return xt(V,z,X,ct);k0(V,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,z!==null&&z.tag===6?(d(V,z.sibling),z=w(z,X),z.return=V,V=z):(d(V,z),z=b1(X,V.mode,ct),z.return=V,V=z),R(V)):d(V,z)}return Je}var Ff=TP(!0),kP=TP(!1),P0=Jl(null),R0=null,Of=null,RS=null;function LS(){RS=Of=R0=null}function MS(a){var c=P0.current;ke(P0),a._currentValue=c}function IS(a,c,d){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===d)break;a=a.return}}function Nf(a,c){R0=a,RS=Of=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&c&&(Xi=!0),a.firstContext=null)}function Ks(a){var c=a._currentValue;if(RS!==a)if(a={context:a,memoizedValue:c,next:null},Of===null){if(R0===null)throw Error(e(308));Of=a,R0.dependencies={lanes:0,firstContext:a}}else Of=Of.next=a;return c}var Hh=null;function DS(a){Hh===null?Hh=[a]:Hh.push(a)}function PP(a,c,d,y){var w=c.interleaved;return w===null?(d.next=d,DS(c)):(d.next=w.next,w.next=d),c.interleaved=d,bo(a,y)}function bo(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var ec=!1;function FS(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function RP(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function _o(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function nc(a,c,d){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,ee&2){var w=y.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),y.pending=c,bo(a,d)}return w=y.interleaved,w===null?(c.next=c,DS(y)):(c.next=w.next,w.next=c),y.interleaved=c,bo(a,d)}function L0(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,YE(a,d)}}function LP(a,c){var d=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var w=null,x=null;if(d=d.firstBaseUpdate,d!==null){do{var R={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};x===null?w=x=R:x=x.next=R,d=d.next}while(d!==null);x===null?w=x=c:x=x.next=c}else w=x=c;d={baseState:y.baseState,firstBaseUpdate:w,lastBaseUpdate:x,shared:y.shared,effects:y.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function M0(a,c,d,y){var w=a.updateQueue;ec=!1;var x=w.firstBaseUpdate,R=w.lastBaseUpdate,O=w.shared.pending;if(O!==null){w.shared.pending=null;var $=O,K=$.next;$.next=null,R===null?x=K:R.next=K,R=$;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,O=rt.lastBaseUpdate,O!==R&&(O===null?rt.firstBaseUpdate=K:O.next=K,rt.lastBaseUpdate=$))}if(x!==null){var ot=w.baseState;R=0,rt=K=$=null,O=x;do{var st=O.lane,mt=O.eventTime;if((y&st)===st){rt!==null&&(rt=rt.next={eventTime:mt,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});t:{var Et=a,xt=O;switch(st=c,mt=d,xt.tag){case 1:if(Et=xt.payload,typeof Et=="function"){ot=Et.call(mt,ot,st);break t}ot=Et;break t;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=xt.payload,st=typeof Et=="function"?Et.call(mt,ot,st):Et,st==null)break t;ot=N({},ot,st);break t;case 2:ec=!0}}O.callback!==null&&O.lane!==0&&(a.flags|=64,st=w.effects,st===null?w.effects=[O]:st.push(O))}else mt={eventTime:mt,lane:st,tag:O.tag,payload:O.payload,callback:O.callback,next:null},rt===null?(K=rt=mt,$=ot):rt=rt.next=mt,R|=st;if(O=O.next,O===null){if(O=w.shared.pending,O===null)break;st=O,O=st.next,st.next=null,w.lastBaseUpdate=st,w.shared.pending=null}}while(!0);if(rt===null&&($=ot),w.baseState=$,w.firstBaseUpdate=K,w.lastBaseUpdate=rt,c=w.shared.interleaved,c!==null){w=c;do R|=w.lane,w=w.next;while(w!==c)}else x===null&&(w.shared.lanes=0);Uh|=R,a.lanes=R,a.memoizedState=ot}}function MP(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],w=y.callback;if(w!==null){if(y.callback=null,y=d,typeof w!="function")throw Error(e(191,w));w.call(y)}}}var Gm={},va=Jl(Gm),Wm=Jl(Gm),Vm=Jl(Gm);function Bh(a){if(a===Gm)throw Error(e(174));return a}function OS(a,c){switch(xe(Vm,c),xe(Wm,a),xe(va,Gm),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Hl(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Hl(c,a)}ke(va),xe(va,c)}function $f(){ke(va),ke(Wm),ke(Vm)}function IP(a){Bh(Vm.current);var c=Bh(va.current),d=Hl(c,a.type);c!==d&&(xe(Wm,a),xe(va,d))}function NS(a){Wm.current===a&&(ke(va),ke(Wm))}var Ne=Jl(0);function I0(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var $S=[];function jS(){for(var a=0;a<$S.length;a++)$S[a]._workInProgressVersionPrimary=null;$S.length=0}var D0=L.ReactCurrentDispatcher,HS=L.ReactCurrentBatchConfig,zh=0,$e=null,pn=null,Rn=null,F0=!1,qm=!1,Xm=0,l$=0;function ui(){throw Error(e(321))}function BS(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!Pr(a[d],c[d]))return!1;return!0}function zS(a,c,d,y,w,x){if(zh=x,$e=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,D0.current=a===null||a.memoizedState===null?d$:f$,a=d(y,w),qm){x=0;do{if(qm=!1,Xm=0,25<=x)throw Error(e(301));x+=1,Rn=pn=null,c.updateQueue=null,D0.current=p$,a=d(y,w)}while(qm)}if(D0.current=$0,c=pn!==null&&pn.next!==null,zh=0,Rn=pn=$e=null,F0=!1,c)throw Error(e(300));return a}function US(){var a=Xm!==0;return Xm=0,a}function Aa(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?$e.memoizedState=Rn=a:Rn=Rn.next=a,Rn}function Qs(){if(pn===null){var a=$e.alternate;a=a!==null?a.memoizedState:null}else a=pn.next;var c=Rn===null?$e.memoizedState:Rn.next;if(c!==null)Rn=c,pn=a;else{if(a===null)throw Error(e(310));pn=a,a={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},Rn===null?$e.memoizedState=Rn=a:Rn=Rn.next=a}return Rn}function Ym(a,c){return typeof c=="function"?c(a):c}function GS(a){var c=Qs(),d=c.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var y=pn,w=y.baseQueue,x=d.pending;if(x!==null){if(w!==null){var R=w.next;w.next=x.next,x.next=R}y.baseQueue=w=x,d.pending=null}if(w!==null){x=w.next,y=y.baseState;var O=R=null,$=null,K=x;do{var rt=K.lane;if((zh&rt)===rt)$!==null&&($=$.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),y=K.hasEagerState?K.eagerState:a(y,K.action);else{var ot={lane:rt,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};$===null?(O=$=ot,R=y):$=$.next=ot,$e.lanes|=rt,Uh|=rt}K=K.next}while(K!==null&&K!==x);$===null?R=y:$.next=O,Pr(y,c.memoizedState)||(Xi=!0),c.memoizedState=y,c.baseState=R,c.baseQueue=$,d.lastRenderedState=y}if(a=d.interleaved,a!==null){w=a;do x=w.lane,$e.lanes|=x,Uh|=x,w=w.next;while(w!==a)}else w===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function WS(a){var c=Qs(),d=c.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var y=d.dispatch,w=d.pending,x=c.memoizedState;if(w!==null){d.pending=null;var R=w=w.next;do x=a(x,R.action),R=R.next;while(R!==w);Pr(x,c.memoizedState)||(Xi=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),d.lastRenderedState=x}return[x,y]}function DP(){}function FP(a,c){var d=$e,y=Qs(),w=c(),x=!Pr(y.memoizedState,w);if(x&&(y.memoizedState=w,Xi=!0),y=y.queue,VS($P.bind(null,d,y,a),[a]),y.getSnapshot!==c||x||Rn!==null&&Rn.memoizedState.tag&1){if(d.flags|=2048,Km(9,NP.bind(null,d,y,w,c),void 0,null),Ln===null)throw Error(e(349));zh&30||OP(d,c,w)}return w}function OP(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=$e.updateQueue,c===null?(c={lastEffect:null,stores:null},$e.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function NP(a,c,d,y){c.value=d,c.getSnapshot=y,jP(c)&&HP(a)}function $P(a,c,d){return d(function(){jP(c)&&HP(a)})}function jP(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!Pr(a,d)}catch{return!0}}function HP(a){var c=bo(a,1);c!==null&&Dr(c,a,1,-1)}function BP(a){var c=Aa();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ym,lastRenderedState:a},c.queue=a,a=a.dispatch=u$.bind(null,$e,a),[c.memoizedState,a]}function Km(a,c,d,y){return a={tag:a,create:c,destroy:d,deps:y,next:null},c=$e.updateQueue,c===null?(c={lastEffect:null,stores:null},$e.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(y=d.next,d.next=a,a.next=y,c.lastEffect=a)),a}function zP(){return Qs().memoizedState}function O0(a,c,d,y){var w=Aa();$e.flags|=a,w.memoizedState=Km(1|c,d,void 0,y===void 0?null:y)}function N0(a,c,d,y){var w=Qs();y=y===void 0?null:y;var x=void 0;if(pn!==null){var R=pn.memoizedState;if(x=R.destroy,y!==null&&BS(y,R.deps)){w.memoizedState=Km(c,d,x,y);return}}$e.flags|=a,w.memoizedState=Km(1|c,d,x,y)}function UP(a,c){return O0(8390656,8,a,c)}function VS(a,c){return N0(2048,8,a,c)}function GP(a,c){return N0(4,2,a,c)}function WP(a,c){return N0(4,4,a,c)}function VP(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function qP(a,c,d){return d=d!=null?d.concat([a]):null,N0(4,4,VP.bind(null,c,a),d)}function qS(){}function XP(a,c){var d=Qs();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&BS(c,y[1])?y[0]:(d.memoizedState=[a,c],a)}function YP(a,c){var d=Qs();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&BS(c,y[1])?y[0]:(a=a(),d.memoizedState=[a,c],a)}function KP(a,c,d){return zh&21?(Pr(d,c)||(d=Ck(),$e.lanes|=d,Uh|=d,a.baseState=!0),c):(a.baseState&&(a.baseState=!1,Xi=!0),a.memoizedState=d)}function c$(a,c){var d=oe;oe=d!==0&&4>d?d:4,a(!0);var y=HS.transition;HS.transition={};try{a(!1),c()}finally{oe=d,HS.transition=y}}function QP(){return Qs().memoizedState}function h$(a,c,d){var y=ac(a);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},JP(a))ZP(c,d);else if(d=PP(a,c,d,y),d!==null){var w=Mi();Dr(d,a,y,w),tR(d,c,y)}}function u$(a,c,d){var y=ac(a),w={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(JP(a))ZP(c,w);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var R=c.lastRenderedState,O=x(R,d);if(w.hasEagerState=!0,w.eagerState=O,Pr(O,R)){var $=c.interleaved;$===null?(w.next=w,DS(c)):(w.next=$.next,$.next=w),c.interleaved=w;return}}catch{}finally{}d=PP(a,c,w,y),d!==null&&(w=Mi(),Dr(d,a,y,w),tR(d,c,y))}}function JP(a){var c=a.alternate;return a===$e||c!==null&&c===$e}function ZP(a,c){qm=F0=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function tR(a,c,d){if(d&4194240){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,YE(a,d)}}var $0={readContext:Ks,useCallback:ui,useContext:ui,useEffect:ui,useImperativeHandle:ui,useInsertionEffect:ui,useLayoutEffect:ui,useMemo:ui,useReducer:ui,useRef:ui,useState:ui,useDebugValue:ui,useDeferredValue:ui,useTransition:ui,useMutableSource:ui,useSyncExternalStore:ui,useId:ui,unstable_isNewReconciler:!1},d$={readContext:Ks,useCallback:function(a,c){return Aa().memoizedState=[a,c===void 0?null:c],a},useContext:Ks,useEffect:UP,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,O0(4194308,4,VP.bind(null,c,a),d)},useLayoutEffect:function(a,c){return O0(4194308,4,a,c)},useInsertionEffect:function(a,c){return O0(4,2,a,c)},useMemo:function(a,c){var d=Aa();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var y=Aa();return c=d!==void 0?d(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=h$.bind(null,$e,a),[y.memoizedState,a]},useRef:function(a){var c=Aa();return a={current:a},c.memoizedState=a},useState:BP,useDebugValue:qS,useDeferredValue:function(a){return Aa().memoizedState=a},useTransition:function(){var a=BP(!1),c=a[0];return a=c$.bind(null,a[1]),Aa().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var y=$e,w=Aa();if(Ie){if(d===void 0)throw Error(e(407));d=d()}else{if(d=c(),Ln===null)throw Error(e(349));zh&30||OP(y,c,d)}w.memoizedState=d;var x={value:d,getSnapshot:c};return w.queue=x,UP($P.bind(null,y,x,a),[a]),y.flags|=2048,Km(9,NP.bind(null,y,x,d,c),void 0,null),d},useId:function(){var a=Aa(),c=Ln.identifierPrefix;if(Ie){var d=Ao,y=vo;d=(y&~(1<<32-kr(y)-1)).toString(32)+d,c=":"+c+"R"+d,d=Xm++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=l$++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},f$={readContext:Ks,useCallback:XP,useContext:Ks,useEffect:VS,useImperativeHandle:qP,useInsertionEffect:GP,useLayoutEffect:WP,useMemo:YP,useReducer:GS,useRef:zP,useState:function(){return GS(Ym)},useDebugValue:qS,useDeferredValue:function(a){var c=Qs();return KP(c,pn.memoizedState,a)},useTransition:function(){var a=GS(Ym)[0],c=Qs().memoizedState;return[a,c]},useMutableSource:DP,useSyncExternalStore:FP,useId:QP,unstable_isNewReconciler:!1},p$={readContext:Ks,useCallback:XP,useContext:Ks,useEffect:VS,useImperativeHandle:qP,useInsertionEffect:GP,useLayoutEffect:WP,useMemo:YP,useReducer:WS,useRef:zP,useState:function(){return WS(Ym)},useDebugValue:qS,useDeferredValue:function(a){var c=Qs();return pn===null?c.memoizedState=a:KP(c,pn.memoizedState,a)},useTransition:function(){var a=WS(Ym)[0],c=Qs().memoizedState;return[a,c]},useMutableSource:DP,useSyncExternalStore:FP,useId:QP,unstable_isNewReconciler:!1};function Lr(a,c){if(a&&a.defaultProps){c=N({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function XS(a,c,d,y){c=a.memoizedState,d=d(y,c),d=d==null?c:N({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var j0={isMounted:function(a){return(a=a._reactInternals)?Fh(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var y=Mi(),w=ac(a),x=_o(y,w);x.payload=c,d!=null&&(x.callback=d),c=nc(a,x,w),c!==null&&(Dr(c,a,w,y),L0(c,a,w))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var y=Mi(),w=ac(a),x=_o(y,w);x.tag=1,x.payload=c,d!=null&&(x.callback=d),c=nc(a,x,w),c!==null&&(Dr(c,a,w,y),L0(c,a,w))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Mi(),y=ac(a),w=_o(d,y);w.tag=2,c!=null&&(w.callback=c),c=nc(a,w,y),c!==null&&(Dr(c,a,y,d),L0(c,a,y))}};function eR(a,c,d,y,w,x,R){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,x,R):c.prototype&&c.prototype.isPureReactComponent?!Om(d,y)||!Om(w,x):!0}function nR(a,c,d){var y=!1,w=Zl,x=c.contextType;return typeof x=="object"&&x!==null?x=Ks(x):(w=qi(c)?Nh:hi.current,y=c.contextTypes,x=(y=y!=null)?Lf(a,w):Zl),c=new c(d,x),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=j0,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=w,a.__reactInternalMemoizedMaskedChildContext=x),c}function iR(a,c,d,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,y),c.state!==a&&j0.enqueueReplaceState(c,c.state,null)}function YS(a,c,d,y){var w=a.stateNode;w.props=d,w.state=a.memoizedState,w.refs={},FS(a);var x=c.contextType;typeof x=="object"&&x!==null?w.context=Ks(x):(x=qi(c)?Nh:hi.current,w.context=Lf(a,x)),w.state=a.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(XS(a,c,x,d),w.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(c=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),c!==w.state&&j0.enqueueReplaceState(w,w.state,null),M0(a,d,w,y),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308)}function jf(a,c){try{var d="",y=c;do d+=dt(y),y=y.return;while(y);var w=d}catch(x){w=`
Error generating stack: `+x.message+`
`+x.stack}return{value:a,source:c,stack:w,digest:null}}function KS(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function QS(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var g$=typeof WeakMap=="function"?WeakMap:Map;function sR(a,c,d){d=_o(-1,d),d.tag=3,d.payload={element:null};var y=c.value;return d.callback=function(){V0||(V0=!0,d1=y),QS(a,c)},d}function rR(a,c,d){d=_o(-1,d),d.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var w=c.value;d.payload=function(){return y(w)},d.callback=function(){QS(a,c)}}var x=a.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(d.callback=function(){QS(a,c),typeof y!="function"&&(sc===null?sc=new Set([this]):sc.add(this));var R=c.stack;this.componentDidCatch(c.value,{componentStack:R!==null?R:""})}),d}function aR(a,c,d){var y=a.pingCache;if(y===null){y=a.pingCache=new g$;var w=new Set;y.set(c,w)}else w=y.get(c),w===void 0&&(w=new Set,y.set(c,w));w.has(d)||(w.add(d),a=P$.bind(null,a,c,d),c.then(a,a))}function oR(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function lR(a,c,d,y,w){return a.mode&1?(a.flags|=65536,a.lanes=w,a):(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=_o(-1,1),c.tag=2,nc(d,c,1))),d.lanes|=1),a)}var m$=L.ReactCurrentOwner,Xi=!1;function Li(a,c,d,y){c.child=a===null?kP(c,null,d,y):Ff(c,a.child,d,y)}function cR(a,c,d,y,w){d=d.render;var x=c.ref;return Nf(c,w),y=zS(a,c,d,y,x,w),d=US(),a!==null&&!Xi?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~w,wo(a,c,w)):(Ie&&d&&xS(c),c.flags|=1,Li(a,c,y,w),c.child)}function hR(a,c,d,y,w){if(a===null){var x=d.type;return typeof x=="function"&&!A1(x)&&x.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=x,uR(a,c,x,y,w)):(a=J0(d.type,null,y,c,c.mode,w),a.ref=c.ref,a.return=c,c.child=a)}if(x=a.child,!(a.lanes&w)){var R=x.memoizedProps;if(d=d.compare,d=d!==null?d:Om,d(R,y)&&a.ref===c.ref)return wo(a,c,w)}return c.flags|=1,a=lc(x,y),a.ref=c.ref,a.return=c,c.child=a}function uR(a,c,d,y,w){if(a!==null){var x=a.memoizedProps;if(Om(x,y)&&a.ref===c.ref)if(Xi=!1,c.pendingProps=y=x,(a.lanes&w)!==0)a.flags&131072&&(Xi=!0);else return c.lanes=a.lanes,wo(a,c,w)}return JS(a,c,d,y,w)}function dR(a,c,d){var y=c.pendingProps,w=y.children,x=a!==null?a.memoizedState:null;if(y.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},xe(Bf,vs),vs|=d;else{if(!(d&1073741824))return a=x!==null?x.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,xe(Bf,vs),vs|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=x!==null?x.baseLanes:d,xe(Bf,vs),vs|=y}else x!==null?(y=x.baseLanes|d,c.memoizedState=null):y=d,xe(Bf,vs),vs|=y;return Li(a,c,w,d),c.child}function fR(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function JS(a,c,d,y,w){var x=qi(d)?Nh:hi.current;return x=Lf(c,x),Nf(c,w),d=zS(a,c,d,y,x,w),y=US(),a!==null&&!Xi?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~w,wo(a,c,w)):(Ie&&y&&xS(c),c.flags|=1,Li(a,c,d,w),c.child)}function pR(a,c,d,y,w){if(qi(d)){var x=!0;E0(c)}else x=!1;if(Nf(c,w),c.stateNode===null)B0(a,c),nR(c,d,y),YS(c,d,y,w),y=!0;else if(a===null){var R=c.stateNode,O=c.memoizedProps;R.props=O;var $=R.context,K=d.contextType;typeof K=="object"&&K!==null?K=Ks(K):(K=qi(d)?Nh:hi.current,K=Lf(c,K));var rt=d.getDerivedStateFromProps,ot=typeof rt=="function"||typeof R.getSnapshotBeforeUpdate=="function";ot||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(O!==y||$!==K)&&iR(c,R,y,K),ec=!1;var st=c.memoizedState;R.state=st,M0(c,y,R,w),$=c.memoizedState,O!==y||st!==$||Vi.current||ec?(typeof rt=="function"&&(XS(c,d,rt,y),$=c.memoizedState),(O=ec||eR(c,d,O,y,st,$,K))?(ot||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(c.flags|=4194308)):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=$),R.props=y,R.state=$,R.context=K,y=O):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{R=c.stateNode,RP(a,c),O=c.memoizedProps,K=c.type===c.elementType?O:Lr(c.type,O),R.props=K,ot=c.pendingProps,st=R.context,$=d.contextType,typeof $=="object"&&$!==null?$=Ks($):($=qi(d)?Nh:hi.current,$=Lf(c,$));var mt=d.getDerivedStateFromProps;(rt=typeof mt=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(O!==ot||st!==$)&&iR(c,R,y,$),ec=!1,st=c.memoizedState,R.state=st,M0(c,y,R,w);var Et=c.memoizedState;O!==ot||st!==Et||Vi.current||ec?(typeof mt=="function"&&(XS(c,d,mt,y),Et=c.memoizedState),(K=ec||eR(c,d,K,y,st,Et,$)||!1)?(rt||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(y,Et,$),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(y,Et,$)),typeof R.componentDidUpdate=="function"&&(c.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof R.componentDidUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Et),R.props=y,R.state=Et,R.context=$,y=K):(typeof R.componentDidUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=1024),y=!1)}return ZS(a,c,d,y,x,w)}function ZS(a,c,d,y,w,x){fR(a,c);var R=(c.flags&128)!==0;if(!y&&!R)return w&&AP(c,d,!1),wo(a,c,x);y=c.stateNode,m$.current=c;var O=R&&typeof d.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&R?(c.child=Ff(c,a.child,null,x),c.child=Ff(c,null,O,x)):Li(a,c,O,x),c.memoizedState=y.state,w&&AP(c,d,!0),c.child}function gR(a){var c=a.stateNode;c.pendingContext?yP(a,c.pendingContext,c.pendingContext!==c.context):c.context&&yP(a,c.context,!1),OS(a,c.containerInfo)}function mR(a,c,d,y,w){return Df(),PS(w),c.flags|=256,Li(a,c,d,y),c.child}var t1={dehydrated:null,treeContext:null,retryLane:0};function e1(a){return{baseLanes:a,cachePool:null,transitions:null}}function yR(a,c,d){var y=c.pendingProps,w=Ne.current,x=!1,R=(c.flags&128)!==0,O;if((O=R)||(O=a!==null&&a.memoizedState===null?!1:(w&2)!==0),O?(x=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(w|=1),xe(Ne,w&1),a===null)return kS(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(c.mode&1?a.data==="$!"?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(R=y.children,a=y.fallback,x?(y=c.mode,x=c.child,R={mode:"hidden",children:R},!(y&1)&&x!==null?(x.childLanes=0,x.pendingProps=R):x=Z0(R,y,0,null),a=qh(a,y,d,null),x.return=c,a.return=c,x.sibling=a,c.child=x,c.child.memoizedState=e1(d),c.memoizedState=t1,a):n1(c,R));if(w=a.memoizedState,w!==null&&(O=w.dehydrated,O!==null))return y$(a,c,R,y,O,w,d);if(x){x=y.fallback,R=c.mode,w=a.child,O=w.sibling;var $={mode:"hidden",children:y.children};return!(R&1)&&c.child!==w?(y=c.child,y.childLanes=0,y.pendingProps=$,c.deletions=null):(y=lc(w,$),y.subtreeFlags=w.subtreeFlags&14680064),O!==null?x=lc(O,x):(x=qh(x,R,d,null),x.flags|=2),x.return=c,y.return=c,y.sibling=x,c.child=y,y=x,x=c.child,R=a.child.memoizedState,R=R===null?e1(d):{baseLanes:R.baseLanes|d,cachePool:null,transitions:R.transitions},x.memoizedState=R,x.childLanes=a.childLanes&~d,c.memoizedState=t1,y}return x=a.child,a=x.sibling,y=lc(x,{mode:"visible",children:y.children}),!(c.mode&1)&&(y.lanes=d),y.return=c,y.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=y,c.memoizedState=null,y}function n1(a,c){return c=Z0({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function H0(a,c,d,y){return y!==null&&PS(y),Ff(c,a.child,null,d),a=n1(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function y$(a,c,d,y,w,x,R){if(d)return c.flags&256?(c.flags&=-257,y=KS(Error(e(422))),H0(a,c,R,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(x=y.fallback,w=c.mode,y=Z0({mode:"visible",children:y.children},w,0,null),x=qh(x,w,R,null),x.flags|=2,y.return=c,x.return=c,y.sibling=x,c.child=y,c.mode&1&&Ff(c,a.child,null,R),c.child.memoizedState=e1(R),c.memoizedState=t1,x);if(!(c.mode&1))return H0(a,c,R,null);if(w.data==="$!"){if(y=w.nextSibling&&w.nextSibling.dataset,y)var O=y.dgst;return y=O,x=Error(e(419)),y=KS(x,y,void 0),H0(a,c,R,y)}if(O=(R&a.childLanes)!==0,Xi||O){if(y=Ln,y!==null){switch(R&-R){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=w&(y.suspendedLanes|R)?0:w,w!==0&&w!==x.retryLane&&(x.retryLane=w,bo(a,w),Dr(y,a,w,-1))}return v1(),y=KS(Error(e(421))),H0(a,c,R,y)}return w.data==="$?"?(c.flags|=128,c.child=a.child,c=R$.bind(null,a),w._reactRetry=c,null):(a=x.treeContext,ys=Ql(w.nextSibling),ms=c,Ie=!0,Rr=null,a!==null&&(Xs[Ys++]=vo,Xs[Ys++]=Ao,Xs[Ys++]=$h,vo=a.id,Ao=a.overflow,$h=c),c=n1(c,y.children),c.flags|=4096,c)}function vR(a,c,d){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),IS(a.return,c,d)}function i1(a,c,d,y,w){var x=a.memoizedState;x===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:w}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=y,x.tail=d,x.tailMode=w)}function AR(a,c,d){var y=c.pendingProps,w=y.revealOrder,x=y.tail;if(Li(a,c,y.children,d),y=Ne.current,y&2)y=y&1|2,c.flags|=128;else{if(a!==null&&a.flags&128)t:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vR(a,d,c);else if(a.tag===19)vR(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break t;for(;a.sibling===null;){if(a.return===null||a.return===c)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(xe(Ne,y),!(c.mode&1))c.memoizedState=null;else switch(w){case"forwards":for(d=c.child,w=null;d!==null;)a=d.alternate,a!==null&&I0(a)===null&&(w=d),d=d.sibling;d=w,d===null?(w=c.child,c.child=null):(w=d.sibling,d.sibling=null),i1(c,!1,w,d,x);break;case"backwards":for(d=null,w=c.child,c.child=null;w!==null;){if(a=w.alternate,a!==null&&I0(a)===null){c.child=w;break}a=w.sibling,w.sibling=d,d=w,w=a}i1(c,!0,d,null,x);break;case"together":i1(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function B0(a,c){!(c.mode&1)&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function wo(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Uh|=c.lanes,!(d&c.childLanes))return null;if(a!==null&&c.child!==a.child)throw Error(e(153));if(c.child!==null){for(a=c.child,d=lc(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=lc(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function v$(a,c,d){switch(c.tag){case 3:gR(c),Df();break;case 5:IP(c);break;case 1:qi(c.type)&&E0(c);break;case 4:OS(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,w=c.memoizedProps.value;xe(P0,y._currentValue),y._currentValue=w;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(xe(Ne,Ne.current&1),c.flags|=128,null):d&c.child.childLanes?yR(a,c,d):(xe(Ne,Ne.current&1),a=wo(a,c,d),a!==null?a.sibling:null);xe(Ne,Ne.current&1);break;case 19:if(y=(d&c.childLanes)!==0,a.flags&128){if(y)return AR(a,c,d);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),xe(Ne,Ne.current),y)break;return null;case 22:case 23:return c.lanes=0,dR(a,c,d)}return wo(a,c,d)}var bR,s1,_R,wR;bR=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},s1=function(){},_R=function(a,c,d,y){var w=a.memoizedProps;if(w!==y){a=c.stateNode,Bh(va.current);var x=null;switch(d){case"input":w=Se(a,w),y=Se(a,y),x=[];break;case"select":w=N({},w,{value:void 0}),y=N({},y,{value:void 0}),x=[];break;case"textarea":w=ds(a,w),y=ds(a,y),x=[];break;default:typeof w.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=b0)}Wn(d,y);var R;d=null;for(K in w)if(!y.hasOwnProperty(K)&&w.hasOwnProperty(K)&&w[K]!=null)if(K==="style"){var O=w[K];for(R in O)O.hasOwnProperty(R)&&(d||(d={}),d[R]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(i.hasOwnProperty(K)?x||(x=[]):(x=x||[]).push(K,null));for(K in y){var $=y[K];if(O=w!=null?w[K]:void 0,y.hasOwnProperty(K)&&$!==O&&($!=null||O!=null))if(K==="style")if(O){for(R in O)!O.hasOwnProperty(R)||$&&$.hasOwnProperty(R)||(d||(d={}),d[R]="");for(R in $)$.hasOwnProperty(R)&&O[R]!==$[R]&&(d||(d={}),d[R]=$[R])}else d||(x||(x=[]),x.push(K,d)),d=$;else K==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,O=O?O.__html:void 0,$!=null&&O!==$&&(x=x||[]).push(K,$)):K==="children"?typeof $!="string"&&typeof $!="number"||(x=x||[]).push(K,""+$):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(i.hasOwnProperty(K)?($!=null&&K==="onScroll"&&Te("scroll",a),x||O===$||(x=[])):(x=x||[]).push(K,$))}d&&(x=x||[]).push("style",d);var K=x;(c.updateQueue=K)&&(c.flags|=4)}},wR=function(a,c,d,y){d!==y&&(c.flags|=4)};function Qm(a,c){if(!Ie)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function di(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,y=0;if(c)for(var w=a.child;w!==null;)d|=w.lanes|w.childLanes,y|=w.subtreeFlags&14680064,y|=w.flags&14680064,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)d|=w.lanes|w.childLanes,y|=w.subtreeFlags,y|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=y,a.childLanes=d,c}function A$(a,c,d){var y=c.pendingProps;switch(CS(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return di(c),null;case 1:return qi(c.type)&&w0(),di(c),null;case 3:return y=c.stateNode,$f(),ke(Vi),ke(hi),jS(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(T0(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Rr!==null&&(g1(Rr),Rr=null))),s1(a,c),di(c),null;case 5:NS(c);var w=Bh(Vm.current);if(d=c.type,a!==null&&c.stateNode!=null)_R(a,c,d,y,w),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(e(166));return di(c),null}if(a=Bh(va.current),T0(c)){y=c.stateNode,d=c.type;var x=c.memoizedProps;switch(y[ya]=c,y[Bm]=x,a=(c.mode&1)!==0,d){case"dialog":Te("cancel",y),Te("close",y);break;case"iframe":case"object":case"embed":Te("load",y);break;case"video":case"audio":for(w=0;w<$m.length;w++)Te($m[w],y);break;case"source":Te("error",y);break;case"img":case"image":case"link":Te("error",y),Te("load",y);break;case"details":Te("toggle",y);break;case"input":rn(y,x),Te("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!x.multiple},Te("invalid",y);break;case"textarea":pa(y,x),Te("invalid",y)}Wn(d,x),w=null;for(var R in x)if(x.hasOwnProperty(R)){var O=x[R];R==="children"?typeof O=="string"?y.textContent!==O&&(x.suppressHydrationWarning!==!0&&A0(y.textContent,O,a),w=["children",O]):typeof O=="number"&&y.textContent!==""+O&&(x.suppressHydrationWarning!==!0&&A0(y.textContent,O,a),w=["children",""+O]):i.hasOwnProperty(R)&&O!=null&&R==="onScroll"&&Te("scroll",y)}switch(d){case"input":Kt(y),Sr(y,x,!0);break;case"textarea":Kt(y),uo(y);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(y.onclick=b0)}y=w,c.updateQueue=y,y!==null&&(c.flags|=4)}else{R=w.nodeType===9?w:w.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=fo(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=R.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=R.createElement(d,{is:y.is}):(a=R.createElement(d),d==="select"&&(R=a,y.multiple?R.multiple=!0:y.size&&(R.size=y.size))):a=R.createElementNS(a,d),a[ya]=c,a[Bm]=y,bR(a,c,!1,!1),c.stateNode=a;t:{switch(R=Ih(d,y),d){case"dialog":Te("cancel",a),Te("close",a),w=y;break;case"iframe":case"object":case"embed":Te("load",a),w=y;break;case"video":case"audio":for(w=0;w<$m.length;w++)Te($m[w],a);w=y;break;case"source":Te("error",a),w=y;break;case"img":case"image":case"link":Te("error",a),Te("load",a),w=y;break;case"details":Te("toggle",a),w=y;break;case"input":rn(a,y),w=Se(a,y),Te("invalid",a);break;case"option":w=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},w=N({},y,{value:void 0}),Te("invalid",a);break;case"textarea":pa(a,y),w=ds(a,y),Te("invalid",a);break;default:w=y}Wn(d,w),O=w;for(x in O)if(O.hasOwnProperty(x)){var $=O[x];x==="style"?fs(a,$):x==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&Cr(a,$)):x==="children"?typeof $=="string"?(d!=="textarea"||$!=="")&&me(a,$):typeof $=="number"&&me(a,""+$):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(i.hasOwnProperty(x)?$!=null&&x==="onScroll"&&Te("scroll",a):$!=null&&P(a,x,$,R))}switch(d){case"input":Kt(a),Sr(a,y,!1);break;case"textarea":Kt(a),uo(a);break;case"option":y.value!=null&&a.setAttribute("value",""+yt(y.value));break;case"select":a.multiple=!!y.multiple,x=y.value,x!=null?Pi(a,!!y.multiple,x,!1):y.defaultValue!=null&&Pi(a,!!y.multiple,y.defaultValue,!0);break;default:typeof w.onClick=="function"&&(a.onclick=b0)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break t;case"img":y=!0;break t;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return di(c),null;case 6:if(a&&c.stateNode!=null)wR(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(e(166));if(d=Bh(Vm.current),Bh(va.current),T0(c)){if(y=c.stateNode,d=c.memoizedProps,y[ya]=c,(x=y.nodeValue!==d)&&(a=ms,a!==null))switch(a.tag){case 3:A0(y.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&A0(y.nodeValue,d,(a.mode&1)!==0)}x&&(c.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[ya]=c,c.stateNode=y}return di(c),null;case 13:if(ke(Ne),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ie&&ys!==null&&c.mode&1&&!(c.flags&128))xP(),Df(),c.flags|=98560,x=!1;else if(x=T0(c),y!==null&&y.dehydrated!==null){if(a===null){if(!x)throw Error(e(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(e(317));x[ya]=c}else Df(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;di(c),x=!1}else Rr!==null&&(g1(Rr),Rr=null),x=!0;if(!x)return c.flags&65536?c:null}return c.flags&128?(c.lanes=d,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,c.mode&1&&(a===null||Ne.current&1?gn===0&&(gn=3):v1())),c.updateQueue!==null&&(c.flags|=4),di(c),null);case 4:return $f(),s1(a,c),a===null&&jm(c.stateNode.containerInfo),di(c),null;case 10:return MS(c.type._context),di(c),null;case 17:return qi(c.type)&&w0(),di(c),null;case 19:if(ke(Ne),x=c.memoizedState,x===null)return di(c),null;if(y=(c.flags&128)!==0,R=x.rendering,R===null)if(y)Qm(x,!1);else{if(gn!==0||a!==null&&a.flags&128)for(a=c.child;a!==null;){if(R=I0(a),R!==null){for(c.flags|=128,Qm(x,!1),y=R.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=d,d=c.child;d!==null;)x=d,a=y,x.flags&=14680066,R=x.alternate,R===null?(x.childLanes=0,x.lanes=a,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=R.childLanes,x.lanes=R.lanes,x.child=R.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=R.memoizedProps,x.memoizedState=R.memoizedState,x.updateQueue=R.updateQueue,x.type=R.type,a=R.dependencies,x.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return xe(Ne,Ne.current&1|2),c.child}a=a.sibling}x.tail!==null&&Qe()>zf&&(c.flags|=128,y=!0,Qm(x,!1),c.lanes=4194304)}else{if(!y)if(a=I0(R),a!==null){if(c.flags|=128,y=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Qm(x,!0),x.tail===null&&x.tailMode==="hidden"&&!R.alternate&&!Ie)return di(c),null}else 2*Qe()-x.renderingStartTime>zf&&d!==1073741824&&(c.flags|=128,y=!0,Qm(x,!1),c.lanes=4194304);x.isBackwards?(R.sibling=c.child,c.child=R):(d=x.last,d!==null?d.sibling=R:c.child=R,x.last=R)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Qe(),c.sibling=null,d=Ne.current,xe(Ne,y?d&1|2:d&1),c):(di(c),null);case 22:case 23:return y1(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&c.mode&1?vs&1073741824&&(di(c),c.subtreeFlags&6&&(c.flags|=8192)):di(c),null;case 24:return null;case 25:return null}throw Error(e(156,c.tag))}function b$(a,c){switch(CS(c),c.tag){case 1:return qi(c.type)&&w0(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return $f(),ke(Vi),ke(hi),jS(),a=c.flags,a&65536&&!(a&128)?(c.flags=a&-65537|128,c):null;case 5:return NS(c),null;case 13:if(ke(Ne),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(e(340));Df()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return ke(Ne),null;case 4:return $f(),null;case 10:return MS(c.type._context),null;case 22:case 23:return y1(),null;case 24:return null;default:return null}}var z0=!1,fi=!1,_$=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Hf(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){We(a,c,y)}else d.current=null}function r1(a,c,d){try{d()}catch(y){We(a,c,y)}}var ER=!1;function w$(a,c){if(yS=l0,a=eP(),cS(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else t:{d=(d=a.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var w=y.anchorOffset,x=y.focusNode;y=y.focusOffset;try{d.nodeType,x.nodeType}catch{d=null;break t}var R=0,O=-1,$=-1,K=0,rt=0,ot=a,st=null;e:for(;;){for(var mt;ot!==d||w!==0&&ot.nodeType!==3||(O=R+w),ot!==x||y!==0&&ot.nodeType!==3||($=R+y),ot.nodeType===3&&(R+=ot.nodeValue.length),(mt=ot.firstChild)!==null;)st=ot,ot=mt;for(;;){if(ot===a)break e;if(st===d&&++K===w&&(O=R),st===x&&++rt===y&&($=R),(mt=ot.nextSibling)!==null)break;ot=st,st=ot.parentNode}ot=mt}d=O===-1||$===-1?null:{start:O,end:$}}else d=null}d=d||{start:0,end:0}}else d=null;for(vS={focusedElem:a,selectionRange:d},l0=!1,bt=c;bt!==null;)if(c=bt,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,bt=a;else for(;bt!==null;){c=bt;try{var Et=c.alternate;if(c.flags&1024)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Et!==null){var xt=Et.memoizedProps,Je=Et.memoizedState,V=c.stateNode,z=V.getSnapshotBeforeUpdate(c.elementType===c.type?xt:Lr(c.type,xt),Je);V.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var X=c.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(ct){We(c,c.return,ct)}if(a=c.sibling,a!==null){a.return=c.return,bt=a;break}bt=c.return}return Et=ER,ER=!1,Et}function Jm(a,c,d){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var w=y=y.next;do{if((w.tag&a)===a){var x=w.destroy;w.destroy=void 0,x!==void 0&&r1(c,d,x)}w=w.next}while(w!==y)}}function U0(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var y=d.create;d.destroy=y()}d=d.next}while(d!==c)}}function a1(a){var c=a.ref;if(c!==null){var d=a.stateNode;switch(a.tag){case 5:a=d;break;default:a=d}typeof c=="function"?c(a):c.current=a}}function SR(a){var c=a.alternate;c!==null&&(a.alternate=null,SR(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[ya],delete c[Bm],delete c[wS],delete c[s$],delete c[r$])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function xR(a){return a.tag===5||a.tag===3||a.tag===4}function CR(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||xR(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function o1(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=b0));else if(y!==4&&(a=a.child,a!==null))for(o1(a,c,d),a=a.sibling;a!==null;)o1(a,c,d),a=a.sibling}function l1(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(l1(a,c,d),a=a.sibling;a!==null;)l1(a,c,d),a=a.sibling}var qn=null,Mr=!1;function ic(a,c,d){for(d=d.child;d!==null;)TR(a,c,d),d=d.sibling}function TR(a,c,d){if(ma&&typeof ma.onCommitFiberUnmount=="function")try{ma.onCommitFiberUnmount(n0,d)}catch{}switch(d.tag){case 5:fi||Hf(d,c);case 6:var y=qn,w=Mr;qn=null,ic(a,c,d),qn=y,Mr=w,qn!==null&&(Mr?(a=qn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):qn.removeChild(d.stateNode));break;case 18:qn!==null&&(Mr?(a=qn,d=d.stateNode,a.nodeType===8?_S(a.parentNode,d):a.nodeType===1&&_S(a,d),Rm(a)):_S(qn,d.stateNode));break;case 4:y=qn,w=Mr,qn=d.stateNode.containerInfo,Mr=!0,ic(a,c,d),qn=y,Mr=w;break;case 0:case 11:case 14:case 15:if(!fi&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){w=y=y.next;do{var x=w,R=x.destroy;x=x.tag,R!==void 0&&(x&2||x&4)&&r1(d,c,R),w=w.next}while(w!==y)}ic(a,c,d);break;case 1:if(!fi&&(Hf(d,c),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(O){We(d,c,O)}ic(a,c,d);break;case 21:ic(a,c,d);break;case 22:d.mode&1?(fi=(y=fi)||d.memoizedState!==null,ic(a,c,d),fi=y):ic(a,c,d);break;default:ic(a,c,d)}}function kR(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new _$),c.forEach(function(y){var w=L$.bind(null,a,y);d.has(y)||(d.add(y),y.then(w,w))})}}function Ir(a,c){var d=c.deletions;if(d!==null)for(var y=0;y<d.length;y++){var w=d[y];try{var x=a,R=c,O=R;t:for(;O!==null;){switch(O.tag){case 5:qn=O.stateNode,Mr=!1;break t;case 3:qn=O.stateNode.containerInfo,Mr=!0;break t;case 4:qn=O.stateNode.containerInfo,Mr=!0;break t}O=O.return}if(qn===null)throw Error(e(160));TR(x,R,w),qn=null,Mr=!1;var $=w.alternate;$!==null&&($.return=null),w.return=null}catch(K){We(w,c,K)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)PR(c,a),c=c.sibling}function PR(a,c){var d=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Ir(c,a),ba(a),y&4){try{Jm(3,a,a.return),U0(3,a)}catch(xt){We(a,a.return,xt)}try{Jm(5,a,a.return)}catch(xt){We(a,a.return,xt)}}break;case 1:Ir(c,a),ba(a),y&512&&d!==null&&Hf(d,d.return);break;case 5:if(Ir(c,a),ba(a),y&512&&d!==null&&Hf(d,d.return),a.flags&32){var w=a.stateNode;try{me(w,"")}catch(xt){We(a,a.return,xt)}}if(y&4&&(w=a.stateNode,w!=null)){var x=a.memoizedProps,R=d!==null?d.memoizedProps:x,O=a.type,$=a.updateQueue;if(a.updateQueue=null,$!==null)try{O==="input"&&x.type==="radio"&&x.name!=null&&oi(w,x),Ih(O,R);var K=Ih(O,x);for(R=0;R<$.length;R+=2){var rt=$[R],ot=$[R+1];rt==="style"?fs(w,ot):rt==="dangerouslySetInnerHTML"?Cr(w,ot):rt==="children"?me(w,ot):P(w,rt,ot,K)}switch(O){case"input":li(w,x);break;case"textarea":xr(w,x);break;case"select":var st=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!x.multiple;var mt=x.value;mt!=null?Pi(w,!!x.multiple,mt,!1):st!==!!x.multiple&&(x.defaultValue!=null?Pi(w,!!x.multiple,x.defaultValue,!0):Pi(w,!!x.multiple,x.multiple?[]:"",!1))}w[Bm]=x}catch(xt){We(a,a.return,xt)}}break;case 6:if(Ir(c,a),ba(a),y&4){if(a.stateNode===null)throw Error(e(162));w=a.stateNode,x=a.memoizedProps;try{w.nodeValue=x}catch(xt){We(a,a.return,xt)}}break;case 3:if(Ir(c,a),ba(a),y&4&&d!==null&&d.memoizedState.isDehydrated)try{Rm(c.containerInfo)}catch(xt){We(a,a.return,xt)}break;case 4:Ir(c,a),ba(a);break;case 13:Ir(c,a),ba(a),w=a.child,w.flags&8192&&(x=w.memoizedState!==null,w.stateNode.isHidden=x,!x||w.alternate!==null&&w.alternate.memoizedState!==null||(u1=Qe())),y&4&&kR(a);break;case 22:if(rt=d!==null&&d.memoizedState!==null,a.mode&1?(fi=(K=fi)||rt,Ir(c,a),fi=K):Ir(c,a),ba(a),y&8192){if(K=a.memoizedState!==null,(a.stateNode.isHidden=K)&&!rt&&a.mode&1)for(bt=a,rt=a.child;rt!==null;){for(ot=bt=rt;bt!==null;){switch(st=bt,mt=st.child,st.tag){case 0:case 11:case 14:case 15:Jm(4,st,st.return);break;case 1:Hf(st,st.return);var Et=st.stateNode;if(typeof Et.componentWillUnmount=="function"){y=st,d=st.return;try{c=y,Et.props=c.memoizedProps,Et.state=c.memoizedState,Et.componentWillUnmount()}catch(xt){We(y,d,xt)}}break;case 5:Hf(st,st.return);break;case 22:if(st.memoizedState!==null){MR(ot);continue}}mt!==null?(mt.return=st,bt=mt):MR(ot)}rt=rt.sibling}t:for(rt=null,ot=a;;){if(ot.tag===5){if(rt===null){rt=ot;try{w=ot.stateNode,K?(x=w.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(O=ot.stateNode,$=ot.memoizedProps.style,R=$!=null&&$.hasOwnProperty("display")?$.display:null,O.style.display=ci("display",R))}catch(xt){We(a,a.return,xt)}}}else if(ot.tag===6){if(rt===null)try{ot.stateNode.nodeValue=K?"":ot.memoizedProps}catch(xt){We(a,a.return,xt)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===a)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===a)break t;for(;ot.sibling===null;){if(ot.return===null||ot.return===a)break t;rt===ot&&(rt=null),ot=ot.return}rt===ot&&(rt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:Ir(c,a),ba(a),y&4&&kR(a);break;case 21:break;default:Ir(c,a),ba(a)}}function ba(a){var c=a.flags;if(c&2){try{t:{for(var d=a.return;d!==null;){if(xR(d)){var y=d;break t}d=d.return}throw Error(e(160))}switch(y.tag){case 5:var w=y.stateNode;y.flags&32&&(me(w,""),y.flags&=-33);var x=CR(a);l1(a,x,w);break;case 3:case 4:var R=y.stateNode.containerInfo,O=CR(a);o1(a,O,R);break;default:throw Error(e(161))}}catch($){We(a,a.return,$)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function E$(a,c,d){bt=a,RR(a)}function RR(a,c,d){for(var y=(a.mode&1)!==0;bt!==null;){var w=bt,x=w.child;if(w.tag===22&&y){var R=w.memoizedState!==null||z0;if(!R){var O=w.alternate,$=O!==null&&O.memoizedState!==null||fi;O=z0;var K=fi;if(z0=R,(fi=$)&&!K)for(bt=w;bt!==null;)R=bt,$=R.child,R.tag===22&&R.memoizedState!==null?IR(w):$!==null?($.return=R,bt=$):IR(w);for(;x!==null;)bt=x,RR(x),x=x.sibling;bt=w,z0=O,fi=K}LR(a)}else w.subtreeFlags&8772&&x!==null?(x.return=w,bt=x):LR(a)}}function LR(a){for(;bt!==null;){var c=bt;if(c.flags&8772){var d=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:fi||U0(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!fi)if(d===null)y.componentDidMount();else{var w=c.elementType===c.type?d.memoizedProps:Lr(c.type,d.memoizedProps);y.componentDidUpdate(w,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&MP(c,x,y);break;case 3:var R=c.updateQueue;if(R!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}MP(c,R,d)}break;case 5:var O=c.stateNode;if(d===null&&c.flags&4){d=O;var $=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&d.focus();break;case"img":$.src&&(d.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var K=c.alternate;if(K!==null){var rt=K.memoizedState;if(rt!==null){var ot=rt.dehydrated;ot!==null&&Rm(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}fi||c.flags&512&&a1(c)}catch(st){We(c,c.return,st)}}if(c===a){bt=null;break}if(d=c.sibling,d!==null){d.return=c.return,bt=d;break}bt=c.return}}function MR(a){for(;bt!==null;){var c=bt;if(c===a){bt=null;break}var d=c.sibling;if(d!==null){d.return=c.return,bt=d;break}bt=c.return}}function IR(a){for(;bt!==null;){var c=bt;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{U0(4,c)}catch($){We(c,d,$)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var w=c.return;try{y.componentDidMount()}catch($){We(c,w,$)}}var x=c.return;try{a1(c)}catch($){We(c,x,$)}break;case 5:var R=c.return;try{a1(c)}catch($){We(c,R,$)}}}catch($){We(c,c.return,$)}if(c===a){bt=null;break}var O=c.sibling;if(O!==null){O.return=c.return,bt=O;break}bt=c.return}}var S$=Math.ceil,G0=L.ReactCurrentDispatcher,c1=L.ReactCurrentOwner,Js=L.ReactCurrentBatchConfig,ee=0,Ln=null,on=null,Xn=0,vs=0,Bf=Jl(0),gn=0,Zm=null,Uh=0,W0=0,h1=0,ty=null,Yi=null,u1=0,zf=1/0,Eo=null,V0=!1,d1=null,sc=null,q0=!1,rc=null,X0=0,ey=0,f1=null,Y0=-1,K0=0;function Mi(){return ee&6?Qe():Y0!==-1?Y0:Y0=Qe()}function ac(a){return a.mode&1?ee&2&&Xn!==0?Xn&-Xn:o$.transition!==null?(K0===0&&(K0=Ck()),K0):(a=oe,a!==0||(a=window.event,a=a===void 0?16:Fk(a.type)),a):1}function Dr(a,c,d,y){if(50<ey)throw ey=0,f1=null,Error(e(185));xm(a,d,y),(!(ee&2)||a!==Ln)&&(a===Ln&&(!(ee&2)&&(W0|=d),gn===4&&oc(a,Xn)),Ki(a,y),d===1&&ee===0&&!(c.mode&1)&&(zf=Qe()+500,S0&&tc()))}function Ki(a,c){var d=a.callbackNode;o2(a,c);var y=r0(a,a===Ln?Xn:0);if(y===0)d!==null&&Ek(d),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(d!=null&&Ek(d),c===1)a.tag===0?a$(FR.bind(null,a)):bP(FR.bind(null,a)),n$(function(){!(ee&6)&&tc()}),d=null;else{switch(Tk(y)){case 1:d=VE;break;case 4:d=Sk;break;case 16:d=e0;break;case 536870912:d=xk;break;default:d=e0}d=UR(d,DR.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function DR(a,c){if(Y0=-1,K0=0,ee&6)throw Error(e(327));var d=a.callbackNode;if(Uf()&&a.callbackNode!==d)return null;var y=r0(a,a===Ln?Xn:0);if(y===0)return null;if(y&30||y&a.expiredLanes||c)c=Q0(a,y);else{c=y;var w=ee;ee|=2;var x=NR();(Ln!==a||Xn!==c)&&(Eo=null,zf=Qe()+500,Wh(a,c));do try{T$();break}catch(O){OR(a,O)}while(!0);LS(),G0.current=x,ee=w,on!==null?c=0:(Ln=null,Xn=0,c=gn)}if(c!==0){if(c===2&&(w=qE(a),w!==0&&(y=w,c=p1(a,w))),c===1)throw d=Zm,Wh(a,0),oc(a,y),Ki(a,Qe()),d;if(c===6)oc(a,y);else{if(w=a.current.alternate,!(y&30)&&!x$(w)&&(c=Q0(a,y),c===2&&(x=qE(a),x!==0&&(y=x,c=p1(a,x))),c===1))throw d=Zm,Wh(a,0),oc(a,y),Ki(a,Qe()),d;switch(a.finishedWork=w,a.finishedLanes=y,c){case 0:case 1:throw Error(e(345));case 2:Vh(a,Yi,Eo);break;case 3:if(oc(a,y),(y&130023424)===y&&(c=u1+500-Qe(),10<c)){if(r0(a,0)!==0)break;if(w=a.suspendedLanes,(w&y)!==y){Mi(),a.pingedLanes|=a.suspendedLanes&w;break}a.timeoutHandle=bS(Vh.bind(null,a,Yi,Eo),c);break}Vh(a,Yi,Eo);break;case 4:if(oc(a,y),(y&4194240)===y)break;for(c=a.eventTimes,w=-1;0<y;){var R=31-kr(y);x=1<<R,R=c[R],R>w&&(w=R),y&=~x}if(y=w,y=Qe()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*S$(y/1960))-y,10<y){a.timeoutHandle=bS(Vh.bind(null,a,Yi,Eo),y);break}Vh(a,Yi,Eo);break;case 5:Vh(a,Yi,Eo);break;default:throw Error(e(329))}}}return Ki(a,Qe()),a.callbackNode===d?DR.bind(null,a):null}function p1(a,c){var d=ty;return a.current.memoizedState.isDehydrated&&(Wh(a,c).flags|=256),a=Q0(a,c),a!==2&&(c=Yi,Yi=d,c!==null&&g1(c)),a}function g1(a){Yi===null?Yi=a:Yi.push.apply(Yi,a)}function x$(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var w=d[y],x=w.getSnapshot;w=w.value;try{if(!Pr(x(),w))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function oc(a,c){for(c&=~h1,c&=~W0,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-kr(c),y=1<<d;a[d]=-1,c&=~y}}function FR(a){if(ee&6)throw Error(e(327));Uf();var c=r0(a,0);if(!(c&1))return Ki(a,Qe()),null;var d=Q0(a,c);if(a.tag!==0&&d===2){var y=qE(a);y!==0&&(c=y,d=p1(a,y))}if(d===1)throw d=Zm,Wh(a,0),oc(a,c),Ki(a,Qe()),d;if(d===6)throw Error(e(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Vh(a,Yi,Eo),Ki(a,Qe()),null}function m1(a,c){var d=ee;ee|=1;try{return a(c)}finally{ee=d,ee===0&&(zf=Qe()+500,S0&&tc())}}function Gh(a){rc!==null&&rc.tag===0&&!(ee&6)&&Uf();var c=ee;ee|=1;var d=Js.transition,y=oe;try{if(Js.transition=null,oe=1,a)return a()}finally{oe=y,Js.transition=d,ee=c,!(ee&6)&&tc()}}function y1(){vs=Bf.current,ke(Bf)}function Wh(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,e$(d)),on!==null)for(d=on.return;d!==null;){var y=d;switch(CS(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&w0();break;case 3:$f(),ke(Vi),ke(hi),jS();break;case 5:NS(y);break;case 4:$f();break;case 13:ke(Ne);break;case 19:ke(Ne);break;case 10:MS(y.type._context);break;case 22:case 23:y1()}d=d.return}if(Ln=a,on=a=lc(a.current,null),Xn=vs=c,gn=0,Zm=null,h1=W0=Uh=0,Yi=ty=null,Hh!==null){for(c=0;c<Hh.length;c++)if(d=Hh[c],y=d.interleaved,y!==null){d.interleaved=null;var w=y.next,x=d.pending;if(x!==null){var R=x.next;x.next=w,y.next=R}d.pending=y}Hh=null}return a}function OR(a,c){do{var d=on;try{if(LS(),D0.current=$0,F0){for(var y=$e.memoizedState;y!==null;){var w=y.queue;w!==null&&(w.pending=null),y=y.next}F0=!1}if(zh=0,Rn=pn=$e=null,qm=!1,Xm=0,c1.current=null,d===null||d.return===null){gn=1,Zm=c,on=null;break}t:{var x=a,R=d.return,O=d,$=c;if(c=Xn,O.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var K=$,rt=O,ot=rt.tag;if(!(rt.mode&1)&&(ot===0||ot===11||ot===15)){var st=rt.alternate;st?(rt.updateQueue=st.updateQueue,rt.memoizedState=st.memoizedState,rt.lanes=st.lanes):(rt.updateQueue=null,rt.memoizedState=null)}var mt=oR(R);if(mt!==null){mt.flags&=-257,lR(mt,R,O,x,c),mt.mode&1&&aR(x,K,c),c=mt,$=K;var Et=c.updateQueue;if(Et===null){var xt=new Set;xt.add($),c.updateQueue=xt}else Et.add($);break t}else{if(!(c&1)){aR(x,K,c),v1();break t}$=Error(e(426))}}else if(Ie&&O.mode&1){var Je=oR(R);if(Je!==null){!(Je.flags&65536)&&(Je.flags|=256),lR(Je,R,O,x,c),PS(jf($,O));break t}}x=$=jf($,O),gn!==4&&(gn=2),ty===null?ty=[x]:ty.push(x),x=R;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var V=sR(x,$,c);LP(x,V);break t;case 1:O=$;var z=x.type,X=x.stateNode;if(!(x.flags&128)&&(typeof z.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(sc===null||!sc.has(X)))){x.flags|=65536,c&=-c,x.lanes|=c;var ct=rR(x,O,c);LP(x,ct);break t}}x=x.return}while(x!==null)}jR(d)}catch(Ct){c=Ct,on===d&&d!==null&&(on=d=d.return);continue}break}while(!0)}function NR(){var a=G0.current;return G0.current=$0,a===null?$0:a}function v1(){(gn===0||gn===3||gn===2)&&(gn=4),Ln===null||!(Uh&268435455)&&!(W0&268435455)||oc(Ln,Xn)}function Q0(a,c){var d=ee;ee|=2;var y=NR();(Ln!==a||Xn!==c)&&(Eo=null,Wh(a,c));do try{C$();break}catch(w){OR(a,w)}while(!0);if(LS(),ee=d,G0.current=y,on!==null)throw Error(e(261));return Ln=null,Xn=0,gn}function C$(){for(;on!==null;)$R(on)}function T$(){for(;on!==null&&!JN();)$R(on)}function $R(a){var c=zR(a.alternate,a,vs);a.memoizedProps=a.pendingProps,c===null?jR(a):on=c,c1.current=null}function jR(a){var c=a;do{var d=c.alternate;if(a=c.return,c.flags&32768){if(d=b$(d,c),d!==null){d.flags&=32767,on=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{gn=6,on=null;return}}else if(d=A$(d,c,vs),d!==null){on=d;return}if(c=c.sibling,c!==null){on=c;return}on=c=a}while(c!==null);gn===0&&(gn=5)}function Vh(a,c,d){var y=oe,w=Js.transition;try{Js.transition=null,oe=1,k$(a,c,d,y)}finally{Js.transition=w,oe=y}return null}function k$(a,c,d,y){do Uf();while(rc!==null);if(ee&6)throw Error(e(327));d=a.finishedWork;var w=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(e(177));a.callbackNode=null,a.callbackPriority=0;var x=d.lanes|d.childLanes;if(l2(a,x),a===Ln&&(on=Ln=null,Xn=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||q0||(q0=!0,UR(e0,function(){return Uf(),null})),x=(d.flags&15990)!==0,d.subtreeFlags&15990||x){x=Js.transition,Js.transition=null;var R=oe;oe=1;var O=ee;ee|=4,c1.current=null,w$(a,d),PR(d,a),X2(vS),l0=!!yS,vS=yS=null,a.current=d,E$(d),ZN(),ee=O,oe=R,Js.transition=x}else a.current=d;if(q0&&(q0=!1,rc=a,X0=w),x=a.pendingLanes,x===0&&(sc=null),n2(d.stateNode),Ki(a,Qe()),c!==null)for(y=a.onRecoverableError,d=0;d<c.length;d++)w=c[d],y(w.value,{componentStack:w.stack,digest:w.digest});if(V0)throw V0=!1,a=d1,d1=null,a;return X0&1&&a.tag!==0&&Uf(),x=a.pendingLanes,x&1?a===f1?ey++:(ey=0,f1=a):ey=0,tc(),null}function Uf(){if(rc!==null){var a=Tk(X0),c=Js.transition,d=oe;try{if(Js.transition=null,oe=16>a?16:a,rc===null)var y=!1;else{if(a=rc,rc=null,X0=0,ee&6)throw Error(e(331));var w=ee;for(ee|=4,bt=a.current;bt!==null;){var x=bt,R=x.child;if(bt.flags&16){var O=x.deletions;if(O!==null){for(var $=0;$<O.length;$++){var K=O[$];for(bt=K;bt!==null;){var rt=bt;switch(rt.tag){case 0:case 11:case 15:Jm(8,rt,x)}var ot=rt.child;if(ot!==null)ot.return=rt,bt=ot;else for(;bt!==null;){rt=bt;var st=rt.sibling,mt=rt.return;if(SR(rt),rt===K){bt=null;break}if(st!==null){st.return=mt,bt=st;break}bt=mt}}}var Et=x.alternate;if(Et!==null){var xt=Et.child;if(xt!==null){Et.child=null;do{var Je=xt.sibling;xt.sibling=null,xt=Je}while(xt!==null)}}bt=x}}if(x.subtreeFlags&2064&&R!==null)R.return=x,bt=R;else t:for(;bt!==null;){if(x=bt,x.flags&2048)switch(x.tag){case 0:case 11:case 15:Jm(9,x,x.return)}var V=x.sibling;if(V!==null){V.return=x.return,bt=V;break t}bt=x.return}}var z=a.current;for(bt=z;bt!==null;){R=bt;var X=R.child;if(R.subtreeFlags&2064&&X!==null)X.return=R,bt=X;else t:for(R=z;bt!==null;){if(O=bt,O.flags&2048)try{switch(O.tag){case 0:case 11:case 15:U0(9,O)}}catch(Ct){We(O,O.return,Ct)}if(O===R){bt=null;break t}var ct=O.sibling;if(ct!==null){ct.return=O.return,bt=ct;break t}bt=O.return}}if(ee=w,tc(),ma&&typeof ma.onPostCommitFiberRoot=="function")try{ma.onPostCommitFiberRoot(n0,a)}catch{}y=!0}return y}finally{oe=d,Js.transition=c}}return!1}function HR(a,c,d){c=jf(d,c),c=sR(a,c,1),a=nc(a,c,1),c=Mi(),a!==null&&(xm(a,1,c),Ki(a,c))}function We(a,c,d){if(a.tag===3)HR(a,a,d);else for(;c!==null;){if(c.tag===3){HR(c,a,d);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(sc===null||!sc.has(y))){a=jf(d,a),a=rR(c,a,1),c=nc(c,a,1),a=Mi(),c!==null&&(xm(c,1,a),Ki(c,a));break}}c=c.return}}function P$(a,c,d){var y=a.pingCache;y!==null&&y.delete(c),c=Mi(),a.pingedLanes|=a.suspendedLanes&d,Ln===a&&(Xn&d)===d&&(gn===4||gn===3&&(Xn&130023424)===Xn&&500>Qe()-u1?Wh(a,0):h1|=d),Ki(a,c)}function BR(a,c){c===0&&(a.mode&1?(c=s0,s0<<=1,!(s0&130023424)&&(s0=4194304)):c=1);var d=Mi();a=bo(a,c),a!==null&&(xm(a,c,d),Ki(a,d))}function R$(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),BR(a,d)}function L$(a,c){var d=0;switch(a.tag){case 13:var y=a.stateNode,w=a.memoizedState;w!==null&&(d=w.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(e(314))}y!==null&&y.delete(c),BR(a,d)}var zR;zR=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Vi.current)Xi=!0;else{if(!(a.lanes&d)&&!(c.flags&128))return Xi=!1,v$(a,c,d);Xi=!!(a.flags&131072)}else Xi=!1,Ie&&c.flags&1048576&&_P(c,C0,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;B0(a,c),a=c.pendingProps;var w=Lf(c,hi.current);Nf(c,d),w=zS(null,c,y,a,w,d);var x=US();return c.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,qi(y)?(x=!0,E0(c)):x=!1,c.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,FS(c),w.updater=j0,c.stateNode=w,w._reactInternals=c,YS(c,y,a,d),c=ZS(null,c,y,!0,x,d)):(c.tag=0,Ie&&x&&xS(c),Li(null,c,w,d),c=c.child),c;case 16:y=c.elementType;t:{switch(B0(a,c),a=c.pendingProps,w=y._init,y=w(y._payload),c.type=y,w=c.tag=I$(y),a=Lr(y,a),w){case 0:c=JS(null,c,y,a,d);break t;case 1:c=pR(null,c,y,a,d);break t;case 11:c=cR(null,c,y,a,d);break t;case 14:c=hR(null,c,y,Lr(y.type,a),d);break t}throw Error(e(306,y,""))}return c;case 0:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Lr(y,w),JS(a,c,y,w,d);case 1:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Lr(y,w),pR(a,c,y,w,d);case 3:t:{if(gR(c),a===null)throw Error(e(387));y=c.pendingProps,x=c.memoizedState,w=x.element,RP(a,c),M0(c,y,null,d);var R=c.memoizedState;if(y=R.element,x.isDehydrated)if(x={element:y,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){w=jf(Error(e(423)),c),c=mR(a,c,y,d,w);break t}else if(y!==w){w=jf(Error(e(424)),c),c=mR(a,c,y,d,w);break t}else for(ys=Ql(c.stateNode.containerInfo.firstChild),ms=c,Ie=!0,Rr=null,d=kP(c,null,y,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Df(),y===w){c=wo(a,c,d);break t}Li(a,c,y,d)}c=c.child}return c;case 5:return IP(c),a===null&&kS(c),y=c.type,w=c.pendingProps,x=a!==null?a.memoizedProps:null,R=w.children,AS(y,w)?R=null:x!==null&&AS(y,x)&&(c.flags|=32),fR(a,c),Li(a,c,R,d),c.child;case 6:return a===null&&kS(c),null;case 13:return yR(a,c,d);case 4:return OS(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=Ff(c,null,y,d):Li(a,c,y,d),c.child;case 11:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Lr(y,w),cR(a,c,y,w,d);case 7:return Li(a,c,c.pendingProps,d),c.child;case 8:return Li(a,c,c.pendingProps.children,d),c.child;case 12:return Li(a,c,c.pendingProps.children,d),c.child;case 10:t:{if(y=c.type._context,w=c.pendingProps,x=c.memoizedProps,R=w.value,xe(P0,y._currentValue),y._currentValue=R,x!==null)if(Pr(x.value,R)){if(x.children===w.children&&!Vi.current){c=wo(a,c,d);break t}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var O=x.dependencies;if(O!==null){R=x.child;for(var $=O.firstContext;$!==null;){if($.context===y){if(x.tag===1){$=_o(-1,d&-d),$.tag=2;var K=x.updateQueue;if(K!==null){K=K.shared;var rt=K.pending;rt===null?$.next=$:($.next=rt.next,rt.next=$),K.pending=$}}x.lanes|=d,$=x.alternate,$!==null&&($.lanes|=d),IS(x.return,d,c),O.lanes|=d;break}$=$.next}}else if(x.tag===10)R=x.type===c.type?null:x.child;else if(x.tag===18){if(R=x.return,R===null)throw Error(e(341));R.lanes|=d,O=R.alternate,O!==null&&(O.lanes|=d),IS(R,d,c),R=x.sibling}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===c){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}Li(a,c,w.children,d),c=c.child}return c;case 9:return w=c.type,y=c.pendingProps.children,Nf(c,d),w=Ks(w),y=y(w),c.flags|=1,Li(a,c,y,d),c.child;case 14:return y=c.type,w=Lr(y,c.pendingProps),w=Lr(y.type,w),hR(a,c,y,w,d);case 15:return uR(a,c,c.type,c.pendingProps,d);case 17:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Lr(y,w),B0(a,c),c.tag=1,qi(y)?(a=!0,E0(c)):a=!1,Nf(c,d),nR(c,y,w),YS(c,y,w,d),ZS(null,c,y,!0,a,d);case 19:return AR(a,c,d);case 22:return dR(a,c,d)}throw Error(e(156,c.tag))};function UR(a,c){return wk(a,c)}function M$(a,c,d,y){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zs(a,c,d,y){return new M$(a,c,d,y)}function A1(a){return a=a.prototype,!(!a||!a.isReactComponent)}function I$(a){if(typeof a=="function")return A1(a)?1:0;if(a!=null){if(a=a.$$typeof,a===tt)return 11;if(a===ht)return 14}return 2}function lc(a,c){var d=a.alternate;return d===null?(d=Zs(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function J0(a,c,d,y,w,x){var R=2;if(y=a,typeof a=="function")A1(a)&&(R=1);else if(typeof a=="string")R=5;else t:switch(a){case F:return qh(d.children,w,x,c);case H:R=8,w|=8;break;case j:return a=Zs(12,d,c,w|2),a.elementType=j,a.lanes=x,a;case Z:return a=Zs(13,d,c,w),a.elementType=Z,a.lanes=x,a;case et:return a=Zs(19,d,c,w),a.elementType=et,a.lanes=x,a;case G:return Z0(d,w,x,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Q:R=10;break t;case W:R=9;break t;case tt:R=11;break t;case ht:R=14;break t;case J:R=16,y=null;break t}throw Error(e(130,a==null?a:typeof a,""))}return c=Zs(R,d,c,w),c.elementType=a,c.type=y,c.lanes=x,c}function qh(a,c,d,y){return a=Zs(7,a,y,c),a.lanes=d,a}function Z0(a,c,d,y){return a=Zs(22,a,y,c),a.elementType=G,a.lanes=d,a.stateNode={isHidden:!1},a}function b1(a,c,d){return a=Zs(6,a,null,c),a.lanes=d,a}function _1(a,c,d){return c=Zs(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function D$(a,c,d,y,w){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=XE(0),this.expirationTimes=XE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=XE(0),this.identifierPrefix=y,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function w1(a,c,d,y,w,x,R,O,$){return a=new D$(a,c,d,O,$),c===1?(c=1,x===!0&&(c|=8)):c=0,x=Zs(3,null,null,c),a.current=x,x.stateNode=a,x.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},FS(x),a}function F$(a,c,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:y==null?null:""+y,children:a,containerInfo:c,implementation:d}}function GR(a){if(!a)return Zl;a=a._reactInternals;t:{if(Fh(a)!==a||a.tag!==1)throw Error(e(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(qi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(e(171))}if(a.tag===1){var d=a.type;if(qi(d))return vP(a,d,c)}return c}function WR(a,c,d,y,w,x,R,O,$){return a=w1(d,y,!0,a,w,x,R,O,$),a.context=GR(null),d=a.current,y=Mi(),w=ac(d),x=_o(y,w),x.callback=c??null,nc(d,x,w),a.current.lanes=w,xm(a,w,y),Ki(a,y),a}function t_(a,c,d,y){var w=c.current,x=Mi(),R=ac(w);return d=GR(d),c.context===null?c.context=d:c.pendingContext=d,c=_o(x,R),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=nc(w,c,R),a!==null&&(Dr(a,w,R,x),L0(a,w,R)),R}function e_(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function VR(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function E1(a,c){VR(a,c),(a=a.alternate)&&VR(a,c)}var qR=typeof reportError=="function"?reportError:function(a){console.error(a)};function S1(a){this._internalRoot=a}n_.prototype.render=S1.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(e(409));t_(a,c,null,null)},n_.prototype.unmount=S1.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Gh(function(){t_(null,a,null,null)}),c[mo]=null}};function n_(a){this._internalRoot=a}n_.prototype.unstable_scheduleHydration=function(a){if(a){var c=Rk();a={blockedOn:null,target:a,priority:c};for(var d=0;d<Xl.length&&c!==0&&c<Xl[d].priority;d++);Xl.splice(d,0,a),d===0&&Ik(a)}};function x1(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function i_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function XR(){}function O$(a,c,d,y,w){if(w){if(typeof y=="function"){var x=y;y=function(){var K=e_(R);x.call(K)}}var R=WR(c,y,a,0,null,!1,!1,"",XR);return a._reactRootContainer=R,a[mo]=R.current,jm(a.nodeType===8?a.parentNode:a),Gh(),R}for(;w=a.lastChild;)a.removeChild(w);if(typeof y=="function"){var O=y;y=function(){var K=e_($);O.call(K)}}var $=w1(a,0,!1,null,null,!1,!1,"",XR);return a._reactRootContainer=$,a[mo]=$.current,jm(a.nodeType===8?a.parentNode:a),Gh(function(){t_(c,$,d,y)}),$}function s_(a,c,d,y,w){var x=d._reactRootContainer;if(x){var R=x;if(typeof w=="function"){var O=w;w=function(){var $=e_(R);O.call($)}}t_(c,R,a,w)}else R=O$(d,c,a,w,y);return e_(R)}kk=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=Sm(c.pendingLanes);d!==0&&(YE(c,d|1),Ki(c,Qe()),!(ee&6)&&(zf=Qe()+500,tc()))}break;case 13:Gh(function(){var y=bo(a,1);if(y!==null){var w=Mi();Dr(y,a,1,w)}}),E1(a,1)}},KE=function(a){if(a.tag===13){var c=bo(a,134217728);if(c!==null){var d=Mi();Dr(c,a,134217728,d)}E1(a,134217728)}},Pk=function(a){if(a.tag===13){var c=ac(a),d=bo(a,c);if(d!==null){var y=Mi();Dr(d,a,c,y)}E1(a,c)}},Rk=function(){return oe},Lk=function(a,c){var d=oe;try{return oe=a,c()}finally{oe=d}},Ri=function(a,c,d){switch(c){case"input":if(li(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var y=d[c];if(y!==a&&y.form===a.form){var w=_0(y);if(!w)throw Error(e(90));Ee(y),li(y,w)}}}break;case"textarea":xr(a,d);break;case"select":c=d.value,c!=null&&Pi(a,!!d.multiple,c,!1)}},Jb=m1,po=Gh;var N$={usingClientEntryPoint:!1,Events:[zm,Pf,_0,Kb,Qb,m1]},ny={findFiberByHostInstance:Oh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$$={bundleType:ny.bundleType,version:ny.version,rendererPackageName:ny.rendererPackageName,rendererConfig:ny.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=bk(a),a===null?null:a.stateNode},findFiberByHostInstance:ny.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var r_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!r_.isDisabled&&r_.supportsFiber)try{n0=r_.inject($$),ma=r_}catch{}}return Qi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N$,Qi.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x1(c))throw Error(e(200));return F$(a,c,null,d)},Qi.createRoot=function(a,c){if(!x1(a))throw Error(e(299));var d=!1,y="",w=qR;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(w=c.onRecoverableError)),c=w1(a,1,!1,null,null,d,!1,y,w),a[mo]=c.current,jm(a.nodeType===8?a.parentNode:a),new S1(c)},Qi.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(e(188)):(a=Object.keys(a).join(","),Error(e(268,a)));return a=bk(c),a=a===null?null:a.stateNode,a},Qi.flushSync=function(a){return Gh(a)},Qi.hydrate=function(a,c,d){if(!i_(c))throw Error(e(200));return s_(null,a,c,!0,d)},Qi.hydrateRoot=function(a,c,d){if(!x1(a))throw Error(e(405));var y=d!=null&&d.hydratedSources||null,w=!1,x="",R=qR;if(d!=null&&(d.unstable_strictMode===!0&&(w=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onRecoverableError!==void 0&&(R=d.onRecoverableError)),c=WR(c,null,a,1,d??null,w,!1,x,R),a[mo]=c.current,jm(a),y)for(a=0;a<y.length;a++)d=y[a],w=d._getVersion,w=w(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,w]:c.mutableSourceEagerHydrationData.push(d,w);return new n_(c)},Qi.render=function(a,c,d){if(!i_(c))throw Error(e(200));return s_(null,a,c,!1,d)},Qi.unmountComponentAtNode=function(a){if(!i_(a))throw Error(e(40));return a._reactRootContainer?(Gh(function(){s_(null,null,a,!1,function(){a._reactRootContainer=null,a[mo]=null})}),!0):!1},Qi.unstable_batchedUpdates=m1,Qi.unstable_renderSubtreeIntoContainer=function(a,c,d,y){if(!i_(d))throw Error(e(200));if(a==null||a._reactInternals===void 0)throw Error(e(38));return s_(a,c,d,!1,y)},Qi.version="18.3.1-next-f1338f8080-20240426",Qi}var iL;function X$(){if(iL)return P1.exports;iL=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),P1.exports=q$(),P1.exports}var sL;function Y$(){if(sL)return a_;sL=1;var p=X$();return a_.createRoot=p.createRoot,a_.hydrateRoot=p.hydrateRoot,a_}var K$=Y$(),Ky={};Ky.d=(p,t)=>{for(var e in t)Ky.o(t,e)&&!Ky.o(p,e)&&Object.defineProperty(p,e,{enumerable:!0,get:t[e]})};Ky.o=(p,t)=>Object.prototype.hasOwnProperty.call(p,t);var Ft=globalThis.pdfjsLib={};Ky.d(Ft,{AbortException:()=>Sh,AnnotationEditorLayer:()=>rB,AnnotationEditorParamsType:()=>Jt,AnnotationEditorType:()=>Bt,AnnotationEditorUIManager:()=>ev,AnnotationLayer:()=>QH,AnnotationMode:()=>yc,ColorPicker:()=>uF,DOMSVGFactory:()=>XT,DrawLayer:()=>aB,FeatureTest:()=>Hi,GlobalWorkerOptions:()=>iu,ImageKind:()=>M_,InvalidPDFException:()=>vx,MissingPDFException:()=>tv,OPS:()=>Or,OutputScale:()=>bx,PDFDataRangeTransport:()=>MD,PDFDateString:()=>LI,PDFWorker:()=>V_,PasswordResponses:()=>tj,PermissionFlag:()=>Z$,PixelsPerInch:()=>ym,RenderingCancelledException:()=>UT,TextLayer:()=>Gx,TouchManager:()=>zw,UnexpectedResponseException:()=>Hw,Util:()=>Pt,VerbosityLevel:()=>kE,XfaLayer:()=>DD,build:()=>LH,createValidAbsoluteUrl:()=>sj,fetchData:()=>ME,getDocument:()=>bH,getFilenameFromUrl:()=>fj,getPdfFilenameFromUrl:()=>pj,getXfaPageViewport:()=>gj,isDataScheme:()=>IE,isPdfFile:()=>GT,noContextMenu:()=>ua,normalizeUnicode:()=>hj,setLayerDimensions:()=>hf,shadow:()=>Yt,stopEvent:()=>Gs,version:()=>RH});const Ti=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),kI=[1,0,0,1,0,0],yx=[.001,0,0,.001,0,0],Q$=1e7,M1=1.35,Hs={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},yc={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},J$="pdfjs_internal_editor_",Bt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Jt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Z$={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},pi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},M_={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},mn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},sy={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},kE={ERRORS:0,WARNINGS:1,INFOS:5},Or={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},tj={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let PE=kE.WARNINGS;function ej(p){Number.isInteger(p)&&(PE=p)}function nj(){return PE}function RE(p){PE>=kE.INFOS&&console.log(`Info: ${p}`)}function Ut(p){PE>=kE.WARNINGS&&console.log(`Warning: ${p}`)}function we(p){throw new Error(p)}function un(p,t){p||we(t)}function ij(p){switch(p==null?void 0:p.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sj(p,t=null,e=null){if(!p)return null;try{if(e&&typeof p=="string"){if(e.addDefaultProtocol&&p.startsWith("www.")){const i=p.match(/\./g);(i==null?void 0:i.length)>=2&&(p=`http://${p}`)}if(e.tryConvertEncoding)try{p=cj(p)}catch{}}const n=t?new URL(p,t):new URL(p);if(ij(n))return n}catch{}return null}function Yt(p,t,e,n=!1){return Object.defineProperty(p,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Rh=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();let rL=class extends Rh{constructor(t,e){super(t,"PasswordException"),this.code=e}},I1=class extends Rh{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}},vx=class extends Rh{constructor(t){super(t,"InvalidPDFException")}},tv=class extends Rh{constructor(t){super(t,"MissingPDFException")}},Hw=class extends Rh{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}},rj=class extends Rh{constructor(t){super(t,"FormatError")}},Sh=class extends Rh{constructor(t){super(t,"AbortException")}};function PI(p){(typeof p!="object"||(p==null?void 0:p.length)===void 0)&&we("Invalid argument for bytesToString");const t=p.length,e=8192;if(t<e)return String.fromCharCode.apply(null,p);const n=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),o=p.subarray(i,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function LE(p){typeof p!="string"&&we("Invalid argument for stringToBytes");const t=p.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=p.charCodeAt(n)&255;return e}function aj(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function HT(p){const t=Object.create(null);for(const[e,n]of p)t[e]=n;return t}function oj(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function lj(){try{return new Function(""),!0}catch{return!1}}let Hi=class{static get isLittleEndian(){return Yt(this,"isLittleEndian",oj())}static get isEvalSupported(){return Yt(this,"isEvalSupported",lj())}static get isOffscreenCanvasSupported(){return Yt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Yt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Yt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Yt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return Yt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}};const D1=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));var Ml,px,I_,Ax;let Pt=(px=class{static makeHexColor(t,e,n){return`#${D1[t]}${D1[e]}${D1[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const n=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[n,i]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n;return[i,s]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],s[0],o[0]),Math.min(n[1],i[1],s[1],o[1]),Math.max(n[0],i[0],s[0],o[0]),Math.max(n[1],i[1],s[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],l=(n+o)/2,h=Math.sqrt((n+o)**2-4*(n*o-s*i))/2,u=l+h||1,f=l-h||1;return[Math.sqrt(u),Math.sqrt(f)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>o?null:[n,s,i,o]}static bezierBoundingBox(t,e,n,i,s,o,l,h,u){return u?(u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],e,h),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],e,h)):u=[Math.min(t,l),Math.min(e,h),Math.max(t,l),Math.max(e,h)],b(this,Ml,Ax).call(this,t,n,s,l,e,i,o,h,3*(-t+3*(n-s)+l),6*(t-2*n+s),3*(n-t),u),b(this,Ml,Ax).call(this,t,n,s,l,e,i,o,h,3*(-e+3*(i-o)+h),6*(e-2*i+o),3*(i-e),u),u}},Ml=new WeakSet,I_=function(t,e,n,i,s,o,l,h,u,f){if(u<=0||u>=1)return;const g=1-u,m=u*u,A=m*u,_=g*(g*(g*t+3*u*e)+3*m*n)+A*i,S=g*(g*(g*s+3*u*o)+3*m*l)+A*h;f[0]=Math.min(f[0],_),f[1]=Math.min(f[1],S),f[2]=Math.max(f[2],_),f[3]=Math.max(f[3],S)},Ax=function(t,e,n,i,s,o,l,h,u,f,g,m){if(Math.abs(u)<1e-12){Math.abs(f)>=1e-12&&b(this,Ml,I_).call(this,t,e,n,i,s,o,l,h,-g/f,m);return}const A=f**2-4*g*u;if(A<0)return;const _=Math.sqrt(A),S=2*u;b(this,Ml,I_).call(this,t,e,n,i,s,o,l,h,(-f+_)/S,m),b(this,Ml,I_).call(this,t,e,n,i,s,o,l,h,(-f-_)/S,m)},E(px,Ml),px);function cj(p){return decodeURIComponent(escape(p))}let F1=null,aL=null;function hj(p){return F1||(F1=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aL=new Map([["","t"]])),p.replaceAll(F1,(t,e,n)=>e?e.normalize("NFKC"):aL.get(n))}function uj(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const p=new Uint8Array(32);return crypto.getRandomValues(p),PI(p)}const BT="pdfjs_internal_id_";function dj(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(PI(p))}typeof Promise.try!="function"&&(Promise.try=function(p,...t){return new Promise(e=>{e(p(...t))})});const To="http://www.w3.org/2000/svg";var oo;let ym=(oo=class{},lt(oo,"CSS",96),lt(oo,"PDF",72),lt(oo,"PDF_TO_CSS_UNITS",oo.CSS/oo.PDF),oo);async function ME(p,t="text"){if(vy(p,document.baseURI)){const e=await fetch(p);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",p,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}let zT=class RI{constructor({viewBox:t,userUnit:e,scale:n,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=i,this.offsetX=s,this.offsetY=o,n*=e;const h=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let f,g,m,A;switch(i%=360,i<0&&(i+=360),i){case 180:f=-1,g=0,m=0,A=1;break;case 90:f=0,g=1,m=1,A=0;break;case 270:f=0,g=-1,m=-1,A=0;break;case 0:f=1,g=0,m=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,A=-A);let _,S,C,T;f===0?(_=Math.abs(u-t[1])*n+s,S=Math.abs(h-t[0])*n+o,C=(t[3]-t[1])*n,T=(t[2]-t[0])*n):(_=Math.abs(h-t[0])*n+s,S=Math.abs(u-t[1])*n+o,C=(t[2]-t[0])*n,T=(t[3]-t[1])*n),this.transform=[f*n,g*n,m*n,A*n,_-f*n*h-m*n*u,S-g*n*h-A*n*u],this.width=C,this.height=T}get rawDims(){const{userUnit:t,viewBox:e}=this,n=e.map(i=>i*t);return Yt(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new RI({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){return Pt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Pt.applyTransform([t[0],t[1]],this.transform),n=Pt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return Pt.applyInverseTransform([t,e],this.transform)}},UT=class extends Rh{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}};function IE(p){const t=p.length;let e=0;for(;e<t&&p[e].trim()==="";)e++;return p.substring(e,e+5).toLowerCase()==="data:"}function GT(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function fj(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function pj(p,t="document.pdf"){if(typeof p!="string")return t;if(IE(p))return Ut('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(p);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||t}let oL=class{constructor(){lt(this,"started",Object.create(null));lt(this,"times",[])}time(t){t in this.started&&Ut(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ut(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:s}of this.times)t.push(`${n.padEnd(e)} ${s-i}ms
`);return t.join("")}};function vy(p,t){try{const{protocol:e}=t?new URL(p,t):new URL(p);return e==="http:"||e==="https:"}catch{return!1}}function ua(p){p.preventDefault()}function Gs(p){p.preventDefault(),p.stopPropagation()}var gx,iv;let LI=(gx=class{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,iv)||v(this,iv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,iv).exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const u=e[7]||"Z";let f=parseInt(e[8],10);f=f>=0&&f<=23?f:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,u==="-"?(o+=f,l+=g):u==="+"&&(o-=f,l-=g),new Date(Date.UTC(n,i,s,o,l,h))}},iv=new WeakMap,E(gx,iv),gx);function gj(p,{scale:t=1,rotation:e=0}){const{width:n,height:i}=p.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new zT({viewBox:s,userUnit:1,scale:t,rotation:e})}function WT(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ut(`Not a valid color format: "${p}"`),[0,0,0])}function mj(p){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of p.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;p.set(e,WT(n))}t.remove()}function Fe(p){const{a:t,b:e,c:n,d:i,e:s,f:o}=p.getTransform();return[t,e,n,i,s,o]}function _a(p){const{a:t,b:e,c:n,d:i,e:s,f:o}=p.getTransform().invertSelf();return[t,e,n,i,s,o]}function hf(p,t,e=!1,n=!0){if(t instanceof zT){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=p,l=Hi.isCSSRoundSupported,h=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${s}px`,f=l?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,g=l?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!e||t.rotation%180===0?(o.width=f,o.height=g):(o.width=g,o.height=f)}n&&p.setAttribute("data-main-rotation",t.rotation)}let bx=class{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}};var Ac,au,$r,ou,sv,gr,rv,Yw,MI,zi,II,DI,D_,FI,_x;let yj=(gr=class{constructor(t){E(this,zi);E(this,Ac,null);E(this,au,null);E(this,$r);E(this,ou,null);E(this,sv,null);v(this,$r,t),r(gr,rv)||v(gr,rv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=v(this,Ac,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,$r)._uiManager._signal;t.addEventListener("contextmenu",ua,{signal:e}),t.addEventListener("pointerdown",b(gr,Yw,MI),{signal:e});const n=v(this,ou,document.createElement("div"));n.className="buttons",t.append(n);const i=r(this,$r).toolbarPosition;if(i){const{style:s}=t,o=r(this,$r)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return b(this,zi,FI).call(this),t}get div(){return r(this,Ac)}hide(){var t;r(this,Ac).classList.add("hidden"),(t=r(this,au))==null||t.hideDropdown()}show(){var t;r(this,Ac).classList.remove("hidden"),(t=r(this,sv))==null||t.shown()}async addAltText(t){const e=await t.render();b(this,zi,D_).call(this,e),r(this,ou).prepend(e,r(this,zi,_x)),v(this,sv,t)}addColorPicker(t){v(this,au,t);const e=t.renderButton();b(this,zi,D_).call(this,e),r(this,ou).prepend(e,r(this,zi,_x))}remove(){var t;r(this,Ac).remove(),(t=r(this,au))==null||t.destroy(),v(this,au,null)}},Ac=new WeakMap,au=new WeakMap,$r=new WeakMap,ou=new WeakMap,sv=new WeakMap,rv=new WeakMap,Yw=new WeakSet,MI=function(t){t.stopPropagation()},zi=new WeakSet,II=function(t){r(this,$r)._focusEventsAllowed=!1,Gs(t)},DI=function(t){r(this,$r)._focusEventsAllowed=!0,Gs(t)},D_=function(t){const e=r(this,$r)._uiManager._signal;t.addEventListener("focusin",b(this,zi,II).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",b(this,zi,DI).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",ua,{signal:e})},FI=function(){const{editorType:t,_uiManager:e}=r(this,$r),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",r(gr,rv)[t]),b(this,zi,D_).call(this,n),n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),r(this,ou).append(n)},_x=function(){const t=document.createElement("div");return t.className="divider",t},E(gr,Yw),E(gr,rv,null),gr);var av,lu,cu,Th,OI,NI,$I,XM;let vj=(XM=class{constructor(t){E(this,Th);E(this,av,null);E(this,lu,null);E(this,cu);v(this,cu,t)}show(t,e,n){const[i,s]=b(this,Th,NI).call(this,e,n),{style:o}=r(this,lu)||v(this,lu,b(this,Th,OI).call(this));t.append(r(this,lu)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,lu).remove()}},av=new WeakMap,lu=new WeakMap,cu=new WeakMap,Th=new WeakSet,OI=function(){const t=v(this,lu,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",ua,{signal:r(this,cu)._signal});const e=v(this,av,document.createElement("div"));return e.className="buttons",t.append(e),b(this,Th,$I).call(this),t},NI=function(t,e){let n=0,i=0;for(const s of t){const o=s.y+s.height;if(o<n)continue;const l=s.x+(e?s.width:0);if(o>n){i=l,n=o;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,n]},$I=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=r(this,cu)._signal;t.addEventListener("contextmenu",ua,{signal:n}),t.addEventListener("click",()=>{r(this,cu).highlightSelection("floating_button")},{signal:n}),r(this,av).append(t)},XM);function Bw(p,t,e){for(const n of e)t.addEventListener(n,p[n].bind(p))}var Kw,YM;let Aj=(YM=class{constructor(){E(this,Kw,0)}get id(){return`${J$}${le(this,Kw)._++}`}},Kw=new WeakMap,YM);var up,ov,vi,dp,F_,fp;let bj=(fp=class{constructor(){E(this,dp);E(this,up,uj());E(this,ov,0);E(this,vi,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Yt(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return b(this,dp,F_).call(this,`${e}_${n}_${i}_${s}`,t)}async getFromUrl(t){return b(this,dp,F_).call(this,t,t)}async getFromBlob(t,e){const n=await e;return b(this,dp,F_).call(this,t,n)}async getFromId(t){r(this,vi)||v(this,vi,new Map);const e=r(this,vi).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,vi)||v(this,vi,new Map);let n=r(this,vi).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${r(this,up)}_${le(this,ov)._++}`,refCounter:1,isSvg:!1},r(this,vi).set(t,n),r(this,vi).set(n.id,n),n}getSvgUrl(t){const e=r(this,vi).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;r(this,vi)||v(this,vi,new Map);const e=r(this,vi).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}(i=n.close)==null||i.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,up)}_`)}},up=new WeakMap,ov=new WeakMap,vi=new WeakMap,dp=new WeakSet,F_=async function(t,e){r(this,vi)||v(this,vi,new Map);let n=r(this,vi).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${r(this,up)}_${le(this,ov)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(n.url=e,i=await ME(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=fp._isSVGFittingCanvas,o=new FileReader,l=new Image,h=new Promise((u,f)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,u()},o.onload=async()=>{const g=n.svgUrl=o.result;l.src=await s?`${g}#svgView(preserveAspectRatio(none))`:g},l.onerror=o.onerror=f});o.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Ut(i),n=null}return r(this,vi).set(t,n),n&&r(this,vi).set(n.id,n),n},fp);var Ze,bc,lv,He,KM;let _j=(KM=class{constructor(t=128){E(this,Ze,[]);E(this,bc,!1);E(this,lv);E(this,He,-1);v(this,lv,t)}add({cmd:t,undo:e,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&t(),r(this,bc))return;const h={cmd:t,undo:e,post:n,type:s};if(r(this,He)===-1){r(this,Ze).length>0&&(r(this,Ze).length=0),v(this,He,0),r(this,Ze).push(h);return}if(o&&r(this,Ze)[r(this,He)].type===s){l&&(h.undo=r(this,Ze)[r(this,He)].undo),r(this,Ze)[r(this,He)]=h;return}const u=r(this,He)+1;u===r(this,lv)?r(this,Ze).splice(0,1):(v(this,He,u),u<r(this,Ze).length&&r(this,Ze).splice(u)),r(this,Ze).push(h)}undo(){if(r(this,He)===-1)return;v(this,bc,!0);const{undo:t,post:e}=r(this,Ze)[r(this,He)];t(),e==null||e(),v(this,bc,!1),v(this,He,r(this,He)-1)}redo(){if(r(this,He)<r(this,Ze).length-1){v(this,He,r(this,He)+1),v(this,bc,!0);const{cmd:t,post:e}=r(this,Ze)[r(this,He)];t(),e==null||e(),v(this,bc,!1)}}hasSomethingToUndo(){return r(this,He)!==-1}hasSomethingToRedo(){return r(this,He)<r(this,Ze).length-1}cleanType(t){if(r(this,He)!==-1){for(let e=r(this,He);e>=0;e--)if(r(this,Ze)[e].type!==t){r(this,Ze).splice(e+1,r(this,He)-e),v(this,He,e);return}r(this,Ze).length=0,v(this,He,-1)}}destroy(){v(this,Ze,null)}},Ze=new WeakMap,bc=new WeakMap,lv=new WeakMap,He=new WeakMap,KM);var Qw,jI,QM;let Ub=(QM=class{constructor(t){E(this,Qw);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Hi.platform;for(const[n,i,s={}]of t)for(const o of n){const l=o.startsWith("mac+");e&&l?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!e&&!l&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(b(this,Qw,jI).call(this,e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:l=null}}=n;l&&!l(t,e)||(i.bind(t,...o,e)(),s||Gs(e))}},Qw=new WeakSet,jI=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e},QM);var hu;let wj=(hu=class{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return mj(t),Yt(this,"_colors",t)}convert(t){const e=WT(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((s,o)=>s===e[o]))return hu._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Pt.makeHexColor(...e):t}},lt(hu,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),hu);var pp,bs,vn,Kn,gp,Io,mp,nr,_c,uu,yp,du,Ca,jr,fu,cv,hv,vp,uv,Ta,wc,Ap,Ec,ka,Jw,Sc,dv,xc,pu,fv,pv,In,he,Do,gu,gv,mv,Cc,Pa,Fo,yv,ir,Rl,pt,O_,wx,HI,BI,N_,zI,UI,GI,Ex,WI,Sx,xx,VI,Ii,ko,qI,XI,Cx,YI,Ay,Tx;let ev=(Rl=class{constructor(t,e,n,i,s,o,l,h,u,f,g,m,A){E(this,pt);E(this,pp,new AbortController);E(this,bs,null);E(this,vn,new Map);E(this,Kn,new Map);E(this,gp,null);E(this,Io,null);E(this,mp,null);E(this,nr,new _j);E(this,_c,null);E(this,uu,null);E(this,yp,0);E(this,du,new Set);E(this,Ca,null);E(this,jr,null);E(this,fu,new Set);lt(this,"_editorUndoBar",null);E(this,cv,!1);E(this,hv,!1);E(this,vp,!1);E(this,uv,null);E(this,Ta,null);E(this,wc,null);E(this,Ap,null);E(this,Ec,!1);E(this,ka,null);E(this,Jw,new Aj);E(this,Sc,!1);E(this,dv,!1);E(this,xc,null);E(this,pu,null);E(this,fv,null);E(this,pv,null);E(this,In,Bt.NONE);E(this,he,new Set);E(this,Do,null);E(this,gu,null);E(this,gv,null);E(this,mv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,Cc,[0,0]);E(this,Pa,null);E(this,Fo,null);E(this,yv,null);E(this,ir,null);const _=this._signal=r(this,pp).signal;v(this,Fo,t),v(this,yv,e),v(this,gp,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:_}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),i._on("setpreference",this.onSetPreference.bind(this),{signal:_}),i._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:_}),b(this,pt,zI).call(this),b(this,pt,VI).call(this),b(this,pt,Ex).call(this),v(this,Io,s.annotationStorage),v(this,uv,s.filterFactory),v(this,gu,o),v(this,Ap,l||null),v(this,cv,h),v(this,hv,u),v(this,vp,f),v(this,pv,g||null),this.viewParameters={realScale:ym.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=A!==!1}static get _keyboardManager(){const t=Rl.prototype,e=o=>r(o,Fo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Yt(this,"_keyboardManager",new Ub([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,Fo).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,Fo).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,n,i,s;(t=r(this,ir))==null||t.resolve(),v(this,ir,null),(e=r(this,pp))==null||e.abort(),v(this,pp,null),this._signal=null;for(const o of r(this,Kn).values())o.destroy();r(this,Kn).clear(),r(this,vn).clear(),r(this,fu).clear(),v(this,bs,null),r(this,he).clear(),r(this,nr).destroy(),(n=r(this,gp))==null||n.destroy(),(i=r(this,ka))==null||i.hide(),v(this,ka,null),r(this,Ta)&&(clearTimeout(r(this,Ta)),v(this,Ta,null)),r(this,Pa)&&(clearTimeout(r(this,Pa)),v(this,Pa,null)),(s=this._editorUndoBar)==null||s.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,pv)}get useNewAltTextFlow(){return r(this,hv)}get useNewAltTextWhenAddingImage(){return r(this,vp)}get hcmFilter(){return Yt(this,"hcmFilter",r(this,gu)?r(this,uv).addHCMFilter(r(this,gu).foreground,r(this,gu).background):"none")}get direction(){return Yt(this,"direction",getComputedStyle(r(this,Fo)).direction)}get highlightColors(){return Yt(this,"highlightColors",r(this,Ap)?new Map(r(this,Ap).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Yt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),v(this,uu,t)}setMainHighlightColorPicker(t){v(this,fv,t)}editAltText(t,e=!1){var n;(n=r(this,gp))==null||n.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":v(this,vp,e);break}}onPageChanging({pageNumber:t}){v(this,yp,t-1)}focusMainContainer(){r(this,Fo).focus()}findParent(t,e){for(const n of r(this,Kn).values()){const{x:i,y:s,width:o,height:l}=n.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=s&&e<=s+l)return n}return null}disableUserSelect(t=!1){r(this,yv).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,fu).add(t)}removeShouldRescale(t){r(this,fu).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*ym.PDF_TO_CSS_UNITS;for(const n of r(this,fu))n.onScaleChanging();(e=r(this,uu))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}=e,l=e.toString(),u=b(this,pt,O_).call(this,e).closest(".textLayer"),f=this.getSelectionBoxes(u);if(!f)return;e.empty();const g=b(this,pt,wx).call(this,u),m=r(this,In)===Bt.NONE,A=()=>{g==null||g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:f,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Bt.HIGHLIGHT,A);return}A()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,Io)&&!r(this,Io).has(t.id)&&r(this,Io).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,Ec)&&(v(this,Ec,!1),b(this,pt,N_).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,he))if(e.div.contains(t)){v(this,pu,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,pu))return;const[t,e]=r(this,pu);v(this,pu,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){b(this,pt,Ex).call(this),b(this,pt,Sx).call(this)}removeEditListeners(){b(this,pt,WI).call(this),b(this,pt,xx).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of r(this,jr))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of r(this,jr))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=r(this,bs))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of r(this,he)){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const o of r(this,jr))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Ut(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const h of n){const u=await i.deserialize(h);if(!u)return;s.push(u)}const o=()=>{for(const h of s)b(this,pt,Cx).call(this,h);b(this,pt,Tx).call(this,s)},l=()=>{for(const h of s)h.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(s){Ut(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,In)!==Bt.NONE&&!this.isEditorHandlingKeyboard&&Rl._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,Ec)&&(v(this,Ec,!1),b(this,pt,N_).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(b(this,pt,UI).call(this),b(this,pt,Sx).call(this),b(this,pt,Ii).call(this,{isEditing:r(this,In)!==Bt.NONE,isEmpty:b(this,pt,Ay).call(this),hasSomethingToUndo:r(this,nr).hasSomethingToUndo(),hasSomethingToRedo:r(this,nr).hasSomethingToRedo(),hasSelectedEditor:!1})):(b(this,pt,GI).call(this),b(this,pt,xx).call(this),b(this,pt,Ii).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,jr)){v(this,jr,t);for(const e of r(this,jr))b(this,pt,ko).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,Jw).id}get currentLayer(){return r(this,Kn).get(r(this,yp))}getLayer(t){return r(this,Kn).get(t)}get currentPageIndex(){return r(this,yp)}addLayer(t){r(this,Kn).set(t.pageIndex,t),r(this,Sc)?t.enable():t.disable()}removeLayer(t){r(this,Kn).delete(t.pageIndex)}async updateMode(t,e=null,n=!1){var i;if(r(this,In)!==t&&!(r(this,ir)&&(await r(this,ir).promise,!r(this,ir)))){if(v(this,ir,Promise.withResolvers()),v(this,In,t),t===Bt.NONE){this.setEditingState(!1),b(this,pt,XI).call(this),(i=this._editorUndoBar)==null||i.hide(),r(this,ir).resolve();return}this.setEditingState(!0),await b(this,pt,qI).call(this),this.unselectAll();for(const s of r(this,Kn).values())s.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),r(this,ir).resolve();return}for(const s of r(this,vn).values())s.annotationElementId===e?(this.setSelected(s),s.enterInEditMode()):s.unselect();r(this,ir).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,In)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var n;if(r(this,jr)){switch(t){case Jt.CREATE:this.currentLayer.addNewEditor();return;case Jt.HIGHLIGHT_DEFAULT_COLOR:(n=r(this,fv))==null||n.updateColor(e);break;case Jt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,gv)||v(this,gv,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of r(this,he))i.updateParams(t,e);for(const i of r(this,jr))i.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var s;for(const o of r(this,vn).values())o.editorType===t&&o.show(e);(((s=r(this,gv))==null?void 0:s.get(Jt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&b(this,pt,ko).call(this,[[Jt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,dv)!==t){v(this,dv,t);for(const e of r(this,Kn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of r(this,vn).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return r(this,vn).get(t)}addEditor(t){r(this,vn).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Ta)&&clearTimeout(r(this,Ta)),v(this,Ta,setTimeout(()=>{this.focusMainContainer(),v(this,Ta,null)},0))),r(this,vn).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,du).has(t.annotationElementId))&&((e=r(this,Io))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,du).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,du).has(t)}removeDeletedAnnotationElement(t){r(this,du).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,bs)!==t&&(v(this,bs,t),t&&b(this,pt,ko).call(this,t.propertiesToUpdate))}updateUI(t){r(this,pt,YI)===t&&b(this,pt,ko).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){b(this,pt,ko).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(r(this,he).has(t)){r(this,he).delete(t),t.unselect(),b(this,pt,Ii).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,he).add(t),t.select(),b(this,pt,ko).call(this,t.propertiesToUpdate),b(this,pt,Ii).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=r(this,uu))==null||e.commitOrRemove();for(const n of r(this,he))n!==t&&n.unselect();r(this,he).clear(),r(this,he).add(t),t.select(),b(this,pt,ko).call(this,t.propertiesToUpdate),b(this,pt,Ii).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,he).has(t)}get firstSelectedEditor(){return r(this,he).values().next().value}unselect(t){t.unselect(),r(this,he).delete(t),b(this,pt,Ii).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,he).size!==0}get isEnterHandled(){return r(this,he).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;r(this,nr).undo(),b(this,pt,Ii).call(this,{hasSomethingToUndo:r(this,nr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:b(this,pt,Ay).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){r(this,nr).redo(),b(this,pt,Ii).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,nr).hasSomethingToRedo(),isEmpty:b(this,pt,Ay).call(this)})}addCommands(t){r(this,nr).add(t),b(this,pt,Ii).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:b(this,pt,Ay).call(this)})}cleanUndoStack(t){r(this,nr).cleanType(t)}delete(){var s;this.commitOrRemove();const t=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...r(this,he)],n=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},i=()=>{for(const o of e)b(this,pt,Cx).call(this,o)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=r(this,bs))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,bs)||this.hasSelection}selectAll(){for(const t of r(this,he))t.commit();b(this,pt,Tx).call(this,r(this,vn).values())}unselectAll(){var t;if(!(r(this,bs)&&(r(this,bs).commitOrRemove(),r(this,In)!==Bt.NONE))&&!((t=r(this,uu))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of r(this,he))e.unselect();r(this,he).clear(),b(this,pt,Ii).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;r(this,Cc)[0]+=t,r(this,Cc)[1]+=e;const[i,s]=r(this,Cc),o=[...r(this,he)],l=1e3;r(this,Pa)&&clearTimeout(r(this,Pa)),v(this,Pa,setTimeout(()=>{v(this,Pa,null),r(this,Cc)[0]=r(this,Cc)[1]=0,this.addCommands({cmd:()=>{for(const h of o)r(this,vn).has(h.id)&&h.translateInPage(i,s)},undo:()=>{for(const h of o)r(this,vn).has(h.id)&&h.translateInPage(-i,-s)},mustExec:!1})},l));for(const h of o)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,Ca,new Map);for(const t of r(this,he))r(this,Ca).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,Ca))return!1;this.disableUserSelect(!1);const t=r(this,Ca);v(this,Ca,null);let e=!1;for(const[{x:i,y:s,pageIndex:o},l]of t)l.newX=i,l.newY=s,l.newPageIndex=o,e||(e=i!==l.savedX||s!==l.savedY||o!==l.savedPageIndex);if(!e)return!1;const n=(i,s,o,l)=>{if(r(this,vn).has(i.id)){const h=r(this,Kn).get(l);h?i._setParentAndPosition(h,s,o):(i.pageIndex=l,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:l}]of t)n(i,s,o,l)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:l}]of t)n(i,s,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,Ca))for(const n of r(this,Ca).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,he).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,bs)===t}getActive(){return r(this,bs)}getMode(){return r(this,In)}get imageManager(){return Yt(this,"imageManager",new bj)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,f=e.rangeCount;u<f;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:o}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,f,g,m)=>({x:(f-i)/o,y:1-(u+g-n)/s,width:m/o,height:g/s});break;case"180":l=(u,f,g,m)=>({x:1-(u+g-n)/s,y:1-(f+m-i)/o,width:g/s,height:m/o});break;case"270":l=(u,f,g,m)=>({x:1-(f+m-i)/o,y:(u-n)/s,width:m/o,height:g/s});break;default:l=(u,f,g,m)=>({x:(u-n)/s,y:(f-i)/o,width:g/s,height:m/o});break}const h=[];for(let u=0,f=e.rangeCount;u<f;u++){const g=e.getRangeAt(u);if(!g.collapsed)for(const{x:m,y:A,width:_,height:S}of g.getClientRects())_===0||S===0||h.push(l(m,A,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,mp)||v(this,mp,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,mp))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=r(this,mp))==null?void 0:i.get(t.data.id);if(!e)return;const n=r(this,Io).getRawValue(e);n&&(r(this,In)===Bt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}},pp=new WeakMap,bs=new WeakMap,vn=new WeakMap,Kn=new WeakMap,gp=new WeakMap,Io=new WeakMap,mp=new WeakMap,nr=new WeakMap,_c=new WeakMap,uu=new WeakMap,yp=new WeakMap,du=new WeakMap,Ca=new WeakMap,jr=new WeakMap,fu=new WeakMap,cv=new WeakMap,hv=new WeakMap,vp=new WeakMap,uv=new WeakMap,Ta=new WeakMap,wc=new WeakMap,Ap=new WeakMap,Ec=new WeakMap,ka=new WeakMap,Jw=new WeakMap,Sc=new WeakMap,dv=new WeakMap,xc=new WeakMap,pu=new WeakMap,fv=new WeakMap,pv=new WeakMap,In=new WeakMap,he=new WeakMap,Do=new WeakMap,gu=new WeakMap,gv=new WeakMap,mv=new WeakMap,Cc=new WeakMap,Pa=new WeakMap,Fo=new WeakMap,yv=new WeakMap,ir=new WeakMap,pt=new WeakSet,O_=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},wx=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of r(this,Kn).values())if(n.hasTextLayer(t))return n;return null},HI=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=b(this,pt,O_).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(r(this,ka)||v(this,ka,new vj(this)),r(this,ka).show(n,i,this.direction==="ltr"))},BI=function(){var s,o,l;const t=document.getSelection();if(!t||t.isCollapsed){r(this,Do)&&((s=r(this,ka))==null||s.hide(),v(this,Do,null),b(this,pt,Ii).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,Do))return;const i=b(this,pt,O_).call(this,t).closest(".textLayer");if(!i){r(this,Do)&&((o=r(this,ka))==null||o.hide(),v(this,Do,null),b(this,pt,Ii).call(this,{hasSelectedText:!1}));return}if((l=r(this,ka))==null||l.hide(),v(this,Do,e),b(this,pt,Ii).call(this,{hasSelectedText:!0}),!(r(this,In)!==Bt.HIGHLIGHT&&r(this,In)!==Bt.NONE)&&(r(this,In)===Bt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,Ec,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=r(this,In)===Bt.HIGHLIGHT?b(this,pt,wx).call(this,i):null;h==null||h.toggleDrawing();const u=new AbortController,f=this.combinedSignal(u),g=m=>{m.type==="pointerup"&&m.button!==0||(u.abort(),h==null||h.toggleDrawing(!0),m.type==="pointerup"&&b(this,pt,N_).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:f}),window.addEventListener("blur",g,{signal:f})}},N_=function(t=""){r(this,In)===Bt.HIGHLIGHT?this.highlightSelection(t):r(this,cv)&&b(this,pt,HI).call(this)},zI=function(){document.addEventListener("selectionchange",b(this,pt,BI).bind(this),{signal:this._signal})},UI=function(){if(r(this,wc))return;v(this,wc,new AbortController);const t=this.combinedSignal(r(this,wc));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},GI=function(){var t;(t=r(this,wc))==null||t.abort(),v(this,wc,null)},Ex=function(){if(r(this,xc))return;v(this,xc,new AbortController);const t=this.combinedSignal(r(this,xc));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},WI=function(){var t;(t=r(this,xc))==null||t.abort(),v(this,xc,null)},Sx=function(){if(r(this,_c))return;v(this,_c,new AbortController);const t=this.combinedSignal(r(this,_c));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},xx=function(){var t;(t=r(this,_c))==null||t.abort(),v(this,_c,null)},VI=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Ii=function(t){Object.entries(t).some(([n,i])=>r(this,mv)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,mv),t)}),r(this,In)===Bt.HIGHLIGHT&&t.hasSelectedEditor===!1&&b(this,pt,ko).call(this,[[Jt.HIGHLIGHT_FREE,!0]]))},ko=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},qI=async function(){if(!r(this,Sc)){v(this,Sc,!0);const t=[];for(const e of r(this,Kn).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,vn).values())e.enable()}},XI=function(){if(this.unselectAll(),r(this,Sc)){v(this,Sc,!1);for(const t of r(this,Kn).values())t.disable();for(const t of r(this,vn).values())t.disable()}},Cx=function(t){const e=r(this,Kn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},YI=function(){let t=null;for(t of r(this,he));return t},Ay=function(){if(r(this,vn).size===0)return!0;if(r(this,vn).size===1)for(const t of r(this,vn).values())return t.isEmpty();return!1},Tx=function(t){for(const e of r(this,he))e.unselect();r(this,he).clear();for(const e of t)e.isEmpty()||(r(this,he).add(e),e.select());b(this,pt,Ii).call(this,{hasSelectedEditor:this.hasSelection})},lt(Rl,"TRANSLATE_SMALL",1),lt(Rl,"TRANSLATE_BIG",10),Rl);var Dn,Ra,Hr,bp,La,_s,_p,Ma,ns,Oo,mu,Ia,Gn,Tc,ca,by,$_;let lL=(Gn=class{constructor(t){E(this,ca);E(this,Dn,null);E(this,Ra,!1);E(this,Hr,null);E(this,bp,null);E(this,La,null);E(this,_s,null);E(this,_p,!1);E(this,Ma,null);E(this,ns,null);E(this,Oo,null);E(this,mu,null);E(this,Ia,!1);v(this,ns,t),v(this,Ia,t._uiManager.useNewAltTextFlow),r(Gn,Tc)||v(Gn,Tc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Gn._l10n??(Gn._l10n=t)}async render(){const t=v(this,Hr,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=v(this,bp,document.createElement("span"));t.append(e),r(this,Ia)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Gn,Tc).missing),e.setAttribute("data-l10n-id",r(Gn,Tc)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=r(this,ns)._uiManager._signal;t.addEventListener("contextmenu",ua,{signal:n}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),r(this,ns)._uiManager.editAltText(r(this,ns)),r(this,Ia)&&r(this,ns)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,ca,by)}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(v(this,_p,!0),i(s))},{signal:n}),await b(this,ca,$_).call(this),t}finish(){r(this,Hr)&&(r(this,Hr).focus({focusVisible:r(this,_p)}),v(this,_p,!1))}isEmpty(){return r(this,Ia)?r(this,Dn)===null:!r(this,Dn)&&!r(this,Ra)}hasData(){return r(this,Ia)?r(this,Dn)!==null||!!r(this,Oo):this.isEmpty()}get guessedText(){return r(this,Oo)}async setGuessedText(t){r(this,Dn)===null&&(v(this,Oo,t),v(this,mu,await Gn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),b(this,ca,$_).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,Ia)||r(this,Dn)){(e=r(this,Ma))==null||e.remove(),v(this,Ma,null);return}if(!r(this,Ma)){const n=v(this,Ma,document.createElement("div"));n.className="noAltTextBadge",r(this,ns).div.append(n)}r(this,Ma).classList.toggle("hidden",!t)}serialize(t){let e=r(this,Dn);return!t&&r(this,Oo)===e&&(e=r(this,mu)),{altText:e,decorative:r(this,Ra),guessedText:r(this,Oo),textWithDisclaimer:r(this,mu)}}get data(){return{altText:r(this,Dn),decorative:r(this,Ra)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(v(this,Oo,n),v(this,mu,i)),!(r(this,Dn)===t&&r(this,Ra)===e)&&(s||(v(this,Dn,t),v(this,Ra,e)),b(this,ca,$_).call(this))}toggle(t=!1){r(this,Hr)&&(!t&&r(this,_s)&&(clearTimeout(r(this,_s)),v(this,_s,null)),r(this,Hr).disabled=!t)}shown(){r(this,ns)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,ca,by)}})}destroy(){var t,e;(t=r(this,Hr))==null||t.remove(),v(this,Hr,null),v(this,bp,null),v(this,La,null),(e=r(this,Ma))==null||e.remove(),v(this,Ma,null)}},Dn=new WeakMap,Ra=new WeakMap,Hr=new WeakMap,bp=new WeakMap,La=new WeakMap,_s=new WeakMap,_p=new WeakMap,Ma=new WeakMap,ns=new WeakMap,Oo=new WeakMap,mu=new WeakMap,Ia=new WeakMap,Tc=new WeakMap,ca=new WeakSet,by=function(){return r(this,Dn)&&"added"||r(this,Dn)===null&&this.guessedText&&"review"||"missing"},$_=async function(){var i,s,o;const t=r(this,Hr);if(!t)return;if(r(this,Ia)){if(t.classList.toggle("done",!!r(this,Dn)),t.setAttribute("data-l10n-id",r(Gn,Tc)[r(this,ca,by)]),(i=r(this,bp))==null||i.setAttribute("data-l10n-id",r(Gn,Tc)[`${r(this,ca,by)}-label`]),!r(this,Dn)){(s=r(this,La))==null||s.remove();return}}else{if(!r(this,Dn)&&!r(this,Ra)){t.classList.remove("done"),(o=r(this,La))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,La);if(!e){v(this,La,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,ns).id}`;const l=100,h=r(this,ns)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(r(this,_s)),v(this,_s,null)},{once:!0}),t.addEventListener("mouseenter",()=>{v(this,_s,setTimeout(()=>{v(this,_s,null),r(this,La).classList.add("show"),r(this,ns)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:h}),t.addEventListener("mouseleave",()=>{var u;r(this,_s)&&(clearTimeout(r(this,_s)),v(this,_s,null)),(u=r(this,La))==null||u.classList.remove("show")},{signal:h})}r(this,Ra)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,Dn)),e.parentNode||t.append(e);const n=r(this,ns).getImageForAltText();n==null||n.setAttribute("aria-describedby",e.id)},E(Gn,Tc,null),lt(Gn,"_l10n",null),Gn);var vv,yu,Av,bv,_v,wv,Ev,wp,No,vu,kc,Ol,KI,QI,kx;const dk=class dk{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:l}){E(this,Ol);E(this,vv);E(this,yu,!1);E(this,Av,null);E(this,bv);E(this,_v);E(this,wv);E(this,Ev);E(this,wp);E(this,No,null);E(this,vu);E(this,kc,null);v(this,vv,t),v(this,Av,n),v(this,bv,e),v(this,_v,i),v(this,wv,s),v(this,Ev,o),v(this,vu,new AbortController),v(this,wp,AbortSignal.any([l,r(this,vu).signal])),t.addEventListener("touchstart",b(this,Ol,KI).bind(this),{passive:!1,signal:r(this,wp)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Yt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=r(this,vu))==null||t.abort(),v(this,vu,null)}};vv=new WeakMap,yu=new WeakMap,Av=new WeakMap,bv=new WeakMap,_v=new WeakMap,wv=new WeakMap,Ev=new WeakMap,wp=new WeakMap,No=new WeakMap,vu=new WeakMap,kc=new WeakMap,Ol=new WeakSet,KI=function(t){var i,s,o;if((i=r(this,bv))!=null&&i.call(this)||t.touches.length<2)return;if(!r(this,kc)){v(this,kc,new AbortController);const l=AbortSignal.any([r(this,wp),r(this,kc).signal]),h=r(this,vv),u={signal:l,passive:!1};h.addEventListener("touchmove",b(this,Ol,QI).bind(this),u),h.addEventListener("touchend",b(this,Ol,kx).bind(this),u),h.addEventListener("touchcancel",b(this,Ol,kx).bind(this),u),(s=r(this,_v))==null||s.call(this)}if(Gs(t),t.touches.length!==2||(o=r(this,Av))!=null&&o.call(this)){v(this,No,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),v(this,No,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},QI=function(t){var L;if(!r(this,No)||t.touches.length!==2)return;let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:i,screenY:s}=e,{screenX:o,screenY:l}=n,h=r(this,No),{touch0X:u,touch0Y:f,touch1X:g,touch1Y:m}=h,A=g-u,_=m-f,S=o-i,C=l-s,T=Math.hypot(S,C)||1,k=Math.hypot(A,_)||1;if(!r(this,yu)&&Math.abs(k-T)<=dk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=s,h.touch1X=o,h.touch1Y=l,t.preventDefault(),!r(this,yu)){v(this,yu,!0);return}const P=[(i+o)/2,(s+l)/2];(L=r(this,wv))==null||L.call(this,P,k,T)},kx=function(t){var e;r(this,kc).abort(),v(this,kc,null),(e=r(this,Ev))==null||e.call(this),r(this,No)&&(t.preventDefault(),v(this,No,null),v(this,yu,!1))};let zw=dk;var Au,Br,Re,Ep,Pc,Sv,bu,Qn,_u,$o,Rc,xv,wu,ws,Cv,Eu,jo,Da,Sp,xp,sr,Su,$t,Tv,Zw,It,Px,kv,Rx,j_,JI,ZI,Lx,H_,Mx,tD,eD,nD,Ix,iD,Dx,sD,rD,aD,Fx,_y;let nn=($t=class{constructor(t){E(this,It);E(this,Au,null);E(this,Br,null);E(this,Re,null);E(this,Ep,!1);E(this,Pc,null);E(this,Sv,"");E(this,bu,!1);E(this,Qn,null);E(this,_u,null);E(this,$o,null);E(this,Rc,null);E(this,xv,"");E(this,wu,!1);E(this,ws,null);E(this,Cv,!1);E(this,Eu,!1);E(this,jo,!1);E(this,Da,null);E(this,Sp,0);E(this,xp,0);E(this,sr,null);E(this,Su,null);lt(this,"_editToolbar",null);lt(this,"_initialOptions",Object.create(null));lt(this,"_initialData",null);lt(this,"_isVisible",!0);lt(this,"_uiManager",null);lt(this,"_focusEventsAllowed",!0);E(this,Tv,!1);E(this,Zw,$t._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[l,h]=this.parentDimensions;this.x=t.x/l,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=$t.prototype._resizeWithKeyboard,e=ev.TRANSLATE_SMALL,n=ev.TRANSLATE_BIG;return Yt(this,"_resizerKeyboardManager",new Ub([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],$t.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Yt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Ej({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if($t._l10n??($t._l10n=t),$t._l10nResizer||($t._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),$t._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);$t._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){we("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Tv)}set _isDraggable(t){var e;v(this,Tv,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,Zw)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):b(this,It,_y).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,wu)?v(this,wu,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/o,this.fixAndSetPosition()}translate(t,e){b(this,It,Px).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,ws)||v(this,ws,[this.x,this.y,this.width,this.height]),b(this,It,Px).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,ws)||v(this,ws,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[h,u]=this.getBaseTranslation();o+=h,l+=u;const{style:f}=n;f.left=`${(100*o).toFixed(2)}%`,f.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!r(this,ws)&&(r(this,ws)[0]!==this.x||r(this,ws)[1]!==this.y)}get _hasBeenResized(){return!!r(this,ws)&&(r(this,ws)[2]!==this.width||r(this,ws)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=$t,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,i]}=this;let{x:s,y:o,width:l,height:h}=this;if(l*=n,h*=i,s*=n,o*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(n-l,s)),o=Math.max(0,Math.min(i-h,o));break;case 90:s=Math.max(0,Math.min(n-h,s)),o=Math.min(i,Math.max(l,o));break;case 180:s=Math.min(n,Math.max(l,s)),o=Math.min(i,Math.max(h,o));break;case 270:s=Math.min(n,Math.max(h,s)),o=Math.max(0,Math.min(i-l,o));break}this.x=s/=n,this.y=o/=i;const[u,f]=this.getBaseTranslation();s+=u,o+=f,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return b(n=$t,kv,Rx).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return b(n=$t,kv,Rx).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/n).toFixed(2)}%`,r(this,bu)||(s.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!r(this,bu)&&e.endsWith("%");if(i&&s)return;const[o,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!r(this,bu)&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=r(this,Re))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,Eu)?this._editToolbar:(this._editToolbar=new yj(this),this.div.append(this._editToolbar.render()),r(this,Re)&&await this._editToolbar.addAltText(r(this,Re)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,Re))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,Re)||(lL.initialize($t._l10n),v(this,Re,new lL(this)),r(this,Au)&&(r(this,Re).data=r(this,Au),v(this,Au,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,Re))==null?void 0:t.data}set altTextData(t){r(this,Re)&&(r(this,Re).data=t)}get guessedAltText(){var t;return(t=r(this,Re))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,Re))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,Re))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,Re)&&!r(this,Re).isEmpty()}hasAltTextData(){var t;return((t=r(this,Re))==null?void 0:t.hasData())??!1}render(){var s;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,Ep)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),b(this,It,Dx).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),Bw(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(r(this,Su)||v(this,Su,new zw({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:b(this,It,tD).bind(this),onPinching:b(this,It,eD).bind(this),onPinchEnd:b(this,It,nD).bind(this),signal:this._uiManager._signal}))),(s=this._uiManager._editorUndoBar)==null||s.hide(),this.div}pointerdown(t){const{isMac:e}=Hi.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(v(this,wu,!0),this._isDraggable){b(this,It,iD).call(this,t);return}b(this,It,Ix).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){r(this,Da)&&clearTimeout(r(this,Da)),v(this,Da,setTimeout(()=>{var t;v(this,Da,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[l,h]=this.pageTranslation,u=t/i,f=e/i,g=this.x*s,m=this.y*o,A=this.width*s,_=this.height*o;switch(n){case 0:return[g+u+l,o-m-f-_+h,g+u+A+l,o-m-f+h];case 90:return[g+f+l,o-m+u+h,g+f+_+l,o-m+u+A+h];case 180:return[g-u-A+l,o-m+f+h,g-u+l,o-m+f+_+h];case 270:return[g-f-_+l,o-m-u-A+h,g-f+l,o-m-u+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,o]=t,l=s-n,h=o-i;switch(this.rotation){case 0:return[n,e-o,l,h];case 90:return[n,e-i,h,l];case 180:return[s,e-i,l,h];case 270:return[s,e-o,h,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){v(this,Eu,!0)}disableEditMode(){v(this,Eu,!1)}isInEditMode(){return r(this,Eu)}shouldGetKeyboardEvents(){return r(this,jo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return e<o&&i>0&&t<s&&n>0}rebuild(){b(this,It,Dx).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){we("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,v(i,Au,t.accessibilityData);const[s,o]=i.pageDimensions,[l,h,u,f]=i.getRectInCurrentCoords(t.rect,o);return i.x=l/s,i.y=h/o,i.width=u/s,i.height=f/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=r(this,Rc))==null||t.abort(),v(this,Rc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,Da)&&(clearTimeout(r(this,Da)),v(this,Da,null)),b(this,It,_y).call(this),this.removeEditToolbar(),r(this,sr)){for(const n of r(this,sr).values())clearTimeout(n);v(this,sr,null)}this.parent=null,(e=r(this,Su))==null||e.destroy(),v(this,Su,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(b(this,It,JI).call(this),r(this,Qn).classList.remove("hidden"),Bw(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),v(this,$o,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,Qn).children;if(!r(this,Br)){v(this,Br,Array.from(e));const o=b(this,It,sD).bind(this),l=b(this,It,rD).bind(this),h=this._uiManager._signal;for(const u of r(this,Br)){const f=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:h}),u.addEventListener("blur",l,{signal:h}),u.addEventListener("focus",b(this,It,aD).bind(this,f),{signal:h}),u.setAttribute("data-l10n-id",$t._l10nResizer[f])}}const n=r(this,Br)[0];let i=0;for(const o of e){if(o===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(r(this,Br).length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)r(this,Qn).append(r(this,Qn).firstChild);else if(s>i)for(let l=0;l<s-i;l++)r(this,Qn).firstChild.before(r(this,Qn).lastChild);let o=0;for(const l of e){const u=r(this,Br)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",$t._l10nResizer[u])}}b(this,It,Fx).call(this,0),v(this,jo,!0),r(this,Qn).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,jo)&&b(this,It,Mx).call(this,r(this,xv),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){b(this,It,_y).call(this),this.div.focus()}select(){var t,e,n;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(n=r(this,Re))==null||n.toggleAltTextBadge(!1)}unselect(){var t,e,n,i,s;(t=r(this,Qn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=r(this,Re))==null||s.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,Cv)}set isEditing(t){v(this,Cv,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){v(this,bu,!0);const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,sr)||v(this,sr,new Map);const{action:n}=t;let i=r(this,sr).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),r(this,sr).delete(n),r(this,sr).size===0&&v(this,sr,null)},$t._telemetryTimeout),r(this,sr).set(n,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),v(this,Ep,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,Ep,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}},Au=new WeakMap,Br=new WeakMap,Re=new WeakMap,Ep=new WeakMap,Pc=new WeakMap,Sv=new WeakMap,bu=new WeakMap,Qn=new WeakMap,_u=new WeakMap,$o=new WeakMap,Rc=new WeakMap,xv=new WeakMap,wu=new WeakMap,ws=new WeakMap,Cv=new WeakMap,Eu=new WeakMap,jo=new WeakMap,Da=new WeakMap,Sp=new WeakMap,xp=new WeakMap,sr=new WeakMap,Su=new WeakMap,Tv=new WeakMap,Zw=new WeakMap,It=new WeakSet,Px=function([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},kv=new WeakSet,Rx=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},j_=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},JI=function(){if(r(this,Qn))return;v(this,Qn,document.createElement("div")),r(this,Qn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");r(this,Qn).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",b(this,It,ZI).bind(this,n),{signal:e}),i.addEventListener("contextmenu",ua,{signal:e}),i.tabIndex=-1}this.div.prepend(r(this,Qn))},ZI=function(t,e){var f;e.preventDefault();const{isMac:n}=Hi.platform;if(e.button!==0||e.ctrlKey&&n)return;(f=r(this,Re))==null||f.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,v(this,_u,[e.screenX,e.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",b(this,It,Mx).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Gs,{passive:!1,signal:o}),window.addEventListener("contextmenu",ua,{signal:o}),v(this,$o,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{var g;s.abort(),this.parent.togglePointerEvents(!0),(g=r(this,Re))==null||g.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=h,b(this,It,H_).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},Lx=function(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[s,o]=this.parentDimensions;this.setDims(s*n,o*i),this.fixAndSetPosition(),this._onResized()},H_=function(){if(!r(this,$o))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=r(this,$o);v(this,$o,null);const s=this.x,o=this.y,l=this.width,h=this.height;s===t&&o===e&&l===n&&h===i||this.addCommands({cmd:b(this,It,Lx).bind(this,s,o,l,h),undo:b(this,It,Lx).bind(this,t,e,n,i),mustExec:!0})},Mx=function(t,e){const[n,i]=this.parentDimensions,s=this.x,o=this.y,l=this.width,h=this.height,u=$t.MIN_SIZE/n,f=$t.MIN_SIZE/i,g=b(this,It,j_).call(this,this.rotation),m=(J,G)=>[g[0]*J+g[2]*G,g[1]*J+g[3]*G],A=b(this,It,j_).call(this,360-this.rotation),_=(J,G)=>[A[0]*J+A[2]*G,A[1]*J+A[3]*G];let S,C,T=!1,k=!1;switch(t){case"topLeft":T=!0,S=(J,G)=>[0,0],C=(J,G)=>[J,G];break;case"topMiddle":S=(J,G)=>[J/2,0],C=(J,G)=>[J/2,G];break;case"topRight":T=!0,S=(J,G)=>[J,0],C=(J,G)=>[0,G];break;case"middleRight":k=!0,S=(J,G)=>[J,G/2],C=(J,G)=>[0,G/2];break;case"bottomRight":T=!0,S=(J,G)=>[J,G],C=(J,G)=>[0,0];break;case"bottomMiddle":S=(J,G)=>[J/2,G],C=(J,G)=>[J/2,0];break;case"bottomLeft":T=!0,S=(J,G)=>[0,G],C=(J,G)=>[J,0];break;case"middleLeft":k=!0,S=(J,G)=>[0,G/2],C=(J,G)=>[J,G/2];break}const P=S(l,h),L=C(l,h);let I=m(...L);const D=$t._round(s+I[0]),F=$t._round(o+I[1]);let H=1,j=1,Q,W;if(e.fromKeyboard)({deltaX:Q,deltaY:W}=e);else{const{screenX:J,screenY:G}=e,[q,U]=r(this,_u);[Q,W]=this.screenToPageTranslation(J-q,G-U),r(this,_u)[0]=J,r(this,_u)[1]=G}if([Q,W]=_(Q/n,W/i),T){const J=Math.hypot(l,h);H=j=Math.max(Math.min(Math.hypot(L[0]-P[0]-Q,L[1]-P[1]-W)/J,1/l,1/h),u/l,f/h)}else k?H=Math.max(u,Math.min(1,Math.abs(L[0]-P[0]-Q)))/l:j=Math.max(f,Math.min(1,Math.abs(L[1]-P[1]-W)))/h;const tt=$t._round(l*H),Z=$t._round(h*j);I=m(...C(tt,Z));const et=D-I[0],ht=F-I[1];r(this,ws)||v(this,ws,[this.x,this.y,this.width,this.height]),this.width=tt,this.height=Z,this.x=et,this.y=ht,this.setDims(n*tt,i*Z),this.fixAndSetPosition(),this._onResizing()},tD=function(){var t;v(this,$o,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=r(this,Re))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},eD=function(t,e,n){let s=.7*(n/e)+1-.7;if(s===1)return;const o=b(this,It,j_).call(this,this.rotation),l=(D,F)=>[o[0]*D+o[2]*F,o[1]*D+o[3]*F],[h,u]=this.parentDimensions,f=this.x,g=this.y,m=this.width,A=this.height,_=$t.MIN_SIZE/h,S=$t.MIN_SIZE/u;s=Math.max(Math.min(s,1/m,1/A),_/m,S/A);const C=$t._round(m*s),T=$t._round(A*s);if(C===m&&T===A)return;r(this,ws)||v(this,ws,[f,g,m,A]);const k=l(m/2,A/2),P=$t._round(f+k[0]),L=$t._round(g+k[1]),I=l(C/2,T/2);this.x=P-I[0],this.y=L-I[1],this.width=C,this.height=T,this.setDims(h*C,u*T),this.fixAndSetPosition(),this._onResizing()},nD=function(){var t;(t=r(this,Re))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),b(this,It,H_).call(this)},Ix=function(t){const{isMac:e}=Hi.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},iD=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},l=u=>{i.abort(),v(this,Pc,null),v(this,wu,!1),this._uiManager.endDragSession()||b(this,It,Ix).call(this,u),n&&this._onStopDragging()};e&&(v(this,Sp,t.clientX),v(this,xp,t.clientY),v(this,Pc,t.pointerId),v(this,Sv,t.pointerType),window.addEventListener("pointermove",u=>{n||(n=!0,this._onStartDragging());const{clientX:f,clientY:g,pointerId:m}=u;if(m!==r(this,Pc)){Gs(u);return}const[A,_]=this.screenToPageTranslation(f-r(this,Sp),g-r(this,xp));v(this,Sp,f),v(this,xp,g),this._uiManager.dragSelectedEditors(A,_)},o),window.addEventListener("touchmove",Gs,o),window.addEventListener("pointerdown",u=>{u.pointerType===r(this,Sv)&&(r(this,Su)||u.isPrimary)&&l(u),Gs(u)},o));const h=u=>{if(!r(this,Pc)||r(this,Pc)===u.pointerId){l(u);return}Gs(u)};window.addEventListener("pointerup",h,{signal:s}),window.addEventListener("blur",h,{signal:s})},Dx=function(){if(r(this,Rc)||!this.div)return;v(this,Rc,new AbortController);const t=this._uiManager.combinedSignal(r(this,Rc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},sD=function(t){$t._resizerKeyboardManager.exec(this,t)},rD=function(t){var e;r(this,jo)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,Qn)&&b(this,It,_y).call(this)},aD=function(t){v(this,xv,r(this,jo)?t:"")},Fx=function(t){if(r(this,Br))for(const e of r(this,Br))e.tabIndex=t},_y=function(){v(this,jo,!1),b(this,It,Fx).call(this,-1),b(this,It,H_).call(this)},E($t,kv),lt($t,"_l10n",null),lt($t,"_l10nResizer",null),lt($t,"_borderLineWidth",-1),lt($t,"_colorManager",new wj),lt($t,"_zIndex",1),lt($t,"_telemetryTimeout",1e3),$t),Ej=class extends nn{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}};const cL=3285377520,tr=4294901760,wa=65535;let oD=class{constructor(t){this.h1=t?t&4294967295:cL,this.h2=t?t&4294967295:cL}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,C=t.length;S<C;S++){const T=t.charCodeAt(S);T<=255?e[n++]=T:(e[n++]=T>>>8,e[n++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,o=new Uint32Array(e.buffer,0,i);let l=0,h=0,u=this.h1,f=this.h2;const g=3432918353,m=461845907,A=g&wa,_=m&wa;for(let S=0;S<i;S++)S&1?(l=o[S],l=l*g&tr|l*A&wa,l=l<<15|l>>>17,l=l*m&tr|l*_&wa,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(h=o[S],h=h*g&tr|h*A&wa,h=h<<15|h>>>17,h=h*m&tr|h*_&wa,f^=h,f=f<<13|f>>>19,f=f*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*g&tr|l*A&wa,l=l<<15|l>>>17,l=l*m&tr|l*_&wa,i&1?u^=l:f^=l}this.h1=u,this.h2=f}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&tr|t*36045&wa,e=e*4283543511&tr|((e<<16|t>>>16)*2950163797&tr)>>>16,t^=e>>>1,t=t*444984403&tr|t*60499&wa,e=e*3301882366&tr|((e<<16|t>>>16)*3120437893&tr)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}};const Ox=Object.freeze({map:null,hash:"",transfer:void 0});var xu,Cu,Fn,tE,lD,JM;let VT=(JM=class{constructor(){E(this,tE);E(this,xu,!1);E(this,Cu,null);E(this,Fn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=r(this,Fn).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return r(this,Fn).get(t)}remove(t){if(r(this,Fn).delete(t),r(this,Fn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,Fn).values())if(e instanceof nn)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=r(this,Fn).get(t);let i=!1;if(n!==void 0)for(const[s,o]of Object.entries(e))n[s]!==o&&(i=!0,n[s]=o);else i=!0,r(this,Fn).set(t,e);i&&b(this,tE,lD).call(this),e instanceof nn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Fn).has(t)}getAll(){return r(this,Fn).size>0?HT(r(this,Fn)):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return r(this,Fn).size}resetModified(){r(this,xu)&&(v(this,xu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new cD(this)}get serializable(){if(r(this,Fn).size===0)return Ox;const t=new Map,e=new oD,n=[],i=Object.create(null);let s=!1;for(const[o,l]of r(this,Fn)){const h=l instanceof nn?l.serialize(!1,i):l;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const o of t.values())o.bitmap&&n.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Ox}get editorStats(){let t=null;const e=new Map;for(const n of r(this,Fn).values()){if(!(n instanceof nn))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const o=t[s]||(t[s]=new Map);for(const[l,h]of Object.entries(i)){if(l==="type")continue;let u=o.get(l);u||(u=new Map,o.set(l,u));const f=u.get(h)??0;u.set(h,f+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){v(this,Cu,null)}get modifiedIds(){if(r(this,Cu))return r(this,Cu);const t=[];for(const e of r(this,Fn).values())!(e instanceof nn)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return v(this,Cu,{ids:new Set(t),hash:t.join(",")})}},xu=new WeakMap,Cu=new WeakMap,Fn=new WeakMap,tE=new WeakSet,lD=function(){r(this,xu)||(v(this,xu,!0),typeof this.onSetModified=="function"&&this.onSetModified())},JM);var Pv,ZM;let cD=(ZM=class extends VT{constructor(e){super();E(this,Pv);const{map:n,hash:i,transfer:s}=e.serializable,o=structuredClone(n,s?{transfer:s}:null);v(this,Pv,{map:o,hash:i,transfer:s})}get print(){we("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,Pv)}get modifiedIds(){return Yt(this,"modifiedIds",{ids:new Set,hash:""})}},Pv=new WeakMap,ZM);var Cp,tI;let Sj=(tI=class{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){E(this,Cp,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,Cp).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,Cp).has(t.loadedName))){if(un(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=t,o=new FontFace(n,i,s);this.addNativeFontFace(o);try{await o.load(),r(this,Cp).add(n),e==null||e(t)}catch{Ut(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}we("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Ut(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Yt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ti||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Yt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(un(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Yt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(L,I){return L.charCodeAt(I)<<24|L.charCodeAt(I+1)<<16|L.charCodeAt(I+2)<<8|L.charCodeAt(I+3)&255}function i(L,I,D,F){const H=L.substring(0,I),j=L.substring(I+D);return H+F+j}let s,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let u=0;function f(L,I){if(++u>30){Ut("Load test font never loaded."),I();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(f.bind(null,L,I))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,g.length,g);const _=16,S=1482184792;let C=n(m,_);for(s=0,o=g.length-3;s<o;s+=4)C=C-S+n(g,s)|0;s<g.length&&(C=C-S+n(g+"XXX",s)|0),m=i(m,_,4,aj(C));const T=`url(data:font/opentype;base64,${btoa(m)});`,k=`@font-face {font-family:"${g}";src:${T}}`;this.insertRule(k);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[t.loadedName,g]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=L,P.append(I)}this._document.body.append(P),f(g,()=>{P.remove(),e.complete()})}},Cp=new WeakMap,tI),xj=class{constructor(t,{disableFontFace:e=!1,fontExtraProperties:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this.fontExtraProperties=n===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${dj(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(o){Ut(`getPathGenerator - ignoring character: "${o}".`)}const s=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=s}};const o_={DATA:1,ERROR:2},ln={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function hL(){}function ts(p){if(p instanceof Sh||p instanceof vx||p instanceof tv||p instanceof rL||p instanceof Hw||p instanceof I1)return p;switch(p instanceof Error||typeof p=="object"&&p!==null||we('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new Sh(p.message);case"InvalidPDFException":return new vx(p.message);case"MissingPDFException":return new tv(p.message);case"PasswordException":return new rL(p.message,p.code);case"UnexpectedResponseException":return new Hw(p.message,p.status);case"UnknownErrorException":return new I1(p.message,p.details)}return new I1(p.message,p.toString())}var Tp,br,hD,uD,dD,B_,eI;let wy=(eI=class{constructor(t,e,n){E(this,br);E(this,Tp,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",b(this,br,hD).bind(this),{signal:r(this,Tp).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:u=>{const f=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:l,action:t,streamId:s,data:e,desiredSize:u.desiredSize},i),f.promise},pull:u=>{const f=Promise.withResolvers();return this.streamControllers[s].pullCall=f,h.postMessage({sourceName:o,targetName:l,stream:ln.PULL,streamId:s,desiredSize:u.desiredSize}),f.promise},cancel:u=>{un(u instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[s].cancelCall=f,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:o,targetName:l,stream:ln.CANCEL,streamId:s,reason:ts(u)}),f.promise}},n)}destroy(){var t;(t=r(this,Tp))==null||t.abort(),v(this,Tp,null)}},Tp=new WeakMap,br=new WeakSet,hD=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){b(this,br,dD).call(this,t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===o_.DATA)i.resolve(t.data);else if(t.callback===o_.ERROR)i.reject(ts(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(o){s.postMessage({sourceName:n,targetName:i,callback:o_.DATA,callbackId:t.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:i,callback:o_.ERROR,callbackId:t.callbackId,reason:ts(o)})});return}if(t.streamId){b(this,br,uD).call(this,t);return}e(t.data)},uD=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this,l=this.actionHandler[t.action],h={enqueue(u,f=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=f,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:ln.ENQUEUE,streamId:e,chunk:u},g)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:ln.CLOSE,streamId:e}),delete o.streamSinks[e])},error(u){un(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:ln.ERROR,streamId:e,reason:ts(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(l,t.data,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:ln.START_COMPLETE,streamId:e,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:ln.START_COMPLETE,streamId:e,reason:ts(u)})})},dD=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case ln.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(ts(t.reason));break;case ln.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(ts(t.reason));break;case ln.PULL:if(!l){s.postMessage({sourceName:n,targetName:i,stream:ln.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||hL).then(function(){s.postMessage({sourceName:n,targetName:i,stream:ln.PULL_COMPLETE,streamId:e,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:ln.PULL_COMPLETE,streamId:e,reason:ts(u)})});break;case ln.ENQUEUE:if(un(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case ln.CLOSE:if(un(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),b(this,br,B_).call(this,o,e);break;case ln.ERROR:un(o,"error should have stream controller"),o.controller.error(ts(t.reason)),b(this,br,B_).call(this,o,e);break;case ln.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(ts(t.reason)),b(this,br,B_).call(this,o,e);break;case ln.CANCEL:if(!l)break;const h=ts(t.reason);Promise.try(l.onCancel||hL,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:ln.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:ln.CANCEL_COMPLETE,streamId:e,reason:ts(u)})}),l.sinkCapability.reject(h),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},B_=async function(t,e){var n,i,s;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(i=t.pullCall)==null?void 0:i.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]},eI);var Rv,nI;let fD=(nI=class{constructor({enableHWA:t=!1}){E(this,Rv,!1);v(this,Rv,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!r(this,Rv)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){we("Abstract method `_createCanvas` called.")}},Rv=new WeakMap,nI),Cj=class extends fD{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}},pD=class{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){we("Abstract method `_fetch` called.")}},gD=class extends pD{async _fetch(t){const e=await ME(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):LE(e)}},mD=class{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(t=!1){}};var Tu,kp,Ho,Bo,Ai,ku,Pu,At,gi,Ey,qf,z_,Xf,yD,Nx,Yf,Sy,xy,$x,Cy,iI;let Tj=(iI=class extends mD{constructor({docId:e,ownerDocument:n=globalThis.document}){super();E(this,At);E(this,Tu);E(this,kp);E(this,Ho);E(this,Bo);E(this,Ai);E(this,ku);E(this,Pu,0);v(this,Bo,e),v(this,Ai,n)}addFilter(e){if(!e)return"none";let n=r(this,At,gi).get(e);if(n)return n;const[i,s,o]=b(this,At,z_).call(this,e),l=e.length===1?i:`${i}${s}${o}`;if(n=r(this,At,gi).get(l),n)return r(this,At,gi).set(e,n),n;const h=`g_${r(this,Bo)}_transfer_map_${le(this,Pu)._++}`,u=b(this,At,Xf).call(this,h);r(this,At,gi).set(e,u),r(this,At,gi).set(l,u);const f=b(this,At,Yf).call(this,h);return b(this,At,xy).call(this,i,s,o,f),u}addHCMFilter(e,n){var _;const i=`${e}-${n}`,s="base";let o=r(this,At,Ey).get(s);if((o==null?void 0:o.key)===i||(o?((_=o.filter)==null||_.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},r(this,At,Ey).set(s,o)),!e||!n))return o.url;const l=b(this,At,Cy).call(this,e);e=Pt.makeHexColor(...l);const h=b(this,At,Cy).call(this,n);if(n=Pt.makeHexColor(...h),r(this,At,qf).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return o.url;const u=new Array(256);for(let S=0;S<=255;S++){const C=S/255;u[S]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const f=u.join(","),g=`g_${r(this,Bo)}_hcm_filter`,m=o.filter=b(this,At,Yf).call(this,g);b(this,At,xy).call(this,f,f,f,m),b(this,At,Nx).call(this,m);const A=(S,C)=>{const T=l[S]/255,k=h[S]/255,P=new Array(C+1);for(let L=0;L<=C;L++)P[L]=T+L/C*(k-T);return P.join(",")};return b(this,At,xy).call(this,A(0,5),A(1,5),A(2,5),m),o.url=b(this,At,Xf).call(this,g),o.url}addAlphaFilter(e){let n=r(this,At,gi).get(e);if(n)return n;const[i]=b(this,At,z_).call(this,[e]),s=`alpha_${i}`;if(n=r(this,At,gi).get(s),n)return r(this,At,gi).set(e,n),n;const o=`g_${r(this,Bo)}_alpha_map_${le(this,Pu)._++}`,l=b(this,At,Xf).call(this,o);r(this,At,gi).set(e,l),r(this,At,gi).set(s,l);const h=b(this,At,Yf).call(this,o);return b(this,At,$x).call(this,i,h),l}addLuminosityFilter(e){let n=r(this,At,gi).get(e||"luminosity");if(n)return n;let i,s;if(e?([i]=b(this,At,z_).call(this,[e]),s=`luminosity_${i}`):s="luminosity",n=r(this,At,gi).get(s),n)return r(this,At,gi).set(e,n),n;const o=`g_${r(this,Bo)}_luminosity_map_${le(this,Pu)._++}`,l=b(this,At,Xf).call(this,o);r(this,At,gi).set(e,l),r(this,At,gi).set(s,l);const h=b(this,At,Yf).call(this,o);return b(this,At,yD).call(this,h),e&&b(this,At,$x).call(this,i,h),l}addHighlightHCMFilter(e,n,i,s,o){var k;const l=`${n}-${i}-${s}-${o}`;let h=r(this,At,Ey).get(e);if((h==null?void 0:h.key)===l||(h?((k=h.filter)==null||k.remove(),h.key=l,h.url="none",h.filter=null):(h={key:l,url:"none",filter:null},r(this,At,Ey).set(e,h)),!n||!i))return h.url;const[u,f]=[n,i].map(b(this,At,Cy).bind(this));let g=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[A,_]=[s,o].map(b(this,At,Cy).bind(this));m<g&&([g,m,A,_]=[m,g,_,A]),r(this,At,qf).style.color="";const S=(P,L,I)=>{const D=new Array(256),F=(m-g)/I,H=P/255,j=(L-P)/(255*I);let Q=0;for(let W=0;W<=I;W++){const tt=Math.round(g+W*F),Z=H+W*j;for(let et=Q;et<=tt;et++)D[et]=Z;Q=tt+1}for(let W=Q;W<256;W++)D[W]=D[Q-1];return D.join(",")},C=`g_${r(this,Bo)}_hcm_${e}_filter`,T=h.filter=b(this,At,Yf).call(this,C);return b(this,At,Nx).call(this,T),b(this,At,xy).call(this,S(A[0],_[0],5),S(A[1],_[1],5),S(A[2],_[2],5),T),h.url=b(this,At,Xf).call(this,C),h.url}destroy(e=!1){var n,i,s,o;e&&((n=r(this,ku))!=null&&n.size)||((i=r(this,Ho))==null||i.parentNode.parentNode.remove(),v(this,Ho,null),(s=r(this,kp))==null||s.clear(),v(this,kp,null),(o=r(this,ku))==null||o.clear(),v(this,ku,null),v(this,Pu,0))}},Tu=new WeakMap,kp=new WeakMap,Ho=new WeakMap,Bo=new WeakMap,Ai=new WeakMap,ku=new WeakMap,Pu=new WeakMap,At=new WeakSet,gi=function(){return r(this,kp)||v(this,kp,new Map)},Ey=function(){return r(this,ku)||v(this,ku,new Map)},qf=function(){if(!r(this,Ho)){const e=r(this,Ai).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=r(this,Ai).createElementNS(To,"svg");i.setAttribute("width",0),i.setAttribute("height",0),v(this,Ho,r(this,Ai).createElementNS(To,"defs")),e.append(i),i.append(r(this,Ho)),r(this,Ai).body.append(e)}return r(this,Ho)},z_=function(e){if(e.length===1){const u=e[0],f=new Array(256);for(let m=0;m<256;m++)f[m]=u[m]/255;const g=f.join(",");return[g,g,g]}const[n,i,s]=e,o=new Array(256),l=new Array(256),h=new Array(256);for(let u=0;u<256;u++)o[u]=n[u]/255,l[u]=i[u]/255,h[u]=s[u]/255;return[o.join(","),l.join(","),h.join(",")]},Xf=function(e){if(r(this,Tu)===void 0){v(this,Tu,"");const n=r(this,Ai).URL;n!==r(this,Ai).baseURI&&(IE(n)?Ut('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,Tu,n.split("#",1)[0]))}return`url(${r(this,Tu)}#${e})`},yD=function(e){const n=r(this,Ai).createElementNS(To,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},Nx=function(e){const n=r(this,Ai).createElementNS(To,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},Yf=function(e){const n=r(this,Ai).createElementNS(To,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),r(this,At,qf).append(n),n},Sy=function(e,n,i){const s=r(this,Ai).createElementNS(To,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)},xy=function(e,n,i,s){const o=r(this,Ai).createElementNS(To,"feComponentTransfer");s.append(o),b(this,At,Sy).call(this,o,"feFuncR",e),b(this,At,Sy).call(this,o,"feFuncG",n),b(this,At,Sy).call(this,o,"feFuncB",i)},$x=function(e,n){const i=r(this,Ai).createElementNS(To,"feComponentTransfer");n.append(i),b(this,At,Sy).call(this,i,"feFuncA",e)},Cy=function(e){return r(this,At,qf).style.color=e,WT(getComputedStyle(r(this,At,qf)).getPropertyValue("color"))},iI),vD=class{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){we("Abstract method `_fetch` called.")}},AD=class extends vD{async _fetch(t){const e=await ME(t,"arraybuffer");return new Uint8Array(e)}};Ti&&Ut("Please use the `legacy` build in Node.js environments.");async function bD(p){const e=await process.getBuiltinModule("fs").promises.readFile(p);return new Uint8Array(e)}let kj=class extends mD{},Pj=class extends fD{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}},Rj=class extends pD{async _fetch(t){return bD(t)}},Lj=class extends vD{async _fetch(t){return bD(t)}};const Ci={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function jx(p,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),p.clip(i)}let qT=class{getPattern(){we("Abstract method `getPattern` called.")}},Mj=class extends qT{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let s;if(i===Ci.STROKE||i===Ci.FILL){const o=e.current.getClippedPathBoundingBox(i,Fe(t))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,u=e.cachedCanvases.getCanvas("pattern",l,h),f=u.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),n=Pt.transform(n,[1,0,0,1,o[0],o[1]]),f.transform(...e.baseTransform),this.matrix&&f.transform(...this.matrix),jx(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),s=t.createPattern(u.canvas,"no-repeat");const g=new DOMMatrix(n);s.setTransform(g)}else jx(t,this._bbox),s=this._createGradient(t);return s}};function O1(p,t,e,n,i,s,o,l){const h=t.coords,u=t.colors,f=p.data,g=p.width*4;let m;h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m),h[n+1]>h[i+1]&&(m=n,n=i,i=m,m=o,o=l,l=m),h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m);const A=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,C=(h[n+1]+t.offsetY)*t.scaleY,T=(h[i]+t.offsetX)*t.scaleX,k=(h[i+1]+t.offsetY)*t.scaleY;if(_>=k)return;const P=u[s],L=u[s+1],I=u[s+2],D=u[o],F=u[o+1],H=u[o+2],j=u[l],Q=u[l+1],W=u[l+2],tt=Math.round(_),Z=Math.round(k);let et,ht,J,G,q,U,N,M;for(let B=tt;B<=Z;B++){if(B<C){const nt=B<_?0:(_-B)/(_-C);et=A-(A-S)*nt,ht=P-(P-D)*nt,J=L-(L-F)*nt,G=I-(I-H)*nt}else{let nt;B>k?nt=1:C===k?nt=0:nt=(C-B)/(C-k),et=S-(S-T)*nt,ht=D-(D-j)*nt,J=F-(F-Q)*nt,G=H-(H-W)*nt}let Y;B<_?Y=0:B>k?Y=1:Y=(_-B)/(_-k),q=A-(A-T)*Y,U=P-(P-j)*Y,N=L-(L-Q)*Y,M=I-(I-W)*Y;const it=Math.round(Math.min(et,q)),dt=Math.round(Math.max(et,q));let at=g*B+it*4;for(let nt=it;nt<=dt;nt++)Y=(et-nt)/(et-q),Y<0?Y=0:Y>1&&(Y=1),f[at++]=ht-(ht-U)*Y|0,f[at++]=J-(J-N)*Y|0,f[at++]=G-(G-M)*Y|0,f[at++]=255}}function Ij(p,t,e){const n=t.coords,i=t.colors;let s,o;switch(t.type){case"lattice":const l=t.verticesPerRow,h=Math.floor(n.length/l)-1,u=l-1;for(s=0;s<h;s++){let f=s*l;for(let g=0;g<u;g++,f++)O1(p,e,n[f],n[f+1],n[f+l],i[f],i[f+1],i[f+l]),O1(p,e,n[f+l+1],n[f+1],n[f+l],i[f+l+1],i[f+1],i[f+l])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)O1(p,e,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}let Dj=class extends qT{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,f=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(f*t[1]*1.1)),3e3),A=u/g,_=f/m,S={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/A,scaleY:1/_},C=g+2*2,T=m+2*2,k=n.getCanvas("mesh",C,T),P=k.context,L=P.createImageData(g,m);if(e){const D=L.data;for(let F=0,H=D.length;F<H;F+=4)D[F]=e[0],D[F+1]=e[1],D[F+2]=e[2],D[F+3]=255}for(const D of this._figures)Ij(L,D,S);return P.putImageData(L,2,2),{canvas:k.canvas,offsetX:l-2*A,offsetY:h-2*_,scaleX:A,scaleY:_}}getPattern(t,e,n,i){jx(t,this._bbox);let s;if(i===Ci.SHADING)s=Pt.singularValueDecompose2dScale(Fe(t));else if(s=Pt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const l=Pt.singularValueDecompose2dScale(this.matrix);s=[s[0]*l[0],s[1]*l[1]]}const o=this._createMeshCanvas(s,i===Ci.SHADING?null:this._background,e.cachedCanvases);return i!==Ci.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}},Fj=class extends qT{getPattern(){return"hotpink"}};function Oj(p){switch(p[0]){case"RadialAxial":return new Mj(p);case"Mesh":return new Dj(p);case"Dummy":return new Fj}throw new Error(`Unknown IR type: ${p[0]}`)}const uL={COLORED:1,UNCOLORED:2};var Ru;let Nj=(Ru=class{constructor(t,e,n,i,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:o,canvasGraphicsFactory:l}=this;let{xstep:h,ystep:u}=this;h=Math.abs(h),u=Math.abs(u),RE("TilingType: "+s);const f=e[0],g=e[1],m=e[2],A=e[3],_=m-f,S=A-g,C=Pt.singularValueDecompose2dScale(this.matrix),T=Pt.singularValueDecompose2dScale(this.baseTransform),k=C[0]*T[0],P=C[1]*T[1];let L=_,I=S,D=!1,F=!1;const H=Math.ceil(h*k),j=Math.ceil(u*P),Q=Math.ceil(_*k),W=Math.ceil(S*P);H>=Q?L=h:D=!0,j>=W?I=u:F=!0;const tt=this.getSizeAndScale(L,this.ctx.canvas.width,k),Z=this.getSizeAndScale(I,this.ctx.canvas.height,P),et=t.cachedCanvases.getCanvas("pattern",tt.size,Z.size),ht=et.context,J=l.createCanvasGraphics(ht);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,i,o),ht.translate(-tt.scale*f,-Z.scale*g),J.transform(tt.scale,0,0,Z.scale,0,0),ht.save(),this.clipBbox(J,f,g,m,A),J.baseTransform=Fe(J.ctx),J.executeOperatorList(n),J.endDrawing(),ht.restore(),D||F){const G=et.canvas;D&&(L=h),F&&(I=u);const q=this.getSizeAndScale(L,this.ctx.canvas.width,k),U=this.getSizeAndScale(I,this.ctx.canvas.height,P),N=q.size,M=U.size,B=t.cachedCanvases.getCanvas("pattern-workaround",N,M),Y=B.context,it=D?Math.floor(_/h):0,dt=F?Math.floor(S/u):0;for(let at=0;at<=it;at++)for(let nt=0;nt<=dt;nt++)Y.drawImage(G,N*at,M*nt,N,M,0,0,N,M);return{canvas:B.canvas,scaleX:q.scale,scaleY:U.scale,offsetX:f,offsetY:g}}return{canvas:et.canvas,scaleX:tt.scale,scaleY:Z.scale,offsetX:f,offsetY:g}}getSizeAndScale(t,e,n){const i=Math.max(Ru.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const o=i-e,l=s-n;t.ctx.rect(e,n,o,l),t.current.updateRectMinMax(Fe(t.ctx),[e,n,i,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case uL.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,s.fillColor=o.fillStyle,s.strokeColor=o.strokeStyle;break;case uL.UNCOLORED:const l=Pt.makeHexColor(n[0],n[1],n[2]);i.fillStyle=l,i.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new rj(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let s=n;i!==Ci.SHADING&&(s=Pt.transform(s,e.baseTransform),this.matrix&&(s=Pt.transform(s,this.matrix)));const o=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const h=t.createPattern(o.canvas,"repeat");return h.setTransform(l),h}},lt(Ru,"MAX_PATTERN_SIZE",3e3),Ru);function $j({src:p,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=Hi.isLittleEndian?4278190080:255,[h,u]=o?[s,l]:[l,s],f=n>>3,g=n&7,m=p.length;e=new Uint32Array(e.buffer);let A=0;for(let _=0;_<i;_++){for(const C=t+f;t<C;t++){const T=t<m?p[t]:255;e[A++]=T&128?u:h,e[A++]=T&64?u:h,e[A++]=T&32?u:h,e[A++]=T&16?u:h,e[A++]=T&8?u:h,e[A++]=T&4?u:h,e[A++]=T&2?u:h,e[A++]=T&1?u:h}if(g===0)continue;const S=t<m?p[t++]:255;for(let C=0;C<g;C++)e[A++]=S&1<<7-C?u:h}return{srcPos:t,destPos:A}}const dL=16,fL=100,jj=15,pL=10,gL=1e3,ls=16;function Hj(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(n,i){t.translate(n,i),this.__originalTranslate(n,i)},p.scale=function(n,i){t.scale(n,i),this.__originalScale(n,i)},p.transform=function(n,i,s,o,l,h){t.transform(n,i,s,o,l,h),this.__originalTransform(n,i,s,o,l,h)},p.setTransform=function(n,i,s,o,l,h){t.setTransform(n,i,s,o,l,h),this.__originalSetTransform(n,i,s,o,l,h)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(n){t.rotate(n),this.__originalRotate(n)},p.clip=function(n){t.clip(n),this.__originalClip(n)},p.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},p.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},p.bezierCurveTo=function(e,n,i,s,o,l){t.bezierCurveTo(e,n,i,s,o,l),this.__originalBezierCurveTo(e,n,i,s,o,l)},p.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}let Bj=class{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}};function l_(p,t,e,n,i,s,o,l,h,u){const[f,g,m,A,_,S]=Fe(p);if(g===0&&m===0){const k=o*f+_,P=Math.round(k),L=l*A+S,I=Math.round(L),D=(o+h)*f+_,F=Math.abs(Math.round(D)-P)||1,H=(l+u)*A+S,j=Math.abs(Math.round(H)-I)||1;return p.setTransform(Math.sign(f),0,0,Math.sign(A),P,I),p.drawImage(t,e,n,i,s,0,0,F,j),p.setTransform(f,g,m,A,_,S),[F,j]}if(f===0&&A===0){const k=l*m+_,P=Math.round(k),L=o*g+S,I=Math.round(L),D=(l+u)*m+_,F=Math.abs(Math.round(D)-P)||1,H=(o+h)*g+S,j=Math.abs(Math.round(H)-I)||1;return p.setTransform(0,Math.sign(g),Math.sign(m),0,P,I),p.drawImage(t,e,n,i,s,0,0,j,F),p.setTransform(f,g,m,A,_,S),[j,F]}p.drawImage(t,e,n,i,s,o,l,h,u);const C=Math.hypot(f,g),T=Math.hypot(m,A);return[C*h,T*u]}function zj(p){const{width:t,height:e}=p;if(t>gL||e>gL)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let o=new Uint8Array(s*(e+1)),l,h,u;const f=t+7&-8;let g=new Uint8Array(f*e),m=0;for(const T of p.data){let k=128;for(;k>0;)g[m++]=T&k?0:255,k>>=1}let A=0;for(m=0,g[m]!==0&&(o[0]=1,++A),h=1;h<t;h++)g[m]!==g[m+1]&&(o[h]=g[m]?2:1,++A),m++;for(g[m]!==0&&(o[h]=2,++A),l=1;l<e;l++){m=l*f,u=l*s,g[m-f]!==g[m]&&(o[u]=g[m]?1:8,++A);let T=(g[m]?4:0)+(g[m-f]?8:0);for(h=1;h<t;h++)T=(T>>2)+(g[m+1]?4:0)+(g[m-f+1]?8:0),i[T]&&(o[u+h]=i[T],++A),m++;if(g[m-f]!==g[m]&&(o[u+h]=g[m]?2:4,++A),A>n)return null}for(m=f*(e-1),u=l*s,g[m]!==0&&(o[u]=8,++A),h=1;h<t;h++)g[m]!==g[m+1]&&(o[u+h]=g[m]?4:8,++A),m++;if(g[m]!==0&&(o[u+h]=4,++A),A>n)return null;const _=new Int32Array([0,s,-1,0,-s,0,0,0,1]),S=new Path2D;for(l=0;A&&l<=e;l++){let T=l*s;const k=T+t;for(;T<k&&!o[T];)T++;if(T===k)continue;S.moveTo(T%s,l);const P=T;let L=o[T];do{const I=_[L];do T+=I;while(!o[T]);const D=o[T];D!==5&&D!==10?(L=D,o[T]=0):(L=D&51*L>>4,o[T]&=L>>2|L<<2),S.lineTo(T%s,T/s|0),o[T]||--A}while(P!==T);--l}return g=null,o=null,function(T){T.save(),T.scale(1/t,-1/e),T.translate(0,-e),T.fill(S),T.beginPath(),T.restore()}}let mL=class{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=kI,this.textMatrixScale=1,this.fontMatrix=yx,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=pi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=Pt.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=Pt.applyTransform(e,t),i=Pt.applyTransform(e.slice(2),t),s=Pt.applyTransform([e[0],e[3]],t),o=Pt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],i[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],i[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],i[1],s[1],o[1])}updateScalingPathMinMax(t,e){Pt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,s,o,l,h,u,f){const g=Pt.bezierBoundingBox(e,n,i,s,o,l,h,u,f);f||this.updateRectMinMax(t,g)}getPathBoundingBox(t=Ci.FILL,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===Ci.STROKE){e||we("Stroke bounding box must include transform.");const i=Pt.singularValueDecompose2dScale(e),s=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=Pt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Ci.FILL,e=null){return Pt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}};function yL(p,t){if(t instanceof ImageData){p.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%ls,s=(e-i)/ls,o=i===0?s:s+1,l=p.createImageData(n,ls);let h=0,u;const f=t.data,g=l.data;let m,A,_,S;if(t.kind===M_.GRAYSCALE_1BPP){const C=f.byteLength,T=new Uint32Array(g.buffer,0,g.byteLength>>2),k=T.length,P=n+7>>3,L=4294967295,I=Hi.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(_=m<s?ls:i,u=0,A=0;A<_;A++){const D=C-h;let F=0;const H=D>P?n:D*8-7,j=H&-8;let Q=0,W=0;for(;F<j;F+=8)W=f[h++],T[u++]=W&128?L:I,T[u++]=W&64?L:I,T[u++]=W&32?L:I,T[u++]=W&16?L:I,T[u++]=W&8?L:I,T[u++]=W&4?L:I,T[u++]=W&2?L:I,T[u++]=W&1?L:I;for(;F<H;F++)Q===0&&(W=f[h++],Q=128),T[u++]=W&Q?L:I,Q>>=1}for(;u<k;)T[u++]=0;p.putImageData(l,0,m*ls)}}else if(t.kind===M_.RGBA_32BPP){for(A=0,S=n*ls*4,m=0;m<s;m++)g.set(f.subarray(h,h+S)),h+=S,p.putImageData(l,0,A),A+=ls;m<o&&(S=n*i*4,g.set(f.subarray(h,h+S)),p.putImageData(l,0,A))}else if(t.kind===M_.RGB_24BPP)for(_=ls,S=n*_,m=0;m<o;m++){for(m>=s&&(_=i,S=n*_),u=0,A=S;A--;)g[u++]=f[h++],g[u++]=f[h++],g[u++]=f[h++],g[u++]=255;p.putImageData(l,0,m*ls)}else throw new Error(`bad image kind: ${t.kind}`)}function vL(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%ls,s=(e-i)/ls,o=i===0?s:s+1,l=p.createImageData(n,ls);let h=0;const u=t.data,f=l.data;for(let g=0;g<o;g++){const m=g<s?ls:i;({srcPos:h}=$j({src:u,srcPos:h,dest:f,width:n,height:m,nonBlackColor:0})),p.putImageData(l,0,g*ls)}}function ry(p,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)p[n]!==void 0&&(t[n]=p[n]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function c_(p){if(p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0),!Ti){const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}}function AL(p,t){if(t)return!0;const e=Pt.singularValueDecompose2dScale(p);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*ym.PDF_TO_CSS_UNITS);return e[0]<=n&&e[1]<=n}const Uj=["butt","round","square"],Gj=["miter","round","bevel"],Wj={},bL={};var da,Hx,Bx,zx,Pp;let U_=(Pp=class{constructor(t,e,n,i,s,{optionalContentConfig:o,markedContentStack:l=null},h,u){E(this,da);this.ctx=t,this.current=new mL(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new Bj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,n){const h=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Fe(this.compositeCtx))}this.ctx.save(),c_(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Fe(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,o=t.fnArray;let l=e||0;const h=s.length;if(h===l)return l;const u=h-l>pL&&typeof n=="function",f=u?Date.now()+jj:0;let g=0;const m=this.commonObjs,A=this.objs;let _;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,n),l;if(_=o[l],_!==Or.dependency)this[_].apply(this,s[l]);else for(const S of s[l]){const C=S.startsWith("g_")?m:A;if(!C.has(S))return C.get(S,n),l}if(l++,l===h)return l;if(u&&++g>pL){if(Date.now()>f)return n(),l;g=0}}}endDrawing(){b(this,da,Hx).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),b(this,da,Bx).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,h=i,u="prescale1",f,g;for(;s>2&&l>1||o>2&&h>1;){let m=l,A=h;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),o>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/A),f=this.cachedCanvases.getCanvas(u,m,A),g=f.context,g.clearRect(0,0,m,A),g.drawImage(t,0,0,l,h,0,0,m,A),t=f.canvas,l=m,h=A,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,o=this.current.patternFill,l=Fe(e);let h,u,f,g;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;u=JSON.stringify(o?l:[l.slice(0,4),s]),h=this._cachedBitmapsMap.get(H),h||(h=new Map,this._cachedBitmapsMap.set(H,h));const j=h.get(u);if(j&&!o){const Q=Math.round(Math.min(l[0],l[2])+l[4]),W=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:j,offsetX:Q,offsetY:W}}f=j}f||(g=this.cachedCanvases.getCanvas("maskCanvas",n,i),vL(g.context,t));let m=Pt.transform(l,[1/n,0,0,-1/i,0,0]);m=Pt.transform(m,[1,0,0,1,0,-i]);const[A,_,S,C]=Pt.getAxialAlignedBoundingBox([0,0,n,i],m),T=Math.round(S-A)||1,k=Math.round(C-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",T,k),L=P.context,I=A,D=_;L.translate(-I,-D),L.transform(...m),f||(f=this._scaleImage(g.canvas,_a(L)),f=f.img,h&&o&&h.set(u,f)),L.imageSmoothingEnabled=AL(Fe(L),t.interpolate),l_(L,f,0,0,f.width,f.height,0,0,n,i),L.globalCompositeOperation="source-in";const F=Pt.transform(_a(L),[1,0,0,1,-I,-D]);return L.fillStyle=o?s.getPattern(e,this,F,Ci.FILL):s,L.fillRect(0,0,n,i),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(u,P.canvas)),{canvas:P.canvas,offsetX:Math.round(I),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Uj[t]}setLineJoin(t){this.ctx.lineJoin=Gj[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...Fe(this.suspendedCtx)),ry(this.suspendedCtx,s),Hj(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ry(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],o=i[1],l=i[2]-s,h=i[3]-o;l===0||h===0||(this.genericComposeSMask(e.context,n,l,h,e.subtype,e.backdrop,e.transferMap,s,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,o,l,h,u,f,g){let m=t.canvas,A=h-f,_=u-g;if(o){const C=Pt.makeHexColor(...o);if(A<0||_<0||A+n>m.width||_+i>m.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,i),k=T.context;k.drawImage(m,-A,-_),k.globalCompositeOperation="destination-atop",k.fillStyle=C,k.fillRect(0,0,n,i),k.globalCompositeOperation="source-over",m=T.canvas,A=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(A,_,n,i),t.clip(T),t.globalCompositeOperation="destination-atop",t.fillStyle=C,t.fillRect(A,_,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const S=new Path2D;S.rect(h,u,n,i),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(m,A,_,n,i,h,u,n,i),e.restore()}save(){this.inSMaskMode?(ry(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ry(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,s,o){this.ctx.transform(t,e,n,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,s=this.current;let o=s.x,l=s.y,h,u;const f=Fe(i),g=f[0]===0&&f[3]===0||f[1]===0&&f[2]===0,m=g?n.slice(0):null;for(let A=0,_=0,S=t.length;A<S;A++)switch(t[A]|0){case Or.rectangle:o=e[_++],l=e[_++];const C=e[_++],T=e[_++],k=o+C,P=l+T;i.moveTo(o,l),C===0||T===0?i.lineTo(k,P):(i.lineTo(k,l),i.lineTo(k,P),i.lineTo(o,P)),g||s.updateRectMinMax(f,[o,l,k,P]),i.closePath();break;case Or.moveTo:o=e[_++],l=e[_++],i.moveTo(o,l),g||s.updatePathMinMax(f,o,l);break;case Or.lineTo:o=e[_++],l=e[_++],i.lineTo(o,l),g||s.updatePathMinMax(f,o,l);break;case Or.curveTo:h=o,u=l,o=e[_+4],l=e[_+5],i.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],o,l),s.updateCurvePathMinMax(f,h,u,e[_],e[_+1],e[_+2],e[_+3],o,l,m),_+=6;break;case Or.curveTo2:h=o,u=l,i.bezierCurveTo(o,l,e[_],e[_+1],e[_+2],e[_+3]),s.updateCurvePathMinMax(f,h,u,o,l,e[_],e[_+1],e[_+2],e[_+3],m),o=e[_+2],l=e[_+3],_+=4;break;case Or.curveTo3:h=o,u=l,o=e[_+2],l=e[_+3],i.bezierCurveTo(e[_],e[_+1],o,l,o,l),s.updateCurvePathMinMax(f,h,u,e[_],e[_+1],o,l,o,l,m),_+=4;break;case Or.closePath:i.closePath();break}g&&s.updateScalingPathMinMax(f,m),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(e.save(),e.strokeStyle=n.getPattern(e,this,_a(e),Ci.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let s=!1;i&&(e.save(),e.fillStyle=n.getPattern(e,this,_a(e),Ci.FILL),s=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Wj}eoClip(){this.pendingClip=bL}beginText(){this.current.textMatrix=kI,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const n=new Path2D,i=e.getTransform().invertSelf();for(const{transform:s,x:o,y:l,fontSize:h,path:u}of t)n.addPath(u,new DOMMatrix(s).preMultiplySelf(i).translate(o,l).scale(h,-h));e.clip(n),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var f;const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||yx,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ut("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const s=n.loadedName||"sans-serif",o=((f=n.systemFontInfo)==null?void 0:f.css)||`"${s}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const h=n.italic?"italic":"normal";let u=e;e<dL?u=dL:e>fL&&(u=fL),this.current.fontSizeScale=e/u,this.ctx.font=`${h} ${l} ${u}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,s,o){this.current.textMatrix=[t,e,n,i,s,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i,s){const o=this.ctx,l=this.current,h=l.font,u=l.textRenderingMode,f=l.fontSize/l.fontSizeScale,g=u&pi.FILL_STROKE_MASK,m=!!(u&pi.ADD_TO_PATH_FLAG),A=l.patternFill&&!h.missingFile,_=l.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||m||A||_)&&(S=h.getPathGenerator(this.commonObjs,t)),h.disableFontFace||A||_){if(o.save(),o.translate(e,n),o.scale(f,-f),g===pi.FILL||g===pi.FILL_STROKE)if(i){const C=o.getTransform();o.setTransform(...i),o.fill(b(this,da,zx).call(this,S,C,i))}else o.fill(S);if(g===pi.STROKE||g===pi.FILL_STROKE)if(s){const C=o.getTransform();o.setTransform(...s),o.stroke(b(this,da,zx).call(this,S,C,s))}else o.lineWidth/=f,o.stroke(S);o.restore()}else(g===pi.FILL||g===pi.FILL_STROKE)&&o.fillText(t,e,n),(g===pi.STROKE||g===pi.FILL_STROKE)&&o.strokeText(t,e,n);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Fe(o),x:e,y:n,fontSize:f,path:S})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return Yt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,h=e.wordSpacing,u=e.fontDirection,f=e.textHScale*u,g=t.length,m=n.vertical,A=m?1:-1,_=n.defaultVMetrics,S=i*e.fontMatrix[0],C=e.textRenderingMode===pi.FILL&&!n.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),u>0?s.scale(f,-1):s.scale(f,1);let T,k;if(e.patternFill){s.save();const F=e.fillColor.getPattern(s,this,_a(s),Ci.FILL);T=Fe(s),s.restore(),s.fillStyle=F}if(e.patternStroke){s.save();const F=e.strokeColor.getPattern(s,this,_a(s),Ci.STROKE);k=Fe(s),s.restore(),s.strokeStyle=F}let P=e.lineWidth;const L=e.textMatrixScale;if(L===0||P===0){const F=e.textRenderingMode&pi.FILL_STROKE_MASK;(F===pi.STROKE||F===pi.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=L;if(o!==1&&(s.scale(o,o),P/=o),s.lineWidth=P,n.isInvalidPDFjsFont){const F=[];let H=0;for(const j of t)F.push(j.unicode),H+=j.width;s.fillText(F.join(""),0,0),e.x+=H*S*f,s.restore(),this.compose();return}let I=0,D;for(D=0;D<g;++D){const F=t[D];if(typeof F=="number"){I+=A*F*i/1e3;continue}let H=!1;const j=(F.isSpace?h:0)+l,Q=F.fontChar,W=F.accent;let tt,Z,et=F.width;if(m){const J=F.vmetric||_,G=-(F.vmetric?J[1]:et*.5)*S,q=J[2]*S;et=J?-J[0]:et,tt=G/o,Z=(I+q)/o}else tt=I/o,Z=0;if(n.remeasure&&et>0){const J=s.measureText(Q).width*1e3/i*o;if(et<J&&this.isFontSubpixelAAEnabled){const G=et/J;H=!0,s.save(),s.scale(G,1),tt/=G}else et!==J&&(tt+=(et-J)/2e3*i/o)}if(this.contentVisible&&(F.isInFont||n.missingFile)){if(C&&!W)s.fillText(Q,tt,Z);else if(this.paintChar(Q,tt,Z,T,k),W){const J=tt+i*W.offset.x/o,G=Z-i*W.offset.y/o;this.paintChar(W.fontChar,J,G,T,k)}}const ht=m?et*S-j*u:et*S+j*u;I+=ht,H&&s.restore()}m?e.y-=I:e.x+=I*f,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,o=n.fontDirection,l=i.vertical?1:-1,h=n.charSpacing,u=n.wordSpacing,f=n.textHScale*o,g=n.fontMatrix||yx,m=t.length,A=n.textRenderingMode===pi.INVISIBLE;let _,S,C,T;if(!(A||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(f,o),_=0;_<m;++_){if(S=t[_],typeof S=="number"){T=l*S*s/1e3,this.ctx.translate(T,0),n.x+=T*f;continue}const k=(S.isSpace?u:0)+h,P=i.charProcOperatorList[S.operatorListId];if(!P){Ut(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(s,s),e.transform(...g),this.executeOperatorList(P),this.restore()),C=Pt.applyTransform([S.width,0],g)[0]*s+k,e.translate(C,0),n.x+=C*f}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,o){this.ctx.rect(n,i,s-n,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=t[1],i=this.baseTransform||Fe(this.ctx),s={createCanvasGraphics:o=>new Pp(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Nj(t,n,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=Pt.makeHexColor(t,e,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=Pt.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=Oj(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,_a(e),Ci.SHADING);const i=_a(e);{const{width:s,height:o}=e.canvas,[l,h,u,f]=Pt.getAxialAlignedBoundingBox([0,0,s,o],i);this.ctx.fillRect(l,h,u-l,f-h)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){we("Should not call beginInlineImage")}beginImageData(){we("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Fe(this.ctx),e)){const n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.current.updateRectMinMax(Fe(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||RE("TODO: Support non-isolated groups."),t.knockout&&Ut("Knockout groups not supported.");const n=Fe(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Pt.getAxialAlignedBoundingBox(t.bbox,Fe(e));const s=[0,0,e.canvas.width,e.canvas.height];i=Pt.intersect(i,s)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,h,u]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(f,h,u),m=g.context;m.translate(-o,-l),m.transform(...n),t.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.save()),ry(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Fe(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=Pt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,n,i,s){if(b(this,da,Hx).call(this),c_(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=l;const[h,u]=Pt.singularValueDecompose2dScale(Fe(this.ctx)),{viewportScale:f}=this,g=Math.ceil(o*this.outputScaleX*f),m=Math.ceil(l*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:A,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-u,0,l*u),c_(this.ctx)}else c_(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new mL(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),b(this,da,Bx).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=zj(t)),i.compiled)){i.compiled(n);return}const s=this._createMaskCanvas(t),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,s,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const h=Fe(l);l.transform(e,n,i,s,0,0);const u=this._createMaskCanvas(t);l.setTransform(1,0,0,1,u.offsetX-h[4],u.offsetY-h[5]);for(let f=0,g=o.length;f<g;f+=2){const m=Pt.transform(h,[e,n,i,s,o[f],o[f+1]]),[A,_]=Pt.applyTransform([0,0],m);l.drawImage(u.canvas,A,_)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:o,width:l,height:h,transform:u}=s,f=this.cachedCanvases.getCanvas("maskCanvas",l,h),g=f.context;g.save();const m=this.getObject(o,s);vL(g,m),g.globalCompositeOperation="source-in",g.fillStyle=i?n.getPattern(g,this,_a(e),Ci.FILL):n,g.fillRect(0,0,l,h),g.restore(),e.save(),e.transform(...u),e.scale(1,-1),l_(e,f.canvas,0,0,l,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Ut("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Ut("Dependent image isn't ready yet");return}const o=s.width,l=s.height,h=[];for(let u=0,f=i.length;u<f;u+=2)h.push({transform:[e,0,0,n,i[u],i[u+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(s,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!Ti){const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none")}i.scale(1/e,-1/n);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;yL(h,t),s=this.applyTransferMapsToCanvas(h)}const o=this._scaleImage(s,_a(i));i.imageSmoothingEnabled=AL(Fe(i),t.interpolate),l_(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,o=t.height,h=this.cachedCanvases.getCanvas("inlineImage",s,o).context;yL(h,t),i=this.applyTransferMapsToCanvas(h)}for(const s of e)n.save(),n.transform(...s.transform),n.scale(1,-1),l_(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===bL?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Fe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let o,l;if(n===0&&i===0){const h=Math.abs(e),u=Math.abs(s);if(h===u)if(t===0)o=l=1/h;else{const f=h*t;o=l=f<1?1/f:1}else if(t===0)o=1/h,l=1/u;else{const f=h*t,g=u*t;o=f<1?1/f:1,l=g<1?1/g:1}}else{const h=Math.abs(e*s-n*i),u=Math.hypot(e,n),f=Math.hypot(i,s);if(t===0)o=f/h,l=u/h;else{const g=t*h;o=f>g?f/g:1,l=u>g?u/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,s]=this.getScaleForStroking();if(e.lineWidth=n||1,i===1&&s===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,s),o.length>0){const l=Math.max(i,s);e.setLineDash(o.map(h=>h/l)),e.lineDashOffset/=l}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}},da=new WeakSet,Hx=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Bx=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},zx=function(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i},Pp);for(const p in Or)U_.prototype[p]!==void 0&&(U_.prototype[Or[p]]=U_.prototype[p]);var L_,Lv,Mv;let iu=(L_=class{static get workerPort(){return r(this,Lv)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");v(this,Lv,t)}static get workerSrc(){return r(this,Mv)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");v(this,Mv,t)}},Lv=new WeakMap,Mv=new WeakMap,E(L_,Lv,null),E(L_,Mv,""),L_);var Lu,Iv,sI;let Vj=(sI=class{constructor({parsedData:t,rawData:e}){E(this,Lu);E(this,Iv);v(this,Lu,t),v(this,Iv,e)}getRaw(){return r(this,Iv)}get(t){return r(this,Lu).get(t)??null}getAll(){return HT(r(this,Lu))}has(t){return r(this,Lu).has(t)}},Lu=new WeakMap,Iv=new WeakMap,sI);const Kf=Symbol("INTERNAL");var Dv,Fv,Ov,Rp,rI;let qj=(rI=class{constructor(t,{name:e,intent:n,usage:i,rbGroups:s}){E(this,Dv,!1);E(this,Fv,!1);E(this,Ov,!1);E(this,Rp,!0);v(this,Dv,!!(t&Hs.DISPLAY)),v(this,Fv,!!(t&Hs.PRINT)),this.name=e,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(r(this,Ov))return r(this,Rp);if(!r(this,Rp))return!1;const{print:t,view:e}=this.usage;return r(this,Dv)?(e==null?void 0:e.viewState)!=="OFF":r(this,Fv)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==Kf&&we("Internal method `_setVisible` called."),v(this,Ov,n),v(this,Rp,e)}},Dv=new WeakMap,Fv=new WeakMap,Ov=new WeakMap,Rp=new WeakMap,rI);var Lc,ue,Lp,Mp,Nv,Ux,aI;let Xj=(aI=class{constructor(t,e=Hs.DISPLAY){E(this,Nv);E(this,Lc,null);E(this,ue,new Map);E(this,Lp,null);E(this,Mp,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,v(this,Mp,t.order);for(const n of t.groups)r(this,ue).set(n.id,new qj(e,n));if(t.baseState==="OFF")for(const n of r(this,ue).values())n._setVisible(Kf,!1);for(const n of t.on)r(this,ue).get(n)._setVisible(Kf,!0);for(const n of t.off)r(this,ue).get(n)._setVisible(Kf,!1);v(this,Lp,this.getHash())}}isVisible(t){if(r(this,ue).size===0)return!0;if(!t)return RE("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,ue).has(t.id)?r(this,ue).get(t.id).visible:(Ut(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return b(this,Nv,Ux).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,ue).has(e))return Ut(`Optional content group not found: ${e}`),!0;if(r(this,ue).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,ue).has(e))return Ut(`Optional content group not found: ${e}`),!0;if(!r(this,ue).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,ue).has(e))return Ut(`Optional content group not found: ${e}`),!0;if(!r(this,ue).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,ue).has(e))return Ut(`Optional content group not found: ${e}`),!0;if(r(this,ue).get(e).visible)return!1}return!0}return Ut(`Unknown optional content policy ${t.policy}.`),!0}return Ut(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var s;const i=r(this,ue).get(t);if(!i){Ut(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const l of o)l!==t&&((s=r(this,ue).get(l))==null||s._setVisible(Kf,!1,!0));i._setVisible(Kf,!!e,!0),v(this,Lc,null)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=r(this,ue).get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}v(this,Lc,null)}get hasInitialVisibility(){return r(this,Lp)===null||this.getHash()===r(this,Lp)}getOrder(){return r(this,ue).size?r(this,Mp)?r(this,Mp).slice():[...r(this,ue).keys()]:null}getGroups(){return r(this,ue).size>0?HT(r(this,ue)):null}getGroup(t){return r(this,ue).get(t)||null}getHash(){if(r(this,Lc)!==null)return r(this,Lc);const t=new oD;for(const[e,n]of r(this,ue))t.update(`${e}:${n.visible}`);return v(this,Lc,t.hexdigest())}},Lc=new WeakMap,ue=new WeakMap,Lp=new WeakMap,Mp=new WeakMap,Nv=new WeakSet,Ux=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const s=t[i];let o;if(Array.isArray(s))o=b(this,Nv,Ux).call(this,s);else if(r(this,ue).has(s))o=r(this,ue).get(s).visible;else return Ut(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"},aI),Yj=class{constructor(t,{disableRange:e=!1,disableStream:n=!1}){un(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,u)=>{this._onReceiveData({begin:h,chunk:u})}),t.addProgressListener((h,u)=>{this._onProgress({loaded:h,total:u})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(n),!0)});un(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,i,s;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){un(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Kj(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Qj(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}},Kj=class{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=GT(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},Qj=class{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function Jj(p){let t=!0,e=n("filename\\*","i").exec(p);if(e){e=e[1];let f=l(e);return f=unescape(f),f=h(f),f=u(f),s(f)}if(e=o(p),e){const f=u(e);return s(f)}if(e=n("filename","i").exec(p),e){e=e[1];let f=l(e);return f=u(f),s(f)}function n(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(f,{fatal:!0}),A=LE(g);g=m.decode(A),t=!1}catch{}}return g}function s(f){return t&&/[\x80-\xff]/.test(f)&&(f=i("utf-8",f),t&&(f=i("iso-8859-1",f))),f}function o(f){const g=[];let m;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=A.exec(f))!==null;){let[,S,C,T]=m;if(S=parseInt(S,10),S in g){if(S===0)break;continue}g[S]=[C,T]}const _=[];for(let S=0;S<g.length&&S in g;++S){let[C,T]=g[S];T=l(T),C&&(T=unescape(T),S===0&&(T=h(T))),_.push(T)}return _.join("")}function l(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let m=0;m<g.length;++m){const A=g[m].indexOf('"');A!==-1&&(g[m]=g[m].slice(0,A),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}f=g.join('"')}return f}function h(f){const g=f.indexOf("'");if(g===-1)return f;const m=f.slice(0,g),_=f.slice(g+1).replace(/^[^']*'/,"");return i(m,_)}function u(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,A,_){if(A==="q"||A==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),i(m,_);try{_=atob(_)}catch{}return i(m,_)})}return""}function _D(p,t){const e=new Headers;if(!p||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function DE(p){try{return new URL(p).origin}catch{}return null}function wD({responseHeaders:p,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(p.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||n||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function ED(p){const t=p.get("Content-Disposition");if(t){let e=Jj(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(GT(e))return e}return null}function FE(p,t){return p===404||p===0&&t.startsWith("file:")?new tv('Missing PDF "'+t+'".'):new Hw(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p)}function SD(p){return p===200||p===206}function xD(p,t,e){return{method:"GET",headers:p,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function CD(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(Ut(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}let _L=class{constructor(t){lt(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=_D(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return un(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Zj(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new tH(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},Zj=class{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,xD(n,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=DE(s.url),!SD(s.status))throw FE(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:l,suggestedLength:h}=wD({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=ED(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Sh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:CD(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}},tH=class{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${n-1}`);const o=i.url;fetch(o,xD(s,this._withCredentials,this._abortController)).then(l=>{const h=DE(l.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!SD(l.status))throw FE(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:CD(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}};const N1=200,$1=206;function eH(p){const t=p.response;return typeof t!="string"?t:LE(t).buffer}let nH=class{constructor({url:t,httpHeaders:e,withCredentials:n}){lt(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=_D(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,o]of this.headers)e.setRequestHeader(s,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=$1):i.expectedStatus=N1,e.responseType="arraybuffer",un(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var i;const n=this.pendingRequests[t];n&&((i=n.onProgress)==null||i.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){n.onError(i.status);return}const s=i.status||N1;if(!(s===N1&&n.expectedStatus===$1)&&s!==n.expectedStatus){n.onError(i.status);return}const l=eH(i);if(s===$1){const h=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);u?n.onDone({begin:parseInt(u[1],10),chunk:l}):(Ut('Missing or invalid "Content-Range" header.'),n.onError(0))}else l?n.onDone({begin:0,chunk:l}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}},iH=class{constructor(t){this._source=t,this._manager=new nH(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return un(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sH(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new rH(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},sH=class{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=DE(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[h,...u]=l.split(": ");return[h,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=wD({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=ED(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=FE(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},rH=class{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=DE((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=FE(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}};const aH=/^[a-z][a-z0-9\-+.]+:/i;function oH(p){if(aH.test(p))return new URL(p);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(p))}let lH=class{constructor(t){this.source=t,this.url=oH(t.url),un(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return un(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new cH(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new hH(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},cH=class{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new tv(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Sh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},hH=class{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}};const uH=1e5,Ji=30,dH=.8;var oI,Mc,is,$v,jv,Mu,zo,Hv,Bv,Iu,Ip,Dp,Ic,Fp,zv,Op,Du,Uv,Gv,Xe,Fu,Ou,Wv,Dc,Np,Nl,TD,kD,Wx,Ws,G_,Vx,PD,RD;let Gx=(Xe=class{constructor({textContentSource:t,container:e,viewport:n}){E(this,Nl);E(this,Mc,Promise.withResolvers());E(this,is,null);E(this,$v,!1);E(this,jv,!!((oI=globalThis.FontInspector)!=null&&oI.enabled));E(this,Mu,null);E(this,zo,null);E(this,Hv,0);E(this,Bv,0);E(this,Iu,null);E(this,Ip,null);E(this,Dp,0);E(this,Ic,0);E(this,Fp,Object.create(null));E(this,zv,[]);E(this,Op,null);E(this,Du,[]);E(this,Uv,new WeakMap);E(this,Gv,null);var h;if(t instanceof ReadableStream)v(this,Op,t);else if(typeof t=="object")v(this,Op,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,is,v(this,Ip,e)),v(this,Ic,n.scale*(globalThis.devicePixelRatio||1)),v(this,Dp,n.rotation),v(this,zo,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:l}=n.rawDims;v(this,Gv,[1,0,0,-1,-o,l+s]),v(this,Bv,i),v(this,Hv,s),b(h=Xe,Ws,PD).call(h),hf(e,n),r(this,Mc).promise.finally(()=>{r(Xe,Np).delete(this),v(this,zo,null),v(this,Fp,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Hi.platform;return Yt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Iu).read().then(({value:e,done:n})=>{if(n){r(this,Mc).resolve();return}r(this,Mu)??v(this,Mu,e.lang),Object.assign(r(this,Fp),e.styles),b(this,Nl,TD).call(this,e.items),t()},r(this,Mc).reject)};return v(this,Iu,r(this,Op).getReader()),r(Xe,Np).add(this),t(),r(this,Mc).promise}update({viewport:t,onBefore:e=null}){var s;const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==r(this,Dp)&&(e==null||e(),v(this,Dp,i),hf(r(this,Ip),{rotation:i})),n!==r(this,Ic)){e==null||e(),v(this,Ic,n);const o={div:null,properties:null,ctx:b(s=Xe,Ws,G_).call(s,r(this,Mu))};for(const l of r(this,Du))o.properties=r(this,Uv).get(l),o.div=l,b(this,Nl,Wx).call(this,o)}}cancel(){var e;const t=new Sh("TextLayer task cancelled.");(e=r(this,Iu))==null||e.cancel(t).catch(()=>{}),v(this,Iu,null),r(this,Mc).reject(t)}get textDivs(){return r(this,Du)}get textContentItemsStr(){return r(this,zv)}static cleanup(){if(!(r(this,Np).size>0)){r(this,Fu).clear();for(const{canvas:t}of r(this,Ou).values())t.remove();r(this,Ou).clear()}}},Mc=new WeakMap,is=new WeakMap,$v=new WeakMap,jv=new WeakMap,Mu=new WeakMap,zo=new WeakMap,Hv=new WeakMap,Bv=new WeakMap,Iu=new WeakMap,Ip=new WeakMap,Dp=new WeakMap,Ic=new WeakMap,Fp=new WeakMap,zv=new WeakMap,Op=new WeakMap,Du=new WeakMap,Uv=new WeakMap,Gv=new WeakMap,Fu=new WeakMap,Ou=new WeakMap,Wv=new WeakMap,Dc=new WeakMap,Np=new WeakMap,Nl=new WeakSet,TD=function(t){var i,s;if(r(this,$v))return;(s=r(this,zo)).ctx??(s.ctx=b(i=Xe,Ws,G_).call(i,r(this,Mu)));const e=r(this,Du),n=r(this,zv);for(const o of t){if(e.length>uH){Ut("Ignoring additional textDivs for performance reasons."),v(this,$v,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=r(this,is);v(this,is,document.createElement("span")),r(this,is).classList.add("markedContent"),o.id!==null&&r(this,is).setAttribute("id",`${o.id}`),l.append(r(this,is))}else o.type==="endMarkedContent"&&v(this,is,r(this,is).parentNode);continue}n.push(o.str),b(this,Nl,kD).call(this,o)}},kD=function(t){var S;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Du).push(e);const i=Pt.transform(r(this,Gv),t.transform);let s=Math.atan2(i[1],i[0]);const o=r(this,Fp)[t.fontName];o.vertical&&(s+=Math.PI/2);let l=r(this,jv)&&o.fontSubstitution||o.fontFamily;l=Xe.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),u=h*b(S=Xe,Ws,RD).call(S,l,r(this,Mu));let f,g;s===0?(f=i[4],g=i[5]-u):(f=i[4]+u*Math.sin(s),g=i[5]-u*Math.cos(s));const m="calc(var(--scale-factor)*",A=e.style;r(this,is)===r(this,Ip)?(A.left=`${(100*f/r(this,Bv)).toFixed(2)}%`,A.top=`${(100*g/r(this,Hv)).toFixed(2)}%`):(A.left=`${m}${f.toFixed(2)}px)`,A.top=`${m}${g.toFixed(2)}px)`),A.fontSize=`${m}${(r(Xe,Dc)*h).toFixed(2)}px)`,A.fontFamily=l,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,jv)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),s!==0&&(n.angle=s*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),T=Math.abs(t.transform[3]);C!==T&&Math.max(C,T)/Math.min(C,T)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?t.height:t.width),r(this,Uv).set(e,n),r(this,zo).div=e,r(this,zo).properties=n,b(this,Nl,Wx).call(this,r(this,zo)),n.hasText&&r(this,is).append(e),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),r(this,is).append(C)}},Wx=function(t){var l;const{div:e,properties:n,ctx:i}=t,{style:s}=e;let o="";if(r(Xe,Dc)>1&&(o=`scale(${1/r(Xe,Dc)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=s,{canvasWidth:u,fontSize:f}=n;b(l=Xe,Ws,Vx).call(l,i,f*r(this,Ic),h);const{width:g}=i.measureText(e.textContent);g>0&&(o=`scaleX(${u*r(this,Ic)/g}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)},Ws=new WeakSet,G_=function(t=null){let e=r(this,Ou).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,Ou).set(t,e),r(this,Wv).set(e,{size:0,family:""})}return e},Vx=function(t,e,n){const i=r(this,Wv).get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)},PD=function(){if(r(this,Dc)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),v(this,Dc,t.getBoundingClientRect().height),t.remove()},RD=function(t,e){const n=r(this,Fu).get(t);if(n)return n;const i=b(this,Ws,G_).call(this,e);i.canvas.width=i.canvas.height=Ji,b(this,Ws,Vx).call(this,i,Ji,t);const s=i.measureText("");let o=s.fontBoundingBoxAscent,l=Math.abs(s.fontBoundingBoxDescent);if(o){const f=o/(o+l);return r(this,Fu).set(t,f),i.canvas.width=i.canvas.height=0,f}i.strokeStyle="red",i.clearRect(0,0,Ji,Ji),i.strokeText("g",0,0);let h=i.getImageData(0,0,Ji,Ji).data;l=0;for(let f=h.length-1-3;f>=0;f-=4)if(h[f]>0){l=Math.ceil(f/4/Ji);break}i.clearRect(0,0,Ji,Ji),i.strokeText("A",0,Ji),h=i.getImageData(0,0,Ji,Ji).data,o=0;for(let f=0,g=h.length;f<g;f+=4)if(h[f]>0){o=Ji-Math.floor(f/4/Ji);break}i.canvas.width=i.canvas.height=0;const u=o?o/(o+l):dH;return r(this,Fu).set(t,u),u},E(Xe,Ws),E(Xe,Fu,new Map),E(Xe,Ou,new Map),E(Xe,Wv,new WeakMap),E(Xe,Dc,null),E(Xe,Np,new Set),Xe),qx=class LD{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(s){var h;if(!s)return;let o=null;const l=s.name;if(l==="#text")o=s.value;else if(LD.shouldBuildText(l))(h=s==null?void 0:s.attributes)!=null&&h.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&e.push({str:o}),!!s.children)for(const u of s.children)i(u)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}};const fH=65536,pH=100,gH=5e3,mH=Ti?Pj:Cj,yH=Ti?Rj:gD,vH=Ti?kj:Tj,AH=Ti?Lj:AD;function bH(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new EH,{docId:e}=t,n=p.url?_H(p.url):null,i=p.data?wH(p.data):null,s=p.httpHeaders||null,o=p.withCredentials===!0,l=p.password??null,h=p.range instanceof MD?p.range:null,u=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:fH;let f=p.worker instanceof V_?p.worker:null;const g=p.verbosity,m=typeof p.docBaseUrl=="string"&&!IE(p.docBaseUrl)?p.docBaseUrl:null,A=typeof p.cMapUrl=="string"?p.cMapUrl:null,_=p.cMapPacked!==!1,S=p.CMapReaderFactory||yH,C=typeof p.standardFontDataUrl=="string"?p.standardFontDataUrl:null,T=p.StandardFontDataFactory||AH,k=p.stopAtErrors!==!0,P=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,L=p.isEvalSupported!==!1,I=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!Ti,D=typeof p.isImageDecoderSupported=="boolean"?p.isImageDecoderSupported:!Ti&&(Hi.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,H=typeof p.disableFontFace=="boolean"?p.disableFontFace:Ti,j=p.fontExtraProperties===!0,Q=p.enableXfa===!0,W=p.ownerDocument||globalThis.document,tt=p.disableRange===!0,Z=p.disableStream===!0,et=p.disableAutoFetch===!0,ht=p.pdfBug===!0,J=p.CanvasFactory||mH,G=p.FilterFactory||vH,q=p.enableHWA===!0,U=h?h.length:p.length??NaN,N=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!Ti&&!H,M=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:S===gD&&T===AD&&A&&C&&vy(A,document.baseURI)&&vy(C,document.baseURI),B=null;ej(g);const Y={canvasFactory:new J({ownerDocument:W,enableHWA:q}),filterFactory:new G({docId:e,ownerDocument:W}),cMapReaderFactory:M?null:new S({baseUrl:A,isCompressed:_}),standardFontDataFactory:M?null:new T({baseUrl:C})};if(!f){const at={verbosity:g,port:iu.workerPort};f=at.port?V_.fromPort(at):new V_(at),t._worker=f}const it={docId:e,apiVersion:"4.10.38",data:i,password:l,disableAutoFetch:et,rangeChunkSize:u,length:U,docBaseUrl:m,enableXfa:Q,evaluatorOptions:{maxImageSize:P,disableFontFace:H,ignoreErrors:k,isEvalSupported:L,isOffscreenCanvasSupported:I,isImageDecoderSupported:D,canvasMaxAreaInBytes:F,fontExtraProperties:j,useSystemFonts:N,cMapUrl:M?A:null,standardFontDataUrl:M?C:null}},dt={disableFontFace:H,fontExtraProperties:j,ownerDocument:W,pdfBug:ht,styleElement:B,loadingParams:{disableAutoFetch:et,enableXfa:Q}};return f.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const at=f.messageHandler.sendWithPromise("GetDocRequest",it,i?[i.buffer]:null);let nt;if(h)nt=new Yj(h,{disableRange:tt,disableStream:Z});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let yt;if(Ti)if(vy(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");yt=_L}else yt=lH;else yt=vy(n)?_L:iH;nt=new yt({url:n,length:U,httpHeaders:s,withCredentials:o,rangeChunkSize:u,disableRange:tt,disableStream:Z})}return at.then(yt=>{if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const ut=new wy(e,yt,f.port),St=new TH(ut,t,nt,dt,Y);t._transport=St,ut.send("Ready",null)})}).catch(t._capability.reject),t}function _H(p){if(p instanceof URL)return p.href;try{return new URL(p,window.location).href}catch{if(Ti&&typeof p=="string")return p}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function wH(p){if(Ti&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return LE(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p==null?void 0:p.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function wL(p){return typeof p=="object"&&Number.isInteger(p==null?void 0:p.num)&&p.num>=0&&Number.isInteger(p==null?void 0:p.gen)&&p.gen>=0}var Nu,eE;let EH=(Nu=class{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${le(Nu,eE)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,n,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}},eE=new WeakMap,E(Nu,eE,0),Nu),MD=class{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){we("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},SH=class{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Yt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}};var Fc,Uo,mr,Qf,W_,lI;let xH=(lI=class{constructor(t,e,n,i=!1){E(this,mr);E(this,Fc,null);E(this,Uo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new oL:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new ID,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new zT({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Yt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=yc.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:u=null,printAnnotationStorage:f=null,isEditing:g=!1}){var L,I;(L=this._stats)==null||L.time("Overall");const m=this._transport.getRenderingIntent(n,i,f,g),{renderingIntent:A,cacheKey:_}=m;v(this,Uo,!1),b(this,mr,W_).call(this),l||(l=this._transport.getOptionalContentConfig(A));let S=this._intentStates.get(_);S||(S=Object.create(null),this._intentStates.set(_,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const C=!!(A&Hs.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(m));const T=D=>{var F;S.renderTasks.delete(k),(this._maybeCleanupAfterRender||C)&&v(this,Uo,!0),b(this,mr,Qf).call(this,!C),D?(k.capability.reject(D),this._abortOperatorList({intentState:S,reason:D instanceof Error?D:new Error(D)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new PH({callback:T,params:{canvasContext:t,viewport:e,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:u});(S.renderTasks||(S.renderTasks=new Set)).add(k);const P=k.task;return Promise.all([S.displayReadyCapability.promise,l]).then(([D,F])=>{var H;if(this.destroyed){T();return}if((H=this._stats)==null||H.time("Rendering"),!(F.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:D,optionalContentConfig:F}),k.operatorListChanged()}).catch(T),P}getOperatorList({intent:t="display",annotationMode:e=yc.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var u;function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,n,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>qx.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function s(){o.read().then(function({value:h,done:u}){if(u){n(l);return}l.lang??(l.lang=h.lang),Object.assign(l.styles,h.styles),l.items.push(...h.items),s()},i)}const o=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),v(this,Uo,!1),b(this,mr,W_).call(this),Promise.all(t)}cleanup(t=!1){v(this,Uo,!0);const e=b(this,mr,Qf).call(this,!1);return t&&e&&this._stats&&(this._stats=new oL),e}_startRenderPage(t,e){var i,s;const n=this._intentStates.get(e);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&b(this,mr,Qf).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:o}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},o).getReader(),u=this._intentStates.get(e);u.streamReader=h;const f=()=>{h.read().then(({value:g,done:m})=>{if(m){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,u),f())},g=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const m of u.renderTasks)m.operatorListChanged();b(this,mr,Qf).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(g);else if(u.opListReadCapability)u.opListReadCapability.reject(g);else throw g}})};f()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof UT){let i=pH;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Sh(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}},Fc=new WeakMap,Uo=new WeakMap,mr=new WeakSet,Qf=function(t=!1){if(b(this,mr,W_).call(this),!r(this,Uo)||this.destroyed)return!1;if(t)return v(this,Fc,setTimeout(()=>{v(this,Fc,null),b(this,mr,Qf).call(this,!1)},gH)),!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,Uo,!1),!0},W_=function(){r(this,Fc)&&(clearTimeout(r(this,Fc)),v(this,Fc,null))},lI);var Go,nE,cI;let CH=(cI=class{constructor(){E(this,Go,new Map);E(this,nE,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};r(this,nE).then(()=>{for(const[i]of r(this,Go))i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Ut("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}r(this,Go).set(e,i)}removeEventListener(t,e){const n=r(this,Go).get(e);n==null||n(),r(this,Go).delete(e)}terminate(){for(const[,t]of r(this,Go))t==null||t();r(this,Go).clear()}},Go=new WeakMap,nE=new WeakMap,cI);var _e,iE,$u,ju,$p,q_,jp,X_;let V_=(_e=class{constructor({name:t=null,port:e=null,verbosity:n=nj()}={}){E(this,$p);var i;if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=r(_e,ju))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(_e,ju)||v(_e,ju,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new wy("main","worker",t),this._messageHandler.on("ready",function(){}),b(this,$p,q_).call(this)}_initialize(){if(r(_e,$u)||r(_e,jp,X_)){this._setupFakeWorker();return}let{workerSrc:t}=_e;try{_e._isSameOrigin(window.location.href,t)||(t=_e._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new wy("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),n.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}this._messageHandler=n,this._port=e,this._webWorker=e,b(this,$p,q_).call(this)}),n.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};o();return}catch{RE("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(_e,$u)||(Ut("Setting up fake worker."),v(_e,$u,!0)),_e._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new CH;this._port=e;const n=`fake${le(_e,iE)._++}`,i=new wy(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new wy(n,n+"_worker",e),b(this,$p,q_).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,n;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=r(_e,ju))==null||e.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(t){var n;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(n=r(this,ju))==null?void 0:n.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new _e(t)}static get workerSrc(){if(iu.workerSrc)return iu.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Yt(this,"_setupFakeWorkerGlobal",(async()=>r(this,jp,X_)?r(this,jp,X_):(await import(this.workerSrc)).WorkerMessageHandler)())}},iE=new WeakMap,$u=new WeakMap,ju=new WeakMap,$p=new WeakSet,q_=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},jp=new WeakSet,X_=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},E(_e,jp),E(_e,iE,0),E(_e,$u,!1),E(_e,ju),Ti&&(v(_e,$u,!0),iu.workerSrc||(iu.workerSrc="./pdf.worker.mjs")),_e._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},_e._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},_e);var Wo,Fa,Hp,Bp,Vo,Hu,Ty,hI;let TH=(hI=class{constructor(t,e,n,i,s){E(this,Hu);E(this,Wo,new Map);E(this,Fa,new Map);E(this,Hp,new Map);E(this,Bp,new Map);E(this,Vo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new ID,this.fontLoader=new Sj({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Yt(this,"annotationStorage",new VT)}getRenderingIntent(t,e=yc.ENABLE,n=null,i=!1,s=!1){let o=Hs.DISPLAY,l=Ox;switch(t){case"any":o=Hs.ANY;break;case"display":break;case"print":o=Hs.PRINT;break;default:Ut(`getRenderingIntent - invalid intent: ${t}`)}const h=o&Hs.PRINT&&n instanceof cD?n:this.annotationStorage;switch(e){case yc.DISABLE:o+=Hs.ANNOTATIONS_DISABLE;break;case yc.ENABLE:break;case yc.ENABLE_FORMS:o+=Hs.ANNOTATIONS_FORMS;break;case yc.ENABLE_STORAGE:o+=Hs.ANNOTATIONS_STORAGE,l=h.serializable;break;default:Ut(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=Hs.IS_EDITING),s&&(o+=Hs.OPLIST);const{ids:u,hash:f}=h.modifiedIds,g=[o,l.hash,f];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=r(this,Vo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of r(this,Fa).values())t.push(i._destroy());r(this,Fa).clear(),r(this,Hp).clear(),r(this,Bp).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),r(this,Wo).clear(),this.filterFactory.destroy(),Gx.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Sh("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{un(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}un(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async n=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((l=e.onProgress)==null||l.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var u;(u=e.onProgress)==null||u.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),t.on("GetRangeReader",(n,i)=>{un(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:l}){if(l){i.close();return}un(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new SH(n,this))}),t.on("DocException",n=>{e._capability.reject(ts(n))}),t.on("PasswordRequest",n=>{v(this,Vo,Promise.withResolvers());try{if(!e.onPassword)throw ts(n);const i=s=>{s instanceof Error?r(this,Vo).reject(s):r(this,Vo).resolve({password:s})};e.onPassword(i,n.code)}catch(i){r(this,Vo).reject(i)}return r(this,Vo).promise}),t.on("DataLoaded",n=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;r(this,Fa).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:l,fontExtraProperties:h,pdfBug:u}=this._params;if("error"in s){const A=s.error;Ut(`Error during font loading: ${A}`),this.commonObjs.resolve(n,A);break}const f=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(A,_)=>globalThis.FontInspector.fontAdded(A,_):null,g=new xj(s,{disableFontFace:l,fontExtraProperties:h,inspectFont:f});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h&&g.data&&(g.data=null),this.commonObjs.resolve(n,g)});break;case"CopyLocalImage":const{imageRef:m}=s;un(m,"The imageRef must be defined.");for(const A of r(this,Fa).values())for(const[,_]of A.objs)if((_==null?void 0:_.ref)===m)return _.dataLen?(this.commonObjs.resolve(n,structuredClone(_)),_.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,s,o])=>{var h;if(this.destroyed)return;const l=r(this,Fa).get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){(h=o==null?void 0:o.bitmap)==null||h.close();return}switch(s){case"Image":l.objs.resolve(n,o),(o==null?void 0:o.dataLen)>Q$&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",n=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),t.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ut("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=r(this,Hp).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&r(this,Bp).set(s.refStr,t);const o=new xH(e,s,this,this._params.pdfBug);return r(this,Fa).set(e,o),o});return r(this,Hp).set(e,i),i}getPageIndex(t){return wL(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return b(this,Hu,Ty).call(this,"GetFieldObjects")}hasJSActions(){return b(this,Hu,Ty).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return b(this,Hu,Ty).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return b(this,Hu,Ty).call(this,"GetOptionalContentConfig").then(e=>new Xj(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,Wo).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new Vj(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return r(this,Wo).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,Fa).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,Wo).clear(),this.filterFactory.destroy(!0),Gx.cleanup()}}cachedPageNumber(t){if(!wL(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,Bp).get(e)??null}},Wo=new WeakMap,Fa=new WeakMap,Hp=new WeakMap,Bp=new WeakMap,Vo=new WeakMap,Hu=new WeakSet,Ty=function(t,e=null){const n=r(this,Wo).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return r(this,Wo).set(t,i),i},hI);const ay=Symbol("INITIAL_DATA");var Es,Vv,Xx,uI;let ID=(uI=class{constructor(){E(this,Vv);E(this,Es,Object.create(null))}get(t,e=null){if(e){const i=b(this,Vv,Xx).call(this,t);return i.promise.then(()=>e(i.data)),null}const n=r(this,Es)[t];if(!n||n.data===ay)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=r(this,Es)[t];return!!e&&e.data!==ay}delete(t){const e=r(this,Es)[t];return!e||e.data===ay?!1:(delete r(this,Es)[t],!0)}resolve(t,e=null){const n=b(this,Vv,Xx).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in r(this,Es)){const{data:n}=r(this,Es)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}v(this,Es,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,Es)){const{data:e}=r(this,Es)[t];e!==ay&&(yield[t,e])}}},Es=new WeakMap,Vv=new WeakSet,Xx=function(t){var e;return(e=r(this,Es))[t]||(e[t]={...Promise.withResolvers(),data:ay})},uI);var Oc,dI;let kH=(dI=class{constructor(t){E(this,Oc,null);v(this,Oc,t),this.onContinue=null}get promise(){return r(this,Oc).capability.promise}cancel(t=0){r(this,Oc).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,Oc).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,Oc);return t.form||t.canvas&&(e==null?void 0:e.size)>0}},Oc=new WeakMap,dI);var Nc,lo,Bu;let PH=(lo=class{constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:l,canvasFactory:h,filterFactory:u,useRequestAnimationFrame:f=!1,pdfBug:g=!1,pageColors:m=null}){E(this,Nc,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=u,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new kH(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var l,h;if(this.cancelled)return;if(this._canvas){if(r(lo,Bu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(lo,Bu).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:s,background:o}=this.params;this.gfx=new U_(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(t=null,e=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),r(this,Nc)&&(window.cancelAnimationFrame(r(this,Nc)),v(this,Nc,null)),r(lo,Bu).delete(this._canvas),this.callback(t||new UT(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,Nc,window.requestAnimationFrame(()=>{v(this,Nc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(lo,Bu).delete(this._canvas),this.callback())))}},Nc=new WeakMap,Bu=new WeakMap,E(lo,Bu,new WeakSet),lo);const RH="4.10.38",LH="f9bea397f";function EL(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function oy(p){return Math.max(0,Math.min(255,255*p))}let SL=class{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=oy(t),[t,t,t]}static G_HTML([t]){const e=EL(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(oy)}static RGB_HTML(t){return`#${t.map(EL).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[oy(1-Math.min(1,t+i)),oy(1-Math.min(1,n+i)),oy(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,s=1-e,o=1-n,l=Math.min(i,s,o);return["CMYK",i,s,o,l]}},MH=class{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){we("Abstract method `_createSVG` called.")}},XT=class extends MH{_createSVG(t){return document.createElementNS(To,t)}},DD=class{static setupStorage(t,e,n,i,s){const o=i.getValue(e,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?t.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const l of n.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const h=l.target.options,u=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:s}){const{attributes:o}=e,l=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[h,u]of Object.entries(o))if(u!=null)switch(h){case"class":u.length&&t.setAttribute(h,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,u)}l&&s.addLinkAttributes(t,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(t,o.dataId,e,n)}static render(t){var g,m;const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:n});const l=s!=="richText",h=t.div;if(h.append(o),t.viewport){const A=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=A}l&&h.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const A=document.createTextNode(i.value);o.append(A),l&&qx.shouldBuildText(i.name)&&u.push(A)}return{textDivs:u}}const f=[[i,-1,o]];for(;f.length>0;){const[A,_,S]=f.at(-1);if(_+1===A.children.length){f.pop();continue}const C=A.children[++f.at(-1)[1]];if(C===null)continue;const{name:T}=C;if(T==="#text"){const P=document.createTextNode(C.value);u.push(P),S.append(P);continue}const k=(g=C==null?void 0:C.attributes)!=null&&g.xmlns?document.createElementNS(C.attributes.xmlns,T):document.createElement(T);if(S.append(k),C.attributes&&this.setAttributes({html:k,element:C,storage:e,intent:s,linkService:n}),((m=C.children)==null?void 0:m.length)>0)f.push([C,-1,k]);else if(C.value){const P=document.createTextNode(C.value);l&&qx.shouldBuildText(T)&&u.push(P),k.append(P)}}for(const A of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}};const Gb=1e3,IH=9,uf=new WeakSet;function Eh(p){return{width:p[2]-p[0],height:p[3]-p[1]}}let DH=class{static create(t){switch(t.data.annotationType){case mn.LINK:return new FD(t);case mn.TEXT:return new FH(t);case mn.WIDGET:switch(t.data.fieldType){case"Tx":return new OH(t);case"Btn":return t.data.radioButton?new $D(t):t.data.checkBox?new $H(t):new jH(t);case"Ch":return new HH(t);case"Sig":return new NH(t)}return new vf(t);case mn.POPUP:return new Kx(t);case mn.FREETEXT:return new UD(t);case mn.LINE:return new zH(t);case mn.SQUARE:return new UH(t);case mn.CIRCLE:return new GH(t);case mn.POLYLINE:return new GD(t);case mn.CARET:return new VH(t);case mn.INK:return new YT(t);case mn.POLYGON:return new WH(t);case mn.HIGHLIGHT:return new WD(t);case mn.UNDERLINE:return new qH(t);case mn.SQUIGGLY:return new XH(t);case mn.STRIKEOUT:return new YH(t);case mn.STAMP:return new VD(t);case mn.FILEATTACHMENT:return new KH(t);default:return new Tn(t)}}};var zu,zp,Up,qv,Yx,Gp;let Tn=(Gp=class{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){E(this,qv);E(this,zu,null);E(this,zp,!1);E(this,Up,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t!=null&&t.str||e!=null&&e.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Gp._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;r(this,zu)||v(this,zu,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&b(this,qv,Yx).call(this,e),(n=r(this,Up))==null||n.popup.updateEdited(t)}resetEdited(){var t;r(this,zu)&&(b(this,qv,Yx).call(this,r(this,zu).rect),(t=r(this,Up))==null||t.popup.resetEdited(),v(this,zu,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof vf||(s.tabIndex=Gb);const{style:o}=s;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Kx){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:l,height:h}=Eh(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;o.borderRadius=k}else if(this instanceof $D){const k=`calc(${l}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;o.borderRadius=k}switch(e.borderStyle.style){case sy.SOLID:o.borderStyle="solid";break;case sy.DASHED:o.borderStyle="dashed";break;case sy.BEVELED:Ut("Unimplemented border style: beveled");break;case sy.INSET:Ut("Unimplemented border style: inset");break;case sy.UNDERLINE:o.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(v(this,zp,!0),o.borderColor=Pt.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const u=Pt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:f,pageHeight:g,pageX:m,pageY:A}=i.rawDims;o.left=`${100*(u[0]-m)/f}%`,o.top=`${100*(u[1]-A)/g}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(o.width=`${100*l/f}%`,o.height=`${100*h/g}%`):this.setRotation(_,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:o}=Eh(this.data.rect);let l,h;t%180===0?(l=100*s/n,h=100*o/i):(l=100*o/n,h=100*s/i),e.style.width=`${l}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const s=i.detail[e],o=s[0],l=s.slice(1);i.target.style[n]=SL[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:SL[`${o}_rgb`](l)})};return Yt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const o=n[i];if(o){const l={detail:{[i]:s},target:t};o(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,T,k]=t.subarray(2,6);if(i===S&&s===C&&e===T&&n===k)return}const{style:o}=this.container;let l;if(r(this,zp)){const{borderColor:S,borderWidth:C}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=i-e,u=s-n,{svgFactory:f}=this,g=f.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const m=f.createElement("defs");g.append(m);const A=f.createElement("clipPath"),_=`clippath_${this.data.id}`;A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),m.append(A);for(let S=2,C=t.length;S<C;S+=8){const T=t[S],k=t[S+1],P=t[S+2],L=t[S+3],I=f.createElement("rect"),D=(P-e)/h,F=(s-k)/u,H=(T-P)/h,j=(k-L)/u;I.setAttribute("x",D),I.setAttribute("y",F),I.setAttribute("width",H),I.setAttribute("height",j),A.append(I),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${F}" width="${H}" height="${j}"/>`)}r(this,zp)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(g),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,e=v(this,Up,new Kx({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){we("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:o,exportValues:l}of i){if(s===-1||o===e)continue;const h=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!uf.has(u)){Ut(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:h,domElement:u})}return n}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==e&&uf.has(i)&&n.push({id:o,exportValue:s,domElement:i})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}},zu=new WeakMap,zp=new WeakMap,Up=new WeakMap,qv=new WeakSet,Yx=function(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}}}=this;n==null||n.splice(0,4,...t);const{width:u,height:f}=Eh(t);e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(o-t[3]+h)/o}%`,i===0?(e.width=`${100*u/s}%`,e.height=`${100*f/o}%`):this.setRotation(i)},Gp);var zs,Kh,OD,ND,fI;let FD=(fI=class extends Tn{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});E(this,zs);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(n.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(b(this,zs,OD).call(this,i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(b(this,zs,ND).call(this,i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&b(this,zs,Kh).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),b(this,zs,Kh).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=i.get(s);o&&(e[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),b(this,zs,Kh).call(this)}_bindResetFormAction(e,n){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),b(this,zs,Kh).call(this),!this._fieldObjects){Ut('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var g;i==null||i();const{fields:s,refs:o,include:l}=n,h=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const A of s){const _=this._fieldObjects[A]||[];for(const{id:S}of _)m.add(S)}for(const A of Object.values(this._fieldObjects))for(const _ of A)m.has(_.id)===l&&h.push(_)}else for(const m of Object.values(this._fieldObjects))h.push(...m);const u=this.annotationStorage,f=[];for(const m of h){const{id:A}=m;switch(f.push(A),m.type){case"text":{const S=m.defaultValue||"";u.setValue(A,{value:S});break}case"checkbox":case"radiobutton":{const S=m.defaultValue===m.exportValues;u.setValue(A,{value:S});break}case"combobox":case"listbox":{const S=m.defaultValue||"";u.setValue(A,{value:S});break}default:continue}const _=document.querySelector(`[data-element-id="${A}"]`);if(_){if(!uf.has(_)){Ut(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;_.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}})),!1}}},zs=new WeakSet,Kh=function(){this.container.setAttribute("data-internal-link","")},OD=function(e,n,i=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},b(this,zs,Kh).call(this)},ND=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),b(this,zs,Kh).call(this)},fI),FH=class extends Tn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}},vf=class extends Tn{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Hi.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(n,o=>{var l;if(n==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}s&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(t,e,n,i){var s,o,l;for(const[h,u]of n)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Pt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||IH,s=t.style;let o;const l=2,h=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),f=Math.round(u/(M1*i))||1,g=u/f;o=Math.min(i,h(g/M1))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,h(u/M1))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=Pt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}},OH=class extends vf{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=n),s.setValue(o.id,{[i]:n})}render(){var i,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let l=o.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&l.length>h&&(l=l.slice(0,h));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const f={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",u??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),uf.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Gb,this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",m=>{t.setValue(e,{value:m.target.value}),this.setPropertyOnSiblings(n,"value",m.target.value,"value"),f.formattedValue=null}),n.addEventListener("resetform",m=>{const A=this.data.defaultFieldValue??"";n.value=f.userValue=A,f.formattedValue=null});let g=m=>{const{formattedValue:A}=f;A!=null&&(m.target.value=A),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",A=>{var S;if(f.focused)return;const{target:_}=A;f.userValue&&(_.value=f.userValue),f.lastCommittedValue=_.value,f.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(f.focused=!0)}),n.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const _={value(S){f.userValue=S.detail.value??"",t.setValue(e,{value:f.userValue.toString()}),S.target.value=f.userValue},formattedValue(S){const{formattedValue:C}=S.detail;f.formattedValue=C,C!=null&&S.target!==document.activeElement&&(S.target.value=C),t.setValue(e,{formattedValue:C})},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:C}=S.detail,{target:T}=S;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let k=f.userValue;!k||k.length<=C||(k=k.slice(0,C),T.value=f.userValue=k,t.setValue(e,{value:k}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(_,A)}),n.addEventListener("keydown",A=>{var C;f.commitKey=1;let _=-1;if(A.key==="Escape"?_=0:A.key==="Enter"&&!this.data.multiLine?_=2:A.key==="Tab"&&(f.commitKey=3),_===-1)return;const{value:S}=A.target;f.lastCommittedValue!==S&&(f.lastCommittedValue=S,f.userValue=S,(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:_,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const m=g;g=null,n.addEventListener("blur",A=>{var S,C;if(!f.focused||!A.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(f.focused=!1);const{value:_}=A.target;f.userValue=_,f.lastCommittedValue!==_&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:f.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}})),m(A)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",A=>{var I;f.lastCommittedValue=null;const{data:_,target:S}=A,{value:C,selectionStart:T,selectionEnd:k}=S;let P=T,L=k;switch(A.inputType){case"deleteWordBackward":{const D=C.substring(0,T).match(/\w*[^\w]*$/);D&&(P-=D[0].length);break}case"deleteWordForward":{const D=C.substring(T).match(/^[^\w]*\w*/);D&&(L+=D[0].length);break}case"deleteContentBackward":T===k&&(P-=1);break;case"deleteContentForward":T===k&&(L+=1);break}A.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:_||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(g&&n.addEventListener("blur",g),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${A}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},NH=class extends vf{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}},$H=class extends vf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return uf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=Gb,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const u of this._getElementsByName(l,n)){const f=h&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=f),t.setValue(u.id,{value:f})}t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue||"Off";o.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const l={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},$D=class extends vf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,n))t.setValue(o.id,{value:!1});const s=document.createElement("input");if(uf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=Gb,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const u of this._getElementsByName(l,n))t.setValue(u.id,{value:!1});t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue;o.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const h={value:u=>{const f=o===u.detail.value;for(const g of this._getElementsByName(u.target.name)){const m=f&&g.id===n;g.domElement&&(g.domElement.checked=m),t.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},jH=class extends FD{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}},HH=class extends vf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");uf.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Gb;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===g});for(const f of this.data.options){const g=document.createElement("option");g.textContent=f.displayValue,g.value=f.exportValue,n.value.includes(f.exportValue)&&(g.setAttribute("selected",!0),s=!1),i.append(g)}let o=null;if(s){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),i.prepend(f),o=()=>{f.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=f=>{const g=f?"value":"textContent",{options:m,multiple:A}=i;return A?Array.prototype.filter.call(m,_=>_.selected).map(_=>_[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let h=l(!1);const u=f=>{const g=f.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",f=>{const g={value(m){o==null||o();const A=m.detail.value,_=new Set(Array.isArray(A)?A:[A]);for(const S of i.options)S.selected=_.has(S.value);t.setValue(e,{value:l(!0)}),h=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const A=i.options,_=m.detail.remove;A[_].selected=!1,i.remove(_),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=l(!1)},insert(m){const{index:A,displayValue:_,exportValue:S}=m.detail.insert,C=i.children[A],T=document.createElement("option");T.textContent=_,T.value=S,C?C.before(T):i.append(T),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},items(m){const{items:A}=m.detail;for(;i.length!==0;)i.remove(0);for(const _ of A){const{displayValue:S,exportValue:C}=_,T=document.createElement("option");T.textContent=S,T.value=C,i.append(T)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},indices(m){const A=new Set(m.detail.indices);for(const _ of m.target.options)_.selected=A.has(_.index);t.setValue(e,{value:l(!0)}),h=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,f)}),i.addEventListener("input",f=>{var A;const g=l(!0),m=l(!1);t.setValue(e,{value:g}),f.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):i.addEventListener("input",function(f){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},Kx=class extends Tn{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Tn._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new BH({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(n=>`${BT}${n}`).join(",")),this.container}};var Wp,sE,rE,Vp,Uu,Ve,qo,qp,Xv,Yv,Xp,Xo,zr,Yo,Kv,Ko,Qv,Gu,Wu,Ae,Y_,Qx,jD,HD,BD,zD,K_,Q_,Jx,pI;let BH=(pI=class{constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:h,rect:u,parentRect:f,open:g}){E(this,Ae);E(this,Wp,b(this,Ae,BD).bind(this));E(this,sE,b(this,Ae,Jx).bind(this));E(this,rE,b(this,Ae,Q_).bind(this));E(this,Vp,b(this,Ae,K_).bind(this));E(this,Uu,null);E(this,Ve,null);E(this,qo,null);E(this,qp,null);E(this,Xv,null);E(this,Yv,null);E(this,Xp,null);E(this,Xo,!1);E(this,zr,null);E(this,Yo,null);E(this,Kv,null);E(this,Ko,null);E(this,Qv,null);E(this,Gu,null);E(this,Wu,!1);var m;v(this,Ve,t),v(this,Qv,i),v(this,qo,o),v(this,Ko,l),v(this,Yv,h),v(this,Uu,e),v(this,Kv,u),v(this,Xp,f),v(this,Xv,n),v(this,qp,LI.toDateObject(s)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup());for(const A of this.trigger)A.addEventListener("click",r(this,Vp)),A.addEventListener("mouseenter",r(this,rE)),A.addEventListener("mouseleave",r(this,sE)),A.classList.add("popupTriggerArea");for(const A of n)(m=A.container)==null||m.addEventListener("keydown",r(this,Wp));r(this,Ve).hidden=!0,g&&b(this,Ae,K_).call(this)}render(){if(r(this,zr))return;const t=v(this,zr,document.createElement("div"));if(t.className="popup",r(this,Uu)){const s=t.style.outlineColor=Pt.makeHexColor(...r(this,Uu));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=Pt.makeHexColor(...r(this,Uu).map(l=>Math.floor(.7*(255-l)+l)))}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=r(this,Qv),t.append(e),r(this,qp)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,qp).valueOf()})),e.append(s)}const i=r(this,Ae,Y_);if(i)DD.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(r(this,qo));t.append(s)}r(this,Ve).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){const l=i[s];n.append(document.createTextNode(l)),s<o-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;r(this,Gu)||v(this,Gu,{contentsObj:r(this,qo),richText:r(this,Ko)}),t&&v(this,Yo,null),e&&(v(this,Ko,b(this,Ae,HD).call(this,e)),v(this,qo,null)),(n=r(this,zr))==null||n.remove(),v(this,zr,null)}resetEdited(){var t;r(this,Gu)&&({contentsObj:le(this,qo)._,richText:le(this,Ko)._}=r(this,Gu),v(this,Gu,null),(t=r(this,zr))==null||t.remove(),v(this,zr,null),v(this,Yo,null))}forceHide(){v(this,Wu,this.isVisible),r(this,Wu)&&(r(this,Ve).hidden=!0)}maybeShow(){r(this,Wu)&&(r(this,zr)||b(this,Ae,Q_).call(this),v(this,Wu,!1),r(this,Ve).hidden=!1)}get isVisible(){return r(this,Ve).hidden===!1}},Wp=new WeakMap,sE=new WeakMap,rE=new WeakMap,Vp=new WeakMap,Uu=new WeakMap,Ve=new WeakMap,qo=new WeakMap,qp=new WeakMap,Xv=new WeakMap,Yv=new WeakMap,Xp=new WeakMap,Xo=new WeakMap,zr=new WeakMap,Yo=new WeakMap,Kv=new WeakMap,Ko=new WeakMap,Qv=new WeakMap,Gu=new WeakMap,Wu=new WeakMap,Ae=new WeakSet,Y_=function(){const t=r(this,Ko),e=r(this,qo);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,Ko).html||null},Qx=function(){var t,e,n;return((n=(e=(t=r(this,Ae,Y_))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},jD=function(){var t,e,n;return((n=(e=(t=r(this,Ae,Y_))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},HD=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:r(this,Ae,jD),fontSize:r(this,Ae,Qx)?`calc(${r(this,Ae,Qx)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return n},BD=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,Xo))&&b(this,Ae,K_).call(this)},zD=function(){if(r(this,Yo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=r(this,Yv);let o=!!r(this,Xp),l=o?r(this,Xp):r(this,Kv);for(const _ of r(this,Xv))if(!l||Pt.intersect(_.data.rect,l)!==null){l=_.data.rect,o=!0;break}const h=Pt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),f=o?l[2]-l[0]+5:0,g=h[0]+f,m=h[1];v(this,Yo,[100*(g-i)/e,100*(m-s)/n]);const{style:A}=r(this,Ve);A.left=`${r(this,Yo)[0]}%`,A.top=`${r(this,Yo)[1]}%`},K_=function(){v(this,Xo,!r(this,Xo)),r(this,Xo)?(b(this,Ae,Q_).call(this),r(this,Ve).addEventListener("click",r(this,Vp)),r(this,Ve).addEventListener("keydown",r(this,Wp))):(b(this,Ae,Jx).call(this),r(this,Ve).removeEventListener("click",r(this,Vp)),r(this,Ve).removeEventListener("keydown",r(this,Wp)))},Q_=function(){r(this,zr)||this.render(),this.isVisible?r(this,Xo)&&r(this,Ve).classList.add("focused"):(b(this,Ae,zD).call(this),r(this,Ve).hidden=!1,r(this,Ve).style.zIndex=parseInt(r(this,Ve).style.zIndex)+1e3)},Jx=function(){r(this,Ve).classList.remove("focused"),!(r(this,Xo)||!this.isVisible)&&(r(this,Ve).hidden=!0,r(this,Ve).style.zIndex=parseInt(r(this,Ve).style.zIndex)-1e3)},pI),UD=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Bt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}};var Jv,gI;let zH=(gI=class extends Tn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,Jv,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:i}=Eh(e.rect),s=this.svgFactory.create(n,i,!0),o=v(this,Jv,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,Jv)}addHighlightArea(){this.container.classList.add("highlightArea")}},Jv=new WeakMap,gI);var Zv,mI;let UH=(mI=class extends Tn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,Zv,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:i}=Eh(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,Zv,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",n-o),l.setAttribute("height",i-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,Zv)}addHighlightArea(){this.container.classList.add("highlightArea")}},Zv=new WeakMap,mI);var tA,yI;let GH=(yI=class extends Tn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,tA,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:i}=Eh(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,tA,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",n/2),l.setAttribute("cy",i/2),l.setAttribute("rx",n/2-o/2),l.setAttribute("ry",i/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,tA)}addHighlightArea(){this.container.classList.add("highlightArea")}},tA=new WeakMap,yI);var eA,vI;let GD=(vI=class extends Tn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,eA,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:i,popupRef:s}}=this;if(!n)return this.container;const{width:o,height:l}=Eh(e),h=this.svgFactory.create(o,l,!0);let u=[];for(let g=0,m=n.length;g<m;g+=2){const A=n[g]-e[0],_=e[3]-n[g+1];u.push(`${A},${_}`)}u=u.join(" ");const f=v(this,eA,this.svgFactory.createElement(this.svgElementName));return f.setAttribute("points",u),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),h.append(f),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,eA)}addHighlightArea(){this.container.classList.add("highlightArea")}},eA=new WeakMap,vI),WH=class extends GD{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},VH=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}};var nA,Vu,iA,Zx,AI;let YT=(AI=class extends Tn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,iA);E(this,nA,null);E(this,Vu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Bt.HIGHLIGHT:Bt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:i,borderStyle:s,popupRef:o}}=this,{transform:l,width:h,height:u}=b(this,iA,Zx).call(this,n,e),f=this.svgFactory.create(h,u,!0),g=v(this,nA,this.svgFactory.createElement("svg:g"));f.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let m=0,A=i.length;m<A;m++){const _=this.svgFactory.createElement(this.svgElementName);r(this,Vu).push(_),_.setAttribute("points",i[m].join(",")),g.append(_)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:i,rect:s}=e,o=r(this,nA);if(n>=0&&o.setAttribute("stroke-width",n||1),i)for(let l=0,h=r(this,Vu).length;l<h;l++)r(this,Vu)[l].setAttribute("points",i[l].join(","));if(s){const{transform:l,width:h,height:u}=b(this,iA,Zx).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${h} ${u}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return r(this,Vu)}addHighlightArea(){this.container.classList.add("highlightArea")}},nA=new WeakMap,Vu=new WeakMap,iA=new WeakSet,Zx=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}},AI),WD=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Bt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},qH=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},XH=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},YH=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},VD=class extends Tn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Bt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}};var sA,rA,tC,bI;let KH=(bI=class extends Tn{constructor(e){var i;super(e,{isRenderable:!0});E(this,rA);E(this,sA,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",b(this,rA,tC).bind(this)),v(this,sA,i);const{isMac:s}=Hi.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&b(this,rA,tC).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return r(this,sA)}addHighlightArea(){this.container.classList.add("highlightArea")}},sA=new WeakMap,rA=new WeakSet,tC=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)},bI);var aA,qu,Xu,oA,gf,qD,eC,_I;let QH=(_I=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:l}){E(this,gf);E(this,aA,null);E(this,qu,null);E(this,Xu,new Map);E(this,oA,null);this.div=t,v(this,aA,e),v(this,qu,n),v(this,oA,l||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return r(this,Xu).size>0}async render(t){var o;const{annotations:e}=t,n=this.div;hf(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new XT,annotationStorage:t.annotationStorage||new VT,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const h=l.annotationType===mn.POPUP;if(h){const g=i.get(l.id);if(!g)continue;s.elements=g}else{const{width:g,height:m}=Eh(l.rect);if(g<=0||m<=0)continue}s.data=l;const u=DH.create(s);if(!u.isRenderable)continue;if(!h&&l.popupRef){const g=i.get(l.popupRef);g?g.push(u):i.set(l.popupRef,[u])}const f=u.render();l.hidden&&(f.style.visibility="hidden"),await b(this,gf,qD).call(this,f,l.id),u._isEditable&&(r(this,Xu).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}b(this,gf,eC).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,hf(e,{rotation:t.rotation}),b(this,gf,eC).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,Xu).values())}getEditableAnnotation(t){return r(this,Xu).get(t)}},aA=new WeakMap,qu=new WeakMap,Xu=new WeakMap,oA=new WeakMap,gf=new WeakSet,qD=async function(t,e){var o,l;const n=t.firstChild||t,i=n.id=`${BT}${e}`,s=await((o=r(this,oA))==null?void 0:o.getAriaAttributes(i));if(s)for(const[h,u]of s)n.setAttribute(h,u);this.div.append(t),(l=r(this,aA))==null||l.moveElementInDOM(this.div,t,n,!1)},eC=function(){if(!r(this,qu))return;const t=this.div;for(const[e,n]of r(this,qu)){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n)}r(this,qu).clear()},_I);const h_=/\r\n?|\n/g;var Ur,Ss,lA,Yu,xs,pe,dn,XD,YD,KD,J_,Il,Z_,tw,QD,nC,JD;let JH=(pe=class extends nn{constructor(e){super({...e,name:"freeTextEditor"});E(this,dn);E(this,Ur);E(this,Ss,"");E(this,lA,`${this.id}-editor`);E(this,Yu,null);E(this,xs);v(this,Ur,e.color||pe._defaultColor||nn._defaultLineColor),v(this,xs,e.fontSize||pe._defaultFontSize)}static get _keyboardManager(){const e=pe.prototype,n=o=>o.isEmpty(),i=ev.TRANSLATE_SMALL,s=ev.TRANSLATE_BIG;return Yt(this,"_keyboardManager",new Ub([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(e,n){nn.initialize(e,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Jt.FREETEXT_SIZE:pe._defaultFontSize=n;break;case Jt.FREETEXT_COLOR:pe._defaultColor=n;break}}updateParams(e,n){switch(e){case Jt.FREETEXT_SIZE:b(this,dn,XD).call(this,n);break;case Jt.FREETEXT_COLOR:b(this,dn,YD).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Jt.FREETEXT_SIZE,pe._defaultFontSize],[Jt.FREETEXT_COLOR,pe._defaultColor||nn._defaultLineColor]]}get propertiesToUpdate(){return[[Jt.FREETEXT_SIZE,r(this,xs)],[Jt.FREETEXT_COLOR,r(this,Ur)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-pe._internalPadding*e,-(pe._internalPadding+r(this,xs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Bt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,Yu,new AbortController);const e=this._uiManager.combinedSignal(r(this,Yu));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,lA)),this._isDraggable=!0,(e=r(this,Yu))==null||e.abort(),v(this,Yu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Ss),n=v(this,Ss,b(this,dn,KD).call(this).trimEnd());if(e===n)return;const i=s=>{if(v(this,Ss,s),!s){this.remove();return}b(this,dn,tw).call(this),this._uiManager.rebuild(this),b(this,dn,J_).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(e)},mustExec:!1}),b(this,dn,J_).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){pe._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,lA)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${r(this,xs)}px * var(--scale-factor))`,i.color=r(this,Ur),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Bw(this,this.div,["dblclick","keydown"]),this.width){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[h,u]=this.getInitialTranslation();[h,u]=this.pageTranslationToScreen(h,u);const[f,g]=this.pageDimensions,[m,A]=this.pageTranslation;let _,S;switch(this.rotation){case 0:_=e+(l[0]-m)/f,S=n+this.height-(l[1]-A)/g;break;case 90:_=e+(l[0]-m)/f,S=n-(l[1]-A)/g,[h,u]=[u,-h];break;case 180:_=e-this.width+(l[0]-m)/f,S=n-(l[1]-A)/g,[h,u]=[-h,-u];break;case 270:_=e+(l[0]-m-this.height*g)/f,S=n+(l[1]-A-this.width*f)/g,[h,u]=[-u,h];break}this.setAt(_*s,S*o,h,u)}else this.setAt(e*s,n*o,this.width*s,this.height*o);b(this,dn,tw).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var _,S,C;const n=e.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const s=b(_=pe,Il,nC).call(_,n.getData("text")||"").replaceAll(h_,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:h,startOffset:u}=l,f=[],g=[];if(h.nodeType===Node.TEXT_NODE){const T=h.parentElement;if(g.push(h.nodeValue.slice(u).replaceAll(h_,"")),T!==this.editorDiv){let k=f;for(const P of this.editorDiv.childNodes){if(P===T){k=g;continue}k.push(b(S=pe,Il,Z_).call(S,P))}}f.push(h.nodeValue.slice(0,u).replaceAll(h_,""))}else if(h===this.editorDiv){let T=f,k=0;for(const P of this.editorDiv.childNodes)k++===u&&(T=g),T.push(b(C=pe,Il,Z_).call(C,P))}v(this,Ss,`${f.join(`
`)}${s}${g.join(`
`)}`),b(this,dn,tw).call(this);const m=new Range;let A=f.reduce((T,k)=>T+k.length,0);for(const{firstChild:T}of this.editorDiv.childNodes)if(T.nodeType===Node.TEXT_NODE){const k=T.nodeValue.length;if(A<=k){m.setStart(T,A),m.setEnd(T,A);break}A-=k}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,i){var l;let s=null;if(e instanceof UD){const{data:{defaultAppearanceData:{fontSize:h,fontColor:u},rect:f,rotation:g,id:m,popupRef:A},textContent:_,textPosition:S,parent:{page:{pageNumber:C}}}=e;if(!_||_.length===0)return null;s=e={annotationType:Bt.FREETEXT,color:Array.from(u),fontSize:h,value:_.join(`
`),position:S,pageIndex:C-1,rect:f.slice(0),rotation:g,id:m,deleted:!1,popupRef:A}}const o=await super.deserialize(e,n,i);return v(o,xs,e.fontSize),v(o,Ur,Pt.makeHexColor(...e.color)),v(o,Ss,b(l=pe,Il,nC).call(l,e.value)),o.annotationElementId=e.id||null,o._initialData=s,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=pe._internalPadding*this.parentScale,i=this.getRect(n,n),s=nn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Ur)),o={annotationType:Bt.FREETEXT,color:s,fontSize:r(this,xs),value:b(this,dn,QD).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!b(this,dn,JD).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${r(this,xs)}px * var(--scale-factor))`,i.color=r(this,Ur),n.replaceChildren();for(const o of r(this,Ss).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}const s=pe._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:r(this,Ss)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},Ur=new WeakMap,Ss=new WeakMap,lA=new WeakMap,Yu=new WeakMap,xs=new WeakMap,dn=new WeakSet,XD=function(e){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-r(this,xs))*this.parentScale),v(this,xs,s),b(this,dn,J_).call(this)},i=r(this,xs);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Jt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},YD=function(e){const n=s=>{v(this,Ur,this.editorDiv.style.color=s)},i=r(this,Ur);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Jt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},KD=function(){var i;const e=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(b(i=pe,Il,Z_).call(i,s)),n=s);return e.join(`
`)},J_=function(){const[e,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,h=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/n):(this.width=i.height/e,this.height=i.width/n),this.fixAndSetPosition()},Il=new WeakSet,Z_=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(h_,"")},tw=function(){if(this.editorDiv.replaceChildren(),!!r(this,Ss))for(const e of r(this,Ss).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},QD=function(){return r(this,Ss).replaceAll(""," ")},nC=function(e){return e.replaceAll(" ","")},JD=function(e){const{value:n,fontSize:i,color:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==i||e.color.some((l,h)=>l!==s[h])||e.pageIndex!==o},E(pe,Il),lt(pe,"_freeTextDefaultContent",""),lt(pe,"_internalPadding",0),lt(pe,"_defaultColor",null),lt(pe,"_defaultFontSize",10),lt(pe,"_type","freetext"),lt(pe,"_editorType",Bt.FREETEXT),pe);var mx;let wt=(mx=class{toSVGPath(){we("Abstract method `toSVGPath` must be implemented.")}get box(){we("Abstract getter `box` must be implemented.")}serialize(t,e){we("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,s,o){o||(o=new Float32Array(t.length));for(let l=0,h=t.length;l<h;l+=2)o[l]=e+t[l]*i,o[l+1]=n+t[l+1]*s;return o}static _rescaleAndSwap(t,e,n,i,s,o){o||(o=new Float32Array(t.length));for(let l=0,h=t.length;l<h;l+=2)o[l]=e+t[l+1]*i,o[l+1]=n+t[l]*s;return o}static _translate(t,e,n,i){i||(i=new Float32Array(t.length));for(let s=0,o=t.length;s<o;s+=2)i[s]=e+t[s],i[s+1]=n+t[s+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,i,s){switch(s){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,s,o){return[(t+5*n)/6,(e+5*i)/6,(5*n+s)/6,(5*i+o)/6,(n+s)/2,(i+o)/2]}},lt(mx,"PRECISION",1e-4),mx);var Cs,Gr,Yp,Kp,Oa,qt,Ku,Qu,cA,hA,Qp,Jp,$c,pr,uA,aE,oE,xn,ky,tF,eF,nF,iF,sF,rF;let ZD=(pr=class{constructor({x:t,y:e},n,i,s,o,l=0){E(this,xn);E(this,Cs);E(this,Gr,[]);E(this,Yp);E(this,Kp);E(this,Oa,[]);E(this,qt,new Float32Array(18));E(this,Ku);E(this,Qu);E(this,cA);E(this,hA);E(this,Qp);E(this,Jp);E(this,$c,[]);v(this,Cs,n),v(this,Jp,s*i),v(this,Kp,o),r(this,qt).set([NaN,NaN,NaN,NaN,t,e],6),v(this,Yp,l),v(this,hA,r(pr,uA)*i),v(this,cA,r(pr,oE)*i),v(this,Qp,i),r(this,$c).push(t,e)}isEmpty(){return isNaN(r(this,qt)[8])}add({x:t,y:e}){var j;v(this,Ku,t),v(this,Qu,e);const[n,i,s,o]=r(this,Cs);let[l,h,u,f]=r(this,qt).subarray(8,12);const g=t-u,m=e-f,A=Math.hypot(g,m);if(A<r(this,cA))return!1;const _=A-r(this,hA),S=_/A,C=S*g,T=S*m;let k=l,P=h;l=u,h=f,u+=C,f+=T,(j=r(this,$c))==null||j.push(t,e);const L=-T/_,I=C/_,D=L*r(this,Jp),F=I*r(this,Jp);return r(this,qt).set(r(this,qt).subarray(2,8),0),r(this,qt).set([u+D,f+F],4),r(this,qt).set(r(this,qt).subarray(14,18),12),r(this,qt).set([u-D,f-F],16),isNaN(r(this,qt)[6])?(r(this,Oa).length===0&&(r(this,qt).set([l+D,h+F],2),r(this,Oa).push(NaN,NaN,NaN,NaN,(l+D-n)/s,(h+F-i)/o),r(this,qt).set([l-D,h-F],14),r(this,Gr).push(NaN,NaN,NaN,NaN,(l-D-n)/s,(h-F-i)/o)),r(this,qt).set([k,P,l,h,u,f],6),!this.isEmpty()):(r(this,qt).set([k,P,l,h,u,f],6),Math.abs(Math.atan2(P-h,k-l)-Math.atan2(T,C))<Math.PI/2?([l,h,u,f]=r(this,qt).subarray(2,6),r(this,Oa).push(NaN,NaN,NaN,NaN,((l+u)/2-n)/s,((h+f)/2-i)/o),[l,h,k,P]=r(this,qt).subarray(14,18),r(this,Gr).push(NaN,NaN,NaN,NaN,((k+l)/2-n)/s,((P+h)/2-i)/o),!0):([k,P,l,h,u,f]=r(this,qt).subarray(0,6),r(this,Oa).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+u)/6-n)/s,((5*h+f)/6-i)/o,((l+u)/2-n)/s,((h+f)/2-i)/o),[u,f,l,h,k,P]=r(this,qt).subarray(12,18),r(this,Gr).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+u)/6-n)/s,((5*h+f)/6-i)/o,((l+u)/2-n)/s,((h+f)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,Oa),e=r(this,Gr);if(isNaN(r(this,qt)[6])&&!this.isEmpty())return b(this,xn,tF).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);b(this,xn,nF).call(this,n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return b(this,xn,eF).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,i,s,o){return new aF(t,e,n,i,s,o)}getOutlines(){var g;const t=r(this,Oa),e=r(this,Gr),n=r(this,qt),[i,s,o,l]=r(this,Cs),h=new Float32Array((((g=r(this,$c))==null?void 0:g.length)??0)+2);for(let m=0,A=h.length-2;m<A;m+=2)h[m]=(r(this,$c)[m]-i)/o,h[m+1]=(r(this,$c)[m+1]-s)/l;if(h[h.length-2]=(r(this,Ku)-i)/o,h[h.length-1]=(r(this,Qu)-s)/l,isNaN(n[6])&&!this.isEmpty())return b(this,xn,iF).call(this,h);const u=new Float32Array(r(this,Oa).length+24+r(this,Gr).length);let f=t.length;for(let m=0;m<f;m+=2){if(isNaN(t[m])){u[m]=u[m+1]=NaN;continue}u[m]=t[m],u[m+1]=t[m+1]}f=b(this,xn,rF).call(this,u,f);for(let m=e.length-6;m>=6;m-=6)for(let A=0;A<6;A+=2){if(isNaN(e[m+A])){u[f]=u[f+1]=NaN,f+=2;continue}u[f]=e[m+A],u[f+1]=e[m+A+1],f+=2}return b(this,xn,sF).call(this,u,f),this.newFreeDrawOutline(u,h,r(this,Cs),r(this,Qp),r(this,Yp),r(this,Kp))}},Cs=new WeakMap,Gr=new WeakMap,Yp=new WeakMap,Kp=new WeakMap,Oa=new WeakMap,qt=new WeakMap,Ku=new WeakMap,Qu=new WeakMap,cA=new WeakMap,hA=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,$c=new WeakMap,uA=new WeakMap,aE=new WeakMap,oE=new WeakMap,xn=new WeakSet,ky=function(){const t=r(this,qt).subarray(4,6),e=r(this,qt).subarray(16,18),[n,i,s,o]=r(this,Cs);return[(r(this,Ku)+(t[0]-e[0])/2-n)/s,(r(this,Qu)+(t[1]-e[1])/2-i)/o,(r(this,Ku)+(e[0]-t[0])/2-n)/s,(r(this,Qu)+(e[1]-t[1])/2-i)/o]},tF=function(){const[t,e,n,i]=r(this,Cs),[s,o,l,h]=b(this,xn,ky).call(this);return`M${(r(this,qt)[2]-t)/n} ${(r(this,qt)[3]-e)/i} L${(r(this,qt)[4]-t)/n} ${(r(this,qt)[5]-e)/i} L${s} ${o} L${l} ${h} L${(r(this,qt)[16]-t)/n} ${(r(this,qt)[17]-e)/i} L${(r(this,qt)[14]-t)/n} ${(r(this,qt)[15]-e)/i} Z`},eF=function(t){const e=r(this,Gr);t.push(`L${e[4]} ${e[5]} Z`)},nF=function(t){const[e,n,i,s]=r(this,Cs),o=r(this,qt).subarray(4,6),l=r(this,qt).subarray(16,18),[h,u,f,g]=b(this,xn,ky).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-n)/s} L${h} ${u} L${f} ${g} L${(l[0]-e)/i} ${(l[1]-n)/s}`)},iF=function(t){const e=r(this,qt),[n,i,s,o]=r(this,Cs),[l,h,u,f]=b(this,xn,ky).call(this),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/o],0),this.newFreeDrawOutline(g,t,r(this,Cs),r(this,Qp),r(this,Yp),r(this,Kp))},sF=function(t,e){const n=r(this,Gr);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},rF=function(t,e){const n=r(this,qt).subarray(4,6),i=r(this,qt).subarray(16,18),[s,o,l,h]=r(this,Cs),[u,f,g,m]=b(this,xn,ky).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/l,(n[1]-o)/h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/h],e),e+=24},E(pr,uA,8),E(pr,aE,2),E(pr,oE,r(pr,uA)+r(pr,aE)),pr);var Zp,Ju,Qo,dA,Ts,fA,tn,lE,oF,wI;let aF=(wI=class extends wt{constructor(e,n,i,s,o,l){super();E(this,lE);E(this,Zp);E(this,Ju,new Float32Array(4));E(this,Qo);E(this,dA);E(this,Ts);E(this,fA);E(this,tn);v(this,tn,e),v(this,Ts,n),v(this,Zp,i),v(this,fA,s),v(this,Qo,o),v(this,dA,l),this.lastPoint=[NaN,NaN],b(this,lE,oF).call(this,l);const[h,u,f,g]=r(this,Ju);for(let m=0,A=e.length;m<A;m+=2)e[m]=(e[m]-h)/f,e[m+1]=(e[m+1]-u)/g;for(let m=0,A=n.length;m<A;m+=2)n[m]=(n[m]-h)/f,n[m+1]=(n[m+1]-u)/g}toSVGPath(){const e=[`M${r(this,tn)[4]} ${r(this,tn)[5]}`];for(let n=6,i=r(this,tn).length;n<i;n+=6){if(isNaN(r(this,tn)[n])){e.push(`L${r(this,tn)[n+4]} ${r(this,tn)[n+5]}`);continue}e.push(`C${r(this,tn)[n]} ${r(this,tn)[n+1]} ${r(this,tn)[n+2]} ${r(this,tn)[n+3]} ${r(this,tn)[n+4]} ${r(this,tn)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,i,s],o){const l=i-e,h=s-n;let u,f;switch(o){case 0:u=wt._rescale(r(this,tn),e,s,l,-h),f=wt._rescale(r(this,Ts),e,s,l,-h);break;case 90:u=wt._rescaleAndSwap(r(this,tn),e,n,l,h),f=wt._rescaleAndSwap(r(this,Ts),e,n,l,h);break;case 180:u=wt._rescale(r(this,tn),i,n,-l,h),f=wt._rescale(r(this,Ts),i,n,-l,h);break;case 270:u=wt._rescaleAndSwap(r(this,tn),i,s,-l,-h),f=wt._rescaleAndSwap(r(this,Ts),i,s,-l,-h);break}return{outline:Array.from(u),points:[Array.from(f)]}}get box(){return r(this,Ju)}newOutliner(e,n,i,s,o,l=0){return new ZD(e,n,i,s,o,l)}getNewOutline(e,n){const[i,s,o,l]=r(this,Ju),[h,u,f,g]=r(this,Zp),m=o*f,A=l*g,_=i*f+h,S=s*g+u,C=this.newOutliner({x:r(this,Ts)[0]*m+_,y:r(this,Ts)[1]*A+S},r(this,Zp),r(this,fA),e,r(this,dA),n??r(this,Qo));for(let T=2;T<r(this,Ts).length;T+=2)C.add({x:r(this,Ts)[T]*m+_,y:r(this,Ts)[T+1]*A+S});return C.getOutlines()}},Zp=new WeakMap,Ju=new WeakMap,Qo=new WeakMap,dA=new WeakMap,Ts=new WeakMap,fA=new WeakMap,tn=new WeakMap,lE=new WeakSet,oF=function(e){const n=r(this,tn);let i=n[4],s=n[5],o=i,l=s,h=i,u=s,f=i,g=s;const m=e?Math.max:Math.min;for(let _=6,S=n.length;_<S;_+=6){if(isNaN(n[_]))o=Math.min(o,n[_+4]),l=Math.min(l,n[_+5]),h=Math.max(h,n[_+4]),u=Math.max(u,n[_+5]),g<n[_+5]?(f=n[_+4],g=n[_+5]):g===n[_+5]&&(f=m(f,n[_+4]));else{const C=Pt.bezierBoundingBox(i,s,...n.slice(_,_+6));o=Math.min(o,C[0]),l=Math.min(l,C[1]),h=Math.max(h,C[2]),u=Math.max(u,C[3]),g<C[3]?(f=C[2],g=C[3]):g===C[3]&&(f=m(f,C[2]))}i=n[_+4],s=n[_+5]}const A=r(this,Ju);A[0]=o-r(this,Qo),A[1]=l-r(this,Qo),A[2]=h-o+2*r(this,Qo),A[3]=u-l+2*r(this,Qo),this.lastPoint=[f,g]},wI);var pA,gA,jc,Wr,Ui,lF,ew,cF,hF,sC,EI;let iC=(EI=class{constructor(t,e=0,n=0,i=!0){E(this,Ui);E(this,pA);E(this,gA);E(this,jc,[]);E(this,Wr,[]);let s=1/0,o=-1/0,l=1/0,h=-1/0;const u=10**-4;for(const{x:C,y:T,width:k,height:P}of t){const L=Math.floor((C-e)/u)*u,I=Math.ceil((C+k+e)/u)*u,D=Math.floor((T-e)/u)*u,F=Math.ceil((T+P+e)/u)*u,H=[L,D,F,!0],j=[I,D,F,!1];r(this,jc).push(H,j),s=Math.min(s,L),o=Math.max(o,I),l=Math.min(l,D),h=Math.max(h,F)}const f=o-s+2*n,g=h-l+2*n,m=s-n,A=l-n,_=r(this,jc).at(i?-1:-2),S=[_[0],_[2]];for(const C of r(this,jc)){const[T,k,P]=C;C[0]=(T-m)/f,C[1]=(k-A)/g,C[2]=(P-A)/g}v(this,pA,new Float32Array([m,A,f,g])),v(this,gA,S)}getOutlines(){r(this,jc).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of r(this,jc))e[3]?(t.push(...b(this,Ui,sC).call(this,e)),b(this,Ui,cF).call(this,e)):(b(this,Ui,hF).call(this,e),t.push(...b(this,Ui,sC).call(this,e)));return b(this,Ui,lF).call(this,t)}},pA=new WeakMap,gA=new WeakMap,jc=new WeakMap,Wr=new WeakMap,Ui=new WeakSet,lF=function(t){const e=[],n=new Set;for(const o of t){const[l,h,u]=o;e.push([l,h,o],[l,u,o])}e.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=e.length;o<l;o+=2){const h=e[o][2],u=e[o+1][2];h.push(u),u.push(h),n.add(h),n.add(u)}const i=[];let s;for(;n.size>0;){const o=n.values().next().value;let[l,h,u,f,g]=o;n.delete(o);let m=l,A=h;for(s=[l,u],i.push(s);;){let _;if(n.has(f))_=f;else if(n.has(g))_=g;else break;n.delete(_),[l,h,u,f,g]=_,m!==l&&(s.push(m,A,l,A===h?h:u),m=l),A=A===h?u:h}s.push(m,A)}return new ZH(i,r(this,pA),r(this,gA))},ew=function(t){const e=r(this,Wr);let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,o=e[s][0];if(o===t)return s;o<t?n=s+1:i=s-1}return i+1},cF=function([,t,e]){const n=b(this,Ui,ew).call(this,t);r(this,Wr).splice(n,0,[t,e])},hF=function([,t,e]){const n=b(this,Ui,ew).call(this,t);for(let i=n;i<r(this,Wr).length;i++){const[s,o]=r(this,Wr)[i];if(s!==t)break;if(s===t&&o===e){r(this,Wr).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,o]=r(this,Wr)[i];if(s!==t)break;if(s===t&&o===e){r(this,Wr).splice(i,1);return}}},sC=function(t){const[e,n,i]=t,s=[[e,n,i]],o=b(this,Ui,ew).call(this,i);for(let l=0;l<o;l++){const[h,u]=r(this,Wr)[l];for(let f=0,g=s.length;f<g;f++){const[,m,A]=s[f];if(!(u<=m||A<=h)){if(m>=h){if(A>u)s[f][1]=u;else{if(g===1)return[];s.splice(f,1),f--,g--}continue}s[f][2]=h,A>u&&s.push([e,u,A])}}}return s},EI);var mA,tg,SI;let ZH=(SI=class extends wt{constructor(e,n,i){super();E(this,mA);E(this,tg);v(this,tg,e),v(this,mA,n),this.lastPoint=i}toSVGPath(){const e=[];for(const n of r(this,tg)){let[i,s]=n;e.push(`M${i} ${s}`);for(let o=2;o<n.length;o+=2){const l=n[o],h=n[o+1];l===i?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${l}`),i=l)}e.push("Z")}return e.join(" ")}serialize([e,n,i,s],o){const l=[],h=i-e,u=s-n;for(const f of r(this,tg)){const g=new Array(f.length);for(let m=0;m<f.length;m+=2)g[m]=e+f[m]*h,g[m+1]=s-f[m+1]*u;l.push(g)}return l}get box(){return r(this,mA)}get classNamesForOutlining(){return["highlightOutline"]}},mA=new WeakMap,tg=new WeakMap,SI),rC=class extends ZD{newFreeDrawOutline(t,e,n,i,s,o){return new tB(t,e,n,i,s,o)}},tB=class extends aF{newOutliner(t,e,n,i,s,o=0){return new rC(t,e,n,i,s,o)}};var Vr,Zu,eg,An,yA,ng,vA,AA,Hc,qr,ig,si,bA,ye,aC,oC,lC,Qh,dF,pc;let uF=(si=class{constructor({editor:t=null,uiManager:e=null}){E(this,ye);E(this,Vr,null);E(this,Zu,null);E(this,eg);E(this,An,null);E(this,yA,!1);E(this,ng,!1);E(this,vA,null);E(this,AA);E(this,Hc,null);E(this,qr,null);E(this,ig);var n;t?(v(this,ng,!1),v(this,ig,Jt.HIGHLIGHT_COLOR),v(this,vA,t)):(v(this,ng,!0),v(this,ig,Jt.HIGHLIGHT_DEFAULT_COLOR)),v(this,qr,(t==null?void 0:t._uiManager)||e),v(this,AA,r(this,qr)._eventBus),v(this,eg,(t==null?void 0:t.color)||((n=r(this,qr))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),r(si,bA)||v(si,bA,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Yt(this,"_keyboardManager",new Ub([[["Escape","mac+Escape"],si.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],si.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],si.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],si.prototype._moveToPrevious],[["Home","mac+Home"],si.prototype._moveToBeginning],[["End","mac+End"],si.prototype._moveToEnd]]))}renderButton(){const t=v(this,Vr,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,qr)._signal;t.addEventListener("click",b(this,ye,Qh).bind(this),{signal:e}),t.addEventListener("keydown",b(this,ye,lC).bind(this),{signal:e});const n=v(this,Zu,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=r(this,eg),t.append(n),t}renderMainDropdown(){const t=v(this,An,b(this,ye,aC).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,Vr)){b(this,ye,Qh).call(this,t);return}const e=t.target.getAttribute("data-color");e&&b(this,ye,oC).call(this,e,t)}_moveToNext(t){var e,n;if(!r(this,ye,pc)){b(this,ye,Qh).call(this,t);return}if(t.target===r(this,Vr)){(e=r(this,An).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=r(this,An))==null?void 0:e.firstChild)||t.target===r(this,Vr)){r(this,ye,pc)&&this._hideDropdownFromKeyboard();return}r(this,ye,pc)||b(this,ye,Qh).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!r(this,ye,pc)){b(this,ye,Qh).call(this,t);return}(e=r(this,An).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,ye,pc)){b(this,ye,Qh).call(this,t);return}(e=r(this,An).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,An))==null||t.classList.add("hidden"),(e=r(this,Hc))==null||e.abort(),v(this,Hc,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,ng)){if(!r(this,ye,pc)){(t=r(this,vA))==null||t.unselect();return}this.hideDropdown(),r(this,Vr).focus({preventScroll:!0,focusVisible:r(this,yA)})}}updateColor(t){if(r(this,Zu)&&(r(this,Zu).style.backgroundColor=t),!r(this,An))return;const e=r(this,qr).highlightColors.values();for(const n of r(this,An).children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,Vr))==null||t.remove(),v(this,Vr,null),v(this,Zu,null),(e=r(this,An))==null||e.remove(),v(this,An,null)}},Vr=new WeakMap,Zu=new WeakMap,eg=new WeakMap,An=new WeakMap,yA=new WeakMap,ng=new WeakMap,vA=new WeakMap,AA=new WeakMap,Hc=new WeakMap,qr=new WeakMap,ig=new WeakMap,bA=new WeakMap,ye=new WeakSet,aC=function(){const t=document.createElement("div"),e=r(this,qr)._signal;t.addEventListener("contextmenu",ua,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of r(this,qr).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",r(si,bA)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===r(this,eg)),s.addEventListener("click",b(this,ye,oC).bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",b(this,ye,lC).bind(this),{signal:e}),t},oC=function(t,e){e.stopPropagation(),r(this,AA).dispatch("switchannotationeditorparams",{source:this,type:r(this,ig),value:t})},lC=function(t){si._keyboardManager.exec(this,t)},Qh=function(t){if(r(this,ye,pc)){this.hideDropdown();return}if(v(this,yA,t.detail===0),r(this,Hc)||(v(this,Hc,new AbortController),window.addEventListener("pointerdown",b(this,ye,dF).bind(this),{signal:r(this,qr).combinedSignal(r(this,Hc))})),r(this,An)){r(this,An).classList.remove("hidden");return}const e=v(this,An,b(this,ye,aC).call(this));r(this,Vr).append(e)},dF=function(t){var e;(e=r(this,An))!=null&&e.contains(t.target)||this.hideDropdown()},pc=function(){return r(this,An)&&!r(this,An).classList.contains("hidden")},E(si,bA,null),si);var sg,_A,Jo,td,rg,ss,wA,EA,ed,rr,ks,Jn,ag,Zo,bi,og,ar,SA,te,jt,cC,nw,fF,pF,gF,hC,Jh,yr,Jf,mF,iw,Py,yF,vF,AF,bF,_F;let xL=(te=class extends nn{constructor(e){super({...e,name:"highlightEditor"});E(this,jt);E(this,sg,null);E(this,_A,0);E(this,Jo);E(this,td,null);E(this,rg,null);E(this,ss,null);E(this,wA,null);E(this,EA,0);E(this,ed,null);E(this,rr,null);E(this,ks,null);E(this,Jn,!1);E(this,ag,null);E(this,Zo);E(this,bi,null);E(this,og,"");E(this,ar);E(this,SA,"");this.color=e.color||te._defaultColor,v(this,ar,e.thickness||te._defaultThickness),v(this,Zo,e.opacity||te._defaultOpacity),v(this,Jo,e.boxes||null),v(this,SA,e.methodOfCreation||""),v(this,og,e.text||""),this._isDraggable=!1,e.highlightId>-1?(v(this,Jn,!0),b(this,jt,nw).call(this,e),b(this,jt,Jh).call(this)):r(this,Jo)&&(v(this,sg,e.anchorNode),v(this,_A,e.anchorOffset),v(this,wA,e.focusNode),v(this,EA,e.focusOffset),b(this,jt,cC).call(this),b(this,jt,Jh).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=te.prototype;return Yt(this,"_keyboardManager",new Ub([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,Jn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,ar),methodOfCreation:r(this,SA)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var i;nn.initialize(e,n),te._defaultColor||(te._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Jt.HIGHLIGHT_DEFAULT_COLOR:te._defaultColor=n;break;case Jt.HIGHLIGHT_THICKNESS:te._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return r(this,ag)}updateParams(e,n){switch(e){case Jt.HIGHLIGHT_COLOR:b(this,jt,fF).call(this,n);break;case Jt.HIGHLIGHT_THICKNESS:b(this,jt,pF).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Jt.HIGHLIGHT_DEFAULT_COLOR,te._defaultColor],[Jt.HIGHLIGHT_THICKNESS,te._defaultThickness]]}get propertiesToUpdate(){return[[Jt.HIGHLIGHT_COLOR,this.color||te._defaultColor],[Jt.HIGHLIGHT_THICKNESS,r(this,ar)||te._defaultThickness],[Jt.HIGHLIGHT_FREE,r(this,Jn)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(v(this,rg,new uF({editor:this})),e.addColorPicker(r(this,rg))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(b(this,jt,Py).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,b(this,jt,Py).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){b(this,jt,hC).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(b(this,jt,Jh).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?b(this,jt,hC).call(this):e&&(b(this,jt,Jh).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var s,o,l;const{drawLayer:n}=this.parent;let i;r(this,Jn)?(e=(e-this.rotation+360)%360,i=b(s=te,yr,Jf).call(s,r(this,rr).box,e)):i=b(o=te,yr,Jf).call(o,[this.x,this.y,this.width,this.height],e),n.updateProperties(r(this,ks),{bbox:i,root:{"data-main-rotation":e}}),n.updateProperties(r(this,bi),{bbox:b(l=te,yr,Jf).call(l,r(this,ss).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();r(this,og)&&(e.setAttribute("aria-label",r(this,og)),e.setAttribute("role","mark")),r(this,Jn)?e.classList.add("free"):this.div.addEventListener("keydown",b(this,jt,mF).bind(this),{signal:this._uiManager._signal});const n=v(this,ed,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=r(this,td);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),Bw(this,r(this,ed),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,bi),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,bi),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:b(this,jt,iw).call(this,!0);break;case 1:case 3:b(this,jt,iw).call(this,!1);break}}select(){var e;super.select(),r(this,bi)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,bi),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),r(this,bi)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,bi),{rootClass:{selected:!1}}),r(this,Jn)||b(this,jt,iw).call(this,!1))}get _mustFixPosition(){return!r(this,Jn)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(r(this,ks),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(r(this,bi),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:i,x:s,y:o}){const{x:l,y:h,width:u,height:f}=i.getBoundingClientRect(),g=new AbortController,m=e.combinedSignal(g),A=_=>{g.abort(),b(this,yr,bF).call(this,e,_)};window.addEventListener("blur",A,{signal:m}),window.addEventListener("pointerup",A,{signal:m}),window.addEventListener("pointerdown",Gs,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ua,{signal:m}),i.addEventListener("pointermove",b(this,yr,AF).bind(this,e),{signal:m}),this._freeHighlight=new rC({x:s,y:o},[l,h,u,f],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,i){var S,C,T,k;let s=null;if(e instanceof WD){const{data:{quadPoints:P,rect:L,rotation:I,id:D,color:F,opacity:H,popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:Bt.HIGHLIGHT,color:Array.from(F),opacity:H,quadPoints:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}else if(e instanceof YT){const{data:{inkLists:P,rect:L,rotation:I,id:D,color:F,borderStyle:{rawWidth:H},popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:Bt.HIGHLIGHT,color:Array.from(F),thickness:H,inkLists:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}const{color:o,quadPoints:l,inkLists:h,opacity:u}=e,f=await super.deserialize(e,n,i);f.color=Pt.makeHexColor(...o),v(f,Zo,u||1),h&&v(f,ar,e.thickness),f.annotationElementId=e.id||null,f._initialData=s;const[g,m]=f.pageDimensions,[A,_]=f.pageTranslation;if(l){const P=v(f,Jo,[]);for(let L=0;L<l.length;L+=8)P.push({x:(l[L]-A)/g,y:1-(l[L+1]-_)/m,width:(l[L+2]-l[L])/g,height:(l[L+1]-l[L+5])/m});b(S=f,jt,cC).call(S),b(C=f,jt,Jh).call(C),f.rotate(f.rotation)}else if(h){v(f,Jn,!0);const P=h[0],L={x:P[0]-A,y:m-(P[1]-_)},I=new rC(L,[0,0,g,m],1,r(f,ar)/2,!0,.001);for(let H=0,j=P.length;H<j;H+=2)L.x=P[H]-A,L.y=m-(P[H+1]-_),I.add(L);const{id:D,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:I.toSVGPath()}},!0,!0);b(T=f,jt,nw).call(T,{highlightOutlines:I.getOutlines(),highlightId:D,clipPathId:F}),b(k=f,jt,Jh).call(k)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=nn._colorManager.convert(this.color),s={annotationType:Bt.HIGHLIGHT,color:i,opacity:r(this,Zo),thickness:r(this,ar),quadPoints:b(this,jt,yF).call(this),outlines:b(this,jt,vF).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:b(this,jt,Py).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!b(this,jt,_F).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},sg=new WeakMap,_A=new WeakMap,Jo=new WeakMap,td=new WeakMap,rg=new WeakMap,ss=new WeakMap,wA=new WeakMap,EA=new WeakMap,ed=new WeakMap,rr=new WeakMap,ks=new WeakMap,Jn=new WeakMap,ag=new WeakMap,Zo=new WeakMap,bi=new WeakMap,og=new WeakMap,ar=new WeakMap,SA=new WeakMap,jt=new WeakSet,cC=function(){const e=new iC(r(this,Jo),.001);v(this,rr,e.getOutlines()),[this.x,this.y,this.width,this.height]=r(this,rr).box;const n=new iC(r(this,Jo),.0025,.001,this._uiManager.direction==="ltr");v(this,ss,n.getOutlines());const{lastPoint:i}=r(this,ss);v(this,ag,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},nw=function({highlightOutlines:e,highlightId:n,clipPathId:i}){var g,m;if(v(this,rr,e),v(this,ss,e.getNewOutline(r(this,ar)/2+1.5,.0025)),n>=0)v(this,ks,n),v(this,td,i),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),v(this,bi,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:r(this,ss).box,path:{d:r(this,ss).toSVGPath()}},!0));else if(this.parent){const A=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(r(this,ks),{bbox:b(g=te,yr,Jf).call(g,r(this,rr).box,(A-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(r(this,bi),{bbox:b(m=te,yr,Jf).call(m,r(this,ss).box,A),path:{d:r(this,ss).toSVGPath()}})}const[o,l,h,u]=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=h,this.height=u;break;case 90:{const[A,_]=this.parentDimensions;this.x=l,this.y=1-o,this.width=h*_/A,this.height=u*A/_;break}case 180:this.x=1-o,this.y=1-l,this.width=h,this.height=u;break;case 270:{const[A,_]=this.parentDimensions;this.x=1-l,this.y=o,this.width=h*_/A,this.height=u*A/_;break}}const{lastPoint:f}=r(this,ss);v(this,ag,[(f[0]-o)/h,(f[1]-l)/u])},fF=function(e){const n=(o,l)=>{var h,u;this.color=o,v(this,Zo,l),(h=this.parent)==null||h.drawLayer.updateProperties(r(this,ks),{root:{fill:o,"fill-opacity":l}}),(u=r(this,rg))==null||u.updateColor(o)},i=this.color,s=r(this,Zo);this.addCommands({cmd:n.bind(this,e,te._defaultOpacity),undo:n.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Jt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},pF=function(e){const n=r(this,ar),i=s=>{v(this,ar,s),b(this,jt,gF).call(this,s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Jt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},gF=function(e){if(!r(this,Jn))return;b(this,jt,nw).call(this,{highlightOutlines:r(this,rr).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},hC=function(){r(this,ks)===null||!this.parent||(this.parent.drawLayer.remove(r(this,ks)),v(this,ks,null),this.parent.drawLayer.remove(r(this,bi)),v(this,bi,null))},Jh=function(e=this.parent){r(this,ks)===null&&({id:le(this,ks)._,clipPathId:le(this,td)._}=e.drawLayer.draw({bbox:r(this,rr).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":r(this,Zo)},rootClass:{highlight:!0,free:r(this,Jn)},path:{d:r(this,rr).toSVGPath()}},!1,!0),v(this,bi,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:r(this,Jn)},bbox:r(this,ss).box,path:{d:r(this,ss).toSVGPath()}},r(this,Jn))),r(this,ed)&&(r(this,ed).style.clipPath=r(this,td)))},yr=new WeakSet,Jf=function([e,n,i,s],o){switch(o){case 90:return[1-n-s,e,s,i];case 180:return[1-e-i,1-n-s,i,s];case 270:return[n,1-e-i,s,i]}return[e,n,i,s]},mF=function(e){te._keyboardManager.exec(this,e)},iw=function(e){if(!r(this,sg))return;const n=window.getSelection();e?n.setPosition(r(this,sg),r(this,_A)):n.setPosition(r(this,wA),r(this,EA))},Py=function(){return r(this,Jn)?this.rotation:0},yF=function(){if(r(this,Jn))return null;const[e,n]=this.pageDimensions,[i,s]=this.pageTranslation,o=r(this,Jo),l=new Float32Array(o.length*8);let h=0;for(const{x:u,y:f,width:g,height:m}of o){const A=u*e+i,_=(1-f)*n+s;l[h]=l[h+4]=A,l[h+1]=l[h+3]=_,l[h+2]=l[h+6]=A+g*e,l[h+5]=l[h+7]=_-m*n,h+=8}return l},vF=function(e){return r(this,rr).serialize(e,b(this,jt,Py).call(this))},AF=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},bF=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},_F=function(e){const{color:n}=this._initialData;return e.color.some((i,s)=>i!==n[s])},E(te,yr),lt(te,"_defaultColor",null),lt(te,"_defaultOpacity",1),lt(te,"_defaultThickness",12),lt(te,"_type","highlight"),lt(te,"_editorType",Bt.HIGHLIGHT),lt(te,"_freeHighlightId",-1),lt(te,"_freeHighlight",null),lt(te,"_freeHighlightClipId",""),te);var nd;class eB{constructor(){E(this,nd,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))this.updateProperty(e,n)}updateSVGProperty(t,e){r(this,nd)[t]=e}toSVGProperties(){const t=r(this,nd);return v(this,nd,Object.create(null)),{root:t}}reset(){v(this,nd,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){we("Not implemented")}}nd=new WeakMap;var Ps,lg,On,id,sd,Bc,zc,Uc,rd,ne,dC,fC,pC,Ry,wF,sw,Ly,Zf;const _t=class _t extends nn{constructor(e){super(e);E(this,ne);E(this,Ps,null);E(this,lg);lt(this,"_drawId",null);v(this,lg,e.mustBeCommitted||!1),e.drawOutlines&&(b(this,ne,dC).call(this,e),b(this,ne,Ry).call(this))}static _mergeSVGProperties(e,n){const i=new Set(Object.keys(e));for(const[s,o]of Object.entries(n))i.has(s)?Object.assign(e[s],o):e[s]=o;return e}static getDefaultDrawingOptions(e){we("Not implemented")}static get typesMap(){we("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(r(_t,On).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)e.push([i,n[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[i,s]of this.constructor.typesMap)e.push([i,n[s]]);return e}_updateProperty(e,n,i){const s=this._drawingOptions,o=s[n],l=h=>{var f;s.updateProperty(n,h);const u=r(this,Ps).updateProperty(n,h);u&&b(this,ne,Ly).call(this,u),(f=this.parent)==null||f.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,_t._mergeSVGProperties(r(this,Ps).getPathResizingSVGProperties(b(this,ne,sw).call(this)),{bbox:b(this,ne,Zf).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,_t._mergeSVGProperties(r(this,Ps).getPathResizedSVGProperties(b(this,ne,sw).call(this)),{bbox:b(this,ne,Zf).call(this)}))}_onTranslating(e,n){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:b(this,ne,Zf).call(this,e,n)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,_t._mergeSVGProperties(r(this,Ps).getPathTranslatedSVGProperties(b(this,ne,sw).call(this),this.parentDimensions),{bbox:b(this,ne,Zf).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,r(this,lg)&&(v(this,lg,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){b(this,ne,pC).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(b(this,ne,Ry).call(this),b(this,ne,Ly).call(this,r(this,Ps).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),b(this,ne,pC).call(this)):e&&(this._uiManager.addShouldRescale(this),b(this,ne,Ry).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_t._mergeSVGProperties({bbox:b(this,ne,Zf).call(this)},r(this,Ps).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&b(this,ne,Ly).call(this,r(this,Ps).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const n=document.createElement("div");e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,n,i,s,o){we("Not implemented")}static startDrawing(e,n,i,s){var C;const{target:o,offsetX:l,offsetY:h,pointerId:u,pointerType:f}=s;if(r(_t,zc)&&r(_t,zc)!==f)return;const{viewport:{rotation:g}}=e,{width:m,height:A}=o.getBoundingClientRect(),_=v(_t,id,new AbortController),S=e.combinedSignal(_);if(r(_t,Bc)||v(_t,Bc,u),r(_t,zc)??v(_t,zc,f),window.addEventListener("pointerup",T=>{var k;r(_t,Bc)===T.pointerId?this._endDraw(T):(k=r(_t,Uc))==null||k.delete(T.pointerId)},{signal:S}),window.addEventListener("pointercancel",T=>{var k;r(_t,Bc)===T.pointerId?this._currentParent.endDrawingSession():(k=r(_t,Uc))==null||k.delete(T.pointerId)},{signal:S}),window.addEventListener("pointerdown",T=>{r(_t,zc)===T.pointerType&&((r(_t,Uc)||v(_t,Uc,new Set)).add(T.pointerId),r(_t,On).isCancellable()&&(r(_t,On).removeLastElement(),r(_t,On).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",ua,{signal:S}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),o.addEventListener("touchmove",T=>{T.timeStamp===r(_t,rd)&&Gs(T)},{signal:S}),e.toggleDrawing(),(C=n._editorUndoBar)==null||C.hide(),r(_t,On)){e.drawLayer.updateProperties(this._currentDrawId,r(_t,On).startNew(l,h,m,A,g));return}n.updateUIForDefaultProperties(this),v(_t,On,this.createDrawerInstance(l,h,m,A,g)),v(_t,sd,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(r(_t,sd).toSVGProperties(),r(_t,On).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(v(_t,rd,-1),!r(_t,On))return;const{offsetX:n,offsetY:i,pointerId:s}=e;if(r(_t,Bc)===s){if(((o=r(_t,Uc))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,r(_t,On).add(n,i)),v(_t,rd,e.timeStamp),Gs(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,v(_t,On,null),v(_t,sd,null),v(_t,zc,null),v(_t,rd,NaN)),r(_t,id)&&(r(_t,id).abort(),v(_t,id,null),v(_t,Bc,NaN),v(_t,Uc,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),e&&n.drawLayer.updateProperties(this._currentDrawId,r(_t,On).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=r(_t,On),s=this._currentDrawId,o=i.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(s,i.setLastElement(o))},undo:()=>{n.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:Jt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Jt.DRAW_STEP),!r(_t,On).isEmpty()){const{pageDimensions:[i,s],scale:o}=n,l=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:r(_t,On).getOutlines(i*o,s*o,o,this._INNER_MARGIN),drawingOptions:r(_t,sd),mustBeCommitted:!e});return this._cleanup(!0),l}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,i,s,o,l){we("Not implemented")}static async deserialize(e,n,i){var g,m;const{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}=n.viewport,u=this.deserializeDraw(l,h,s,o,this._INNER_MARGIN,e),f=await super.deserialize(e,n,i);return f.createDrawingOptions(e),b(g=f,ne,dC).call(g,{drawOutlines:u}),b(m=f,ne,Ry).call(m),f.onScaleChanging(),f.rotate(),f}serializeDraw(e){const[n,i]=this.pageTranslation,[s,o]=this.pageDimensions;return r(this,Ps).serialize([n,i,s,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ps=new WeakMap,lg=new WeakMap,On=new WeakMap,id=new WeakMap,sd=new WeakMap,Bc=new WeakMap,zc=new WeakMap,Uc=new WeakMap,rd=new WeakMap,ne=new WeakSet,dC=function({drawOutlines:e,drawId:n,drawingOptions:i}){v(this,Ps,e),this._drawingOptions||(this._drawingOptions=i),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=b(this,ne,fC).call(this,e,this.parent),b(this,ne,Ly).call(this,e.box)},fC=function(e,n){const{id:i}=n.drawLayer.draw(_t._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i},pC=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Ry=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=b(this,ne,fC).call(this,r(this,Ps),e)}},wF=function([e,n,i,s]){const{parentDimensions:[o,l],rotation:h}=this;switch(h){case 90:return[n,1-e,i*(l/o),s*(o/l)];case 180:return[1-e,1-n,i,s];case 270:return[1-n,e,i*(l/o),s*(o/l)];default:return[e,n,i,s]}},sw=function(){const{x:e,y:n,width:i,height:s,parentDimensions:[o,l],rotation:h}=this;switch(h){case 90:return[1-n,e,i*(o/l),s*(l/o)];case 180:return[1-e,1-n,i,s];case 270:return[n,1-e,i*(o/l),s*(l/o)];default:return[e,n,i,s]}},Ly=function(e){if([this.x,this.y,this.width,this.height]=b(this,ne,wF).call(this,e),this.div){this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)}this._onResized()},Zf=function(){const{x:e,y:n,width:i,height:s,rotation:o,parentRotation:l,parentDimensions:[h,u]}=this;switch((o*4+l)/90){case 1:return[1-n-s,e,s,i];case 2:return[1-e-i,1-n-s,i,s];case 3:return[n,1-e-i,s,i];case 4:return[e,n-i*(h/u),s*(u/h),i*(h/u)];case 5:return[1-n,e,i*(h/u),s*(u/h)];case 6:return[1-e-s*(u/h),1-n,s*(u/h),i*(h/u)];case 7:return[n-i*(h/u),1-e-s*(u/h),i*(h/u),s*(u/h)];case 8:return[e-i,n-s,i,s];case 9:return[1-n,e-i,s,i];case 10:return[1-e,1-n,i,s];case 11:return[n-s,1-e,s,i];case 12:return[e-s*(u/h),n,s*(u/h),i*(h/u)];case 13:return[1-n-i*(h/u),e-s*(u/h),i*(h/u),s*(u/h)];case 14:return[1-e,1-n-i*(h/u),s*(u/h),i*(h/u)];case 15:return[n,1-e,i*(h/u),s*(u/h)];default:return[e,n,i,s]}},lt(_t,"_currentDrawId",-1),lt(_t,"_currentParent",null),E(_t,On,null),E(_t,id,null),E(_t,sd,null),E(_t,Bc,NaN),E(_t,zc,null),E(_t,Uc,null),E(_t,rd,NaN),lt(_t,"_INNER_MARGIN",3);let uC=_t;var Na,Nn,$n,ad,cg,Oi,Zn,or,od,ld,cd,hg,rw;class nB{constructor(t,e,n,i,s,o){E(this,hg);E(this,Na,new Float64Array(6));E(this,Nn);E(this,$n);E(this,ad);E(this,cg);E(this,Oi);E(this,Zn,"");E(this,or,0);E(this,od,new Uw);E(this,ld);E(this,cd);v(this,ld,n),v(this,cd,i),v(this,ad,s),v(this,cg,o),[t,e]=b(this,hg,rw).call(this,t,e);const l=v(this,Nn,[NaN,NaN,NaN,NaN,t,e]);v(this,Oi,[t,e]),v(this,$n,[{line:l,points:r(this,Oi)}]),r(this,Na).set(l,0)}updateProperty(t,e){t==="stroke-width"&&v(this,cg,e)}isEmpty(){return!r(this,$n)||r(this,$n).length===0}isCancellable(){return r(this,Oi).length<=10}add(t,e){[t,e]=b(this,hg,rw).call(this,t,e);const[n,i,s,o]=r(this,Na).subarray(2,6),l=t-s,h=e-o;return Math.hypot(r(this,ld)*l,r(this,cd)*h)<=2?null:(r(this,Oi).push(t,e),isNaN(n)?(r(this,Na).set([s,o,t,e],2),r(this,Nn).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(r(this,Na)[0])&&r(this,Nn).splice(6,6),r(this,Na).set([n,i,s,o,t,e],0),r(this,Nn).push(...wt.createBezierPoints(n,i,s,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(r(this,Oi).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,s){v(this,ld,n),v(this,cd,i),v(this,ad,s),[t,e]=b(this,hg,rw).call(this,t,e);const o=v(this,Nn,[NaN,NaN,NaN,NaN,t,e]);v(this,Oi,[t,e]);const l=r(this,$n).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),r(this,$n).push({line:o,points:r(this,Oi)}),r(this,Na).set(o,0),v(this,or,0),this.toSVGPath(),null}getLastElement(){return r(this,$n).at(-1)}setLastElement(t){return r(this,$n)?(r(this,$n).push(t),v(this,Nn,t.line),v(this,Oi,t.points),v(this,or,0),{path:{d:this.toSVGPath()}}):r(this,od).setLastElement(t)}removeLastElement(){if(!r(this,$n))return r(this,od).removeLastElement();r(this,$n).pop(),v(this,Zn,"");for(let t=0,e=r(this,$n).length;t<e;t++){const{line:n,points:i}=r(this,$n)[t];v(this,Nn,n),v(this,Oi,i),v(this,or,0),this.toSVGPath()}return{path:{d:r(this,Zn)}}}toSVGPath(){const t=wt.svgRound(r(this,Nn)[4]),e=wt.svgRound(r(this,Nn)[5]);if(r(this,Oi).length===2)return v(this,Zn,`${r(this,Zn)} M ${t} ${e} Z`),r(this,Zn);if(r(this,Oi).length<=6){const i=r(this,Zn).lastIndexOf("M");v(this,Zn,`${r(this,Zn).slice(0,i)} M ${t} ${e}`),v(this,or,6)}if(r(this,Oi).length===4){const i=wt.svgRound(r(this,Nn)[10]),s=wt.svgRound(r(this,Nn)[11]);return v(this,Zn,`${r(this,Zn)} L ${i} ${s}`),v(this,or,12),r(this,Zn)}const n=[];r(this,or)===0&&(n.push(`M ${t} ${e}`),v(this,or,6));for(let i=r(this,or),s=r(this,Nn).length;i<s;i+=6){const[o,l,h,u,f,g]=r(this,Nn).slice(i,i+6).map(wt.svgRound);n.push(`C${o} ${l} ${h} ${u} ${f} ${g}`)}return v(this,Zn,r(this,Zn)+n.join(" ")),v(this,or,r(this,Nn).length),r(this,Zn)}getOutlines(t,e,n,i){const s=r(this,$n).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),r(this,od).build(r(this,$n),t,e,n,r(this,ad),r(this,cg),i),v(this,Na,null),v(this,Nn,null),v(this,$n,null),v(this,Zn,null),r(this,od)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Na=new WeakMap,Nn=new WeakMap,$n=new WeakMap,ad=new WeakMap,cg=new WeakMap,Oi=new WeakMap,Zn=new WeakMap,or=new WeakMap,od=new WeakMap,ld=new WeakMap,cd=new WeakMap,hg=new WeakSet,rw=function(t,e){return wt._normalizePoint(t,e,r(this,ld),r(this,cd),r(this,ad))};var Ni,xA,CA,Rs,$a,ja,ug,dg,fg,ri,Po,EF,SF,xF;const fk=class fk extends wt{constructor(){super(...arguments);E(this,ri);E(this,Ni);E(this,xA,0);E(this,CA);E(this,Rs);E(this,$a);E(this,ja);E(this,ug);E(this,dg);E(this,fg)}build(e,n,i,s,o,l,h){v(this,$a,n),v(this,ja,i),v(this,ug,s),v(this,dg,o),v(this,fg,l),v(this,CA,h??0),v(this,Rs,e),b(this,ri,SF).call(this)}setLastElement(e){return r(this,Rs).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return r(this,Rs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of r(this,Rs)){if(e.push(`M${wt.svgRound(n[4])} ${wt.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12){e.push(`L${wt.svgRound(n[10])} ${wt.svgRound(n[11])}`);continue}for(let i=6,s=n.length;i<s;i+=6){const[o,l,h,u,f,g]=n.subarray(i,i+6).map(wt.svgRound);e.push(`C${o} ${l} ${h} ${u} ${f} ${g}`)}}return e.join("")}serialize([e,n,i,s],o){const l=[],h=[],[u,f,g,m]=b(this,ri,EF).call(this);let A,_,S,C,T,k,P,L,I;switch(r(this,dg)){case 0:I=wt._rescale,A=e,_=n+s,S=i,C=-s,T=e+u*i,k=n+(1-f-m)*s,P=e+(u+g)*i,L=n+(1-f)*s;break;case 90:I=wt._rescaleAndSwap,A=e,_=n,S=i,C=s,T=e+f*i,k=n+u*s,P=e+(f+m)*i,L=n+(u+g)*s;break;case 180:I=wt._rescale,A=e+i,_=n,S=-i,C=s,T=e+(1-u-g)*i,k=n+f*s,P=e+(1-u)*i,L=n+(f+m)*s;break;case 270:I=wt._rescaleAndSwap,A=e+i,_=n+s,S=-i,C=-s,T=e+(1-f-m)*i,k=n+(1-u-g)*s,P=e+(1-f)*i,L=n+(1-u)*s;break}for(const{line:D,points:F}of r(this,Rs))l.push(I(D,A,_,S,C,o?new Array(D.length):null)),h.push(I(F,A,_,S,C,o?new Array(F.length):null));return{lines:l,points:h,rect:[T,k,P,L]}}static deserialize(e,n,i,s,o,{paths:{lines:l,points:h},rotation:u,thickness:f}){const g=[];let m,A,_,S,C;switch(u){case 0:C=wt._rescale,m=-e/i,A=n/s+1,_=1/i,S=-1/s;break;case 90:C=wt._rescaleAndSwap,m=-n/s,A=-e/i,_=1/s,S=1/i;break;case 180:C=wt._rescale,m=e/i+1,A=-n/s,_=-1/i,S=1/s;break;case 270:C=wt._rescaleAndSwap,m=n/s+1,A=e/i+1,_=-1/s,S=-1/i;break}if(!l){l=[];for(const k of h){const P=k.length;if(P===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(P===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const L=new Float32Array(3*(P-2));l.push(L);let[I,D,F,H]=k.subarray(0,4);L.set([NaN,NaN,NaN,NaN,I,D],0);for(let j=4;j<P;j+=2){const Q=k[j],W=k[j+1];L.set(wt.createBezierPoints(I,D,F,H,Q,W),(j-2)*3),[I,D,F,H]=[F,H,Q,W]}}}for(let k=0,P=l.length;k<P;k++)g.push({line:C(l[k].map(L=>L??NaN),m,A,_,S),points:C(h[k].map(L=>L??NaN),m,A,_,S)});const T=new fk;return T.build(g,i,s,1,u,f,o),T}get box(){return r(this,Ni)}updateProperty(e,n){return e==="stroke-width"?b(this,ri,xF).call(this,n):null}updateParentDimensions([e,n],i){const[s,o]=b(this,ri,Po).call(this);v(this,$a,e),v(this,ja,n),v(this,ug,i);const[l,h]=b(this,ri,Po).call(this),u=l-s,f=h-o,g=r(this,Ni);return g[0]-=u,g[1]-=f,g[2]+=2*u,g[3]+=2*f,g}updateRotation(e){return v(this,xA,e),{path:{transform:this.rotationTransform}}}get viewBox(){return r(this,Ni).map(wt.svgRound).join(" ")}get defaultProperties(){const[e,n]=r(this,Ni);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(e)} ${wt.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=r(this,Ni);let i=0,s=0,o=0,l=0,h=0,u=0;switch(r(this,xA)){case 90:s=n/e,o=-e/n,h=e;break;case 180:i=-1,l=-1,h=e,u=n;break;case 270:s=-n/e,o=e/n,u=n;break;default:return""}return`matrix(${i} ${s} ${o} ${l} ${wt.svgRound(h)} ${wt.svgRound(u)})`}getPathResizingSVGProperties([e,n,i,s]){const[o,l]=b(this,ri,Po).call(this),[h,u,f,g]=r(this,Ni);if(Math.abs(f-o)<=wt.PRECISION||Math.abs(g-l)<=wt.PRECISION){const C=e+i/2-(h+f/2),T=n+s/2-(u+g/2);return{path:{"transform-origin":`${wt.svgRound(e)} ${wt.svgRound(n)}`,transform:`${this.rotationTransform} translate(${C} ${T})`}}}const m=(i-2*o)/(f-2*o),A=(s-2*l)/(g-2*l),_=f/i,S=g/s;return{path:{"transform-origin":`${wt.svgRound(h)} ${wt.svgRound(u)}`,transform:`${this.rotationTransform} scale(${_} ${S}) translate(${wt.svgRound(o)} ${wt.svgRound(l)}) scale(${m} ${A}) translate(${wt.svgRound(-o)} ${wt.svgRound(-l)})`}}}getPathResizedSVGProperties([e,n,i,s]){const[o,l]=b(this,ri,Po).call(this),h=r(this,Ni),[u,f,g,m]=h;if(h[0]=e,h[1]=n,h[2]=i,h[3]=s,Math.abs(g-o)<=wt.PRECISION||Math.abs(m-l)<=wt.PRECISION){const T=e+i/2-(u+g/2),k=n+s/2-(f+m/2);for(const{line:P,points:L}of r(this,Rs))wt._translate(P,T,k,P),wt._translate(L,T,k,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(e)} ${wt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(i-2*o)/(g-2*o),_=(s-2*l)/(m-2*l),S=-A*(u+o)+e+o,C=-_*(f+l)+n+l;if(A!==1||_!==1||S!==0||C!==0)for(const{line:T,points:k}of r(this,Rs))wt._rescale(T,S,C,A,_,T),wt._rescale(k,S,C,A,_,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(e)} ${wt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],i){const[s,o]=i,l=r(this,Ni),h=e-l[0],u=n-l[1];if(r(this,$a)===s&&r(this,ja)===o)for(const{line:f,points:g}of r(this,Rs))wt._translate(f,h,u,f),wt._translate(g,h,u,g);else{const f=r(this,$a)/s,g=r(this,ja)/o;v(this,$a,s),v(this,ja,o);for(const{line:m,points:A}of r(this,Rs))wt._rescale(m,h,u,f,g,m),wt._rescale(A,h,u,f,g,A);l[2]*=f,l[3]*=g}return l[0]=e,l[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(e)} ${wt.svgRound(n)}`}}}get defaultSVGProperties(){const e=r(this,Ni);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(e[0])} ${wt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};Ni=new WeakMap,xA=new WeakMap,CA=new WeakMap,Rs=new WeakMap,$a=new WeakMap,ja=new WeakMap,ug=new WeakMap,dg=new WeakMap,fg=new WeakMap,ri=new WeakSet,Po=function(e=r(this,fg)){const n=r(this,CA)+e/2*r(this,ug);return r(this,dg)%180===0?[n/r(this,$a),n/r(this,ja)]:[n/r(this,ja),n/r(this,$a)]},EF=function(){const[e,n,i,s]=r(this,Ni),[o,l]=b(this,ri,Po).call(this,0);return[e+o,n+l,i-2*o,s-2*l]},SF=function(){const e=v(this,Ni,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of r(this,Rs)){if(s.length<=12){for(let h=4,u=s.length;h<u;h+=6){const[f,g]=s.subarray(h,h+2);e[0]=Math.min(e[0],f),e[1]=Math.min(e[1],g),e[2]=Math.max(e[2],f),e[3]=Math.max(e[3],g)}continue}let o=s[4],l=s[5];for(let h=6,u=s.length;h<u;h+=6){const[f,g,m,A,_,S]=s.subarray(h,h+6);Pt.bezierBoundingBox(o,l,f,g,m,A,_,S,e),o=_,l=S}}const[n,i]=b(this,ri,Po).call(this);e[0]=Math.min(1,Math.max(0,e[0]-n)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+n)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]},xF=function(e){const[n,i]=b(this,ri,Po).call(this);v(this,fg,e);const[s,o]=b(this,ri,Po).call(this),[l,h]=[s-n,o-i],u=r(this,Ni);return u[0]-=l,u[1]-=h,u[2]+=2*l,u[3]+=2*h,u};let Uw=fk;var pg;const pk=class pk extends eB{constructor(e){super();E(this,pg);v(this,pg,e),super.updateProperties({fill:"none",stroke:nn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,n){e==="stroke-width"&&(n??(n=this["stroke-width"]),n*=r(this,pg).realScale),super.updateSVGProperty(e,n)}clone(){const e=new pk(r(this,pg));return e.updateAll(this),e}};pg=new WeakMap;let gC=pk;var tl,cE,CF;let iB=(tl=class extends uC{constructor(e){super({...e,name:"inkEditor"});E(this,cE);this._willKeepAspectRatio=!0}static initialize(e,n){nn.initialize(e,n),this._defaultDrawingOptions=new gC(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Yt(this,"typesMap",new Map([[Jt.INK_THICKNESS,"stroke-width"],[Jt.INK_COLOR,"stroke"],[Jt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,i,s,o){return new nB(e,n,i,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,i,s,o,l){return Uw.deserialize(e,n,i,s,o,l)}static async deserialize(e,n,i){let s=null;if(e instanceof YT){const{data:{inkLists:l,rect:h,rotation:u,id:f,color:g,opacity:m,borderStyle:{rawWidth:A},popupRef:_},parent:{page:{pageNumber:S}}}=e;s=e={annotationType:Bt.INK,color:Array.from(g),thickness:A,opacity:m,paths:{points:l},boxes:null,pageIndex:S-1,rect:h.slice(0),rotation:u,id:f,deleted:!1,popupRef:_}}const o=await super.deserialize(e,n,i);return o.annotationElementId=e.id||null,o._initialData=s,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:i}=this;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:i}){this._drawingOptions=tl.getDefaultDrawingOptions({stroke:Pt.makeHexColor(...e),"stroke-width":n,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:i,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":h}}=this,u={annotationType:Bt.INK,color:nn._colorManager.convert(o),opacity:l,thickness:h,paths:{lines:n,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?u:this.annotationElementId&&!b(this,cE,CF).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(e){const{points:n,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:n}),null}},cE=new WeakSet,CF=function(e){const{color:n,thickness:i,opacity:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((l,h)=>l!==n[h])||e.thickness!==i||e.opacity!==s||e.pageIndex!==o},lt(tl,"_type","ink"),lt(tl,"_editorType",Bt.INK),lt(tl,"_defaultDrawingOptions",null),tl);var Be,ti,Gc,el,Wc,gg,Ha,Ba,Ls,mg,Vc,se,My,Iy,aw,mC,ow,yC,lw,TF;let sB=(Vc=class extends nn{constructor(e){super({...e,name:"stampEditor"});E(this,se);E(this,Be,null);E(this,ti,null);E(this,Gc,null);E(this,el,null);E(this,Wc,null);E(this,gg,"");E(this,Ha,null);E(this,Ba,null);E(this,Ls,!1);E(this,mg,!1);v(this,el,e.bitmapUrl),v(this,Wc,e.bitmapFile)}static initialize(e,n){nn.initialize(e,n)}static get supportedTypes(){return Yt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Yt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,n){n.pasteEditor(Bt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=e||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const u=h.output;return await this.setGuessedAltText(u),n&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var e;r(this,ti)&&(v(this,Be,null),this._uiManager.imageManager.deleteId(r(this,ti)),(e=r(this,Ha))==null||e.remove(),v(this,Ha,null),r(this,Ba)&&(clearTimeout(r(this,Ba)),v(this,Ba,null))),super.remove()}rebuild(){if(!this.parent){r(this,ti)&&b(this,se,aw).call(this);return}super.rebuild(),this.div!==null&&(r(this,ti)&&r(this,Ha)===null&&b(this,se,aw).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(r(this,Gc)||r(this,Be)||r(this,el)||r(this,Wc)||r(this,ti))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;if(this.width&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,Be)?b(this,se,mC).call(this):b(this,se,aw).call(this),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(e*i,n*s,this.width*i,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;r(this,Ba)!==null&&clearTimeout(r(this,Ba)),v(this,Ba,setTimeout(()=>{v(this,Ba,null),b(this,se,yC).call(this)},200))}copyCanvas(e,n,i=!1){var A;e||(e=224);const{width:s,height:o}=r(this,Be),l=new bx;let h=r(this,Be),u=s,f=o,g=null;if(n){if(s>n||o>n){const H=Math.min(n/s,n/o);u=Math.floor(s*H),f=Math.floor(o*H)}g=document.createElement("canvas");const _=g.width=Math.ceil(u*l.sx),S=g.height=Math.ceil(f*l.sy);r(this,Ls)||(h=b(this,se,ow).call(this,_,S));const C=g.getContext("2d");C.filter=this._uiManager.hcmFilter;let T="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(A=window.matchMedia)!=null&&A.call(window,"(prefers-color-scheme: dark)").matches&&(T="#8f8f9d",k="#42414d");const P=15,L=P*l.sx,I=P*l.sy,D=new OffscreenCanvas(L*2,I*2),F=D.getContext("2d");F.fillStyle=T,F.fillRect(0,0,L*2,I*2),F.fillStyle=k,F.fillRect(0,0,L,I),F.fillRect(L,I,L,I),C.fillStyle=C.createPattern(D,"repeat"),C.fillRect(0,0,_,S),C.drawImage(h,0,0,h.width,h.height,0,0,_,S)}let m=null;if(i){let _,S;if(l.symmetric&&h.width<e&&h.height<e)_=h.width,S=h.height;else if(h=r(this,Be),s>e||o>e){const k=Math.min(e/s,e/o);_=Math.floor(s*k),S=Math.floor(o*k),r(this,Ls)||(h=b(this,se,ow).call(this,_,S))}const T=new OffscreenCanvas(_,S).getContext("2d",{willReadFrequently:!0});T.drawImage(h,0,0,h.width,h.height,0,0,_,S),m={width:_,height:S,data:T.getImageData(0,0,_,S).data}}return{canvas:g,width:u,height:f,imageData:m}}getImageForAltText(){return r(this,Ha)}static async deserialize(e,n,i){var S;let s=null;if(e instanceof VD){const{data:{rect:C,rotation:T,id:k,structParent:P,popupRef:L},container:I,parent:{page:{pageNumber:D}}}=e,F=I.querySelector("canvas"),H=i.imageManager.getFromCanvas(I.id,F);F.remove();const j=((S=await n._structTree.getAriaAttributes(`${BT}${k}`))==null?void 0:S.get("aria-label"))||"";s=e={annotationType:Bt.STAMP,bitmapId:H.id,bitmap:H.bitmap,pageIndex:D-1,rect:C.slice(0),rotation:T,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:P,popupRef:L}}const o=await super.deserialize(e,n,i),{rect:l,bitmap:h,bitmapUrl:u,bitmapId:f,isSvg:g,accessibilityData:m}=e;f&&i.imageManager.isValidId(f)?(v(o,ti,f),h&&v(o,Be,h)):v(o,el,u),v(o,Ls,g);const[A,_]=o.pageDimensions;return o.width=(l[2]-l[0])/A,o.height=(l[3]-l[1])/_,o.annotationElementId=e.id||null,m&&(o.altTextData=m),o._initialData=s,v(o,mg,!!s),o}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Bt.STAMP,bitmapId:r(this,ti),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,Ls),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=b(this,se,lw).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const h=b(this,se,TF).call(this,i);if(h.isSame)return null;h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const l=r(this,Ls)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(r(this,ti)))n.stamps.set(r(this,ti),{area:l,serialized:i}),i.bitmap=b(this,se,lw).call(this,!1);else if(r(this,Ls)){const h=n.stamps.get(r(this,ti));l>h.area&&(h.area=l,h.serialized.bitmap.close(),h.serialized.bitmap=b(this,se,lw).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},Be=new WeakMap,ti=new WeakMap,Gc=new WeakMap,el=new WeakMap,Wc=new WeakMap,gg=new WeakMap,Ha=new WeakMap,Ba=new WeakMap,Ls=new WeakMap,mg=new WeakMap,se=new WeakSet,My=function(e,n=!1){if(!e){this.remove();return}v(this,Be,e.bitmap),n||(v(this,ti,e.id),v(this,Ls,e.isSvg)),e.file&&v(this,gg,e.file.name),b(this,se,mC).call(this)},Iy=function(){if(v(this,Gc,null),this._uiManager.enableWaiting(!1),!!r(this,Ha)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Be)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Be)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},aw=function(){if(r(this,ti)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,ti)).then(i=>b(this,se,My).call(this,i,!0)).finally(()=>b(this,se,Iy).call(this));return}if(r(this,el)){const i=r(this,el);v(this,el,null),this._uiManager.enableWaiting(!0),v(this,Gc,this._uiManager.imageManager.getFromUrl(i).then(s=>b(this,se,My).call(this,s)).finally(()=>b(this,se,Iy).call(this)));return}if(r(this,Wc)){const i=r(this,Wc);v(this,Wc,null),this._uiManager.enableWaiting(!0),v(this,Gc,this._uiManager.imageManager.getFromFile(i).then(s=>b(this,se,My).call(this,s)).finally(()=>b(this,se,Iy).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Vc.supportedTypesStr;const n=this._uiManager._signal;v(this,Gc,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),b(this,se,My).call(this,s)}i()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>b(this,se,Iy).call(this))),e.click()},mC=function(){var g;const{div:e}=this;let{width:n,height:i}=r(this,Be);const[s,o]=this.pageDimensions,l=.75;if(this.width)n=this.width*s,i=this.height*o;else if(n>l*s||i>l*o){const m=Math.min(l*s/n,l*o/i);n*=m,i*=m}const[h,u]=this.parentDimensions;this.setDims(n*h/s,i*u/o),this._uiManager.enableWaiting(!1);const f=v(this,Ha,document.createElement("canvas"));f.setAttribute("role","img"),this.addContainer(f),this.width=n/s,this.height=i/o,(g=this._initialOptions)!=null&&g.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),b(this,se,yC).call(this),r(this,mg)||(this.parent.addUndoableEditor(this),v(this,mg,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,gg)&&f.setAttribute("aria-label",r(this,gg))},ow=function(e,n){const{width:i,height:s}=r(this,Be);let o=i,l=s,h=r(this,Be);for(;o>2*e||l>2*n;){const u=o,f=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*n&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(h,0,0,u,f,0,0,o,l),h=g.transferToImageBitmap()}return h},yC=function(){const[e,n]=this.parentDimensions,{width:i,height:s}=this,o=new bx,l=Math.ceil(i*e*o.sx),h=Math.ceil(s*n*o.sy),u=r(this,Ha);if(!u||u.width===l&&u.height===h)return;u.width=l,u.height=h;const f=r(this,Ls)?r(this,Be):b(this,se,ow).call(this,l,h),g=u.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,h)},lw=function(e){if(e){if(r(this,Ls)){const s=this._uiManager.imageManager.getSvgUrl(r(this,ti));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=r(this,Be),n.getContext("2d").drawImage(r(this,Be),0,0),n.toDataURL()}if(r(this,Ls)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*ym.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*ym.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(r(this,Be),0,0,r(this,Be).width,r(this,Be).height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(r(this,Be))},TF=function(e){var l;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===n,o=(((l=e.accessibilityData)==null?void 0:l.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},lt(Vc,"_type","stamp"),lt(Vc,"_editorType",Bt.STAMP),Vc);var hd,yg,za,qc,nl,lr,Xc,vg,ud,Xr,il,_i,sl,Tt,hs,Yc,Oe,kF,xa,vC,AC,cw;let rB=(hs=class{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:h,viewport:u,l10n:f}){E(this,Oe);E(this,hd);E(this,yg,!1);E(this,za,null);E(this,qc,null);E(this,nl,null);E(this,lr,new Map);E(this,Xc,!1);E(this,vg,!1);E(this,ud,!1);E(this,Xr,null);E(this,il,null);E(this,_i,null);E(this,sl,null);E(this,Tt);const g=[...r(hs,Yc).values()];if(!hs._initialized){hs._initialized=!0;for(const m of g)m.initialize(f,t)}t.registerEditorTypes(g),v(this,Tt,t),this.pageIndex=e,this.div=n,v(this,hd,s),v(this,za,o),this.viewport=u,v(this,_i,h),this.drawLayer=l,this._structTree=i,r(this,Tt).addLayer(this)}get isEmpty(){return r(this,lr).size===0}get isInvisible(){return this.isEmpty&&r(this,Tt).getMode()===Bt.NONE}updateToolbar(t){r(this,Tt).updateToolbar(t)}updateMode(t=r(this,Tt).getMode()){switch(b(this,Oe,cw).call(this),t){case Bt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Bt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Bt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of r(hs,Yc).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,_i))==null?void 0:e.div)}setEditingState(t){r(this,Tt).setEditingState(t)}addCommands(t){r(this,Tt).addCommands(t)}cleanUndoStack(t){r(this,Tt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,za))==null||e.div.classList.toggle("disabled",!t)}async enable(){v(this,ud,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of r(this,lr).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(r(this,Tt).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!r(this,za)){v(this,ud,!1);return}const e=r(this,za).getEditableAnnotations();for(const n of e){if(n.hide(),r(this,Tt).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}v(this,ud,!1)}disable(){var i;v(this,vg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of r(this,lr).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(i=this.getEditableAnnotation(s.annotationElementId))==null||i.show(),s.remove()}if(r(this,za)){const s=r(this,za).getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(r(this,Tt).isDeletedAnnotationElement(l))continue;let h=e.get(l);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=t.get(l),h&&(r(this,Tt).addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}b(this,Oe,cw).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of r(hs,Yc).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,vg,!1)}getEditableAnnotation(t){var e;return((e=r(this,za))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,Tt).getActive()!==t&&r(this,Tt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,_i))!=null&&t.div&&!r(this,sl)){v(this,sl,new AbortController);const e=r(this,Tt).combinedSignal(r(this,sl));r(this,_i).div.addEventListener("pointerdown",b(this,Oe,kF).bind(this),{signal:e}),r(this,_i).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,_i))!=null&&t.div&&r(this,sl)&&(r(this,sl).abort(),v(this,sl,null),r(this,_i).div.classList.remove("highlighting"))}enableClick(){if(r(this,qc))return;v(this,qc,new AbortController);const t=r(this,Tt).combinedSignal(r(this,qc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=r(this,qc))==null||t.abort(),v(this,qc,null)}attach(t){r(this,lr).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,Tt).isDeletedAnnotationElement(e)&&r(this,Tt).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,lr).delete(t.id),(e=r(this,hd))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,vg)&&t.annotationElementId&&r(this,Tt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,Tt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,Tt).addDeletedAnnotationElement(t.annotationElementId),nn.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,Tt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!r(this,ud)),r(this,Tt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,nl)&&(t._focusEventsAllowed=!1,v(this,nl,setTimeout(()=>{v(this,nl,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,Tt)._signal}),e.focus())},0))),t._structTreeParentId=(n=r(this,hd))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return r(this,Tt).getId()}combinedSignal(t){return r(this,Tt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,Oe,xa))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,Tt).updateToolbar(t),r(this,Tt).updateMode(t);const{offsetX:n,offsetY:i}=b(this,Oe,AC).call(this),s=this.getNextId(),o=b(this,Oe,vC).call(this,{parent:this,id:s,x:n,y:i,uiManager:r(this,Tt),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=r(hs,Yc).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,Tt)))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),s=b(this,Oe,vC).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:r(this,Tt),isCentered:e,...n});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(b(this,Oe,AC).call(this),!0)}setSelected(t){r(this,Tt).setSelected(t)}toggleSelected(t){r(this,Tt).toggleSelected(t)}unselect(t){r(this,Tt).unselect(t)}pointerup(t){var n;const{isMac:e}=Hi.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,Xc)&&(v(this,Xc,!1),!((n=r(this,Oe,xa))!=null&&n.isDrawer&&r(this,Oe,xa).supportMultipleDrawings))){if(!r(this,yg)){v(this,yg,!0);return}if(r(this,Tt).getMode()===Bt.STAMP){r(this,Tt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var i;if(r(this,Tt).getMode()===Bt.HIGHLIGHT&&this.enableTextSelection(),r(this,Xc)){v(this,Xc,!1);return}const{isMac:e}=Hi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(v(this,Xc,!0),(i=r(this,Oe,xa))!=null&&i.isDrawer){this.startDrawingSession(t);return}const n=r(this,Tt).getActive();v(this,yg,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus(),r(this,Xr)){r(this,Oe,xa).startDrawing(this,r(this,Tt),!1,t);return}r(this,Tt).setCurrentDrawingSession(this),v(this,Xr,new AbortController);const e=r(this,Tt).combinedSignal(r(this,Xr));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(v(this,il,null),this.commitOrRemove())},{signal:e}),r(this,Oe,xa).startDrawing(this,r(this,Tt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&v(this,il,e);return}r(this,il)&&setTimeout(()=>{var e;(e=r(this,il))==null||e.focus(),v(this,il,null)},0)}endDrawingSession(t=!1){return r(this,Xr)?(r(this,Tt).setCurrentDrawingSession(null),r(this,Xr).abort(),v(this,Xr,null),v(this,il,null),r(this,Oe,xa).endDrawing(t)):null}findNewParent(t,e,n){const i=r(this,Tt).findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return r(this,Xr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){r(this,Xr)&&r(this,Oe,xa).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=r(this,Tt).getActive())==null?void 0:t.parent)===this&&(r(this,Tt).commitOrRemove(),r(this,Tt).setActiveEditor(null)),r(this,nl)&&(clearTimeout(r(this,nl)),v(this,nl,null));for(const n of r(this,lr).values())(e=r(this,hd))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,r(this,lr).clear(),r(this,Tt).removeLayer(this)}render({viewport:t}){this.viewport=t,hf(this.div,t);for(const e of r(this,Tt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,Tt).commitOrRemove(),b(this,Oe,cw).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,hf(this.div,{rotation:n}),e!==n)for(const i of r(this,lr).values())i.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,Tt).viewParameters.realScale}},hd=new WeakMap,yg=new WeakMap,za=new WeakMap,qc=new WeakMap,nl=new WeakMap,lr=new WeakMap,Xc=new WeakMap,vg=new WeakMap,ud=new WeakMap,Xr=new WeakMap,il=new WeakMap,_i=new WeakMap,sl=new WeakMap,Tt=new WeakMap,Yc=new WeakMap,Oe=new WeakSet,kF=function(t){r(this,Tt).unselectAll();const{target:e}=t;if(e===r(this,_i).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,_i).div.contains(e)){const{isMac:n}=Hi.platform;if(t.button!==0||t.ctrlKey&&n)return;r(this,Tt).showAllEditors("highlight",!0,!0),r(this,_i).div.classList.add("free"),this.toggleDrawing(),xL.startHighlighting(this,r(this,Tt).direction==="ltr",{target:r(this,_i).div,x:t.x,y:t.y}),r(this,_i).div.addEventListener("pointerup",()=>{r(this,_i).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,Tt)._signal}),t.preventDefault()}},xa=function(){return r(hs,Yc).get(r(this,Tt).getMode())},vC=function(t){const e=r(this,Oe,xa);return e?new e.prototype.constructor(t):null},AC=function(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),o=Math.max(0,e),l=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),u=(s+l)/2-t,f=(o+h)/2-e,[g,m]=this.viewport.rotation%180===0?[u,f]:[f,u];return{offsetX:g,offsetY:m}},cw=function(){for(const t of r(this,lr).values())t.isEmpty()&&t.remove()},lt(hs,"_initialized",!1),E(hs,Yc,new Map([JH,iB,sB,xL].map(t=>[t._editorType,t]))),hs);var Yr,TA,$i,dd,hE,En,PF,co,bC,RF,_C;let aB=(En=class{constructor({pageIndex:t}){E(this,co);E(this,Yr,null);E(this,TA,0);E(this,$i,new Map);E(this,dd,new Map);this.pageIndex=t}setParent(t){if(!r(this,Yr)){v(this,Yr,t);return}if(r(this,Yr)!==t){if(r(this,$i).size>0)for(const e of r(this,$i).values())e.remove(),t.append(e);v(this,Yr,t)}}static get _svgFactory(){return Yt(this,"_svgFactory",new XT)}draw(t,e=!1,n=!1){const i=le(this,TA)._++,s=b(this,co,bC).call(this),o=En._svgFactory.createElement("defs");s.append(o);const l=En._svgFactory.createElement("path");o.append(l);const h=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",h),l.setAttribute("vector-effect","non-scaling-stroke"),e&&r(this,dd).set(i,l);const u=n?b(this,co,RF).call(this,o,h):null,f=En._svgFactory.createElement("use");return s.append(f),f.setAttribute("href",`#${h}`),this.updateProperties(s,t),r(this,$i).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(t,e){const n=le(this,TA)._++,i=b(this,co,bC).call(this),s=En._svgFactory.createElement("defs");i.append(s);const o=En._svgFactory.createElement("path");s.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const g=En._svgFactory.createElement("mask");s.append(g),h=`mask_p${this.pageIndex}_${n}`,g.setAttribute("id",h),g.setAttribute("maskUnits","objectBoundingBox");const m=En._svgFactory.createElement("rect");g.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const A=En._svgFactory.createElement("use");g.append(A),A.setAttribute("href",`#${l}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const u=En._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${l}`),h&&u.setAttribute("mask",`url(#${h})`);const f=u.cloneNode();return i.append(f),u.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(i,t),r(this,$i).set(n,i),n}finalizeDraw(t,e){r(this,dd).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var h;if(!e)return;const{root:n,bbox:i,rootClass:s,path:o}=e,l=typeof t=="number"?r(this,$i).get(t):t;if(l){if(n&&b(this,co,_C).call(this,l,n),i&&b(h=En,hE,PF).call(h,l,i),s){const{classList:u}=l;for(const[f,g]of Object.entries(s))u.toggle(f,g)}if(o){const f=l.firstChild.firstChild;b(this,co,_C).call(this,f,o)}}}updateParent(t,e){if(e===this)return;const n=r(this,$i).get(t);n&&(r(e,Yr).append(n),r(this,$i).delete(t),r(e,$i).set(t,n))}remove(t){r(this,dd).delete(t),r(this,Yr)!==null&&(r(this,$i).get(t).remove(),r(this,$i).delete(t))}destroy(){v(this,Yr,null);for(const t of r(this,$i).values())t.remove();r(this,$i).clear(),r(this,dd).clear()}},Yr=new WeakMap,TA=new WeakMap,$i=new WeakMap,dd=new WeakMap,hE=new WeakSet,PF=function(t,[e,n,i,s]){const{style:o}=t;o.top=`${100*n}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},co=new WeakSet,bC=function(){const t=En._svgFactory.create(1,1,!0);return r(this,Yr).append(t),t.setAttribute("aria-hidden",!0),t},RF=function(t,e){const n=En._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=En._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i},_C=function(t,e){for(const[n,i]of Object.entries(e))i===null?t.removeAttribute(n):t.setAttribute(n,i)},E(En,hE),En);globalThis.pdfjsTestingUtils={HighlightOutliner:iC};Ft.AbortException;Ft.AnnotationEditorLayer;Ft.AnnotationEditorParamsType;Ft.AnnotationEditorType;Ft.AnnotationEditorUIManager;Ft.AnnotationLayer;Ft.AnnotationMode;Ft.ColorPicker;Ft.DOMSVGFactory;Ft.DrawLayer;Ft.FeatureTest;var LF=Ft.GlobalWorkerOptions;Ft.ImageKind;Ft.InvalidPDFException;Ft.MissingPDFException;Ft.OPS;Ft.OutputScale;Ft.PDFDataRangeTransport;Ft.PDFDateString;Ft.PDFWorker;Ft.PasswordResponses;Ft.PermissionFlag;Ft.PixelsPerInch;Ft.RenderingCancelledException;Ft.TextLayer;Ft.TouchManager;Ft.UnexpectedResponseException;Ft.Util;Ft.VerbosityLevel;Ft.XfaLayer;Ft.build;Ft.createValidAbsoluteUrl;Ft.fetchData;var oB=Ft.getDocument;Ft.getFilenameFromUrl;Ft.getPdfFilenameFromUrl;Ft.getXfaPageViewport;Ft.isDataScheme;Ft.isPdfFile;Ft.noContextMenu;Ft.normalizeUnicode;Ft.setLayerDimensions;Ft.shadow;Ft.stopEvent;Ft.version;const lB=p=>{var n;let t="Unknown",e=null;if(p.target.files&&p.target.files[0]){if(e=p.target.files[0],e){const i=(n=e.name.split(".").pop())==null?void 0:n.toLowerCase();i==="pdf"?t="PDF":["jpg","jpeg","png","gif"].includes(i||"")?t="Image":t="Unknown"}return{fileType:t,file:e}}};var j1={exports:{}},CL;function cB(){return CL||(CL=1,function(p){var t=function(e){var n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(U,N,M){U[N]=M.value},o,l=typeof Symbol=="function"?Symbol:{},h=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function g(U,N,M){return Object.defineProperty(U,N,{value:M,enumerable:!0,configurable:!0,writable:!0}),U[N]}try{g({},"")}catch{g=function(N,M,B){return N[M]=B}}function m(U,N,M,B){var Y=N&&N.prototype instanceof P?N:P,it=Object.create(Y.prototype),dt=new J(B||[]);return s(it,"_invoke",{value:tt(U,M,dt)}),it}e.wrap=m;function A(U,N,M){try{return{type:"normal",arg:U.call(N,M)}}catch(B){return{type:"throw",arg:B}}}var _="suspendedStart",S="suspendedYield",C="executing",T="completed",k={};function P(){}function L(){}function I(){}var D={};g(D,h,function(){return this});var F=Object.getPrototypeOf,H=F&&F(F(G([])));H&&H!==n&&i.call(H,h)&&(D=H);var j=I.prototype=P.prototype=Object.create(D);L.prototype=I,s(j,"constructor",{value:I,configurable:!0}),s(I,"constructor",{value:L,configurable:!0}),L.displayName=g(I,f,"GeneratorFunction");function Q(U){["next","throw","return"].forEach(function(N){g(U,N,function(M){return this._invoke(N,M)})})}e.isGeneratorFunction=function(U){var N=typeof U=="function"&&U.constructor;return N?N===L||(N.displayName||N.name)==="GeneratorFunction":!1},e.mark=function(U){return Object.setPrototypeOf?Object.setPrototypeOf(U,I):(U.__proto__=I,g(U,f,"GeneratorFunction")),U.prototype=Object.create(j),U},e.awrap=function(U){return{__await:U}};function W(U,N){function M(it,dt,at,nt){var yt=A(U[it],U,dt);if(yt.type==="throw")nt(yt.arg);else{var ut=yt.arg,St=ut.value;return St&&typeof St=="object"&&i.call(St,"__await")?N.resolve(St.__await).then(function(Kt){M("next",Kt,at,nt)},function(Kt){M("throw",Kt,at,nt)}):N.resolve(St).then(function(Kt){ut.value=Kt,at(ut)},function(Kt){return M("throw",Kt,at,nt)})}}var B;function Y(it,dt){function at(){return new N(function(nt,yt){M(it,dt,nt,yt)})}return B=B?B.then(at,at):at()}s(this,"_invoke",{value:Y})}Q(W.prototype),g(W.prototype,u,function(){return this}),e.AsyncIterator=W,e.async=function(U,N,M,B,Y){Y===void 0&&(Y=Promise);var it=new W(m(U,N,M,B),Y);return e.isGeneratorFunction(N)?it:it.next().then(function(dt){return dt.done?dt.value:it.next()})};function tt(U,N,M){var B=_;return function(it,dt){if(B===C)throw new Error("Generator is already running");if(B===T){if(it==="throw")throw dt;return q()}for(M.method=it,M.arg=dt;;){var at=M.delegate;if(at){var nt=Z(at,M);if(nt){if(nt===k)continue;return nt}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(B===_)throw B=T,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);B=C;var yt=A(U,N,M);if(yt.type==="normal"){if(B=M.done?T:S,yt.arg===k)continue;return{value:yt.arg,done:M.done}}else yt.type==="throw"&&(B=T,M.method="throw",M.arg=yt.arg)}}}function Z(U,N){var M=N.method,B=U.iterator[M];if(B===o)return N.delegate=null,M==="throw"&&U.iterator.return&&(N.method="return",N.arg=o,Z(U,N),N.method==="throw")||M!=="return"&&(N.method="throw",N.arg=new TypeError("The iterator does not provide a '"+M+"' method")),k;var Y=A(B,U.iterator,N.arg);if(Y.type==="throw")return N.method="throw",N.arg=Y.arg,N.delegate=null,k;var it=Y.arg;if(!it)return N.method="throw",N.arg=new TypeError("iterator result is not an object"),N.delegate=null,k;if(it.done)N[U.resultName]=it.value,N.next=U.nextLoc,N.method!=="return"&&(N.method="next",N.arg=o);else return it;return N.delegate=null,k}Q(j),g(j,f,"Generator"),g(j,h,function(){return this}),g(j,"toString",function(){return"[object Generator]"});function et(U){var N={tryLoc:U[0]};1 in U&&(N.catchLoc=U[1]),2 in U&&(N.finallyLoc=U[2],N.afterLoc=U[3]),this.tryEntries.push(N)}function ht(U){var N=U.completion||{};N.type="normal",delete N.arg,U.completion=N}function J(U){this.tryEntries=[{tryLoc:"root"}],U.forEach(et,this),this.reset(!0)}e.keys=function(U){var N=Object(U),M=[];for(var B in N)M.push(B);return M.reverse(),function Y(){for(;M.length;){var it=M.pop();if(it in N)return Y.value=it,Y.done=!1,Y}return Y.done=!0,Y}};function G(U){if(U){var N=U[h];if(N)return N.call(U);if(typeof U.next=="function")return U;if(!isNaN(U.length)){var M=-1,B=function Y(){for(;++M<U.length;)if(i.call(U,M))return Y.value=U[M],Y.done=!1,Y;return Y.value=o,Y.done=!0,Y};return B.next=B}}return{next:q}}e.values=G;function q(){return{value:o,done:!0}}return J.prototype={constructor:J,reset:function(U){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ht),!U)for(var N in this)N.charAt(0)==="t"&&i.call(this,N)&&!isNaN(+N.slice(1))&&(this[N]=o)},stop:function(){this.done=!0;var U=this.tryEntries[0],N=U.completion;if(N.type==="throw")throw N.arg;return this.rval},dispatchException:function(U){if(this.done)throw U;var N=this;function M(nt,yt){return it.type="throw",it.arg=U,N.next=nt,yt&&(N.method="next",N.arg=o),!!yt}for(var B=this.tryEntries.length-1;B>=0;--B){var Y=this.tryEntries[B],it=Y.completion;if(Y.tryLoc==="root")return M("end");if(Y.tryLoc<=this.prev){var dt=i.call(Y,"catchLoc"),at=i.call(Y,"finallyLoc");if(dt&&at){if(this.prev<Y.catchLoc)return M(Y.catchLoc,!0);if(this.prev<Y.finallyLoc)return M(Y.finallyLoc)}else if(dt){if(this.prev<Y.catchLoc)return M(Y.catchLoc,!0)}else if(at){if(this.prev<Y.finallyLoc)return M(Y.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(U,N){for(var M=this.tryEntries.length-1;M>=0;--M){var B=this.tryEntries[M];if(B.tryLoc<=this.prev&&i.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var Y=B;break}}Y&&(U==="break"||U==="continue")&&Y.tryLoc<=N&&N<=Y.finallyLoc&&(Y=null);var it=Y?Y.completion:{};return it.type=U,it.arg=N,Y?(this.method="next",this.next=Y.finallyLoc,k):this.complete(it)},complete:function(U,N){if(U.type==="throw")throw U.arg;return U.type==="break"||U.type==="continue"?this.next=U.arg:U.type==="return"?(this.rval=this.arg=U.arg,this.method="return",this.next="end"):U.type==="normal"&&N&&(this.next=N),k},finish:function(U){for(var N=this.tryEntries.length-1;N>=0;--N){var M=this.tryEntries[N];if(M.finallyLoc===U)return this.complete(M.completion,M.afterLoc),ht(M),k}},catch:function(U){for(var N=this.tryEntries.length-1;N>=0;--N){var M=this.tryEntries[N];if(M.tryLoc===U){var B=M.completion;if(B.type==="throw"){var Y=B.arg;ht(M)}return Y}}throw new Error("illegal catch attempt")},delegateYield:function(U,N,M){return this.delegate={iterator:G(U),resultName:N,nextLoc:M},this.method==="next"&&(this.arg=o),k}},e}(p.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(j1)),j1.exports}var H1,TL;function KT(){return TL||(TL=1,H1=(p,t)=>`${p}-${t}-${Math.random().toString(16).slice(3,8)}`),H1}var B1,kL;function MF(){if(kL)return B1;kL=1;const p=KT();let t=0;return B1=({id:e,action:n,payload:i={}})=>{let s=e;return typeof s>"u"&&(s=p("Job",t),t+=1),{id:s,action:n,payload:i}},B1}var ly={},PL;function QT(){if(PL)return ly;PL=1;let p=!1;return ly.logging=p,ly.setLogging=t=>{p=t},ly.log=(...t)=>p?console.log.apply(this,t):null,ly}var z1,RL;function hB(){if(RL)return z1;RL=1;const p=MF(),{log:t}=QT(),e=KT();let n=0;return z1=()=>{const i=e("Scheduler",n),s={},o={};let l=[];n+=1;const h=()=>l.length,u=()=>Object.keys(s).length,f=()=>{if(l.length!==0){const S=Object.keys(s);for(let C=0;C<S.length;C+=1)if(typeof o[S[C]]>"u"){l[0](s[S[C]]);break}}},g=(S,C)=>new Promise((T,k)=>{const P=p({action:S,payload:C});l.push(async L=>{l.shift(),o[L.id]=P;try{T(await L[S].apply(this,[...C,P.id]))}catch(I){k(I)}finally{delete o[L.id],f()}}),t(`[${i}]: Add ${P.id} to JobQueue`),t(`[${i}]: JobQueue length=${l.length}`),f()});return{addWorker:S=>(s[S.id]=S,t(`[${i}]: Add ${S.id}`),t(`[${i}]: Number of workers=${u()}`),f(),S.id),addJob:async(S,...C)=>{if(u()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return g(S,C)},terminate:async()=>{Object.keys(s).forEach(async S=>{await s[S].terminate()}),l=[]},getQueueLen:h,getNumWorkers:u}},z1}function uB(p){throw new Error('Could not dynamically require "'+p+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var U1,LL;function dB(){return LL||(LL=1,U1=p=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof uB=="function"&&(t.type="node"),typeof p>"u"?t:t[p]}),U1}var G1,ML;function fB(){if(ML)return G1;ML=1;const t=dB()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return G1=e=>{const n={...e};return["corePath","workerPath","langPath"].forEach(i=>{e[i]&&(n[i]=t(n[i]))}),n},G1}var W1,IL;function IF(){return IL||(IL=1,W1={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),W1}const pB="tesseract.js",gB="6.0.0",mB="Pure Javascript Multilingual OCR",yB="src/index.js",vB="src/index.d.ts",AB="dist/tesseract.min.js",bB="dist/tesseract.min.js",_B={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},wB={"./src/worker/node/index.js":"./src/worker/browser/index.js"},EB="",SB=["jeromewu"],xB="Apache-2.0",CB={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},TB={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},kB={"@rollup/pluginutils":"^5.0.2"},PB={type:"git",url:"https://github.com/naptha/tesseract.js.git"},RB={url:"https://github.com/naptha/tesseract.js/issues"},LB="https://github.com/naptha/tesseract.js",MB={type:"opencollective",url:"https://opencollective.com/tesseractjs"},IB={name:pB,version:gB,description:mB,main:yB,types:vB,unpkg:AB,jsdelivr:bB,scripts:_B,browser:wB,author:EB,contributors:SB,license:xB,devDependencies:CB,dependencies:TB,overrides:kB,repository:PB,bugs:RB,homepage:LB,collective:MB};var V1,DL;function DB(){return DL||(DL=1,V1={workerBlobURL:!0,logger:()=>{}}),V1}var q1,FL;function FB(){if(FL)return q1;FL=1;const p=IB.version;return q1={...DB(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${p}/dist/worker.min.js`},q1}var X1,OL;function OB(){return OL||(OL=1,X1=({workerPath:p,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const n=new Blob([`importScripts("${p}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(n))}else e=new Worker(p);return e}),X1}var Y1,NL;function NB(){return NL||(NL=1,Y1=p=>{p.terminate()}),Y1}var K1,$L;function $B(){return $L||($L=1,K1=(p,t)=>{p.onmessage=({data:e})=>{t(e)}}),K1}var Q1,jL;function jB(){return jL||(jL=1,Q1=async(p,t)=>{p.postMessage(t)}),Q1}var J1,HL;function HB(){if(HL)return J1;HL=1;const p=e=>new Promise((n,i)=>{const s=new FileReader;s.onload=()=>{n(s.result)},s.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},s.readAsArrayBuffer(e)}),t=async e=>{let n=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?n=atob(e.split(",")[1]).split("").map(i=>i.charCodeAt(0)):n=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(n=await t(e.src)),e.tagName==="VIDEO"&&(n=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(i=>{e.toBlob(async s=>{n=await p(s),i()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const i=await e.convertToBlob();n=await p(i)}else(e instanceof File||e instanceof Blob)&&(n=await p(e));return new Uint8Array(n)};return J1=t,J1}var Z1,BL;function BB(){if(BL)return Z1;BL=1;const p=FB(),t=OB(),e=NB(),n=$B(),i=jB(),s=HB();return Z1={defaultOptions:p,spawnWorker:t,terminateWorker:e,onMessage:n,send:i,loadImage:s},Z1}var tx,zL;function DF(){if(zL)return tx;zL=1;const p=fB(),t=MF(),{log:e}=QT(),n=KT(),i=IF(),{defaultOptions:s,spawnWorker:o,terminateWorker:l,onMessage:h,loadImage:u,send:f}=BB();let g=0;return tx=async(m="eng",A=i.LSTM_ONLY,_={},S={})=>{const C=n("Worker",g),{logger:T,errorHandler:k,...P}=p({...s,..._}),L={},I=typeof m=="string"?m.split("+"):m;let D=A,F=S;const H=[i.DEFAULT,i.LSTM_ONLY].includes(A)&&!P.legacyCore;let j,Q;const W=new Promise((ut,St)=>{Q=ut,j=St}),tt=ut=>{j(ut.message)};let Z=o(P);Z.onerror=tt,g+=1;const et=({id:ut,action:St,payload:Kt})=>new Promise((Ee,Me)=>{e(`[${C}]: Start ${ut}, action=${St}`);const Se=`${St}-${ut}`;L[Se]={resolve:Ee,reject:Me},f(Z,{workerId:C,jobId:ut,action:St,payload:Kt})}),ht=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),J=ut=>et(t({id:ut,action:"load",payload:{options:{lstmOnly:H,corePath:P.corePath,logging:P.logging}}})),G=(ut,St,Kt)=>et(t({id:Kt,action:"FS",payload:{method:"writeFile",args:[ut,St]}})),q=(ut,St)=>et(t({id:St,action:"FS",payload:{method:"readFile",args:[ut,{encoding:"utf8"}]}})),U=(ut,St)=>et(t({id:St,action:"FS",payload:{method:"unlink",args:[ut]}})),N=(ut,St,Kt)=>et(t({id:Kt,action:"FS",payload:{method:ut,args:St}})),M=(ut,St)=>et(t({id:St,action:"loadLanguage",payload:{langs:ut,options:{langPath:P.langPath,dataPath:P.dataPath,cachePath:P.cachePath,cacheMethod:P.cacheMethod,gzip:P.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(D)&&!P.legacyLang}}})),B=(ut,St,Kt,Ee)=>et(t({id:Ee,action:"initialize",payload:{langs:ut,oem:St,config:Kt}})),Y=(ut="eng",St,Kt,Ee)=>{if(H&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(St))throw Error("Legacy model requested but code missing.");const Me=St||D;D=Me;const Se=Kt||F;F=Se;const oi=(typeof ut=="string"?ut.split("+"):ut).filter(li=>!I.includes(li));return I.push(...oi),oi.length>0?M(oi,Ee).then(()=>B(ut,Me,Se,Ee)):B(ut,Me,Se,Ee)},it=(ut={},St)=>et(t({id:St,action:"setParameters",payload:{params:ut}})),dt=async(ut,St={},Kt={text:!0},Ee)=>et(t({id:Ee,action:"recognize",payload:{image:await u(ut),options:St,output:Kt}})),at=async(ut,St)=>{if(H)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return et(t({id:St,action:"detect",payload:{image:await u(ut)}}))},nt=async()=>(Z!==null&&(l(Z),Z=null),Promise.resolve());h(Z,({workerId:ut,jobId:St,status:Kt,action:Ee,data:Me})=>{const Se=`${Ee}-${St}`;if(Kt==="resolve")e(`[${ut}]: Complete ${St}`),L[Se].resolve({jobId:St,data:Me}),delete L[Se];else if(Kt==="reject")if(L[Se].reject(Me),delete L[Se],Ee==="load"&&j(Me),k)k(Me);else throw Error(Me);else Kt==="progress"&&T({...Me,userJobId:St})});const yt={id:C,worker:Z,load:ht,writeText:G,readText:q,removeFile:U,FS:N,reinitialize:Y,setParameters:it,recognize:dt,detect:at,terminate:nt};return J().then(()=>M(m)).then(()=>B(m,A,S)).then(()=>Q(yt)).catch(()=>{}),W},tx}var ex,UL;function zB(){if(UL)return ex;UL=1;const p=DF();return ex={recognize:async(n,i,s)=>{const o=await p(i,1,s);return o.recognize(n).finally(async()=>{await o.terminate()})},detect:async(n,i)=>{const s=await p("osd",0,i);return s.detect(n).finally(async()=>{await s.terminate()})}},ex}var nx,GL;function UB(){return GL||(GL=1,nx={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),nx}var ix,WL;function GB(){return WL||(WL=1,ix={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),ix}var sx,VL;function WB(){if(VL)return sx;VL=1,cB();const p=hB(),t=DF(),e=zB(),n=UB(),i=IF(),s=GB(),{setLogging:o}=QT();return sx={languages:n,OEM:i,PSM:s,createScheduler:p,createWorker:t,setLogging:o,...e},sx}var VB=WB();const qL=TI(VB);var cy={},Pe={};const qB="modulepreload",XB=function(p){return"/"+p},XL={},u_=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(e.map(h=>{if(h=XB(h),h in XL)return;XL[h]=!0;const u=h.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${f}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":qB,u||(g.as="script"),g.crossOrigin="",g.href=h,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((m,A)=>{g.addEventListener("load",m),g.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};var Qy={};Qy.d=(p,t)=>{for(var e in t)Qy.o(t,e)&&!Qy.o(p,e)&&Object.defineProperty(p,e,{enumerable:!0,get:t[e]})};Qy.o=(p,t)=>Object.prototype.hasOwnProperty.call(p,t);var Nt=globalThis.pdfjsLib={};Qy.d(Nt,{AbortException:()=>bf,AnnotationEditorLayer:()=>IT,AnnotationEditorParamsType:()=>Ot,AnnotationEditorType:()=>zt,AnnotationEditorUIManager:()=>ff,AnnotationLayer:()=>V3,AnnotationMode:()=>vc,ColorPicker:()=>qw,DOMSVGFactory:()=>ck,DrawLayer:()=>NT,FeatureTest:()=>Bi,GlobalWorkerOptions:()=>Pl,ImageKind:()=>hw,InvalidPDFException:()=>OF,MissingPDFException:()=>Af,OPS:()=>Nr,OutputScale:()=>CC,PDFDataRangeTransport:()=>MO,PDFDateString:()=>nk,PDFWorker:()=>hp,PasswordResponses:()=>JB,PermissionFlag:()=>QB,PixelsPerInch:()=>xh,RenderingCancelledException:()=>tk,TextLayer:()=>tT,UnexpectedResponseException:()=>jE,Util:()=>kt,VerbosityLevel:()=>OE,XfaLayer:()=>DO,build:()=>C3,createValidAbsoluteUrl:()=>nz,fetchData:()=>BE,getDocument:()=>y3,getFilenameFromUrl:()=>uz,getPdfFilenameFromUrl:()=>dz,getXfaPageViewport:()=>fz,isDataScheme:()=>zE,isPdfFile:()=>ek,noContextMenu:()=>wr,normalizeUnicode:()=>lz,setLayerDimensions:()=>df,shadow:()=>Zt,version:()=>x3});const ki=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),FF=[1,0,0,1,0,0],wC=[.001,0,0,.001,0,0],YB=1e7,rx=1.35,Bs={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},vc={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},KB="pdfjs_internal_editor_",zt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Ot={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},QB={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},mi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hw={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},yn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},hy={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},OE={ERRORS:0,WARNINGS:1,INFOS:5},Nr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},JB={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let NE=OE.WARNINGS;function ZB(p){Number.isInteger(p)&&(NE=p)}function tz(){return NE}function $E(p){NE>=OE.INFOS&&console.log(`Info: ${p}`)}function Wt(p){NE>=OE.WARNINGS&&console.log(`Warning: ${p}`)}function Le(p){throw new Error(p)}function Sn(p,t){p||Le(t)}function ez(p){switch(p==null?void 0:p.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function nz(p,t=null,e=null){if(!p)return null;try{if(e&&typeof p=="string"){if(e.addDefaultProtocol&&p.startsWith("www.")){const i=p.match(/\./g);(i==null?void 0:i.length)>=2&&(p=`http://${p}`)}if(e.tryConvertEncoding)try{p=oz(p)}catch{}}const n=t?new URL(p,t):new URL(p);if(ez(n))return n}catch{}return null}function Zt(p,t,e,n=!1){return Object.defineProperty(p,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Lh=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class EC extends Lh{constructor(t,e){super(t,"PasswordException"),this.code=e}}class SC extends Lh{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class OF extends Lh{constructor(t){super(t,"InvalidPDFException")}}class Af extends Lh{constructor(t){super(t,"MissingPDFException")}}class jE extends Lh{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class iz extends Lh{constructor(t){super(t,"FormatError")}}class bf extends Lh{constructor(t){super(t,"AbortException")}}function NF(p){(typeof p!="object"||(p==null?void 0:p.length)===void 0)&&Le("Invalid argument for bytesToString");const t=p.length,e=8192;if(t<e)return String.fromCharCode.apply(null,p);const n=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),o=p.subarray(i,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function HE(p){typeof p!="string"&&Le("Invalid argument for stringToBytes");const t=p.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=p.charCodeAt(n)&255;return e}function sz(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function JT(p){const t=Object.create(null);for(const[e,n]of p)t[e]=n;return t}function rz(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function az(){try{return new Function(""),!0}catch{return!1}}class Bi{static get isLittleEndian(){return Zt(this,"isLittleEndian",rz())}static get isEvalSupported(){return Zt(this,"isEvalSupported",az())}static get isOffscreenCanvasSupported(){return Zt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Zt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Zt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return Zt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const ax=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));var Dl,uw,xC;class kt{static makeHexColor(t,e,n){return`#${ax[t]}${ax[e]}${ax[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const n=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[n,i]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n;return[i,s]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],s[0],o[0]),Math.min(n[1],i[1],s[1],o[1]),Math.max(n[0],i[0],s[0],o[0]),Math.max(n[1],i[1],s[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],l=(n+o)/2,h=Math.sqrt((n+o)**2-4*(n*o-s*i))/2,u=l+h||1,f=l-h||1;return[Math.sqrt(u),Math.sqrt(f)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>o?null:[n,s,i,o]}static bezierBoundingBox(t,e,n,i,s,o,l,h,u){return u?(u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],e,h),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],e,h)):u=[Math.min(t,l),Math.min(e,h),Math.max(t,l),Math.max(e,h)],b(this,Dl,xC).call(this,t,n,s,l,e,i,o,h,3*(-t+3*(n-s)+l),6*(t-2*n+s),3*(n-t),u),b(this,Dl,xC).call(this,t,n,s,l,e,i,o,h,3*(-e+3*(i-o)+h),6*(e-2*i+o),3*(i-e),u),u}}Dl=new WeakSet,uw=function(t,e,n,i,s,o,l,h,u,f){if(u<=0||u>=1)return;const g=1-u,m=u*u,A=m*u,_=g*(g*(g*t+3*u*e)+3*m*n)+A*i,S=g*(g*(g*s+3*u*o)+3*m*l)+A*h;f[0]=Math.min(f[0],_),f[1]=Math.min(f[1],S),f[2]=Math.max(f[2],_),f[3]=Math.max(f[3],S)},xC=function(t,e,n,i,s,o,l,h,u,f,g,m){if(Math.abs(u)<1e-12){Math.abs(f)>=1e-12&&b(this,Dl,uw).call(this,t,e,n,i,s,o,l,h,-g/f,m);return}const A=f**2-4*g*u;if(A<0)return;const _=Math.sqrt(A),S=2*u;b(this,Dl,uw).call(this,t,e,n,i,s,o,l,h,(-f+_)/S,m),b(this,Dl,uw).call(this,t,e,n,i,s,o,l,h,(-f-_)/S,m)},E(kt,Dl);function oz(p){return decodeURIComponent(escape(p))}let ox=null,YL=null;function lz(p){return ox||(ox=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,YL=new Map([["","t"]])),p.replaceAll(ox,(t,e,n)=>e?e.normalize("NFKC"):YL.get(n))}function cz(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const p=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(p);else for(let t=0;t<32;t++)p[t]=Math.floor(Math.random()*255);return NF(p)}const ZT="pdfjs_internal_id_",So={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function hz(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(NF(p))}const Ro="http://www.w3.org/2000/svg",su=class su{};lt(su,"CSS",96),lt(su,"PDF",72),lt(su,"PDF_TO_CSS_UNITS",su.CSS/su.PDF);let xh=su;async function BE(p,t="text"){if(Dy(p,document.baseURI)){const e=await fetch(p);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",p,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class Wb{constructor({viewBox:t,scale:e,rotation:n,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=t,this.scale=e,this.rotation=n,this.offsetX=i,this.offsetY=s;const l=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let u,f,g,m;switch(n%=360,n<0&&(n+=360),n){case 180:u=-1,f=0,g=0,m=1;break;case 90:u=0,f=1,g=1,m=0;break;case 270:u=0,f=-1,g=-1,m=0;break;case 0:u=1,f=0,g=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(g=-g,m=-m);let A,_,S,C;u===0?(A=Math.abs(h-t[1])*e+i,_=Math.abs(l-t[0])*e+s,S=(t[3]-t[1])*e,C=(t[2]-t[0])*e):(A=Math.abs(l-t[0])*e+i,_=Math.abs(h-t[1])*e+s,S=(t[2]-t[0])*e,C=(t[3]-t[1])*e),this.transform=[u*e,f*e,g*e,m*e,A-u*e*l-g*e*h,_-f*e*l-m*e*h],this.width=S,this.height=C}get rawDims(){const{viewBox:t}=this;return Zt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new Wb({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){return kt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=kt.applyTransform([t[0],t[1]],this.transform),n=kt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return kt.applyInverseTransform([t,e],this.transform)}}class tk extends Lh{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function zE(p){const t=p.length;let e=0;for(;e<t&&p[e].trim()==="";)e++;return p.substring(e,e+5).toLowerCase()==="data:"}function ek(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function uz(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function dz(p,t="document.pdf"){if(typeof p!="string")return t;if(zE(p))return Wt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(p);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||t}class KL{constructor(){lt(this,"started",Object.create(null));lt(this,"times",[])}time(t){t in this.started&&Wt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Wt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:s}of this.times)t.push(`${n.padEnd(e)} ${s-i}ms
`);return t.join("")}}function Dy(p,t){try{const{protocol:e}=t?new URL(p,t):new URL(p);return e==="http:"||e==="https:"}catch{return!1}}function wr(p){p.preventDefault()}function QL(p){console.log("Deprecated API usage: "+p)}var kA;class nk{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,kA)||v(this,kA,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,kA).exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const u=e[7]||"Z";let f=parseInt(e[8],10);f=f>=0&&f<=23?f:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,u==="-"?(o+=f,l+=g):u==="+"&&(o-=f,l-=g),new Date(Date.UTC(n,i,s,o,l,h))}}kA=new WeakMap,E(nk,kA);function fz(p,{scale:t=1,rotation:e=0}){const{width:n,height:i}=p.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new Wb({viewBox:s,scale:t,rotation:e})}function ik(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Wt(`Not a valid color format: "${p}"`),[0,0,0])}function pz(p){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of p.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;p.set(e,ik(n))}t.remove()}function Ge(p){const{a:t,b:e,c:n,d:i,e:s,f:o}=p.getTransform();return[t,e,n,i,s,o]}function xo(p){const{a:t,b:e,c:n,d:i,e:s,f:o}=p.getTransform().invertSelf();return[t,e,n,i,s,o]}function df(p,t,e=!1,n=!0){if(t instanceof Wb){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=p,l=Bi.isCSSRoundSupported,h=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${s}px`,f=l?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,g=l?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!e||t.rotation%180===0?(o.width=f,o.height=g):(o.width=g,o.height=f)}n&&p.setAttribute("data-main-rotation",t.rotation)}class CC{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Kc,fd,Kr,pd,PA,RA,uE,$F,Gi,jF,HF,dw,BF,kC;const Lo=class Lo{constructor(t){E(this,Gi);E(this,Kc,null);E(this,fd,null);E(this,Kr);E(this,pd,null);E(this,PA,null);v(this,Kr,t),r(Lo,RA)||v(Lo,RA,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=v(this,Kc,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,Kr)._uiManager._signal;t.addEventListener("contextmenu",wr,{signal:e}),t.addEventListener("pointerdown",b(Lo,uE,$F),{signal:e});const n=v(this,pd,document.createElement("div"));n.className="buttons",t.append(n);const i=r(this,Kr).toolbarPosition;if(i){const{style:s}=t,o=r(this,Kr)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return b(this,Gi,BF).call(this),t}get div(){return r(this,Kc)}hide(){var t;r(this,Kc).classList.add("hidden"),(t=r(this,fd))==null||t.hideDropdown()}show(){var t;r(this,Kc).classList.remove("hidden"),(t=r(this,PA))==null||t.shown()}async addAltText(t){const e=await t.render();b(this,Gi,dw).call(this,e),r(this,pd).prepend(e,r(this,Gi,kC)),v(this,PA,t)}addColorPicker(t){v(this,fd,t);const e=t.renderButton();b(this,Gi,dw).call(this,e),r(this,pd).prepend(e,r(this,Gi,kC))}remove(){var t;r(this,Kc).remove(),(t=r(this,fd))==null||t.destroy(),v(this,fd,null)}};Kc=new WeakMap,fd=new WeakMap,Kr=new WeakMap,pd=new WeakMap,PA=new WeakMap,RA=new WeakMap,uE=new WeakSet,$F=function(t){t.stopPropagation()},Gi=new WeakSet,jF=function(t){r(this,Kr)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},HF=function(t){r(this,Kr)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},dw=function(t){const e=r(this,Kr)._uiManager._signal;t.addEventListener("focusin",b(this,Gi,jF).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",b(this,Gi,HF).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",wr,{signal:e})},BF=function(){const{editorType:t,_uiManager:e}=r(this,Kr),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",r(Lo,RA)[t]),b(this,Gi,dw).call(this,n),n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),r(this,pd).append(n)},kC=function(){const t=document.createElement("div");return t.className="divider",t},E(Lo,uE),E(Lo,RA,null);let TC=Lo;var LA,gd,md,kh,zF,UF,GF;class gz{constructor(t){E(this,kh);E(this,LA,null);E(this,gd,null);E(this,md);v(this,md,t)}show(t,e,n){const[i,s]=b(this,kh,UF).call(this,e,n),{style:o}=r(this,gd)||v(this,gd,b(this,kh,zF).call(this));t.append(r(this,gd)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,gd).remove()}}LA=new WeakMap,gd=new WeakMap,md=new WeakMap,kh=new WeakSet,zF=function(){const t=v(this,gd,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",wr,{signal:r(this,md)._signal});const e=v(this,LA,document.createElement("div"));return e.className="buttons",t.append(e),b(this,kh,GF).call(this),t},UF=function(t,e){let n=0,i=0;for(const s of t){const o=s.y+s.height;if(o<n)continue;const l=s.x+(e?s.width:0);if(o>n){i=l,n=o;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,n]},GF=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=r(this,md)._signal;t.addEventListener("contextmenu",wr,{signal:n}),t.addEventListener("click",()=>{r(this,md).highlightSelection("floating_button")},{signal:n}),r(this,LA).append(t)};function Gw(p,t,e){for(const n of e)t.addEventListener(n,p[n].bind(p))}function mz(p){return Math.round(Math.min(255,Math.max(1,255*p))).toString(16).padStart(2,"0")}var dE;class yz{constructor(){E(this,dE,0)}get id(){return`${KB}${le(this,dE)._++}`}}dE=new WeakMap;var Ag,MA,wi,bg,fw;const gk=class gk{constructor(){E(this,bg);E(this,Ag,cz());E(this,MA,0);E(this,wi,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Zt(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return b(this,bg,fw).call(this,`${e}_${n}_${i}_${s}`,t)}async getFromUrl(t){return b(this,bg,fw).call(this,t,t)}async getFromBlob(t,e){const n=await e;return b(this,bg,fw).call(this,t,n)}async getFromId(t){r(this,wi)||v(this,wi,new Map);const e=r(this,wi).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,wi)||v(this,wi,new Map);let n=r(this,wi).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${r(this,Ag)}_${le(this,MA)._++}`,refCounter:1,isSvg:!1},r(this,wi).set(t,n),r(this,wi).set(n.id,n),n}getSvgUrl(t){const e=r(this,wi).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;r(this,wi)||v(this,wi,new Map);const e=r(this,wi).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}(i=n.close)==null||i.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,Ag)}_`)}};Ag=new WeakMap,MA=new WeakMap,wi=new WeakMap,bg=new WeakSet,fw=async function(t,e){r(this,wi)||v(this,wi,new Map);let n=r(this,wi).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${r(this,Ag)}_${le(this,MA)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(n.url=e,i=await BE(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=gk._isSVGFittingCanvas,o=new FileReader,l=new Image,h=new Promise((u,f)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,u()},o.onload=async()=>{const g=n.svgUrl=o.result;l.src=await s?`${g}#svgView(preserveAspectRatio(none))`:g},l.onerror=o.onerror=f});o.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){console.error(i),n=null}return r(this,wi).set(t,n),n&&r(this,wi).set(n.id,n),n};let PC=gk;var jn,Qc,IA,Hn;class vz{constructor(t=128){E(this,jn,[]);E(this,Qc,!1);E(this,IA);E(this,Hn,-1);v(this,IA,t)}add({cmd:t,undo:e,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&t(),r(this,Qc))return;const h={cmd:t,undo:e,post:n,type:s};if(r(this,Hn)===-1){r(this,jn).length>0&&(r(this,jn).length=0),v(this,Hn,0),r(this,jn).push(h);return}if(o&&r(this,jn)[r(this,Hn)].type===s){l&&(h.undo=r(this,jn)[r(this,Hn)].undo),r(this,jn)[r(this,Hn)]=h;return}const u=r(this,Hn)+1;u===r(this,IA)?r(this,jn).splice(0,1):(v(this,Hn,u),u<r(this,jn).length&&r(this,jn).splice(u)),r(this,jn).push(h)}undo(){if(r(this,Hn)===-1)return;v(this,Qc,!0);const{undo:t,post:e}=r(this,jn)[r(this,Hn)];t(),e==null||e(),v(this,Qc,!1),v(this,Hn,r(this,Hn)-1)}redo(){if(r(this,Hn)<r(this,jn).length-1){v(this,Hn,r(this,Hn)+1),v(this,Qc,!0);const{cmd:t,post:e}=r(this,jn)[r(this,Hn)];t(),e==null||e(),v(this,Qc,!1)}}hasSomethingToUndo(){return r(this,Hn)!==-1}hasSomethingToRedo(){return r(this,Hn)<r(this,jn).length-1}destroy(){v(this,jn,null)}}jn=new WeakMap,Qc=new WeakMap,IA=new WeakMap,Hn=new WeakMap;var fE,WF;class Vb{constructor(t){E(this,fE);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Bi.platform;for(const[n,i,s={}]of t)for(const o of n){const l=o.startsWith("mac+");e&&l?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!e&&!l&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(b(this,fE,WF).call(this,e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:l=null}}=n;l&&!l(t,e)||(i.bind(t,...o,e)(),s||(e.stopPropagation(),e.preventDefault()))}}fE=new WeakSet,WF=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const pE=class pE{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return pz(t),Zt(this,"_colors",t)}convert(t){const e=ik(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((s,o)=>s===e[o]))return pE._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?kt.makeHexColor(...e):t}};lt(pE,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let RC=pE;var _g,Ms,bn,ei,wg,rl,Eg,Qr,Jc,Sg,yd,Ua,Jr,vd,DA,FA,xg,OA,Ga,Zc,Cg,th,Wa,gE,eh,NA,nh,Ad,$A,jA,Bn,de,al,bd,HA,BA,ih,Va,ol,zA,cr,gt,pw,LC,VF,qF,gw,XF,YF,KF,MC,QF,IC,DC,JF,Di,gc,ZF,tO,FC,eO,Fy,OC;const lp=class lp{constructor(t,e,n,i,s,o,l,h,u,f,g){E(this,gt);E(this,_g,new AbortController);E(this,Ms,null);E(this,bn,new Map);E(this,ei,new Map);E(this,wg,null);E(this,rl,null);E(this,Eg,null);E(this,Qr,new vz);E(this,Jc,null);E(this,Sg,0);E(this,yd,new Set);E(this,Ua,null);E(this,Jr,null);E(this,vd,new Set);E(this,DA,!1);E(this,FA,!1);E(this,xg,!1);E(this,OA,null);E(this,Ga,null);E(this,Zc,null);E(this,Cg,null);E(this,th,!1);E(this,Wa,null);E(this,gE,new yz);E(this,eh,!1);E(this,NA,!1);E(this,nh,null);E(this,Ad,null);E(this,$A,null);E(this,jA,null);E(this,Bn,zt.NONE);E(this,de,new Set);E(this,al,null);E(this,bd,null);E(this,HA,null);E(this,BA,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,ih,[0,0]);E(this,Va,null);E(this,ol,null);E(this,zA,null);E(this,cr,null);const m=this._signal=r(this,_g).signal;v(this,ol,t),v(this,zA,e),v(this,wg,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:m}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),i._on("setpreference",this.onSetPreference.bind(this),{signal:m}),i._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:m}),b(this,gt,XF).call(this),b(this,gt,JF).call(this),b(this,gt,MC).call(this),v(this,rl,s.annotationStorage),v(this,OA,s.filterFactory),v(this,bd,o),v(this,Cg,l||null),v(this,DA,h),v(this,FA,u),v(this,xg,f),v(this,jA,g||null),this.viewParameters={realScale:xh.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=lp.prototype,e=o=>r(o,ol).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new Vb([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,ol).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,ol).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,n,i;(t=r(this,cr))==null||t.resolve(),v(this,cr,null),(e=r(this,_g))==null||e.abort(),v(this,_g,null),this._signal=null;for(const s of r(this,ei).values())s.destroy();r(this,ei).clear(),r(this,bn).clear(),r(this,vd).clear(),v(this,Ms,null),r(this,de).clear(),r(this,Qr).destroy(),(n=r(this,wg))==null||n.destroy(),(i=r(this,Wa))==null||i.hide(),v(this,Wa,null),r(this,Ga)&&(clearTimeout(r(this,Ga)),v(this,Ga,null)),r(this,Va)&&(clearTimeout(r(this,Va)),v(this,Va,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,jA)}get useNewAltTextFlow(){return r(this,FA)}get useNewAltTextWhenAddingImage(){return r(this,xg)}get hcmFilter(){return Zt(this,"hcmFilter",r(this,bd)?r(this,OA).addHCMFilter(r(this,bd).foreground,r(this,bd).background):"none")}get direction(){return Zt(this,"direction",getComputedStyle(r(this,ol)).direction)}get highlightColors(){return Zt(this,"highlightColors",r(this,Cg)?new Map(r(this,Cg).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Zt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){v(this,$A,t)}editAltText(t,e=!1){var n;(n=r(this,wg))==null||n.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":v(this,xg,e);break}}onPageChanging({pageNumber:t}){v(this,Sg,t-1)}focusMainContainer(){r(this,ol).focus()}findParent(t,e){for(const n of r(this,ei).values()){const{x:i,y:s,width:o,height:l}=n.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=s&&e<=s+l)return n}return null}disableUserSelect(t=!1){r(this,zA).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,vd).add(t)}removeShouldRescale(t){r(this,vd).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*xh.PDF_TO_CSS_UNITS;for(const e of r(this,vd))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}=e,l=e.toString(),u=b(this,gt,pw).call(this,e).closest(".textLayer"),f=this.getSelectionBoxes(u);if(!f)return;e.empty();const g=b(this,gt,LC).call(this,u),m=r(this,Bn)===zt.NONE,A=()=>{g==null||g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:f,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(zt.HIGHLIGHT,A);return}A()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,rl)&&!r(this,rl).has(t.id)&&r(this,rl).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,th)&&(v(this,th,!1),b(this,gt,gw).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,de))if(e.div.contains(t)){v(this,Ad,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,Ad))return;const[t,e]=r(this,Ad);v(this,Ad,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){b(this,gt,MC).call(this),b(this,gt,IC).call(this)}removeEditListeners(){b(this,gt,QF).call(this),b(this,gt,DC).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of r(this,Jr))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of r(this,Jr))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=r(this,Ms))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of r(this,de)){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const o of r(this,Jr))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Wt(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const h of n){const u=await i.deserialize(h);if(!u)return;s.push(u)}const o=()=>{for(const h of s)b(this,gt,FC).call(this,h);b(this,gt,OC).call(this,s)},l=()=>{for(const h of s)h.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(s){Wt(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,Bn)!==zt.NONE&&!this.isEditorHandlingKeyboard&&lp._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,th)&&(v(this,th,!1),b(this,gt,gw).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(b(this,gt,YF).call(this),b(this,gt,IC).call(this),b(this,gt,Di).call(this,{isEditing:r(this,Bn)!==zt.NONE,isEmpty:b(this,gt,Fy).call(this),hasSomethingToUndo:r(this,Qr).hasSomethingToUndo(),hasSomethingToRedo:r(this,Qr).hasSomethingToRedo(),hasSelectedEditor:!1})):(b(this,gt,KF).call(this),b(this,gt,DC).call(this),b(this,gt,Di).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,Jr)){v(this,Jr,t);for(const e of r(this,Jr))b(this,gt,gc).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,gE).id}get currentLayer(){return r(this,ei).get(r(this,Sg))}getLayer(t){return r(this,ei).get(t)}get currentPageIndex(){return r(this,Sg)}addLayer(t){r(this,ei).set(t.pageIndex,t),r(this,eh)?t.enable():t.disable()}removeLayer(t){r(this,ei).delete(t.pageIndex)}async updateMode(t,e=null,n=!1){if(r(this,Bn)!==t&&!(r(this,cr)&&(await r(this,cr).promise,!r(this,cr)))){if(v(this,cr,Promise.withResolvers()),v(this,Bn,t),t===zt.NONE){this.setEditingState(!1),b(this,gt,tO).call(this),r(this,cr).resolve();return}this.setEditingState(!0),await b(this,gt,ZF).call(this),this.unselectAll();for(const i of r(this,ei).values())i.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),r(this,cr).resolve();return}for(const i of r(this,bn).values())i.annotationElementId===e?(this.setSelected(i),i.enterInEditMode()):i.unselect();r(this,cr).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,Bn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var n;if(r(this,Jr)){switch(t){case Ot.CREATE:this.currentLayer.addNewEditor();return;case Ot.HIGHLIGHT_DEFAULT_COLOR:(n=r(this,$A))==null||n.updateColor(e);break;case Ot.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,HA)||v(this,HA,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of r(this,de))i.updateParams(t,e);for(const i of r(this,Jr))i.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var s;for(const o of r(this,bn).values())o.editorType===t&&o.show(e);(((s=r(this,HA))==null?void 0:s.get(Ot.HIGHLIGHT_SHOW_ALL))??!0)!==e&&b(this,gt,gc).call(this,[[Ot.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,NA)!==t){v(this,NA,t);for(const e of r(this,ei).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of r(this,bn).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return r(this,bn).get(t)}addEditor(t){r(this,bn).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Ga)&&clearTimeout(r(this,Ga)),v(this,Ga,setTimeout(()=>{this.focusMainContainer(),v(this,Ga,null)},0))),r(this,bn).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,yd).has(t.annotationElementId))&&((e=r(this,rl))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,yd).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,yd).has(t)}removeDeletedAnnotationElement(t){r(this,yd).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,Ms)!==t&&(v(this,Ms,t),t&&b(this,gt,gc).call(this,t.propertiesToUpdate))}updateUI(t){r(this,gt,eO)===t&&b(this,gt,gc).call(this,t.propertiesToUpdate)}toggleSelected(t){if(r(this,de).has(t)){r(this,de).delete(t),t.unselect(),b(this,gt,Di).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,de).add(t),t.select(),b(this,gt,gc).call(this,t.propertiesToUpdate),b(this,gt,Di).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of r(this,de))e!==t&&e.unselect();r(this,de).clear(),r(this,de).add(t),t.select(),b(this,gt,gc).call(this,t.propertiesToUpdate),b(this,gt,Di).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,de).has(t)}get firstSelectedEditor(){return r(this,de).values().next().value}unselect(t){t.unselect(),r(this,de).delete(t),b(this,gt,Di).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,de).size!==0}get isEnterHandled(){return r(this,de).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){r(this,Qr).undo(),b(this,gt,Di).call(this,{hasSomethingToUndo:r(this,Qr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:b(this,gt,Fy).call(this)})}redo(){r(this,Qr).redo(),b(this,gt,Di).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Qr).hasSomethingToRedo(),isEmpty:b(this,gt,Fy).call(this)})}addCommands(t){r(this,Qr).add(t),b(this,gt,Di).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:b(this,gt,Fy).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...r(this,de)],e=()=>{for(const i of t)i.remove()},n=()=>{for(const i of t)b(this,gt,FC).call(this,i)};this.addCommands({cmd:e,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=r(this,Ms))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,Ms)||this.hasSelection}selectAll(){for(const t of r(this,de))t.commit();b(this,gt,OC).call(this,r(this,bn).values())}unselectAll(){if(!(r(this,Ms)&&(r(this,Ms).commitOrRemove(),r(this,Bn)!==zt.NONE))&&this.hasSelection){for(const t of r(this,de))t.unselect();r(this,de).clear(),b(this,gt,Di).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;r(this,ih)[0]+=t,r(this,ih)[1]+=e;const[i,s]=r(this,ih),o=[...r(this,de)],l=1e3;r(this,Va)&&clearTimeout(r(this,Va)),v(this,Va,setTimeout(()=>{v(this,Va,null),r(this,ih)[0]=r(this,ih)[1]=0,this.addCommands({cmd:()=>{for(const h of o)r(this,bn).has(h.id)&&h.translateInPage(i,s)},undo:()=>{for(const h of o)r(this,bn).has(h.id)&&h.translateInPage(-i,-s)},mustExec:!1})},l));for(const h of o)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,Ua,new Map);for(const t of r(this,de))r(this,Ua).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,Ua))return!1;this.disableUserSelect(!1);const t=r(this,Ua);v(this,Ua,null);let e=!1;for(const[{x:i,y:s,pageIndex:o},l]of t)l.newX=i,l.newY=s,l.newPageIndex=o,e||(e=i!==l.savedX||s!==l.savedY||o!==l.savedPageIndex);if(!e)return!1;const n=(i,s,o,l)=>{if(r(this,bn).has(i.id)){const h=r(this,ei).get(l);h?i._setParentAndPosition(h,s,o):(i.pageIndex=l,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:l}]of t)n(i,s,o,l)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:l}]of t)n(i,s,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,Ua))for(const n of r(this,Ua).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,de).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,Ms)===t}getActive(){return r(this,Ms)}getMode(){return r(this,Bn)}get imageManager(){return Zt(this,"imageManager",new PC)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,f=e.rangeCount;u<f;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:o}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,f,g,m)=>({x:(f-i)/o,y:1-(u+g-n)/s,width:m/o,height:g/s});break;case"180":l=(u,f,g,m)=>({x:1-(u+g-n)/s,y:1-(f+m-i)/o,width:g/s,height:m/o});break;case"270":l=(u,f,g,m)=>({x:1-(f+m-i)/o,y:(u-n)/s,width:m/o,height:g/s});break;default:l=(u,f,g,m)=>({x:(u-n)/s,y:(f-i)/o,width:g/s,height:m/o});break}const h=[];for(let u=0,f=e.rangeCount;u<f;u++){const g=e.getRangeAt(u);if(!g.collapsed)for(const{x:m,y:A,width:_,height:S}of g.getClientRects())_===0||S===0||h.push(l(m,A,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,Eg)||v(this,Eg,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,Eg))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=r(this,Eg))==null?void 0:i.get(t.data.id);if(!e)return;const n=r(this,rl).getRawValue(e);n&&(r(this,Bn)===zt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}};_g=new WeakMap,Ms=new WeakMap,bn=new WeakMap,ei=new WeakMap,wg=new WeakMap,rl=new WeakMap,Eg=new WeakMap,Qr=new WeakMap,Jc=new WeakMap,Sg=new WeakMap,yd=new WeakMap,Ua=new WeakMap,Jr=new WeakMap,vd=new WeakMap,DA=new WeakMap,FA=new WeakMap,xg=new WeakMap,OA=new WeakMap,Ga=new WeakMap,Zc=new WeakMap,Cg=new WeakMap,th=new WeakMap,Wa=new WeakMap,gE=new WeakMap,eh=new WeakMap,NA=new WeakMap,nh=new WeakMap,Ad=new WeakMap,$A=new WeakMap,jA=new WeakMap,Bn=new WeakMap,de=new WeakMap,al=new WeakMap,bd=new WeakMap,HA=new WeakMap,BA=new WeakMap,ih=new WeakMap,Va=new WeakMap,ol=new WeakMap,zA=new WeakMap,cr=new WeakMap,gt=new WeakSet,pw=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},LC=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of r(this,ei).values())if(n.hasTextLayer(t))return n;return null},VF=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=b(this,gt,pw).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(r(this,Wa)||v(this,Wa,new gz(this)),r(this,Wa).show(n,i,this.direction==="ltr"))},qF=function(){var s,o,l;const t=document.getSelection();if(!t||t.isCollapsed){r(this,al)&&((s=r(this,Wa))==null||s.hide(),v(this,al,null),b(this,gt,Di).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,al))return;const i=b(this,gt,pw).call(this,t).closest(".textLayer");if(!i){r(this,al)&&((o=r(this,Wa))==null||o.hide(),v(this,al,null),b(this,gt,Di).call(this,{hasSelectedText:!1}));return}if((l=r(this,Wa))==null||l.hide(),v(this,al,e),b(this,gt,Di).call(this,{hasSelectedText:!0}),!(r(this,Bn)!==zt.HIGHLIGHT&&r(this,Bn)!==zt.NONE)&&(r(this,Bn)===zt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,th,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=r(this,Bn)===zt.HIGHLIGHT?b(this,gt,LC).call(this,i):null;h==null||h.toggleDrawing();const u=new AbortController,f=this.combinedSignal(u),g=m=>{m.type==="pointerup"&&m.button!==0||(u.abort(),h==null||h.toggleDrawing(!0),m.type==="pointerup"&&b(this,gt,gw).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:f}),window.addEventListener("blur",g,{signal:f})}},gw=function(t=""){r(this,Bn)===zt.HIGHLIGHT?this.highlightSelection(t):r(this,DA)&&b(this,gt,VF).call(this)},XF=function(){document.addEventListener("selectionchange",b(this,gt,qF).bind(this),{signal:this._signal})},YF=function(){if(r(this,Zc))return;v(this,Zc,new AbortController);const t=this.combinedSignal(r(this,Zc));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},KF=function(){var t;(t=r(this,Zc))==null||t.abort(),v(this,Zc,null)},MC=function(){if(r(this,nh))return;v(this,nh,new AbortController);const t=this.combinedSignal(r(this,nh));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},QF=function(){var t;(t=r(this,nh))==null||t.abort(),v(this,nh,null)},IC=function(){if(r(this,Jc))return;v(this,Jc,new AbortController);const t=this.combinedSignal(r(this,Jc));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},DC=function(){var t;(t=r(this,Jc))==null||t.abort(),v(this,Jc,null)},JF=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Di=function(t){Object.entries(t).some(([n,i])=>r(this,BA)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,BA),t)}),r(this,Bn)===zt.HIGHLIGHT&&t.hasSelectedEditor===!1&&b(this,gt,gc).call(this,[[Ot.HIGHLIGHT_FREE,!0]]))},gc=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},ZF=async function(){if(!r(this,eh)){v(this,eh,!0);const t=[];for(const e of r(this,ei).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,bn).values())e.enable()}},tO=function(){if(this.unselectAll(),r(this,eh)){v(this,eh,!1);for(const t of r(this,ei).values())t.disable();for(const t of r(this,bn).values())t.disable()}},FC=function(t){const e=r(this,ei).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},eO=function(){let t=null;for(t of r(this,de));return t},Fy=function(){if(r(this,bn).size===0)return!0;if(r(this,bn).size===1)for(const t of r(this,bn).values())return t.isEmpty();return!1},OC=function(t){for(const e of r(this,de))e.unselect();r(this,de).clear();for(const e of t)e.isEmpty()||(r(this,de).add(e),e.select());b(this,gt,Di).call(this,{hasSelectedEditor:this.hasSelection})},lt(lp,"TRANSLATE_SMALL",1),lt(lp,"TRANSLATE_BIG",10);let ff=lp;var zn,qa,Zr,Tg,Xa,Is,kg,Ya,rs,ll,_d,Ka,sh,ha,Oy,mw;const Fi=class Fi{constructor(t){E(this,ha);E(this,zn,null);E(this,qa,!1);E(this,Zr,null);E(this,Tg,null);E(this,Xa,null);E(this,Is,null);E(this,kg,!1);E(this,Ya,null);E(this,rs,null);E(this,ll,null);E(this,_d,null);E(this,Ka,!1);v(this,rs,t),v(this,Ka,t._uiManager.useNewAltTextFlow),r(Fi,sh)||v(Fi,sh,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Fi._l10n??(Fi._l10n=t)}async render(){const t=v(this,Zr,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=v(this,Tg,document.createElement("span"));t.append(e),r(this,Ka)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Fi,sh).missing),e.setAttribute("data-l10n-id",r(Fi,sh)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=r(this,rs)._uiManager._signal;t.addEventListener("contextmenu",wr,{signal:n}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),r(this,rs)._uiManager.editAltText(r(this,rs)),r(this,Ka)&&r(this,rs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,ha,Oy)}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(v(this,kg,!0),i(s))},{signal:n}),await b(this,ha,mw).call(this),t}finish(){r(this,Zr)&&(r(this,Zr).focus({focusVisible:r(this,kg)}),v(this,kg,!1))}isEmpty(){return r(this,Ka)?r(this,zn)===null:!r(this,zn)&&!r(this,qa)}hasData(){return r(this,Ka)?r(this,zn)!==null||!!r(this,ll):this.isEmpty()}get guessedText(){return r(this,ll)}async setGuessedText(t){r(this,zn)===null&&(v(this,ll,t),v(this,_d,await Fi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),b(this,ha,mw).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,Ka)||r(this,zn)){(e=r(this,Ya))==null||e.remove(),v(this,Ya,null);return}if(!r(this,Ya)){const n=v(this,Ya,document.createElement("div"));n.className="noAltTextBadge",r(this,rs).div.append(n)}r(this,Ya).classList.toggle("hidden",!t)}serialize(t){let e=r(this,zn);return!t&&r(this,ll)===e&&(e=r(this,_d)),{altText:e,decorative:r(this,qa),guessedText:r(this,ll),textWithDisclaimer:r(this,_d)}}get data(){return{altText:r(this,zn),decorative:r(this,qa)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(v(this,ll,n),v(this,_d,i)),!(r(this,zn)===t&&r(this,qa)===e)&&(s||(v(this,zn,t),v(this,qa,e)),b(this,ha,mw).call(this))}toggle(t=!1){r(this,Zr)&&(!t&&r(this,Is)&&(clearTimeout(r(this,Is)),v(this,Is,null)),r(this,Zr).disabled=!t)}shown(){r(this,rs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,ha,Oy)}})}destroy(){var t,e;(t=r(this,Zr))==null||t.remove(),v(this,Zr,null),v(this,Tg,null),v(this,Xa,null),(e=r(this,Ya))==null||e.remove(),v(this,Ya,null)}};zn=new WeakMap,qa=new WeakMap,Zr=new WeakMap,Tg=new WeakMap,Xa=new WeakMap,Is=new WeakMap,kg=new WeakMap,Ya=new WeakMap,rs=new WeakMap,ll=new WeakMap,_d=new WeakMap,Ka=new WeakMap,sh=new WeakMap,ha=new WeakSet,Oy=function(){return r(this,zn)&&"added"||r(this,zn)===null&&this.guessedText&&"review"||"missing"},mw=async function(){var i,s,o;const t=r(this,Zr);if(!t)return;if(r(this,Ka)){if(t.classList.toggle("done",!!r(this,zn)),t.setAttribute("data-l10n-id",r(Fi,sh)[r(this,ha,Oy)]),(i=r(this,Tg))==null||i.setAttribute("data-l10n-id",r(Fi,sh)[`${r(this,ha,Oy)}-label`]),!r(this,zn)){(s=r(this,Xa))==null||s.remove();return}}else{if(!r(this,zn)&&!r(this,qa)){t.classList.remove("done"),(o=r(this,Xa))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,Xa);if(!e){v(this,Xa,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,rs).id}`;const l=100,h=r(this,rs)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(r(this,Is)),v(this,Is,null)},{once:!0}),t.addEventListener("mouseenter",()=>{v(this,Is,setTimeout(()=>{v(this,Is,null),r(this,Xa).classList.add("show"),r(this,rs)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:h}),t.addEventListener("mouseleave",()=>{var u;r(this,Is)&&(clearTimeout(r(this,Is)),v(this,Is,null)),(u=r(this,Xa))==null||u.classList.remove("show")},{signal:h})}r(this,qa)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,zn)),e.parentNode||t.append(e);const n=r(this,rs).getImageForAltText();n==null||n.setAttribute("aria-describedby",e.id)},E(Fi,sh,null),lt(Fi,"_l10n",null);let Ww=Fi;var wd,ta,ze,Pg,Ed,ni,Sd,rh,UA,xd,ah,GA,Cd,cl,Qa,Rg,Lg,hr,WA,mE,Gt,NC,VA,$C,jC,nO,iO,HC,BC,zC,sO,UC,rO,aO,oO,GC,Ny;const ae=class ae{constructor(t){E(this,Gt);E(this,wd,null);E(this,ta,null);E(this,ze,null);E(this,Pg,!1);E(this,Ed,!1);E(this,ni,null);E(this,Sd,null);E(this,rh,null);E(this,UA,"");E(this,xd,!1);E(this,ah,null);E(this,GA,!1);E(this,Cd,!1);E(this,cl,!1);E(this,Qa,null);E(this,Rg,0);E(this,Lg,0);E(this,hr,null);lt(this,"_editToolbar",null);lt(this,"_initialOptions",Object.create(null));lt(this,"_initialData",null);lt(this,"_isVisible",!0);lt(this,"_uiManager",null);lt(this,"_focusEventsAllowed",!0);E(this,WA,!1);E(this,mE,ae._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[l,h]=this.parentDimensions;this.x=t.x/l,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=ae.prototype._resizeWithKeyboard,e=ff.TRANSLATE_SMALL,n=ff.TRANSLATE_BIG;return Zt(this,"_resizerKeyboardManager",new Vb([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],ae.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Zt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Az({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ae._l10n??(ae._l10n=t),ae._l10nResizer||(ae._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ae._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);ae._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Le("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,WA)}set _isDraggable(t){var e;v(this,WA,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,mE)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):b(this,Gt,Ny).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,xd)?v(this,xd,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/o,this.fixAndSetPosition()}translate(t,e){b(this,Gt,NC).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,ah)||v(this,ah,[this.x,this.y]),b(this,Gt,NC).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,ah)||v(this,ah,[this.x,this.y]);const[n,i]=this.parentDimensions;if(this.x+=t/n,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[l,h]=this.getBaseTranslation();s+=l,o+=h,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!r(this,ah)&&(r(this,ah)[0]!==this.x||r(this,ah)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=ae,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,n]=this.pageDimensions;let{x:i,y:s,width:o,height:l}=this;if(o*=e,l*=n,i*=e,s*=n,this._mustFixPosition)switch(t){case 0:i=Math.max(0,Math.min(e-o,i)),s=Math.max(0,Math.min(n-l,s));break;case 90:i=Math.max(0,Math.min(e-l,i)),s=Math.min(n,Math.max(o,s));break;case 180:i=Math.min(e,Math.max(o,i)),s=Math.min(n,Math.max(l,s));break;case 270:i=Math.min(e,Math.max(l,i)),s=Math.max(0,Math.min(n-o,s));break}this.x=i/=e,this.y=s/=n;const[h,u]=this.getBaseTranslation();i+=h,s+=u;const{style:f}=this.div;f.left=`${(100*i).toFixed(2)}%`,f.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return b(n=ae,VA,$C).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return b(n=ae,VA,$C).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions;this.div.style.width=`${(100*t/n).toFixed(2)}%`,r(this,Ed)||(this.div.style.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!r(this,Ed)&&e.endsWith("%");if(i&&s)return;const[o,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!r(this,Ed)&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=r(this,ze))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,Cd)?this._editToolbar:(this._editToolbar=new TC(this),this.div.append(this._editToolbar.render()),r(this,ze)&&await this._editToolbar.addAltText(r(this,ze)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,ze))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,ze)||(Ww.initialize(ae._l10n),v(this,ze,new Ww(this)),r(this,wd)&&(r(this,ze).data=r(this,wd),v(this,wd,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,ze))==null?void 0:t.data}set altTextData(t){r(this,ze)&&(r(this,ze).data=t)}get guessedAltText(){var t;return(t=r(this,ze))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,ze))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,ze))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,ze)&&!r(this,ze).isEmpty()}hasAltTextData(){var t;return((t=r(this,ze))==null?void 0:t.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,Pg)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),b(this,Gt,UC).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),Gw(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Bi.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(v(this,xd,!0),this._isDraggable){b(this,Gt,sO).call(this,t);return}b(this,Gt,zC).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){r(this,Qa)&&clearTimeout(r(this,Qa)),v(this,Qa,setTimeout(()=>{var t;v(this,Qa,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition()}getRect(t,e,n=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[l,h]=this.pageTranslation,u=t/i,f=e/i,g=this.x*s,m=this.y*o,A=this.width*s,_=this.height*o;switch(n){case 0:return[g+u+l,o-m-f-_+h,g+u+A+l,o-m-f+h];case 90:return[g+f+l,o-m+u+h,g+f+_+l,o-m+u+A+h];case 180:return[g-u-A+l,o-m+f+h,g-u+l,o-m+f+_+h];case 270:return[g-f-_+l,o-m-u-A+h,g-f+l,o-m-u+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,o]=t,l=s-n,h=o-i;switch(this.rotation){case 0:return[n,e-o,l,h];case 90:return[n,e-i,h,l];case 180:return[s,e-i,l,h];case 270:return[s,e-o,h,l];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){v(this,Cd,!0)}disableEditMode(){v(this,Cd,!1)}isInEditMode(){return r(this,Cd)}shouldGetKeyboardEvents(){return r(this,cl)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){b(this,Gt,UC).call(this)}rotate(t){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Le("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,v(i,wd,t.accessibilityData);const[s,o]=i.pageDimensions,[l,h,u,f]=i.getRectInCurrentCoords(t.rect,o);return i.x=l/s,i.y=h/o,i.width=u/s,i.height=f/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t;if((t=r(this,rh))==null||t.abort(),v(this,rh,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,Qa)&&(clearTimeout(r(this,Qa)),v(this,Qa,null)),b(this,Gt,Ny).call(this),this.removeEditToolbar(),r(this,hr)){for(const e of r(this,hr).values())clearTimeout(e);v(this,hr,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(b(this,Gt,nO).call(this),r(this,ni).classList.remove("hidden"),Gw(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),v(this,Sd,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,ni).children;if(!r(this,ta)){v(this,ta,Array.from(e));const o=b(this,Gt,rO).bind(this),l=b(this,Gt,aO).bind(this),h=this._uiManager._signal;for(const u of r(this,ta)){const f=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:h}),u.addEventListener("blur",l,{signal:h}),u.addEventListener("focus",b(this,Gt,oO).bind(this,f),{signal:h}),u.setAttribute("data-l10n-id",ae._l10nResizer[f])}}const n=r(this,ta)[0];let i=0;for(const o of e){if(o===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(r(this,ta).length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)r(this,ni).append(r(this,ni).firstChild);else if(s>i)for(let l=0;l<s-i;l++)r(this,ni).firstChild.before(r(this,ni).lastChild);let o=0;for(const l of e){const u=r(this,ta)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",ae._l10nResizer[u])}}b(this,Gt,GC).call(this,0),v(this,cl,!0),r(this,ni).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,cl)&&b(this,Gt,BC).call(this,r(this,UA),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){b(this,Gt,Ny).call(this),this.div.focus()}select(){var t,e,n;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(n=r(this,ze))==null||n.toggleAltTextBadge(!1)}unselect(){var t,e,n,i,s;(t=r(this,ni))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=r(this,ze))==null||s.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,GA)}set isEditing(t){v(this,GA,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){v(this,Ed,!0);const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,hr)||v(this,hr,new Map);const{action:n}=t;let i=r(this,hr).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),r(this,hr).delete(n),r(this,hr).size===0&&v(this,hr,null)},ae._telemetryTimeout),r(this,hr).set(n,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),v(this,Pg,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,Pg,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};wd=new WeakMap,ta=new WeakMap,ze=new WeakMap,Pg=new WeakMap,Ed=new WeakMap,ni=new WeakMap,Sd=new WeakMap,rh=new WeakMap,UA=new WeakMap,xd=new WeakMap,ah=new WeakMap,GA=new WeakMap,Cd=new WeakMap,cl=new WeakMap,Qa=new WeakMap,Rg=new WeakMap,Lg=new WeakMap,hr=new WeakMap,WA=new WeakMap,mE=new WeakMap,Gt=new WeakSet,NC=function([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this.fixAndSetPosition()},VA=new WeakSet,$C=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},jC=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},nO=function(){if(r(this,ni))return;v(this,ni,document.createElement("div")),r(this,ni).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");r(this,ni).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",b(this,Gt,iO).bind(this,n),{signal:e}),i.addEventListener("contextmenu",wr,{signal:e}),i.tabIndex=-1}this.div.prepend(r(this,ni))},iO=function(t,e){var _;e.preventDefault();const{isMac:n}=Bi.platform;if(e.button!==0||e.ctrlKey&&n)return;(_=r(this,ze))==null||_.toggle(!1);const i=this._isDraggable;this._isDraggable=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",b(this,Gt,BC).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("contextmenu",wr,{signal:o});const l=this.x,h=this.y,u=this.width,f=this.height,g=this.parent.div.style.cursor,m=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const A=()=>{var S;s.abort(),this.parent.togglePointerEvents(!0),(S=r(this,ze))==null||S.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=g,this.div.style.cursor=m,b(this,Gt,HC).call(this,l,h,u,f)};window.addEventListener("pointerup",A,{signal:o}),window.addEventListener("blur",A,{signal:o})},HC=function(t,e,n,i){const s=this.x,o=this.y,l=this.width,h=this.height;s===t&&o===e&&l===n&&h===i||this.addCommands({cmd:()=>{this.width=l,this.height=h,this.x=s,this.y=o;const[u,f]=this.parentDimensions;this.setDims(u*l,f*h),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=i,this.x=t,this.y=e;const[u,f]=this.parentDimensions;this.setDims(u*n,f*i),this.fixAndSetPosition()},mustExec:!0})},BC=function(t,e){const[n,i]=this.parentDimensions,s=this.x,o=this.y,l=this.width,h=this.height,u=ae.MIN_SIZE/n,f=ae.MIN_SIZE/i,g=G=>Math.round(G*1e4)/1e4,m=b(this,Gt,jC).call(this,this.rotation),A=(G,q)=>[m[0]*G+m[2]*q,m[1]*G+m[3]*q],_=b(this,Gt,jC).call(this,360-this.rotation),S=(G,q)=>[_[0]*G+_[2]*q,_[1]*G+_[3]*q];let C,T,k=!1,P=!1;switch(t){case"topLeft":k=!0,C=(G,q)=>[0,0],T=(G,q)=>[G,q];break;case"topMiddle":C=(G,q)=>[G/2,0],T=(G,q)=>[G/2,q];break;case"topRight":k=!0,C=(G,q)=>[G,0],T=(G,q)=>[0,q];break;case"middleRight":P=!0,C=(G,q)=>[G,q/2],T=(G,q)=>[0,q/2];break;case"bottomRight":k=!0,C=(G,q)=>[G,q],T=(G,q)=>[0,0];break;case"bottomMiddle":C=(G,q)=>[G/2,q],T=(G,q)=>[G/2,0];break;case"bottomLeft":k=!0,C=(G,q)=>[0,q],T=(G,q)=>[G,0];break;case"middleLeft":P=!0,C=(G,q)=>[0,q/2],T=(G,q)=>[G,q/2];break}const L=C(l,h),I=T(l,h);let D=A(...I);const F=g(s+D[0]),H=g(o+D[1]);let j=1,Q=1,[W,tt]=this.screenToPageTranslation(e.movementX,e.movementY);if([W,tt]=S(W/n,tt/i),k){const G=Math.hypot(l,h);j=Q=Math.max(Math.min(Math.hypot(I[0]-L[0]-W,I[1]-L[1]-tt)/G,1/l,1/h),u/l,f/h)}else P?j=Math.max(u,Math.min(1,Math.abs(I[0]-L[0]-W)))/l:Q=Math.max(f,Math.min(1,Math.abs(I[1]-L[1]-tt)))/h;const Z=g(l*j),et=g(h*Q);D=A(...T(Z,et));const ht=F-D[0],J=H-D[1];this.width=Z,this.height=et,this.x=ht,this.y=J,this.setDims(n*Z,i*et),this.fixAndSetPosition()},zC=function(t){const{isMac:e}=Bi.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},sO=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const n=new AbortController,i=this._uiManager.combinedSignal(n);if(e){this.div.classList.add("moving"),v(this,Rg,t.clientX),v(this,Lg,t.clientY);const o=l=>{const{clientX:h,clientY:u}=l,[f,g]=this.screenToPageTranslation(h-r(this,Rg),u-r(this,Lg));v(this,Rg,h),v(this,Lg,u),this._uiManager.dragSelectedEditors(f,g)};window.addEventListener("pointermove",o,{passive:!0,capture:!0,signal:i})}const s=()=>{n.abort(),e&&this.div.classList.remove("moving"),v(this,xd,!1),this._uiManager.endDragSession()||b(this,Gt,zC).call(this,t)};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})},UC=function(){if(r(this,rh)||!this.div)return;v(this,rh,new AbortController);const t=this._uiManager.combinedSignal(r(this,rh));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},rO=function(t){ae._resizerKeyboardManager.exec(this,t)},aO=function(t){var e;r(this,cl)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,ni)&&b(this,Gt,Ny).call(this)},oO=function(t){v(this,UA,r(this,cl)?t:"")},GC=function(t){if(r(this,ta))for(const e of r(this,ta))e.tabIndex=t},Ny=function(){if(v(this,cl,!1),b(this,Gt,GC).call(this,-1),r(this,Sd)){const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=r(this,Sd);b(this,Gt,HC).call(this,t,e,n,i),v(this,Sd,null)}},E(ae,VA),lt(ae,"_l10n",null),lt(ae,"_l10nResizer",null),lt(ae,"_borderLineWidth",-1),lt(ae,"_colorManager",new RC),lt(ae,"_zIndex",1),lt(ae,"_telemetryTimeout",1e3);let ge=ae;class Az extends ge{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const JL=3285377520,er=4294901760,Ea=65535;class lO{constructor(t){this.h1=t?t&4294967295:JL,this.h2=t?t&4294967295:JL}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,C=t.length;S<C;S++){const T=t.charCodeAt(S);T<=255?e[n++]=T:(e[n++]=T>>>8,e[n++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,o=new Uint32Array(e.buffer,0,i);let l=0,h=0,u=this.h1,f=this.h2;const g=3432918353,m=461845907,A=g&Ea,_=m&Ea;for(let S=0;S<i;S++)S&1?(l=o[S],l=l*g&er|l*A&Ea,l=l<<15|l>>>17,l=l*m&er|l*_&Ea,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(h=o[S],h=h*g&er|h*A&Ea,h=h<<15|h>>>17,h=h*m&er|h*_&Ea,f^=h,f=f<<13|f>>>19,f=f*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*g&er|l*A&Ea,l=l<<15|l>>>17,l=l*m&er|l*_&Ea,i&1?u^=l:f^=l}this.h1=u,this.h2=f}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&er|t*36045&Ea,e=e*4283543511&er|((e<<16|t>>>16)*2950163797&er)>>>16,t^=e>>>1,t=t*444984403&er|t*60499&Ea,e=e*3301882366&er|((e<<16|t>>>16)*3120437893&er)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const WC=Object.freeze({map:null,hash:"",transfer:void 0});var Td,kd,Un,yE,cO;class sk{constructor(){E(this,yE);E(this,Td,!1);E(this,kd,null);E(this,Un,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=r(this,Un).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return r(this,Un).get(t)}remove(t){if(r(this,Un).delete(t),r(this,Un).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,Un).values())if(e instanceof ge)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=r(this,Un).get(t);let i=!1;if(n!==void 0)for(const[s,o]of Object.entries(e))n[s]!==o&&(i=!0,n[s]=o);else i=!0,r(this,Un).set(t,e);i&&b(this,yE,cO).call(this),e instanceof ge&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Un).has(t)}getAll(){return r(this,Un).size>0?JT(r(this,Un)):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return r(this,Un).size}resetModified(){r(this,Td)&&(v(this,Td,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new hO(this)}get serializable(){if(r(this,Un).size===0)return WC;const t=new Map,e=new lO,n=[],i=Object.create(null);let s=!1;for(const[o,l]of r(this,Un)){const h=l instanceof ge?l.serialize(!1,i):l;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const o of t.values())o.bitmap&&n.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:WC}get editorStats(){let t=null;const e=new Map;for(const n of r(this,Un).values()){if(!(n instanceof ge))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const o=t[s]||(t[s]=new Map);for(const[l,h]of Object.entries(i)){if(l==="type")continue;let u=o.get(l);u||(u=new Map,o.set(l,u));const f=u.get(h)??0;u.set(h,f+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){v(this,kd,null)}get modifiedIds(){if(r(this,kd))return r(this,kd);const t=[];for(const e of r(this,Un).values())!(e instanceof ge)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return v(this,kd,{ids:new Set(t),hash:t.join(",")})}}Td=new WeakMap,kd=new WeakMap,Un=new WeakMap,yE=new WeakSet,cO=function(){r(this,Td)||(v(this,Td,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var qA;class hO extends sk{constructor(e){super();E(this,qA);const{map:n,hash:i,transfer:s}=e.serializable,o=structuredClone(n,s?{transfer:s}:null);v(this,qA,{map:o,hash:i,transfer:s})}get print(){Le("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,qA)}get modifiedIds(){return Zt(this,"modifiedIds",{ids:new Set,hash:""})}}qA=new WeakMap;var Mg;class bz{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){E(this,Mg,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,Mg).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,Mg).has(t.loadedName))){if(Sn(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=t,o=new FontFace(n,i,s);this.addNativeFontFace(o);try{await o.load(),r(this,Mg).add(n),e==null||e(t)}catch{Wt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Le("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Wt(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Zt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(ki||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Zt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Sn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Zt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(L,I){return L.charCodeAt(I)<<24|L.charCodeAt(I+1)<<16|L.charCodeAt(I+2)<<8|L.charCodeAt(I+3)&255}function i(L,I,D,F){const H=L.substring(0,I),j=L.substring(I+D);return H+F+j}let s,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let u=0;function f(L,I){if(++u>30){Wt("Load test font never loaded."),I();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(f.bind(null,L,I))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,g.length,g);const _=16,S=1482184792;let C=n(m,_);for(s=0,o=g.length-3;s<o;s+=4)C=C-S+n(g,s)|0;s<g.length&&(C=C-S+n(g+"XXX",s)|0),m=i(m,_,4,sz(C));const T=`url(data:font/opentype;base64,${btoa(m)});`,k=`@font-face {font-family:"${g}";src:${T}}`;this.insertRule(k);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[t.loadedName,g]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=L,P.append(I)}this._document.body.append(P),f(g,()=>{P.remove(),e.complete()})}}Mg=new WeakMap;class _z{constructor(t,{disableFontFace:e=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this.disableFontFace=e===!0,this._inspectFont=n}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${hz(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let n;try{n=t.get(this.loadedName+"_path_"+e)}catch(s){Wt(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[e]=function(s,o){};const i=[];for(let s=0,o=n.length;s<o;)switch(n[s++]){case So.BEZIER_CURVE_TO:{const[l,h,u,f,g,m]=n.slice(s,s+6);i.push(A=>A.bezierCurveTo(l,h,u,f,g,m)),s+=6}break;case So.MOVE_TO:{const[l,h]=n.slice(s,s+2);i.push(u=>u.moveTo(l,h)),s+=2}break;case So.LINE_TO:{const[l,h]=n.slice(s,s+2);i.push(u=>u.lineTo(l,h)),s+=2}break;case So.QUADRATIC_CURVE_TO:{const[l,h,u,f]=n.slice(s,s+4);i.push(g=>g.quadraticCurveTo(l,h,u,f)),s+=4}break;case So.RESTORE:i.push(l=>l.restore());break;case So.SAVE:i.push(l=>l.save());break;case So.SCALE:Sn(i.length===2,"Scale command is only valid at the third position.");break;case So.TRANSFORM:{const[l,h,u,f,g,m]=n.slice(s,s+6);i.push(A=>A.transform(l,h,u,f,g,m)),s+=6}break;case So.TRANSLATE:{const[l,h]=n.slice(s,s+2);i.push(u=>u.translate(l,h)),s+=2}break}return this.compiledGlyphs[e]=function(o,l){i[0](o),i[1](o),o.scale(l,-l);for(let h=2,u=i.length;h<u;h++)i[h](o)}}}var XA;class uO{constructor({enableHWA:t=!1}){E(this,XA,!1);v(this,XA,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!r(this,XA)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Le("Abstract method `_createCanvas` called.")}}XA=new WeakMap;class wz extends uO{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class dO{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Le("Abstract method `_fetch` called.")}}class fO extends dO{async _fetch(t){const e=await BE(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):HE(e)}}class pO{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(t=!1){}}var Pd,Rd,Ja,hl,Ei,vE,Ld,vt,yi,tp,ep,yw,np,gO,VC,ip,$y,jy,qC,Hy;class Ez extends pO{constructor({docId:e,ownerDocument:n=globalThis.document}){super();E(this,vt);E(this,Pd);E(this,Rd);E(this,Ja);E(this,hl);E(this,Ei);E(this,vE);E(this,Ld,0);v(this,hl,e),v(this,Ei,n)}addFilter(e){if(!e)return"none";let n=r(this,vt,yi).get(e);if(n)return n;const[i,s,o]=b(this,vt,yw).call(this,e),l=e.length===1?i:`${i}${s}${o}`;if(n=r(this,vt,yi).get(l),n)return r(this,vt,yi).set(e,n),n;const h=`g_${r(this,hl)}_transfer_map_${le(this,Ld)._++}`,u=b(this,vt,np).call(this,h);r(this,vt,yi).set(e,u),r(this,vt,yi).set(l,u);const f=b(this,vt,ip).call(this,h);return b(this,vt,jy).call(this,i,s,o,f),u}addHCMFilter(e,n){var _;const i=`${e}-${n}`,s="base";let o=r(this,vt,tp).get(s);if((o==null?void 0:o.key)===i||(o?((_=o.filter)==null||_.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},r(this,vt,tp).set(s,o)),!e||!n))return o.url;const l=b(this,vt,Hy).call(this,e);e=kt.makeHexColor(...l);const h=b(this,vt,Hy).call(this,n);if(n=kt.makeHexColor(...h),r(this,vt,ep).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return o.url;const u=new Array(256);for(let S=0;S<=255;S++){const C=S/255;u[S]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const f=u.join(","),g=`g_${r(this,hl)}_hcm_filter`,m=o.filter=b(this,vt,ip).call(this,g);b(this,vt,jy).call(this,f,f,f,m),b(this,vt,VC).call(this,m);const A=(S,C)=>{const T=l[S]/255,k=h[S]/255,P=new Array(C+1);for(let L=0;L<=C;L++)P[L]=T+L/C*(k-T);return P.join(",")};return b(this,vt,jy).call(this,A(0,5),A(1,5),A(2,5),m),o.url=b(this,vt,np).call(this,g),o.url}addAlphaFilter(e){let n=r(this,vt,yi).get(e);if(n)return n;const[i]=b(this,vt,yw).call(this,[e]),s=`alpha_${i}`;if(n=r(this,vt,yi).get(s),n)return r(this,vt,yi).set(e,n),n;const o=`g_${r(this,hl)}_alpha_map_${le(this,Ld)._++}`,l=b(this,vt,np).call(this,o);r(this,vt,yi).set(e,l),r(this,vt,yi).set(s,l);const h=b(this,vt,ip).call(this,o);return b(this,vt,qC).call(this,i,h),l}addLuminosityFilter(e){let n=r(this,vt,yi).get(e||"luminosity");if(n)return n;let i,s;if(e?([i]=b(this,vt,yw).call(this,[e]),s=`luminosity_${i}`):s="luminosity",n=r(this,vt,yi).get(s),n)return r(this,vt,yi).set(e,n),n;const o=`g_${r(this,hl)}_luminosity_map_${le(this,Ld)._++}`,l=b(this,vt,np).call(this,o);r(this,vt,yi).set(e,l),r(this,vt,yi).set(s,l);const h=b(this,vt,ip).call(this,o);return b(this,vt,gO).call(this,h),e&&b(this,vt,qC).call(this,i,h),l}addHighlightHCMFilter(e,n,i,s,o){var k;const l=`${n}-${i}-${s}-${o}`;let h=r(this,vt,tp).get(e);if((h==null?void 0:h.key)===l||(h?((k=h.filter)==null||k.remove(),h.key=l,h.url="none",h.filter=null):(h={key:l,url:"none",filter:null},r(this,vt,tp).set(e,h)),!n||!i))return h.url;const[u,f]=[n,i].map(b(this,vt,Hy).bind(this));let g=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[A,_]=[s,o].map(b(this,vt,Hy).bind(this));m<g&&([g,m,A,_]=[m,g,_,A]),r(this,vt,ep).style.color="";const S=(P,L,I)=>{const D=new Array(256),F=(m-g)/I,H=P/255,j=(L-P)/(255*I);let Q=0;for(let W=0;W<=I;W++){const tt=Math.round(g+W*F),Z=H+W*j;for(let et=Q;et<=tt;et++)D[et]=Z;Q=tt+1}for(let W=Q;W<256;W++)D[W]=D[Q-1];return D.join(",")},C=`g_${r(this,hl)}_hcm_${e}_filter`,T=h.filter=b(this,vt,ip).call(this,C);return b(this,vt,VC).call(this,T),b(this,vt,jy).call(this,S(A[0],_[0],5),S(A[1],_[1],5),S(A[2],_[2],5),T),h.url=b(this,vt,np).call(this,C),h.url}destroy(e=!1){e&&r(this,vt,tp).size!==0||(r(this,Ja)&&(r(this,Ja).parentNode.parentNode.remove(),v(this,Ja,null)),r(this,Rd)&&(r(this,Rd).clear(),v(this,Rd,null)),v(this,Ld,0))}}Pd=new WeakMap,Rd=new WeakMap,Ja=new WeakMap,hl=new WeakMap,Ei=new WeakMap,vE=new WeakMap,Ld=new WeakMap,vt=new WeakSet,yi=function(){return r(this,Rd)||v(this,Rd,new Map)},tp=function(){return r(this,vE)||v(this,vE,new Map)},ep=function(){if(!r(this,Ja)){const e=r(this,Ei).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=r(this,Ei).createElementNS(Ro,"svg");i.setAttribute("width",0),i.setAttribute("height",0),v(this,Ja,r(this,Ei).createElementNS(Ro,"defs")),e.append(i),i.append(r(this,Ja)),r(this,Ei).body.append(e)}return r(this,Ja)},yw=function(e){if(e.length===1){const u=e[0],f=new Array(256);for(let m=0;m<256;m++)f[m]=u[m]/255;const g=f.join(",");return[g,g,g]}const[n,i,s]=e,o=new Array(256),l=new Array(256),h=new Array(256);for(let u=0;u<256;u++)o[u]=n[u]/255,l[u]=i[u]/255,h[u]=s[u]/255;return[o.join(","),l.join(","),h.join(",")]},np=function(e){if(r(this,Pd)===void 0){v(this,Pd,"");const n=r(this,Ei).URL;n!==r(this,Ei).baseURI&&(zE(n)?Wt('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,Pd,n.split("#",1)[0]))}return`url(${r(this,Pd)}#${e})`},gO=function(e){const n=r(this,Ei).createElementNS(Ro,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},VC=function(e){const n=r(this,Ei).createElementNS(Ro,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},ip=function(e){const n=r(this,Ei).createElementNS(Ro,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),r(this,vt,ep).append(n),n},$y=function(e,n,i){const s=r(this,Ei).createElementNS(Ro,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)},jy=function(e,n,i,s){const o=r(this,Ei).createElementNS(Ro,"feComponentTransfer");s.append(o),b(this,vt,$y).call(this,o,"feFuncR",e),b(this,vt,$y).call(this,o,"feFuncG",n),b(this,vt,$y).call(this,o,"feFuncB",i)},qC=function(e,n){const i=r(this,Ei).createElementNS(Ro,"feComponentTransfer");n.append(i),b(this,vt,$y).call(this,i,"feFuncA",e)},Hy=function(e){return r(this,vt,ep).style.color=e,ik(getComputedStyle(r(this,vt,ep)).getPropertyValue("color"))};class mO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Le("Abstract method `_fetch` called.")}}class yO extends mO{async _fetch(t){const e=await BE(t,"arraybuffer");return new Uint8Array(e)}}if(ki){var XC=Promise.withResolvers(),Jy=null;(async()=>{const t=await u_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),e=await u_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),n=await u_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await u_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let s,o;return new Map(Object.entries({fs:t,http:e,https:n,url:i,canvas:s,path2d:o}))})().then(t=>{Jy=t,XC.resolve()},t=>{Wt(`loadPackages: ${t}`),Jy=new Map,XC.resolve()})}class Ch{static get promise(){return XC.promise}static get(t){return Jy==null?void 0:Jy.get(t)}}async function vO(p){const e=await Ch.get("fs").promises.readFile(p);return new Uint8Array(e)}class Sz extends pO{}class xz extends uO{_createCanvas(t,e){return Ch.get("canvas").createCanvas(t,e)}}class Cz extends dO{async _fetch(t){return vO(t)}}class Tz extends mO{async _fetch(t){return vO(t)}}const ji={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function YC(p,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),p.clip(i)}class rk{getPattern(){Le("Abstract method `getPattern` called.")}}class kz extends rk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let s;if(i===ji.STROKE||i===ji.FILL){const o=e.current.getClippedPathBoundingBox(i,Ge(t))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,u=e.cachedCanvases.getCanvas("pattern",l,h),f=u.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),n=kt.transform(n,[1,0,0,1,o[0],o[1]]),f.transform(...e.baseTransform),this.matrix&&f.transform(...this.matrix),YC(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),s=t.createPattern(u.canvas,"no-repeat");const g=new DOMMatrix(n);s.setTransform(g)}else YC(t,this._bbox),s=this._createGradient(t);return s}}function lx(p,t,e,n,i,s,o,l){const h=t.coords,u=t.colors,f=p.data,g=p.width*4;let m;h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m),h[n+1]>h[i+1]&&(m=n,n=i,i=m,m=o,o=l,l=m),h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m);const A=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,C=(h[n+1]+t.offsetY)*t.scaleY,T=(h[i]+t.offsetX)*t.scaleX,k=(h[i+1]+t.offsetY)*t.scaleY;if(_>=k)return;const P=u[s],L=u[s+1],I=u[s+2],D=u[o],F=u[o+1],H=u[o+2],j=u[l],Q=u[l+1],W=u[l+2],tt=Math.round(_),Z=Math.round(k);let et,ht,J,G,q,U,N,M;for(let B=tt;B<=Z;B++){if(B<C){const nt=B<_?0:(_-B)/(_-C);et=A-(A-S)*nt,ht=P-(P-D)*nt,J=L-(L-F)*nt,G=I-(I-H)*nt}else{let nt;B>k?nt=1:C===k?nt=0:nt=(C-B)/(C-k),et=S-(S-T)*nt,ht=D-(D-j)*nt,J=F-(F-Q)*nt,G=H-(H-W)*nt}let Y;B<_?Y=0:B>k?Y=1:Y=(_-B)/(_-k),q=A-(A-T)*Y,U=P-(P-j)*Y,N=L-(L-Q)*Y,M=I-(I-W)*Y;const it=Math.round(Math.min(et,q)),dt=Math.round(Math.max(et,q));let at=g*B+it*4;for(let nt=it;nt<=dt;nt++)Y=(et-nt)/(et-q),Y<0?Y=0:Y>1&&(Y=1),f[at++]=ht-(ht-U)*Y|0,f[at++]=J-(J-N)*Y|0,f[at++]=G-(G-M)*Y|0,f[at++]=255}}function Pz(p,t,e){const n=t.coords,i=t.colors;let s,o;switch(t.type){case"lattice":const l=t.verticesPerRow,h=Math.floor(n.length/l)-1,u=l-1;for(s=0;s<h;s++){let f=s*l;for(let g=0;g<u;g++,f++)lx(p,e,n[f],n[f+1],n[f+l],i[f],i[f+1],i[f+l]),lx(p,e,n[f+l+1],n[f+1],n[f+l],i[f+l+1],i[f+1],i[f+l])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)lx(p,e,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class Rz extends rk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,f=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(f*t[1]*1.1)),3e3),A=u/g,_=f/m,S={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/A,scaleY:1/_},C=g+2*2,T=m+2*2,k=n.getCanvas("mesh",C,T),P=k.context,L=P.createImageData(g,m);if(e){const D=L.data;for(let F=0,H=D.length;F<H;F+=4)D[F]=e[0],D[F+1]=e[1],D[F+2]=e[2],D[F+3]=255}for(const D of this._figures)Pz(L,D,S);return P.putImageData(L,2,2),{canvas:k.canvas,offsetX:l-2*A,offsetY:h-2*_,scaleX:A,scaleY:_}}getPattern(t,e,n,i){YC(t,this._bbox);let s;if(i===ji.SHADING)s=kt.singularValueDecompose2dScale(Ge(t));else if(s=kt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const l=kt.singularValueDecompose2dScale(this.matrix);s=[s[0]*l[0],s[1]*l[1]]}const o=this._createMeshCanvas(s,i===ji.SHADING?null:this._background,e.cachedCanvases);return i!==ji.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class Lz extends rk{getPattern(){return"hotpink"}}function Mz(p){switch(p[0]){case"RadialAxial":return new kz(p);case"Mesh":return new Rz(p);case"Dummy":return new Lz}throw new Error(`Unknown IR type: ${p[0]}`)}const ZL={COLORED:1,UNCOLORED:2},AE=class AE{constructor(t,e,n,i,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:o,canvasGraphicsFactory:l}=this;let{xstep:h,ystep:u}=this;h=Math.abs(h),u=Math.abs(u),$E("TilingType: "+s);const f=e[0],g=e[1],m=e[2],A=e[3],_=m-f,S=A-g,C=kt.singularValueDecompose2dScale(this.matrix),T=kt.singularValueDecompose2dScale(this.baseTransform),k=C[0]*T[0],P=C[1]*T[1];let L=_,I=S,D=!1,F=!1;const H=Math.ceil(h*k),j=Math.ceil(u*P),Q=Math.ceil(_*k),W=Math.ceil(S*P);H>=Q?L=h:D=!0,j>=W?I=u:F=!0;const tt=this.getSizeAndScale(L,this.ctx.canvas.width,k),Z=this.getSizeAndScale(I,this.ctx.canvas.height,P),et=t.cachedCanvases.getCanvas("pattern",tt.size,Z.size),ht=et.context,J=l.createCanvasGraphics(ht);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,i,o),ht.translate(-tt.scale*f,-Z.scale*g),J.transform(tt.scale,0,0,Z.scale,0,0),ht.save(),this.clipBbox(J,f,g,m,A),J.baseTransform=Ge(J.ctx),J.executeOperatorList(n),J.endDrawing(),ht.restore(),D||F){const G=et.canvas;D&&(L=h),F&&(I=u);const q=this.getSizeAndScale(L,this.ctx.canvas.width,k),U=this.getSizeAndScale(I,this.ctx.canvas.height,P),N=q.size,M=U.size,B=t.cachedCanvases.getCanvas("pattern-workaround",N,M),Y=B.context,it=D?Math.floor(_/h):0,dt=F?Math.floor(S/u):0;for(let at=0;at<=it;at++)for(let nt=0;nt<=dt;nt++)Y.drawImage(G,N*at,M*nt,N,M,0,0,N,M);return{canvas:B.canvas,scaleX:q.scale,scaleY:U.scale,offsetX:f,offsetY:g}}return{canvas:et.canvas,scaleX:tt.scale,scaleY:Z.scale,offsetX:f,offsetY:g}}getSizeAndScale(t,e,n){const i=Math.max(AE.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const o=i-e,l=s-n;t.ctx.rect(e,n,o,l),t.current.updateRectMinMax(Ge(t.ctx),[e,n,i,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case ZL.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,s.fillColor=o.fillStyle,s.strokeColor=o.strokeStyle;break;case ZL.UNCOLORED:const l=kt.makeHexColor(n[0],n[1],n[2]);i.fillStyle=l,i.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new iz(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let s=n;i!==ji.SHADING&&(s=kt.transform(s,e.baseTransform),this.matrix&&(s=kt.transform(s,this.matrix)));const o=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const h=t.createPattern(o.canvas,"repeat");return h.setTransform(l),h}};lt(AE,"MAX_PATTERN_SIZE",3e3);let KC=AE;function Iz({src:p,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=Bi.isLittleEndian?4278190080:255,[h,u]=o?[s,l]:[l,s],f=n>>3,g=n&7,m=p.length;e=new Uint32Array(e.buffer);let A=0;for(let _=0;_<i;_++){for(const C=t+f;t<C;t++){const T=t<m?p[t]:255;e[A++]=T&128?u:h,e[A++]=T&64?u:h,e[A++]=T&32?u:h,e[A++]=T&16?u:h,e[A++]=T&8?u:h,e[A++]=T&4?u:h,e[A++]=T&2?u:h,e[A++]=T&1?u:h}if(g===0)continue;const S=t<m?p[t++]:255;for(let C=0;C<g;C++)e[A++]=S&1<<7-C?u:h}return{srcPos:t,destPos:A}}const tM=16,eM=100,Dz=15,nM=10,iM=1e3,cs=16;function Fz(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(n,i){t.translate(n,i),this.__originalTranslate(n,i)},p.scale=function(n,i){t.scale(n,i),this.__originalScale(n,i)},p.transform=function(n,i,s,o,l,h){t.transform(n,i,s,o,l,h),this.__originalTransform(n,i,s,o,l,h)},p.setTransform=function(n,i,s,o,l,h){t.setTransform(n,i,s,o,l,h),this.__originalSetTransform(n,i,s,o,l,h)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(n){t.rotate(n),this.__originalRotate(n)},p.clip=function(n){t.clip(n),this.__originalClip(n)},p.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},p.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},p.bezierCurveTo=function(e,n,i,s,o,l){t.bezierCurveTo(e,n,i,s,o,l),this.__originalBezierCurveTo(e,n,i,s,o,l)},p.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Oz{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function d_(p,t,e,n,i,s,o,l,h,u){const[f,g,m,A,_,S]=Ge(p);if(g===0&&m===0){const k=o*f+_,P=Math.round(k),L=l*A+S,I=Math.round(L),D=(o+h)*f+_,F=Math.abs(Math.round(D)-P)||1,H=(l+u)*A+S,j=Math.abs(Math.round(H)-I)||1;return p.setTransform(Math.sign(f),0,0,Math.sign(A),P,I),p.drawImage(t,e,n,i,s,0,0,F,j),p.setTransform(f,g,m,A,_,S),[F,j]}if(f===0&&A===0){const k=l*m+_,P=Math.round(k),L=o*g+S,I=Math.round(L),D=(l+u)*m+_,F=Math.abs(Math.round(D)-P)||1,H=(o+h)*g+S,j=Math.abs(Math.round(H)-I)||1;return p.setTransform(0,Math.sign(g),Math.sign(m),0,P,I),p.drawImage(t,e,n,i,s,0,0,j,F),p.setTransform(f,g,m,A,_,S),[j,F]}p.drawImage(t,e,n,i,s,o,l,h,u);const C=Math.hypot(f,g),T=Math.hypot(m,A);return[C*h,T*u]}function Nz(p){const{width:t,height:e}=p;if(t>iM||e>iM)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let o=new Uint8Array(s*(e+1)),l,h,u;const f=t+7&-8;let g=new Uint8Array(f*e),m=0;for(const T of p.data){let k=128;for(;k>0;)g[m++]=T&k?0:255,k>>=1}let A=0;for(m=0,g[m]!==0&&(o[0]=1,++A),h=1;h<t;h++)g[m]!==g[m+1]&&(o[h]=g[m]?2:1,++A),m++;for(g[m]!==0&&(o[h]=2,++A),l=1;l<e;l++){m=l*f,u=l*s,g[m-f]!==g[m]&&(o[u]=g[m]?1:8,++A);let T=(g[m]?4:0)+(g[m-f]?8:0);for(h=1;h<t;h++)T=(T>>2)+(g[m+1]?4:0)+(g[m-f+1]?8:0),i[T]&&(o[u+h]=i[T],++A),m++;if(g[m-f]!==g[m]&&(o[u+h]=g[m]?2:4,++A),A>n)return null}for(m=f*(e-1),u=l*s,g[m]!==0&&(o[u]=8,++A),h=1;h<t;h++)g[m]!==g[m+1]&&(o[u+h]=g[m]?4:8,++A),m++;if(g[m]!==0&&(o[u+h]=4,++A),A>n)return null;const _=new Int32Array([0,s,-1,0,-s,0,0,0,1]),S=new Path2D;for(l=0;A&&l<=e;l++){let T=l*s;const k=T+t;for(;T<k&&!o[T];)T++;if(T===k)continue;S.moveTo(T%s,l);const P=T;let L=o[T];do{const I=_[L];do T+=I;while(!o[T]);const D=o[T];D!==5&&D!==10?(L=D,o[T]=0):(L=D&51*L>>4,o[T]&=L>>2|L<<2),S.lineTo(T%s,T/s|0),o[T]||--A}while(P!==T);--l}return g=null,o=null,function(T){T.save(),T.scale(1/t,-1/e),T.translate(0,-e),T.fill(S),T.beginPath(),T.restore()}}class sM{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=FF,this.textMatrixScale=1,this.fontMatrix=wC,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=mi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=kt.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=kt.applyTransform(e,t),i=kt.applyTransform(e.slice(2),t),s=kt.applyTransform([e[0],e[3]],t),o=kt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],i[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],i[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],i[1],s[1],o[1])}updateScalingPathMinMax(t,e){kt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,s,o,l,h,u,f){const g=kt.bezierBoundingBox(e,n,i,s,o,l,h,u,f);f||this.updateRectMinMax(t,g)}getPathBoundingBox(t=ji.FILL,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===ji.STROKE){e||Le("Stroke bounding box must include transform.");const i=kt.singularValueDecompose2dScale(e),s=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=kt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=ji.FILL,e=null){return kt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function rM(p,t){if(typeof ImageData<"u"&&t instanceof ImageData){p.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%cs,s=(e-i)/cs,o=i===0?s:s+1,l=p.createImageData(n,cs);let h=0,u;const f=t.data,g=l.data;let m,A,_,S;if(t.kind===hw.GRAYSCALE_1BPP){const C=f.byteLength,T=new Uint32Array(g.buffer,0,g.byteLength>>2),k=T.length,P=n+7>>3,L=4294967295,I=Bi.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(_=m<s?cs:i,u=0,A=0;A<_;A++){const D=C-h;let F=0;const H=D>P?n:D*8-7,j=H&-8;let Q=0,W=0;for(;F<j;F+=8)W=f[h++],T[u++]=W&128?L:I,T[u++]=W&64?L:I,T[u++]=W&32?L:I,T[u++]=W&16?L:I,T[u++]=W&8?L:I,T[u++]=W&4?L:I,T[u++]=W&2?L:I,T[u++]=W&1?L:I;for(;F<H;F++)Q===0&&(W=f[h++],Q=128),T[u++]=W&Q?L:I,Q>>=1}for(;u<k;)T[u++]=0;p.putImageData(l,0,m*cs)}}else if(t.kind===hw.RGBA_32BPP){for(A=0,S=n*cs*4,m=0;m<s;m++)g.set(f.subarray(h,h+S)),h+=S,p.putImageData(l,0,A),A+=cs;m<o&&(S=n*i*4,g.set(f.subarray(h,h+S)),p.putImageData(l,0,A))}else if(t.kind===hw.RGB_24BPP)for(_=cs,S=n*_,m=0;m<o;m++){for(m>=s&&(_=i,S=n*_),u=0,A=S;A--;)g[u++]=f[h++],g[u++]=f[h++],g[u++]=f[h++],g[u++]=255;p.putImageData(l,0,m*cs)}else throw new Error(`bad image kind: ${t.kind}`)}function aM(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%cs,s=(e-i)/cs,o=i===0?s:s+1,l=p.createImageData(n,cs);let h=0;const u=t.data,f=l.data;for(let g=0;g<o;g++){const m=g<s?cs:i;({srcPos:h}=Iz({src:u,srcPos:h,dest:f,width:n,height:m,nonBlackColor:0})),p.putImageData(l,0,g*cs)}}function uy(p,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)p[n]!==void 0&&(t[n]=p[n]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function f_(p){if(p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0),!ki){const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}}function oM(p,t){if(t)return!0;const e=kt.singularValueDecompose2dScale(p);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*xh.PDF_TO_CSS_UNITS);return e[0]<=n&&e[1]<=n}const $z=["butt","round","square"],jz=["miter","round","bevel"],Hz={},lM={};var Ph,QC,JC;const mk=class mk{constructor(t,e,n,i,s,{optionalContentConfig:o,markedContentStack:l=null},h,u){E(this,Ph);this.ctx=t,this.current=new sM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new Oz(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,n){const h=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ge(this.compositeCtx))}this.ctx.save(),f_(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ge(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,o=t.fnArray;let l=e||0;const h=s.length;if(h===l)return l;const u=h-l>nM&&typeof n=="function",f=u?Date.now()+Dz:0;let g=0;const m=this.commonObjs,A=this.objs;let _;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,n),l;if(_=o[l],_!==Nr.dependency)this[_].apply(this,s[l]);else for(const S of s[l]){const C=S.startsWith("g_")?m:A;if(!C.has(S))return C.get(S,n),l}if(l++,l===h)return l;if(u&&++g>nM){if(Date.now()>f)return n(),l;g=0}}}endDrawing(){b(this,Ph,QC).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),b(this,Ph,JC).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,h=i,u="prescale1",f,g;for(;s>2&&l>1||o>2&&h>1;){let m=l,A=h;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),o>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/A),f=this.cachedCanvases.getCanvas(u,m,A),g=f.context,g.clearRect(0,0,m,A),g.drawImage(t,0,0,l,h,0,0,m,A),t=f.canvas,l=m,h=A,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,o=this.current.patternFill,l=Ge(e);let h,u,f,g;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;u=JSON.stringify(o?l:[l.slice(0,4),s]),h=this._cachedBitmapsMap.get(H),h||(h=new Map,this._cachedBitmapsMap.set(H,h));const j=h.get(u);if(j&&!o){const Q=Math.round(Math.min(l[0],l[2])+l[4]),W=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:j,offsetX:Q,offsetY:W}}f=j}f||(g=this.cachedCanvases.getCanvas("maskCanvas",n,i),aM(g.context,t));let m=kt.transform(l,[1/n,0,0,-1/i,0,0]);m=kt.transform(m,[1,0,0,1,0,-i]);const[A,_,S,C]=kt.getAxialAlignedBoundingBox([0,0,n,i],m),T=Math.round(S-A)||1,k=Math.round(C-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",T,k),L=P.context,I=A,D=_;L.translate(-I,-D),L.transform(...m),f||(f=this._scaleImage(g.canvas,xo(L)),f=f.img,h&&o&&h.set(u,f)),L.imageSmoothingEnabled=oM(Ge(L),t.interpolate),d_(L,f,0,0,f.width,f.height,0,0,n,i),L.globalCompositeOperation="source-in";const F=kt.transform(xo(L),[1,0,0,1,-I,-D]);return L.fillStyle=o?s.getPattern(e,this,F,ji.FILL):s,L.fillRect(0,0,n,i),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(u,P.canvas)),{canvas:P.canvas,offsetX:Math.round(I),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=$z[t]}setLineJoin(t){this.ctx.lineJoin=jz[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...Ge(this.suspendedCtx)),uy(this.suspendedCtx,s),Fz(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),uy(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],o=i[1],l=i[2]-s,h=i[3]-o;l===0||h===0||(this.genericComposeSMask(e.context,n,l,h,e.subtype,e.backdrop,e.transferMap,s,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,o,l,h,u,f,g){let m=t.canvas,A=h-f,_=u-g;if(o){const C=kt.makeHexColor(...o);if(A<0||_<0||A+n>m.width||_+i>m.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,i),k=T.context;k.drawImage(m,-A,-_),k.globalCompositeOperation="destination-atop",k.fillStyle=C,k.fillRect(0,0,n,i),k.globalCompositeOperation="source-over",m=T.canvas,A=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(A,_,n,i),t.clip(T),t.globalCompositeOperation="destination-atop",t.fillStyle=C,t.fillRect(A,_,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const S=new Path2D;S.rect(h,u,n,i),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(m,A,_,n,i,h,u,n,i),e.restore()}save(){this.inSMaskMode?(uy(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),uy(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,s,o){this.ctx.transform(t,e,n,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,s=this.current;let o=s.x,l=s.y,h,u;const f=Ge(i),g=f[0]===0&&f[3]===0||f[1]===0&&f[2]===0,m=g?n.slice(0):null;for(let A=0,_=0,S=t.length;A<S;A++)switch(t[A]|0){case Nr.rectangle:o=e[_++],l=e[_++];const C=e[_++],T=e[_++],k=o+C,P=l+T;i.moveTo(o,l),C===0||T===0?i.lineTo(k,P):(i.lineTo(k,l),i.lineTo(k,P),i.lineTo(o,P)),g||s.updateRectMinMax(f,[o,l,k,P]),i.closePath();break;case Nr.moveTo:o=e[_++],l=e[_++],i.moveTo(o,l),g||s.updatePathMinMax(f,o,l);break;case Nr.lineTo:o=e[_++],l=e[_++],i.lineTo(o,l),g||s.updatePathMinMax(f,o,l);break;case Nr.curveTo:h=o,u=l,o=e[_+4],l=e[_+5],i.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],o,l),s.updateCurvePathMinMax(f,h,u,e[_],e[_+1],e[_+2],e[_+3],o,l,m),_+=6;break;case Nr.curveTo2:h=o,u=l,i.bezierCurveTo(o,l,e[_],e[_+1],e[_+2],e[_+3]),s.updateCurvePathMinMax(f,h,u,o,l,e[_],e[_+1],e[_+2],e[_+3],m),o=e[_+2],l=e[_+3],_+=4;break;case Nr.curveTo3:h=o,u=l,o=e[_+2],l=e[_+3],i.bezierCurveTo(e[_],e[_+1],o,l,o,l),s.updateCurvePathMinMax(f,h,u,e[_],e[_+1],o,l,o,l,m),_+=4;break;case Nr.closePath:i.closePath();break}g&&s.updateScalingPathMinMax(f,m),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(e.save(),e.strokeStyle=n.getPattern(e,this,xo(e),ji.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let s=!1;i&&(e.save(),e.fillStyle=n.getPattern(e,this,xo(e),ji.FILL),s=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Hz}eoClip(){this.pendingClip=lM}beginText(){this.current.textMatrix=FF,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const n of t)e.setTransform(...n.transform),e.translate(n.x,n.y),n.addToPath(e,n.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var f;const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||wC,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Wt("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const s=n.loadedName||"sans-serif",o=((f=n.systemFontInfo)==null?void 0:f.css)||`"${s}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const h=n.italic?"italic":"normal";let u=e;e<tM?u=tM:e>eM&&(u=eM),this.current.fontSizeScale=e/u,this.ctx.font=`${h} ${l} ${u}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,s,o){this.current.textMatrix=[t,e,n,i,s,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i){const s=this.ctx,o=this.current,l=o.font,h=o.textRenderingMode,u=o.fontSize/o.fontSizeScale,f=h&mi.FILL_STROKE_MASK,g=!!(h&mi.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile;let A;(l.disableFontFace||g||m)&&(A=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||m?(s.save(),s.translate(e,n),s.beginPath(),A(s,u),i&&s.setTransform(...i),(f===mi.FILL||f===mi.FILL_STROKE)&&s.fill(),(f===mi.STROKE||f===mi.FILL_STROKE)&&s.stroke(),s.restore()):((f===mi.FILL||f===mi.FILL_STROKE)&&s.fillText(t,e,n),(f===mi.STROKE||f===mi.FILL_STROKE)&&s.strokeText(t,e,n)),g&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ge(s),x:e,y:n,fontSize:u,addToPath:A})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return Zt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,h=e.wordSpacing,u=e.fontDirection,f=e.textHScale*u,g=t.length,m=n.vertical,A=m?1:-1,_=n.defaultVMetrics,S=i*e.fontMatrix[0],C=e.textRenderingMode===mi.FILL&&!n.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),u>0?s.scale(f,-1):s.scale(f,1);let T;if(e.patternFill){s.save();const D=e.fillColor.getPattern(s,this,xo(s),ji.FILL);T=Ge(s),s.restore(),s.fillStyle=D}let k=e.lineWidth;const P=e.textMatrixScale;if(P===0||k===0){const D=e.textRenderingMode&mi.FILL_STROKE_MASK;(D===mi.STROKE||D===mi.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=P;if(o!==1&&(s.scale(o,o),k/=o),s.lineWidth=k,n.isInvalidPDFjsFont){const D=[];let F=0;for(const H of t)D.push(H.unicode),F+=H.width;s.fillText(D.join(""),0,0),e.x+=F*S*f,s.restore(),this.compose();return}let L=0,I;for(I=0;I<g;++I){const D=t[I];if(typeof D=="number"){L+=A*D*i/1e3;continue}let F=!1;const H=(D.isSpace?h:0)+l,j=D.fontChar,Q=D.accent;let W,tt,Z=D.width;if(m){const ht=D.vmetric||_,J=-(D.vmetric?ht[1]:Z*.5)*S,G=ht[2]*S;Z=ht?-ht[0]:Z,W=J/o,tt=(L+G)/o}else W=L/o,tt=0;if(n.remeasure&&Z>0){const ht=s.measureText(j).width*1e3/i*o;if(Z<ht&&this.isFontSubpixelAAEnabled){const J=Z/ht;F=!0,s.save(),s.scale(J,1),W/=J}else Z!==ht&&(W+=(Z-ht)/2e3*i/o)}if(this.contentVisible&&(D.isInFont||n.missingFile)){if(C&&!Q)s.fillText(j,W,tt);else if(this.paintChar(j,W,tt,T),Q){const ht=W+i*Q.offset.x/o,J=tt-i*Q.offset.y/o;this.paintChar(Q.fontChar,ht,J,T)}}const et=m?Z*S-H*u:Z*S+H*u;L+=et,F&&s.restore()}m?e.y-=L:e.x+=L*f,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,o=n.fontDirection,l=i.vertical?1:-1,h=n.charSpacing,u=n.wordSpacing,f=n.textHScale*o,g=n.fontMatrix||wC,m=t.length,A=n.textRenderingMode===mi.INVISIBLE;let _,S,C,T;if(!(A||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(f,o),_=0;_<m;++_){if(S=t[_],typeof S=="number"){T=l*S*s/1e3,this.ctx.translate(T,0),n.x+=T*f;continue}const k=(S.isSpace?u:0)+h,P=i.charProcOperatorList[S.operatorListId];if(!P){Wt(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(s,s),e.transform(...g),this.executeOperatorList(P),this.restore()),C=kt.applyTransform([S.width,0],g)[0]*s+k,e.translate(C,0),n.x+=C*f}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,o){this.ctx.rect(n,i,s-n,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=t[1],i=this.baseTransform||Ge(this.ctx),s={createCanvasGraphics:o=>new mk(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new KC(t,n,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=kt.makeHexColor(t,e,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=kt.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=Mz(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,xo(e),ji.SHADING);const i=xo(e);{const{width:s,height:o}=e.canvas,[l,h,u,f]=kt.getAxialAlignedBoundingBox([0,0,s,o],i);this.ctx.fillRect(l,h,u-l,f-h)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Le("Should not call beginInlineImage")}beginImageData(){Le("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Ge(this.ctx),e)){const n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.current.updateRectMinMax(Ge(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||$E("TODO: Support non-isolated groups."),t.knockout&&Wt("Knockout groups not supported.");const n=Ge(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=kt.getAxialAlignedBoundingBox(t.bbox,Ge(e));const s=[0,0,e.canvas.width,e.canvas.height];i=kt.intersect(i,s)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,h,u]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(f,h,u),m=g.context;m.translate(-o,-l),m.transform(...n),t.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.save()),uy(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ge(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=kt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,n,i,s){if(b(this,Ph,QC).call(this),f_(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=l;const[h,u]=kt.singularValueDecompose2dScale(Ge(this.ctx)),{viewportScale:f}=this,g=Math.ceil(o*this.outputScaleX*f),m=Math.ceil(l*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:A,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-u,0,l*u),f_(this.ctx)}else f_(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new sM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),b(this,Ph,JC).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=Nz(t)),i.compiled)){i.compiled(n);return}const s=this._createMaskCanvas(t),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,s,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const h=Ge(l);l.transform(e,n,i,s,0,0);const u=this._createMaskCanvas(t);l.setTransform(1,0,0,1,u.offsetX-h[4],u.offsetY-h[5]);for(let f=0,g=o.length;f<g;f+=2){const m=kt.transform(h,[e,n,i,s,o[f],o[f+1]]),[A,_]=kt.applyTransform([0,0],m);l.drawImage(u.canvas,A,_)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:o,width:l,height:h,transform:u}=s,f=this.cachedCanvases.getCanvas("maskCanvas",l,h),g=f.context;g.save();const m=this.getObject(o,s);aM(g,m),g.globalCompositeOperation="source-in",g.fillStyle=i?n.getPattern(g,this,xo(e),ji.FILL):n,g.fillRect(0,0,l,h),g.restore(),e.save(),e.transform(...u),e.scale(1,-1),d_(e,f.canvas,0,0,l,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Wt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Wt("Dependent image isn't ready yet");return}const o=s.width,l=s.height,h=[];for(let u=0,f=i.length;u<f;u+=2)h.push({transform:[e,0,0,n,i[u],i[u+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(s,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!ki){const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none")}i.scale(1/e,-1/n);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;rM(h,t),s=this.applyTransferMapsToCanvas(h)}const o=this._scaleImage(s,xo(i));i.imageSmoothingEnabled=oM(Ge(i),t.interpolate),d_(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,o=t.height,h=this.cachedCanvases.getCanvas("inlineImage",s,o).context;rM(h,t),i=this.applyTransferMapsToCanvas(h)}for(const s of e)n.save(),n.transform(...s.transform),n.scale(1,-1),d_(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===lM?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ge(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let o,l;if(n===0&&i===0){const h=Math.abs(e),u=Math.abs(s);if(h===u)if(t===0)o=l=1/h;else{const f=h*t;o=l=f<1?1/f:1}else if(t===0)o=1/h,l=1/u;else{const f=h*t,g=u*t;o=f<1?1/f:1,l=g<1?1/g:1}}else{const h=Math.abs(e*s-n*i),u=Math.hypot(e,n),f=Math.hypot(i,s);if(t===0)o=f/h,l=u/h;else{const g=t*h;o=f>g?f/g:1,l=u>g?u/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,s]=this.getScaleForStroking();if(e.lineWidth=n||1,i===1&&s===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,s),o.length>0){const l=Math.max(i,s);e.setLineDash(o.map(h=>h/l)),e.lineDashOffset/=l}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ph=new WeakSet,QC=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},JC=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let cp=mk;for(const p in Nr)cp.prototype[p]!==void 0&&(cp.prototype[Nr[p]]=cp.prototype[p]);var YA,KA;class Pl{static get workerPort(){return r(this,YA)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");v(this,YA,t)}static get workerSrc(){return r(this,KA)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");v(this,KA,t)}}YA=new WeakMap,KA=new WeakMap,E(Pl,YA,null),E(Pl,KA,"");const p_={UNKNOWN:0,DATA:1,ERROR:2},cn={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function As(p){switch(p instanceof Error||typeof p=="object"&&p!==null||Le('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new bf(p.message);case"MissingPDFException":return new Af(p.message);case"PasswordException":return new EC(p.message,p.code);case"UnexpectedResponseException":return new jE(p.message,p.status);case"UnknownErrorException":return new SC(p.message,p.details);default:return new SC(p.message,p.toString())}}var Ig,_r,AO,bO,_O,vw;class By{constructor(t,e,n){E(this,_r);E(this,Ig,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",b(this,_r,AO).bind(this),{signal:r(this,Ig).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:u=>{const f=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:l,action:t,streamId:s,data:e,desiredSize:u.desiredSize},i),f.promise},pull:u=>{const f=Promise.withResolvers();return this.streamControllers[s].pullCall=f,h.postMessage({sourceName:o,targetName:l,stream:cn.PULL,streamId:s,desiredSize:u.desiredSize}),f.promise},cancel:u=>{Sn(u instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[s].cancelCall=f,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:o,targetName:l,stream:cn.CANCEL,streamId:s,reason:As(u)}),f.promise}},n)}destroy(){var t;(t=r(this,Ig))==null||t.abort(),v(this,Ig,null)}}Ig=new WeakMap,_r=new WeakSet,AO=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){b(this,_r,_O).call(this,t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===p_.DATA)i.resolve(t.data);else if(t.callback===p_.ERROR)i.reject(As(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,s=this.comObj;new Promise(function(o){o(e(t.data))}).then(function(o){s.postMessage({sourceName:n,targetName:i,callback:p_.DATA,callbackId:t.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:i,callback:p_.ERROR,callbackId:t.callbackId,reason:As(o)})});return}if(t.streamId){b(this,_r,bO).call(this,t);return}e(t.data)},bO=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this,l=this.actionHandler[t.action],h={enqueue(u,f=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=f,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:cn.ENQUEUE,streamId:e,chunk:u},g)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:cn.CLOSE,streamId:e}),delete o.streamSinks[e])},error(u){Sn(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:cn.ERROR,streamId:e,reason:As(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,new Promise(function(u){u(l(t.data,h))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cn.START_COMPLETE,streamId:e,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:cn.START_COMPLETE,streamId:e,reason:As(u)})})},_O=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case cn.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(As(t.reason));break;case cn.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(As(t.reason));break;case cn.PULL:if(!l){s.postMessage({sourceName:n,targetName:i,stream:cn.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,new Promise(function(h){var u;h((u=l.onPull)==null?void 0:u.call(l))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cn.PULL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:n,targetName:i,stream:cn.PULL_COMPLETE,streamId:e,reason:As(h)})});break;case cn.ENQUEUE:if(Sn(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case cn.CLOSE:if(Sn(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),b(this,_r,vw).call(this,o,e);break;case cn.ERROR:Sn(o,"error should have stream controller"),o.controller.error(As(t.reason)),b(this,_r,vw).call(this,o,e);break;case cn.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(As(t.reason)),b(this,_r,vw).call(this,o,e);break;case cn.CANCEL:if(!l)break;new Promise(function(h){var u;h((u=l.onCancel)==null?void 0:u.call(l,As(t.reason)))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cn.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:n,targetName:i,stream:cn.CANCEL_COMPLETE,streamId:e,reason:As(h)})}),l.sinkCapability.reject(As(t.reason)),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},vw=async function(t,e){var n,i,s;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(i=t.pullCall)==null?void 0:i.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]};var Md,QA;class Bz{constructor({parsedData:t,rawData:e}){E(this,Md);E(this,QA);v(this,Md,t),v(this,QA,e)}getRaw(){return r(this,QA)}get(t){return r(this,Md).get(t)??null}getAll(){return JT(r(this,Md))}has(t){return r(this,Md).has(t)}}Md=new WeakMap,QA=new WeakMap;const sp=Symbol("INTERNAL");var JA,ZA,tb,Dg;class zz{constructor(t,{name:e,intent:n,usage:i,rbGroups:s}){E(this,JA,!1);E(this,ZA,!1);E(this,tb,!1);E(this,Dg,!0);v(this,JA,!!(t&Bs.DISPLAY)),v(this,ZA,!!(t&Bs.PRINT)),this.name=e,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(r(this,tb))return r(this,Dg);if(!r(this,Dg))return!1;const{print:t,view:e}=this.usage;return r(this,JA)?(e==null?void 0:e.viewState)!=="OFF":r(this,ZA)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==sp&&Le("Internal method `_setVisible` called."),v(this,tb,n),v(this,Dg,e)}}JA=new WeakMap,ZA=new WeakMap,tb=new WeakMap,Dg=new WeakMap;var oh,fe,Fg,Og,eb,ZC;class Uz{constructor(t,e=Bs.DISPLAY){E(this,eb);E(this,oh,null);E(this,fe,new Map);E(this,Fg,null);E(this,Og,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,v(this,Og,t.order);for(const n of t.groups)r(this,fe).set(n.id,new zz(e,n));if(t.baseState==="OFF")for(const n of r(this,fe).values())n._setVisible(sp,!1);for(const n of t.on)r(this,fe).get(n)._setVisible(sp,!0);for(const n of t.off)r(this,fe).get(n)._setVisible(sp,!1);v(this,Fg,this.getHash())}}isVisible(t){if(r(this,fe).size===0)return!0;if(!t)return $E("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,fe).has(t.id)?r(this,fe).get(t.id).visible:(Wt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return b(this,eb,ZC).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,fe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(r(this,fe).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,fe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(!r(this,fe).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,fe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(!r(this,fe).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,fe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(r(this,fe).get(e).visible)return!1}return!0}return Wt(`Unknown optional content policy ${t.policy}.`),!0}return Wt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var s;const i=r(this,fe).get(t);if(!i){Wt(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const l of o)l!==t&&((s=r(this,fe).get(l))==null||s._setVisible(sp,!1,!0));i._setVisible(sp,!!e,!0),v(this,oh,null)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=r(this,fe).get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}v(this,oh,null)}get hasInitialVisibility(){return r(this,Fg)===null||this.getHash()===r(this,Fg)}getOrder(){return r(this,fe).size?r(this,Og)?r(this,Og).slice():[...r(this,fe).keys()]:null}getGroups(){return r(this,fe).size>0?JT(r(this,fe)):null}getGroup(t){return r(this,fe).get(t)||null}getHash(){if(r(this,oh)!==null)return r(this,oh);const t=new lO;for(const[e,n]of r(this,fe))t.update(`${e}:${n.visible}`);return v(this,oh,t.hexdigest())}}oh=new WeakMap,fe=new WeakMap,Fg=new WeakMap,Og=new WeakMap,eb=new WeakSet,ZC=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const s=t[i];let o;if(Array.isArray(s))o=b(this,eb,ZC).call(this,s);else if(r(this,fe).has(s))o=r(this,fe).get(s).visible;else return Wt(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"};class Gz{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Sn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,u)=>{this._onReceiveData({begin:h,chunk:u})}),t.addProgressListener((h,u)=>{this._onProgress({loaded:h,total:u})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(n),!0)});Sn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,i,s;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Sn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Wz(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Vz(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class Wz{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=ek(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Vz{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function qz(p){let t=!0,e=n("filename\\*","i").exec(p);if(e){e=e[1];let f=l(e);return f=unescape(f),f=h(f),f=u(f),s(f)}if(e=o(p),e){const f=u(e);return s(f)}if(e=n("filename","i").exec(p),e){e=e[1];let f=l(e);return f=u(f),s(f)}function n(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(f,{fatal:!0}),A=HE(g);g=m.decode(A),t=!1}catch{}}return g}function s(f){return t&&/[\x80-\xff]/.test(f)&&(f=i("utf-8",f),t&&(f=i("iso-8859-1",f))),f}function o(f){const g=[];let m;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=A.exec(f))!==null;){let[,S,C,T]=m;if(S=parseInt(S,10),S in g){if(S===0)break;continue}g[S]=[C,T]}const _=[];for(let S=0;S<g.length&&S in g;++S){let[C,T]=g[S];T=l(T),C&&(T=unescape(T),S===0&&(T=h(T))),_.push(T)}return _.join("")}function l(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let m=0;m<g.length;++m){const A=g[m].indexOf('"');A!==-1&&(g[m]=g[m].slice(0,A),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}f=g.join('"')}return f}function h(f){const g=f.indexOf("'");if(g===-1)return f;const m=f.slice(0,g),_=f.slice(g+1).replace(/^[^']*'/,"");return i(m,_)}function u(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,A,_){if(A==="q"||A==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),i(m,_);try{_=atob(_)}catch{}return i(m,_)})}return""}function ak(p,t){const e=new Headers;if(!p||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function ok({responseHeaders:p,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(p.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||n||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function lk(p){const t=p.get("Content-Disposition");if(t){let e=qz(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(ek(e))return e}return null}function UE(p,t){return p===404||p===0&&t.startsWith("file:")?new Af('Missing PDF "'+t+'".'):new jE(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p)}function wO(p){return p===200||p===206}function EO(p,t,e){return{method:"GET",headers:p,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function SO(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(Wt(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class cM{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=ak(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Xz(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Yz(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Xz{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,EO(n,this._withCredentials,this._abortController)).then(s=>{if(!wO(s.status))throw UE(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:l,suggestedLength:h}=ok({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=lk(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new bf("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:SO(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class Yz{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${n-1}`);const o=i.url;fetch(o,EO(s,this._withCredentials,this._abortController)).then(l=>{if(!wO(l.status))throw UE(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:SO(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const cx=200,hx=206;function Kz(p){const t=p.response;return typeof t!="string"?t:HE(t).buffer}class Qz{constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=ak(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,n){const i={begin:t,end:e};for(const s in n)i[s]=n[s];return this.request(i)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,o]of this.headers)e.setRequestHeader(s,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=hx):i.expectedStatus=cx,e.responseType="arraybuffer",t.onError&&(e.onerror=function(s){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var i;const n=this.pendingRequests[t];n&&((i=n.onProgress)==null||i.call(n,e))}onStateChange(t,e){var h,u,f;const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){(h=n.onError)==null||h.call(n,i.status);return}const s=i.status||cx;if(!(s===cx&&n.expectedStatus===hx)&&s!==n.expectedStatus){(u=n.onError)==null||u.call(n,i.status);return}const l=Kz(i);if(s===hx){const g=i.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(g);n.onDone({begin:parseInt(m[1],10),chunk:l})}else l?n.onDone({begin:0,chunk:l}):(f=n.onError)==null||f.call(n,i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Jz{constructor(t){this._source=t,this._manager=new Qz(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Sn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Zz(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new t3(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Zz{constructor(t,e){this._manager=t;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),n=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map(o=>{const[l,...h]=o.split(": ");return[l,h.join(": ")]})),{allowRangeRequests:i,suggestedLength:s}=ok({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=lk(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=UE(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class t3{constructor(t,e,n){this._manager=t;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=UE(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const e3=/^[a-z][a-z0-9\-+.]+:/i;function n3(p){if(e3.test(p))return new URL(p);const t=Ch.get("url");return new URL(t.pathToFileURL(p))}function xO(p,t,e){return p.protocol==="http:"?Ch.get("http").request(p,{headers:t},e):Ch.get("https").request(p,{headers:t},e)}class i3{constructor(t){this.source=t,this.url=n3(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=ak(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new a3(this):new s3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new o3(this,t,e):new r3(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class CO{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new bf("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class TO{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class s3 extends CO{constructor(t){super(t);const e=Object.fromEntries(t.headers),n=i=>{if(i.statusCode===404){const h=new Af(`Missing PDF "${this._url}".`);this._storedError=h,this._headersCapability.reject(h);return}this._headersCapability.resolve(),this._setReadableStream(i);const s=new Headers(this._readableStream.headers),{allowRangeRequests:o,suggestedLength:l}=ok({responseHeaders:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=lk(s)};this._request=xO(this._url,e,n),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class r3 extends TO{constructor(t,e,n){super(t);const i=Object.fromEntries(t.headers);i.Range=`bytes=${e}-${n-1}`;const s=o=>{if(o.statusCode===404){const l=new Af(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(o)};this._request=xO(this._url,i,s),this._request.on("error",o=>{this._storedError=o}),this._request.end()}}class a3 extends CO{constructor(t){super(t);const e=Ch.get("fs");e.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Af(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}}class o3 extends TO{constructor(t,e,n){super(t);const i=Ch.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:n-1}))}}const l3=1e5,Zi=30,c3=.8;var xI,lh,as,nb,ib,Id,ul,sb,rb,Dd,Ng,$g,ch,jg,ab,Hg,Fd,ob,lb,Ye,Od,Nd,cb,hh,Bg,$l,kO,PO,eT,Vs,Aw,nT,RO,LO;let tT=(Ye=class{constructor({textContentSource:t,container:e,viewport:n}){E(this,$l);E(this,lh,Promise.withResolvers());E(this,as,null);E(this,nb,!1);E(this,ib,!!((xI=globalThis.FontInspector)!=null&&xI.enabled));E(this,Id,null);E(this,ul,null);E(this,sb,0);E(this,rb,0);E(this,Dd,null);E(this,Ng,null);E(this,$g,0);E(this,ch,0);E(this,jg,Object.create(null));E(this,ab,[]);E(this,Hg,null);E(this,Fd,[]);E(this,ob,new WeakMap);E(this,lb,null);var h;if(t instanceof ReadableStream)v(this,Hg,t);else if(typeof t=="object")v(this,Hg,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,as,v(this,Ng,e)),v(this,ch,n.scale*(globalThis.devicePixelRatio||1)),v(this,$g,n.rotation),v(this,ul,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:l}=n.rawDims;v(this,lb,[1,0,0,-1,-o,l+s]),v(this,rb,i),v(this,sb,s),b(h=Ye,Vs,RO).call(h),df(e,n),r(this,lh).promise.finally(()=>{r(Ye,Bg).delete(this),v(this,ul,null),v(this,jg,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Bi.platform;return Zt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Dd).read().then(({value:e,done:n})=>{if(n){r(this,lh).resolve();return}r(this,Id)??v(this,Id,e.lang),Object.assign(r(this,jg),e.styles),b(this,$l,kO).call(this,e.items),t()},r(this,lh).reject)};return v(this,Dd,r(this,Hg).getReader()),r(Ye,Bg).add(this),t(),r(this,lh).promise}update({viewport:t,onBefore:e=null}){var s;const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==r(this,$g)&&(e==null||e(),v(this,$g,i),df(r(this,Ng),{rotation:i})),n!==r(this,ch)){e==null||e(),v(this,ch,n);const o={div:null,properties:null,ctx:b(s=Ye,Vs,Aw).call(s,r(this,Id))};for(const l of r(this,Fd))o.properties=r(this,ob).get(l),o.div=l,b(this,$l,eT).call(this,o)}}cancel(){var e;const t=new bf("TextLayer task cancelled.");(e=r(this,Dd))==null||e.cancel(t).catch(()=>{}),v(this,Dd,null),r(this,lh).reject(t)}get textDivs(){return r(this,Fd)}get textContentItemsStr(){return r(this,ab)}static cleanup(){if(!(r(this,Bg).size>0)){r(this,Od).clear();for(const{canvas:t}of r(this,Nd).values())t.remove();r(this,Nd).clear()}}},lh=new WeakMap,as=new WeakMap,nb=new WeakMap,ib=new WeakMap,Id=new WeakMap,ul=new WeakMap,sb=new WeakMap,rb=new WeakMap,Dd=new WeakMap,Ng=new WeakMap,$g=new WeakMap,ch=new WeakMap,jg=new WeakMap,ab=new WeakMap,Hg=new WeakMap,Fd=new WeakMap,ob=new WeakMap,lb=new WeakMap,Od=new WeakMap,Nd=new WeakMap,cb=new WeakMap,hh=new WeakMap,Bg=new WeakMap,$l=new WeakSet,kO=function(t){var i,s;if(r(this,nb))return;(s=r(this,ul)).ctx??(s.ctx=b(i=Ye,Vs,Aw).call(i,r(this,Id)));const e=r(this,Fd),n=r(this,ab);for(const o of t){if(e.length>l3){Wt("Ignoring additional textDivs for performance reasons."),v(this,nb,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=r(this,as);v(this,as,document.createElement("span")),r(this,as).classList.add("markedContent"),o.id!==null&&r(this,as).setAttribute("id",`${o.id}`),l.append(r(this,as))}else o.type==="endMarkedContent"&&v(this,as,r(this,as).parentNode);continue}n.push(o.str),b(this,$l,PO).call(this,o)}},PO=function(t){var S;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Fd).push(e);const i=kt.transform(r(this,lb),t.transform);let s=Math.atan2(i[1],i[0]);const o=r(this,jg)[t.fontName];o.vertical&&(s+=Math.PI/2);let l=r(this,ib)&&o.fontSubstitution||o.fontFamily;l=Ye.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),u=h*b(S=Ye,Vs,LO).call(S,l,r(this,Id));let f,g;s===0?(f=i[4],g=i[5]-u):(f=i[4]+u*Math.sin(s),g=i[5]-u*Math.cos(s));const m="calc(var(--scale-factor)*",A=e.style;r(this,as)===r(this,Ng)?(A.left=`${(100*f/r(this,rb)).toFixed(2)}%`,A.top=`${(100*g/r(this,sb)).toFixed(2)}%`):(A.left=`${m}${f.toFixed(2)}px)`,A.top=`${m}${g.toFixed(2)}px)`),A.fontSize=`${m}${(r(Ye,hh)*h).toFixed(2)}px)`,A.fontFamily=l,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,ib)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),s!==0&&(n.angle=s*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),T=Math.abs(t.transform[3]);C!==T&&Math.max(C,T)/Math.min(C,T)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?t.height:t.width),r(this,ob).set(e,n),r(this,ul).div=e,r(this,ul).properties=n,b(this,$l,eT).call(this,r(this,ul)),n.hasText&&r(this,as).append(e),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),r(this,as).append(C)}},eT=function(t){var l;const{div:e,properties:n,ctx:i}=t,{style:s}=e;let o="";if(r(Ye,hh)>1&&(o=`scale(${1/r(Ye,hh)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=s,{canvasWidth:u,fontSize:f}=n;b(l=Ye,Vs,nT).call(l,i,f*r(this,ch),h);const{width:g}=i.measureText(e.textContent);g>0&&(o=`scaleX(${u*r(this,ch)/g}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)},Vs=new WeakSet,Aw=function(t=null){let e=r(this,Nd).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,Nd).set(t,e),r(this,cb).set(e,{size:0,family:""})}return e},nT=function(t,e,n){const i=r(this,cb).get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)},RO=function(){if(r(this,hh)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),v(this,hh,t.getBoundingClientRect().height),t.remove()},LO=function(t,e){const n=r(this,Od).get(t);if(n)return n;const i=b(this,Vs,Aw).call(this,e);i.canvas.width=i.canvas.height=Zi,b(this,Vs,nT).call(this,i,Zi,t);const s=i.measureText("");let o=s.fontBoundingBoxAscent,l=Math.abs(s.fontBoundingBoxDescent);if(o){const f=o/(o+l);return r(this,Od).set(t,f),i.canvas.width=i.canvas.height=0,f}i.strokeStyle="red",i.clearRect(0,0,Zi,Zi),i.strokeText("g",0,0);let h=i.getImageData(0,0,Zi,Zi).data;l=0;for(let f=h.length-1-3;f>=0;f-=4)if(h[f]>0){l=Math.ceil(f/4/Zi);break}i.clearRect(0,0,Zi,Zi),i.strokeText("A",0,Zi),h=i.getImageData(0,0,Zi,Zi).data,o=0;for(let f=0,g=h.length;f<g;f+=4)if(h[f]>0){o=Zi-Math.floor(f/4/Zi);break}i.canvas.width=i.canvas.height=0;const u=o?o/(o+l):c3;return r(this,Od).set(t,u),u},E(Ye,Vs),E(Ye,Od,new Map),E(Ye,Nd,new Map),E(Ye,cb,new WeakMap),E(Ye,hh,null),E(Ye,Bg,new Set),Ye);class nv{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(s){var h;if(!s)return;let o=null;const l=s.name;if(l==="#text")o=s.value;else if(nv.shouldBuildText(l))(h=s==null?void 0:s.attributes)!=null&&h.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&e.push({str:o}),!!s.children)for(const u of s.children)i(u)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const h3=65536,u3=100,d3=5e3,f3=ki?xz:wz,p3=ki?Cz:fO,g3=ki?Sz:Ez,m3=ki?Tz:yO;function y3(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new iT,{docId:e}=t,n=p.url?v3(p.url):null,i=p.data?A3(p.data):null,s=p.httpHeaders||null,o=p.withCredentials===!0,l=p.password??null,h=p.range instanceof MO?p.range:null,u=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:h3;let f=p.worker instanceof hp?p.worker:null;const g=p.verbosity,m=typeof p.docBaseUrl=="string"&&!zE(p.docBaseUrl)?p.docBaseUrl:null,A=typeof p.cMapUrl=="string"?p.cMapUrl:null,_=p.cMapPacked!==!1,S=p.CMapReaderFactory||p3,C=typeof p.standardFontDataUrl=="string"?p.standardFontDataUrl:null,T=p.StandardFontDataFactory||m3,k=p.stopAtErrors!==!0,P=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,L=p.isEvalSupported!==!1,I=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!ki,D=typeof p.isChrome=="boolean"?p.isChrome:!Bi.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),F=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,H=typeof p.disableFontFace=="boolean"?p.disableFontFace:ki,j=p.fontExtraProperties===!0,Q=p.enableXfa===!0,W=p.ownerDocument||globalThis.document,tt=p.disableRange===!0,Z=p.disableStream===!0,et=p.disableAutoFetch===!0,ht=p.pdfBug===!0,J=p.CanvasFactory||f3,G=p.FilterFactory||g3,q=p.enableHWA===!0,U=h?h.length:p.length??NaN,N=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!ki&&!H,M=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:S===fO&&T===yO&&A&&C&&Dy(A,document.baseURI)&&Dy(C,document.baseURI);p.canvasFactory&&QL("`canvasFactory`-instance option, please use `CanvasFactory` instead."),p.filterFactory&&QL("`filterFactory`-instance option, please use `FilterFactory` instead.");const B=null;ZB(g);const Y={canvasFactory:new J({ownerDocument:W,enableHWA:q}),filterFactory:new G({docId:e,ownerDocument:W}),cMapReaderFactory:M?null:new S({baseUrl:A,isCompressed:_}),standardFontDataFactory:M?null:new T({baseUrl:C})};if(!f){const at={verbosity:g,port:Pl.workerPort};f=at.port?hp.fromPort(at):new hp(at),t._worker=f}const it={docId:e,apiVersion:"4.8.69",data:i,password:l,disableAutoFetch:et,rangeChunkSize:u,length:U,docBaseUrl:m,enableXfa:Q,evaluatorOptions:{maxImageSize:P,disableFontFace:H,ignoreErrors:k,isEvalSupported:L,isOffscreenCanvasSupported:I,isChrome:D,canvasMaxAreaInBytes:F,fontExtraProperties:j,useSystemFonts:N,cMapUrl:M?A:null,standardFontDataUrl:M?C:null}},dt={disableFontFace:H,fontExtraProperties:j,ownerDocument:W,pdfBug:ht,styleElement:B,loadingParams:{disableAutoFetch:et,enableXfa:Q}};return f.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const at=f.messageHandler.sendWithPromise("GetDocRequest",it,i?[i.buffer]:null);let nt;if(h)nt=new Gz(h,{disableRange:tt,disableStream:Z});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let yt;ki?yt=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&Dy(n)?cM:i3:yt=Dy(n)?cM:Jz,nt=new yt({url:n,length:U,httpHeaders:s,withCredentials:o,rangeChunkSize:u,disableRange:tt,disableStream:Z})}return at.then(yt=>{if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const ut=new By(e,yt,f.port),St=new E3(ut,t,nt,dt,Y);t._transport=St,ut.send("Ready",null)})}).catch(t._capability.reject),t}function v3(p){if(p instanceof URL)return p.href;try{return new URL(p,window.location).href}catch{if(ki&&typeof p=="string")return p}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function A3(p){if(ki&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return HE(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p==null?void 0:p.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hM(p){return typeof p=="object"&&Number.isInteger(p==null?void 0:p.num)&&p.num>=0&&Number.isInteger(p==null?void 0:p.gen)&&p.gen>=0}var bE;const _E=class _E{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${le(_E,bE)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,n;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};bE=new WeakMap,E(_E,bE,0);let iT=_E;class MO{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Le("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class b3{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var uh,dl,vr,rp,bw;class _3{constructor(t,e,n,i=!1){E(this,vr);E(this,uh,null);E(this,dl,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new KL:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new IO,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new Wb({viewBox:this.view,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=vc.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:u=null,printAnnotationStorage:f=null,isEditing:g=!1}){var L,I;(L=this._stats)==null||L.time("Overall");const m=this._transport.getRenderingIntent(n,i,f,g),{renderingIntent:A,cacheKey:_}=m;v(this,dl,!1),b(this,vr,bw).call(this),l||(l=this._transport.getOptionalContentConfig(A));let S=this._intentStates.get(_);S||(S=Object.create(null),this._intentStates.set(_,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const C=!!(A&Bs.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(m));const T=D=>{var F;S.renderTasks.delete(k),(this._maybeCleanupAfterRender||C)&&v(this,dl,!0),b(this,vr,rp).call(this,!C),D?(k.capability.reject(D),this._abortOperatorList({intentState:S,reason:D instanceof Error?D:new Error(D)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new rT({callback:T,params:{canvasContext:t,viewport:e,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:u});(S.renderTasks||(S.renderTasks=new Set)).add(k);const P=k.task;return Promise.all([S.displayReadyCapability.promise,l]).then(([D,F])=>{var H;if(this.destroyed){T();return}if((H=this._stats)==null||H.time("Rendering"),!(F.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:D,optionalContentConfig:F}),k.operatorListChanged()}).catch(T),P}getOperatorList({intent:t="display",annotationMode:e=vc.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var u;function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,n,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>nv.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function s(){o.read().then(function({value:h,done:u}){if(u){n(l);return}l.lang??(l.lang=h.lang),Object.assign(l.styles,h.styles),l.items.push(...h.items),s()},i)}const o=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),v(this,dl,!1),b(this,vr,bw).call(this),Promise.all(t)}cleanup(t=!1){v(this,dl,!0);const e=b(this,vr,rp).call(this,!1);return t&&e&&this._stats&&(this._stats=new KL),e}_startRenderPage(t,e){var i,s;const n=this._intentStates.get(e);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&b(this,vr,rp).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:o}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},o).getReader(),u=this._intentStates.get(e);u.streamReader=h;const f=()=>{h.read().then(({value:g,done:m})=>{if(m){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,u),f())},g=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const m of u.renderTasks)m.operatorListChanged();b(this,vr,rp).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(g);else if(u.opListReadCapability)u.opListReadCapability.reject(g);else throw g}})};f()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof tk){let i=u3;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new bf(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}uh=new WeakMap,dl=new WeakMap,vr=new WeakSet,rp=function(t=!1){if(b(this,vr,bw).call(this),!r(this,dl)||this.destroyed)return!1;if(t)return v(this,uh,setTimeout(()=>{v(this,uh,null),b(this,vr,rp).call(this,!1)},d3)),!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,dl,!1),!0},bw=function(){r(this,uh)&&(clearTimeout(r(this,uh)),v(this,uh,null))};var fl,wE;class w3{constructor(){E(this,fl,new Map);E(this,wE,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};r(this,wE).then(()=>{for(const[i]of r(this,fl))i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Wt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}r(this,fl).set(e,i)}removeEventListener(t,e){const n=r(this,fl).get(e);n==null||n(),r(this,fl).delete(e)}terminate(){for(const[,t]of r(this,fl))t==null||t();r(this,fl).clear()}}fl=new WeakMap,wE=new WeakMap;var EE,$d,jd,zg,_w,Ug,ww;const De=class De{constructor({name:t=null,port:e=null,verbosity:n=tz()}={}){E(this,zg);var i;if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=r(De,jd))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(De,jd)||v(De,jd,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return ki?Promise.all([Ch.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new By("main","worker",t),this._messageHandler.on("ready",function(){}),b(this,zg,_w).call(this)}_initialize(){if(r(De,$d)||r(De,Ug,ww)){this._setupFakeWorker();return}let{workerSrc:t}=De;try{De._isSameOrigin(window.location.href,t)||(t=De._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new By("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),n.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}this._messageHandler=n,this._port=e,this._webWorker=e,b(this,zg,_w).call(this)}),n.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};o();return}catch{$E("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(De,$d)||(Wt("Setting up fake worker."),v(De,$d,!0)),De._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new w3;this._port=e;const n=`fake${le(De,EE)._++}`,i=new By(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new By(n,n+"_worker",e),b(this,zg,_w).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=r(De,jd))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var n;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(n=r(this,jd))==null?void 0:n.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new De(t)}static get workerSrc(){if(Pl.workerSrc)return Pl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Zt(this,"_setupFakeWorkerGlobal",(async()=>r(this,Ug,ww)?r(this,Ug,ww):(await import(this.workerSrc)).WorkerMessageHandler)())}};EE=new WeakMap,$d=new WeakMap,jd=new WeakMap,zg=new WeakSet,_w=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ug=new WeakSet,ww=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},E(De,Ug),E(De,EE,0),E(De,$d,!1),E(De,jd),ki&&(v(De,$d,!0),Pl.workerSrc||(Pl.workerSrc="./pdf.worker.mjs")),De._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},De._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let hp=De;var pl,Za,Gg,Wg,to,Hd,zy;class E3{constructor(t,e,n,i,s){E(this,Hd);E(this,pl,new Map);E(this,Za,new Map);E(this,Gg,new Map);E(this,Wg,new Map);E(this,to,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new IO,this.fontLoader=new bz({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Zt(this,"annotationStorage",new sk)}getRenderingIntent(t,e=vc.ENABLE,n=null,i=!1,s=!1){let o=Bs.DISPLAY,l=WC;switch(t){case"any":o=Bs.ANY;break;case"display":break;case"print":o=Bs.PRINT;break;default:Wt(`getRenderingIntent - invalid intent: ${t}`)}const h=o&Bs.PRINT&&n instanceof hO?n:this.annotationStorage;switch(e){case vc.DISABLE:o+=Bs.ANNOTATIONS_DISABLE;break;case vc.ENABLE:break;case vc.ENABLE_FORMS:o+=Bs.ANNOTATIONS_FORMS;break;case vc.ENABLE_STORAGE:o+=Bs.ANNOTATIONS_STORAGE,l=h.serializable;break;default:Wt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=Bs.IS_EDITING),s&&(o+=Bs.OPLIST);const{ids:u,hash:f}=h.modifiedIds,g=[o,l.hash,f];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=r(this,to))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of r(this,Za).values())t.push(i._destroy());r(this,Za).clear(),r(this,Gg).clear(),r(this,Wg).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i;this.commonObjs.clear(),this.fontLoader.clear(),r(this,pl).clear(),this.filterFactory.destroy(),tT.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new bf("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{Sn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}Sn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async n=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((l=e.onProgress)==null||l.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var u;(u=e.onProgress)==null||u.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),t.on("GetRangeReader",(n,i)=>{Sn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:l}){if(l){i.close();return}Sn(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new b3(n,this))}),t.on("DocException",function(n){let i;switch(n.name){case"PasswordException":i=new EC(n.message,n.code);break;case"InvalidPDFException":i=new OF(n.message);break;case"MissingPDFException":i=new Af(n.message);break;case"UnexpectedResponseException":i=new jE(n.message,n.status);break;case"UnknownErrorException":i=new SC(n.message,n.details);break;default:Le("DocException - expected a valid Error.")}e._capability.reject(i)}),t.on("PasswordRequest",n=>{if(v(this,to,Promise.withResolvers()),e.onPassword){const i=s=>{s instanceof Error?r(this,to).reject(s):r(this,to).resolve({password:s})};try{e.onPassword(i,n.code)}catch(s){r(this,to).reject(s)}}else r(this,to).reject(new EC(n.message,n.code));return r(this,to).promise}),t.on("DataLoaded",n=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;r(this,Za).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:l,fontExtraProperties:h,pdfBug:u}=this._params;if("error"in s){const A=s.error;Wt(`Error during font loading: ${A}`),this.commonObjs.resolve(n,A);break}const f=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(A,_)=>globalThis.FontInspector.fontAdded(A,_):null,g=new _z(s,{disableFontFace:l,inspectFont:f});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h&&g.data&&(g.data=null),this.commonObjs.resolve(n,g)});break;case"CopyLocalImage":const{imageRef:m}=s;Sn(m,"The imageRef must be defined.");for(const A of r(this,Za).values())for(const[,_]of A.objs)if((_==null?void 0:_.ref)===m)return _.dataLen?(this.commonObjs.resolve(n,structuredClone(_)),_.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,s,o])=>{var h;if(this.destroyed)return;const l=r(this,Za).get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){(h=o==null?void 0:o.bitmap)==null||h.close();return}switch(s){case"Image":l.objs.resolve(n,o),(o==null?void 0:o.dataLen)>YB&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",n=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),t.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Wt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=r(this,Gg).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&r(this,Wg).set(s.refStr,t);const o=new _3(e,s,this,this._params.pdfBug);return r(this,Za).set(e,o),o});return r(this,Gg).set(e,i),i}getPageIndex(t){return hM(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return b(this,Hd,zy).call(this,"GetFieldObjects")}hasJSActions(){return b(this,Hd,zy).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return b(this,Hd,zy).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return b(this,Hd,zy).call(this,"GetOptionalContentConfig").then(e=>new Uz(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,pl).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new Bz(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return r(this,pl).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,Za).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,pl).clear(),this.filterFactory.destroy(!0),tT.cleanup()}}cachedPageNumber(t){if(!hM(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,Wg).get(e)??null}}pl=new WeakMap,Za=new WeakMap,Gg=new WeakMap,Wg=new WeakMap,to=new WeakMap,Hd=new WeakSet,zy=function(t,e=null){const n=r(this,pl).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return r(this,pl).set(t,i),i};const g_=Symbol("INITIAL_DATA");var ea,hb,sT;class IO{constructor(){E(this,hb);E(this,ea,Object.create(null))}get(t,e=null){if(e){const i=b(this,hb,sT).call(this,t);return i.promise.then(()=>e(i.data)),null}const n=r(this,ea)[t];if(!n||n.data===g_)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=r(this,ea)[t];return!!e&&e.data!==g_}resolve(t,e=null){const n=b(this,hb,sT).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in r(this,ea)){const{data:n}=r(this,ea)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}v(this,ea,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,ea)){const{data:e}=r(this,ea)[t];e!==g_&&(yield[t,e])}}}ea=new WeakMap,hb=new WeakSet,sT=function(t){var e;return(e=r(this,ea))[t]||(e[t]={...Promise.withResolvers(),data:g_})};var dh;class S3{constructor(t){E(this,dh,null);v(this,dh,t),this.onContinue=null}get promise(){return r(this,dh).capability.promise}cancel(t=0){r(this,dh).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,dh).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,dh);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}dh=new WeakMap;var fh,Bd;const ru=class ru{constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:l,canvasFactory:h,filterFactory:u,useRequestAnimationFrame:f=!1,pdfBug:g=!1,pageColors:m=null}){E(this,fh,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=u,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new S3(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var l,h;if(this.cancelled)return;if(this._canvas){if(r(ru,Bd).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(ru,Bd).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:s,background:o}=this.params;this.gfx=new cp(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(t=null,e=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),r(this,fh)&&(window.cancelAnimationFrame(r(this,fh)),v(this,fh,null)),r(ru,Bd).delete(this._canvas),this.callback(t||new tk(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,fh,window.requestAnimationFrame(()=>{v(this,fh,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(ru,Bd).delete(this._canvas),this.callback())))}};fh=new WeakMap,Bd=new WeakMap,E(ru,Bd,new WeakSet);let rT=ru;const x3="4.8.69",C3="3634dab10";function uM(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function dy(p){return Math.max(0,Math.min(255,255*p))}class dM{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=dy(t),[t,t,t]}static G_HTML([t]){const e=uM(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(dy)}static RGB_HTML(t){return`#${t.map(uM).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[dy(1-Math.min(1,t+i)),dy(1-Math.min(1,n+i)),dy(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,s=1-e,o=1-n,l=Math.min(i,s,o);return["CMYK",i,s,o,l]}}class T3{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Le("Abstract method `_createSVG` called.")}}class ck extends T3{_createSVG(t){return document.createElementNS(Ro,t)}}class DO{static setupStorage(t,e,n,i,s){const o=i.getValue(e,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?t.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const l of n.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const h=l.target.options,u=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:s}){const{attributes:o}=e,l=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[h,u]of Object.entries(o))if(u!=null)switch(h){case"class":u.length&&t.setAttribute(h,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,u)}l&&s.addLinkAttributes(t,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(t,o.dataId,e,n)}static render(t){var g,m;const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:n});const l=s!=="richText",h=t.div;if(h.append(o),t.viewport){const A=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=A}l&&h.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const A=document.createTextNode(i.value);o.append(A),l&&nv.shouldBuildText(i.name)&&u.push(A)}return{textDivs:u}}const f=[[i,-1,o]];for(;f.length>0;){const[A,_,S]=f.at(-1);if(_+1===A.children.length){f.pop();continue}const C=A.children[++f.at(-1)[1]];if(C===null)continue;const{name:T}=C;if(T==="#text"){const P=document.createTextNode(C.value);u.push(P),S.append(P);continue}const k=(g=C==null?void 0:C.attributes)!=null&&g.xmlns?document.createElementNS(C.attributes.xmlns,T):document.createElement(T);if(S.append(k),C.attributes&&this.setAttributes({html:k,element:C,storage:e,intent:s,linkService:n}),((m=C.children)==null?void 0:m.length)>0)f.push([C,-1,k]);else if(C.value){const P=document.createTextNode(C.value);l&&nv.shouldBuildText(T)&&u.push(P),k.append(P)}}for(const A of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const qb=1e3,k3=9,pf=new WeakSet;function Ll(p){return{width:p[2]-p[0],height:p[3]-p[1]}}class P3{static create(t){switch(t.data.annotationType){case yn.LINK:return new FO(t);case yn.TEXT:return new R3(t);case yn.WIDGET:switch(t.data.fieldType){case"Tx":return new L3(t);case"Btn":return t.data.radioButton?new $O(t):t.data.checkBox?new I3(t):new D3(t);case"Ch":return new F3(t);case"Sig":return new M3(t)}return new _f(t);case yn.POPUP:return new oT(t);case yn.FREETEXT:return new UO(t);case yn.LINE:return new N3(t);case yn.SQUARE:return new $3(t);case yn.CIRCLE:return new j3(t);case yn.POLYLINE:return new GO(t);case yn.CARET:return new B3(t);case yn.INK:return new hk(t);case yn.POLYGON:return new H3(t);case yn.HIGHLIGHT:return new WO(t);case yn.UNDERLINE:return new z3(t);case yn.SQUIGGLY:return new U3(t);case yn.STRIKEOUT:return new G3(t);case yn.STAMP:return new VO(t);case yn.FILEATTACHMENT:return new W3(t);default:return new sn(t)}}}var zd,Vg,qg,ub,aT;const yk=class yk{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){E(this,ub);E(this,zd,null);E(this,Vg,!1);E(this,qg,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t!=null&&t.str||e!=null&&e.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return yk._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;r(this,zd)||v(this,zd,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&b(this,ub,aT).call(this,e),(n=r(this,qg))==null||n.popup.updateEdited(t)}resetEdited(){var t;r(this,zd)&&(b(this,ub,aT).call(this,r(this,zd).rect),(t=r(this,qg))==null||t.popup.resetEdited(),v(this,zd,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof _f||(s.tabIndex=qb);const{style:o}=s;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof oT){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:l,height:h}=Ll(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;o.borderRadius=k}else if(this instanceof $O){const k=`calc(${l}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;o.borderRadius=k}switch(e.borderStyle.style){case hy.SOLID:o.borderStyle="solid";break;case hy.DASHED:o.borderStyle="dashed";break;case hy.BEVELED:Wt("Unimplemented border style: beveled");break;case hy.INSET:Wt("Unimplemented border style: inset");break;case hy.UNDERLINE:o.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(v(this,Vg,!0),o.borderColor=kt.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const u=kt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:f,pageHeight:g,pageX:m,pageY:A}=i.rawDims;o.left=`${100*(u[0]-m)/f}%`,o.top=`${100*(u[1]-A)/g}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(o.width=`${100*l/f}%`,o.height=`${100*h/g}%`):this.setRotation(_,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:o}=Ll(this.data.rect);let l,h;t%180===0?(l=100*s/n,h=100*o/i):(l=100*o/n,h=100*s/i),e.style.width=`${l}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const s=i.detail[e],o=s[0],l=s.slice(1);i.target.style[n]=dM[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:dM[`${o}_rgb`](l)})};return Zt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const o=n[i];if(o){const l={detail:{[i]:s},target:t};o(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,T,k]=t.subarray(2,6);if(i===S&&s===C&&e===T&&n===k)return}const{style:o}=this.container;let l;if(r(this,Vg)){const{borderColor:S,borderWidth:C}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=i-e,u=s-n,{svgFactory:f}=this,g=f.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const m=f.createElement("defs");g.append(m);const A=f.createElement("clipPath"),_=`clippath_${this.data.id}`;A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),m.append(A);for(let S=2,C=t.length;S<C;S+=8){const T=t[S],k=t[S+1],P=t[S+2],L=t[S+3],I=f.createElement("rect"),D=(P-e)/h,F=(s-k)/u,H=(T-P)/h,j=(k-L)/u;I.setAttribute("x",D),I.setAttribute("y",F),I.setAttribute("width",H),I.setAttribute("height",j),A.append(I),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${F}" width="${H}" height="${j}"/>`)}r(this,Vg)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(g),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,e=v(this,qg,new oT({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Le("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:o,exportValues:l}of i){if(s===-1||o===e)continue;const h=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!pf.has(u)){Wt(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:h,domElement:u})}return n}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==e&&pf.has(i)&&n.push({id:o,exportValue:s,domElement:i})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};zd=new WeakMap,Vg=new WeakMap,qg=new WeakMap,ub=new WeakSet,aT=function(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}}}=this;n==null||n.splice(0,4,...t);const{width:u,height:f}=Ll(t);e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(o-t[3]+h)/o}%`,i===0?(e.width=`${100*u/s}%`,e.height=`${100*f/o}%`):this.setRotation(i)};let sn=yk;var Us,Zh,OO,NO;class FO extends sn{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});E(this,Us);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(n.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(b(this,Us,OO).call(this,i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(b(this,Us,NO).call(this,i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&b(this,Us,Zh).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),b(this,Us,Zh).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=i.get(s);o&&(e[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),b(this,Us,Zh).call(this)}_bindResetFormAction(e,n){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),b(this,Us,Zh).call(this),!this._fieldObjects){Wt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var g;i==null||i();const{fields:s,refs:o,include:l}=n,h=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const A of s){const _=this._fieldObjects[A]||[];for(const{id:S}of _)m.add(S)}for(const A of Object.values(this._fieldObjects))for(const _ of A)m.has(_.id)===l&&h.push(_)}else for(const m of Object.values(this._fieldObjects))h.push(...m);const u=this.annotationStorage,f=[];for(const m of h){const{id:A}=m;switch(f.push(A),m.type){case"text":{const S=m.defaultValue||"";u.setValue(A,{value:S});break}case"checkbox":case"radiobutton":{const S=m.defaultValue===m.exportValues;u.setValue(A,{value:S});break}case"combobox":case"listbox":{const S=m.defaultValue||"";u.setValue(A,{value:S});break}default:continue}const _=document.querySelector(`[data-element-id="${A}"]`);if(_){if(!pf.has(_)){Wt(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;_.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}})),!1}}}Us=new WeakSet,Zh=function(){this.container.setAttribute("data-internal-link","")},OO=function(e,n,i=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},b(this,Us,Zh).call(this)},NO=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),b(this,Us,Zh).call(this)};class R3 extends sn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class _f extends sn{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Bi.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(n,o=>{var l;if(n==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}s&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(t,e,n,i){var s,o,l;for(const[h,u]of n)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":kt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||k3,s=t.style;let o;const l=2,h=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),f=Math.round(u/(rx*i))||1,g=u/f;o=Math.min(i,h(g/rx))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,h(u/rx))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=kt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class L3 extends _f{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=n),s.setValue(o.id,{[i]:n})}render(){var i,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let l=o.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&l.length>h&&(l=l.slice(0,h));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const f={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",u??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),pf.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=qb,this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",m=>{t.setValue(e,{value:m.target.value}),this.setPropertyOnSiblings(n,"value",m.target.value,"value"),f.formattedValue=null}),n.addEventListener("resetform",m=>{const A=this.data.defaultFieldValue??"";n.value=f.userValue=A,f.formattedValue=null});let g=m=>{const{formattedValue:A}=f;A!=null&&(m.target.value=A),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",A=>{var S;if(f.focused)return;const{target:_}=A;f.userValue&&(_.value=f.userValue),f.lastCommittedValue=_.value,f.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(f.focused=!0)}),n.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const _={value(S){f.userValue=S.detail.value??"",t.setValue(e,{value:f.userValue.toString()}),S.target.value=f.userValue},formattedValue(S){const{formattedValue:C}=S.detail;f.formattedValue=C,C!=null&&S.target!==document.activeElement&&(S.target.value=C),t.setValue(e,{formattedValue:C})},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:C}=S.detail,{target:T}=S;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let k=f.userValue;!k||k.length<=C||(k=k.slice(0,C),T.value=f.userValue=k,t.setValue(e,{value:k}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(_,A)}),n.addEventListener("keydown",A=>{var C;f.commitKey=1;let _=-1;if(A.key==="Escape"?_=0:A.key==="Enter"&&!this.data.multiLine?_=2:A.key==="Tab"&&(f.commitKey=3),_===-1)return;const{value:S}=A.target;f.lastCommittedValue!==S&&(f.lastCommittedValue=S,f.userValue=S,(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:_,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const m=g;g=null,n.addEventListener("blur",A=>{var S,C;if(!f.focused||!A.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(f.focused=!1);const{value:_}=A.target;f.userValue=_,f.lastCommittedValue!==_&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:f.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}})),m(A)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",A=>{var I;f.lastCommittedValue=null;const{data:_,target:S}=A,{value:C,selectionStart:T,selectionEnd:k}=S;let P=T,L=k;switch(A.inputType){case"deleteWordBackward":{const D=C.substring(0,T).match(/\w*[^\w]*$/);D&&(P-=D[0].length);break}case"deleteWordForward":{const D=C.substring(T).match(/^[^\w]*\w*/);D&&(L+=D[0].length);break}case"deleteContentBackward":T===k&&(P-=1);break;case"deleteContentForward":T===k&&(L+=1);break}A.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:_||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(g&&n.addEventListener("blur",g),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${A}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class M3 extends _f{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class I3 extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return pf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=qb,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const u of this._getElementsByName(l,n)){const f=h&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=f),t.setValue(u.id,{value:f})}t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue||"Off";o.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const l={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $O extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,n))t.setValue(o.id,{value:!1});const s=document.createElement("input");if(pf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=qb,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const u of this._getElementsByName(l,n))t.setValue(u.id,{value:!1});t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue;o.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const h={value:u=>{const f=o===u.detail.value;for(const g of this._getElementsByName(u.target.name)){const m=f&&g.id===n;g.domElement&&(g.domElement.checked=m),t.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class D3 extends FO{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class F3 extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");pf.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=qb;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===g});for(const f of this.data.options){const g=document.createElement("option");g.textContent=f.displayValue,g.value=f.exportValue,n.value.includes(f.exportValue)&&(g.setAttribute("selected",!0),s=!1),i.append(g)}let o=null;if(s){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),i.prepend(f),o=()=>{f.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=f=>{const g=f?"value":"textContent",{options:m,multiple:A}=i;return A?Array.prototype.filter.call(m,_=>_.selected).map(_=>_[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let h=l(!1);const u=f=>{const g=f.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",f=>{const g={value(m){o==null||o();const A=m.detail.value,_=new Set(Array.isArray(A)?A:[A]);for(const S of i.options)S.selected=_.has(S.value);t.setValue(e,{value:l(!0)}),h=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const A=i.options,_=m.detail.remove;A[_].selected=!1,i.remove(_),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=l(!1)},insert(m){const{index:A,displayValue:_,exportValue:S}=m.detail.insert,C=i.children[A],T=document.createElement("option");T.textContent=_,T.value=S,C?C.before(T):i.append(T),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},items(m){const{items:A}=m.detail;for(;i.length!==0;)i.remove(0);for(const _ of A){const{displayValue:S,exportValue:C}=_,T=document.createElement("option");T.textContent=S,T.value=C,i.append(T)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),h=l(!1)},indices(m){const A=new Set(m.detail.indices);for(const _ of m.target.options)_.selected=A.has(_.index);t.setValue(e,{value:l(!0)}),h=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,f)}),i.addEventListener("input",f=>{var A;const g=l(!0),m=l(!1);t.setValue(e,{value:g}),f.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):i.addEventListener("input",function(f){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class oT extends sn{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:sn._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new O3({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(n=>`${ZT}${n}`).join(",")),this.container}}var Xg,SE,xE,Yg,Ud,qe,gl,Kg,db,fb,Qg,ml,na,yl,pb,vl,gb,Gd,Wd,be,Ew,lT,jO,HO,BO,zO,Sw,xw,cT;class O3{constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:h,rect:u,parentRect:f,open:g}){E(this,be);E(this,Xg,b(this,be,BO).bind(this));E(this,SE,b(this,be,cT).bind(this));E(this,xE,b(this,be,xw).bind(this));E(this,Yg,b(this,be,Sw).bind(this));E(this,Ud,null);E(this,qe,null);E(this,gl,null);E(this,Kg,null);E(this,db,null);E(this,fb,null);E(this,Qg,null);E(this,ml,!1);E(this,na,null);E(this,yl,null);E(this,pb,null);E(this,vl,null);E(this,gb,null);E(this,Gd,null);E(this,Wd,!1);var m;v(this,qe,t),v(this,gb,i),v(this,gl,o),v(this,vl,l),v(this,fb,h),v(this,Ud,e),v(this,pb,u),v(this,Qg,f),v(this,db,n),v(this,Kg,nk.toDateObject(s)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup());for(const A of this.trigger)A.addEventListener("click",r(this,Yg)),A.addEventListener("mouseenter",r(this,xE)),A.addEventListener("mouseleave",r(this,SE)),A.classList.add("popupTriggerArea");for(const A of n)(m=A.container)==null||m.addEventListener("keydown",r(this,Xg));r(this,qe).hidden=!0,g&&b(this,be,Sw).call(this)}render(){if(r(this,na))return;const t=v(this,na,document.createElement("div"));if(t.className="popup",r(this,Ud)){const s=t.style.outlineColor=kt.makeHexColor(...r(this,Ud));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=kt.makeHexColor(...r(this,Ud).map(l=>Math.floor(.7*(255-l)+l)))}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=r(this,gb),t.append(e),r(this,Kg)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,Kg).valueOf()})),e.append(s)}const i=r(this,be,Ew);if(i)DO.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(r(this,gl));t.append(s)}r(this,qe).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){const l=i[s];n.append(document.createTextNode(l)),s<o-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;r(this,Gd)||v(this,Gd,{contentsObj:r(this,gl),richText:r(this,vl)}),t&&v(this,yl,null),e&&(v(this,vl,b(this,be,HO).call(this,e)),v(this,gl,null)),(n=r(this,na))==null||n.remove(),v(this,na,null)}resetEdited(){var t;r(this,Gd)&&({contentsObj:le(this,gl)._,richText:le(this,vl)._}=r(this,Gd),v(this,Gd,null),(t=r(this,na))==null||t.remove(),v(this,na,null),v(this,yl,null))}forceHide(){v(this,Wd,this.isVisible),r(this,Wd)&&(r(this,qe).hidden=!0)}maybeShow(){r(this,Wd)&&(r(this,na)||b(this,be,xw).call(this),v(this,Wd,!1),r(this,qe).hidden=!1)}get isVisible(){return r(this,qe).hidden===!1}}Xg=new WeakMap,SE=new WeakMap,xE=new WeakMap,Yg=new WeakMap,Ud=new WeakMap,qe=new WeakMap,gl=new WeakMap,Kg=new WeakMap,db=new WeakMap,fb=new WeakMap,Qg=new WeakMap,ml=new WeakMap,na=new WeakMap,yl=new WeakMap,pb=new WeakMap,vl=new WeakMap,gb=new WeakMap,Gd=new WeakMap,Wd=new WeakMap,be=new WeakSet,Ew=function(){const t=r(this,vl),e=r(this,gl);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,vl).html||null},lT=function(){var t,e,n;return((n=(e=(t=r(this,be,Ew))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},jO=function(){var t,e,n;return((n=(e=(t=r(this,be,Ew))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},HO=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:r(this,be,jO),fontSize:r(this,be,lT)?`calc(${r(this,be,lT)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return n},BO=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,ml))&&b(this,be,Sw).call(this)},zO=function(){if(r(this,yl)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=r(this,fb);let o=!!r(this,Qg),l=o?r(this,Qg):r(this,pb);for(const _ of r(this,db))if(!l||kt.intersect(_.data.rect,l)!==null){l=_.data.rect,o=!0;break}const h=kt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),f=o?l[2]-l[0]+5:0,g=h[0]+f,m=h[1];v(this,yl,[100*(g-i)/e,100*(m-s)/n]);const{style:A}=r(this,qe);A.left=`${r(this,yl)[0]}%`,A.top=`${r(this,yl)[1]}%`},Sw=function(){v(this,ml,!r(this,ml)),r(this,ml)?(b(this,be,xw).call(this),r(this,qe).addEventListener("click",r(this,Yg)),r(this,qe).addEventListener("keydown",r(this,Xg))):(b(this,be,cT).call(this),r(this,qe).removeEventListener("click",r(this,Yg)),r(this,qe).removeEventListener("keydown",r(this,Xg)))},xw=function(){r(this,na)||this.render(),this.isVisible?r(this,ml)&&r(this,qe).classList.add("focused"):(b(this,be,zO).call(this),r(this,qe).hidden=!1,r(this,qe).style.zIndex=parseInt(r(this,qe).style.zIndex)+1e3)},cT=function(){r(this,qe).classList.remove("focused"),!(r(this,ml)||!this.isVisible)&&(r(this,qe).hidden=!0,r(this,qe).style.zIndex=parseInt(r(this,qe).style.zIndex)-1e3)};class UO extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=zt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var mb;class N3 extends sn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,mb,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:i}=Ll(e.rect),s=this.svgFactory.create(n,i,!0),o=v(this,mb,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,mb)}addHighlightArea(){this.container.classList.add("highlightArea")}}mb=new WeakMap;var yb;class $3 extends sn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,yb,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:i}=Ll(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,yb,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",n-o),l.setAttribute("height",i-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,yb)}addHighlightArea(){this.container.classList.add("highlightArea")}}yb=new WeakMap;var vb;class j3 extends sn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,vb,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:i}=Ll(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,vb,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",n/2),l.setAttribute("cy",i/2),l.setAttribute("rx",n/2-o/2),l.setAttribute("ry",i/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,vb)}addHighlightArea(){this.container.classList.add("highlightArea")}}vb=new WeakMap;var Ab;class GO extends sn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,Ab,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:i,popupRef:s}}=this;if(!n)return this.container;const{width:o,height:l}=Ll(e),h=this.svgFactory.create(o,l,!0);let u=[];for(let g=0,m=n.length;g<m;g+=2){const A=n[g]-e[0],_=e[3]-n[g+1];u.push(`${A},${_}`)}u=u.join(" ");const f=v(this,Ab,this.svgFactory.createElement(this.svgElementName));return f.setAttribute("points",u),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),h.append(f),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,Ab)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ab=new WeakMap;class H3 extends GO{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class B3 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var bb;class hk extends sn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,bb,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?zt.HIGHLIGHT:zt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:n,borderStyle:i,popupRef:s}}=this,{width:o,height:l}=Ll(e),h=this.svgFactory.create(o,l,!0);for(const u of n){let f=[];for(let m=0,A=u.length;m<A;m+=2){const _=u[m]-e[0],S=e[3]-u[m+1];f.push(`${_},${S}`)}f=f.join(" ");const g=this.svgFactory.createElement(this.svgElementName);r(this,bb).push(g),g.setAttribute("points",f),g.setAttribute("stroke-width",i.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),h.append(g)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return r(this,bb)}addHighlightArea(){this.container.classList.add("highlightArea")}}bb=new WeakMap;class WO extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=zt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class z3 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class U3 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class G3 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class VO extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=zt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var _b,wb,hT;class W3 extends sn{constructor(e){var i;super(e,{isRenderable:!0});E(this,wb);E(this,_b,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",b(this,wb,hT).bind(this)),v(this,_b,i);const{isMac:s}=Bi.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&b(this,wb,hT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return r(this,_b)}addHighlightArea(){this.container.classList.add("highlightArea")}}_b=new WeakMap,wb=new WeakSet,hT=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Eb,Vd,qd,Sb,mf,qO,uT,CI;let V3=(CI=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:l}){E(this,mf);E(this,Eb,null);E(this,Vd,null);E(this,qd,new Map);E(this,Sb,null);this.div=t,v(this,Eb,e),v(this,Vd,n),v(this,Sb,l||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return r(this,qd).size>0}async render(t){var o;const{annotations:e}=t,n=this.div;df(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ck,annotationStorage:t.annotationStorage||new sk,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const h=l.annotationType===yn.POPUP;if(h){const g=i.get(l.id);if(!g)continue;s.elements=g}else{const{width:g,height:m}=Ll(l.rect);if(g<=0||m<=0)continue}s.data=l;const u=P3.create(s);if(!u.isRenderable)continue;if(!h&&l.popupRef){const g=i.get(l.popupRef);g?g.push(u):i.set(l.popupRef,[u])}const f=u.render();l.hidden&&(f.style.visibility="hidden"),await b(this,mf,qO).call(this,f,l.id),u._isEditable&&(r(this,qd).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}b(this,mf,uT).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,df(e,{rotation:t.rotation}),b(this,mf,uT).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,qd).values())}getEditableAnnotation(t){return r(this,qd).get(t)}},Eb=new WeakMap,Vd=new WeakMap,qd=new WeakMap,Sb=new WeakMap,mf=new WeakSet,qO=async function(t,e){var o,l;const n=t.firstChild||t,i=n.id=`${ZT}${e}`,s=await((o=r(this,Sb))==null?void 0:o.getAriaAttributes(i));if(s)for(const[h,u]of s)n.setAttribute(h,u);this.div.append(t),(l=r(this,Eb))==null||l.moveElementInDOM(this.div,t,n,!1)},uT=function(){if(!r(this,Vd))return;const t=this.div;for(const[e,n]of r(this,Vd)){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n)}r(this,Vd).clear()},CI);const m_=/\r\n?|\n/g;var ia,Ds,xb,Xd,Fs,fn,XO,YO,KO,Cw,Fl,Tw,kw,QO,fT,JO;const Ce=class Ce extends ge{constructor(e){super({...e,name:"freeTextEditor"});E(this,fn);E(this,ia);E(this,Ds,"");E(this,xb,`${this.id}-editor`);E(this,Xd,null);E(this,Fs);v(this,ia,e.color||Ce._defaultColor||ge._defaultLineColor),v(this,Fs,e.fontSize||Ce._defaultFontSize)}static get _keyboardManager(){const e=Ce.prototype,n=o=>o.isEmpty(),i=ff.TRANSLATE_SMALL,s=ff.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new Vb([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(e,n){ge.initialize(e,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Ot.FREETEXT_SIZE:Ce._defaultFontSize=n;break;case Ot.FREETEXT_COLOR:Ce._defaultColor=n;break}}updateParams(e,n){switch(e){case Ot.FREETEXT_SIZE:b(this,fn,XO).call(this,n);break;case Ot.FREETEXT_COLOR:b(this,fn,YO).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ot.FREETEXT_SIZE,Ce._defaultFontSize],[Ot.FREETEXT_COLOR,Ce._defaultColor||ge._defaultLineColor]]}get propertiesToUpdate(){return[[Ot.FREETEXT_SIZE,r(this,Fs)],[Ot.FREETEXT_COLOR,r(this,ia)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ce._internalPadding*e,-(Ce._internalPadding+r(this,Fs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(zt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,Xd,new AbortController);const e=this._uiManager.combinedSignal(r(this,Xd));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,xb)),this._isDraggable=!0,(e=r(this,Xd))==null||e.abort(),v(this,Xd,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Ds),n=v(this,Ds,b(this,fn,KO).call(this).trimEnd());if(e===n)return;const i=s=>{if(v(this,Ds,s),!s){this.remove();return}b(this,fn,kw).call(this),this._uiManager.rebuild(this),b(this,fn,Cw).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(e)},mustExec:!1}),b(this,fn,Cw).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ce._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,xb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${r(this,Fs)}px * var(--scale-factor))`,i.color=r(this,ia),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Gw(this,this.div,["dblclick","keydown"]),this.width){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[h,u]=this.getInitialTranslation();[h,u]=this.pageTranslationToScreen(h,u);const[f,g]=this.pageDimensions,[m,A]=this.pageTranslation;let _,S;switch(this.rotation){case 0:_=e+(l[0]-m)/f,S=n+this.height-(l[1]-A)/g;break;case 90:_=e+(l[0]-m)/f,S=n-(l[1]-A)/g,[h,u]=[u,-h];break;case 180:_=e-this.width+(l[0]-m)/f,S=n-(l[1]-A)/g,[h,u]=[-h,-u];break;case 270:_=e+(l[0]-m-this.height*g)/f,S=n+(l[1]-A-this.width*f)/g,[h,u]=[-u,h];break}this.setAt(_*s,S*o,h,u)}else this.setAt(e*s,n*o,this.width*s,this.height*o);b(this,fn,kw).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var _,S,C;const n=e.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const s=b(_=Ce,Fl,fT).call(_,n.getData("text")||"").replaceAll(m_,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:h,startOffset:u}=l,f=[],g=[];if(h.nodeType===Node.TEXT_NODE){const T=h.parentElement;if(g.push(h.nodeValue.slice(u).replaceAll(m_,"")),T!==this.editorDiv){let k=f;for(const P of this.editorDiv.childNodes){if(P===T){k=g;continue}k.push(b(S=Ce,Fl,Tw).call(S,P))}}f.push(h.nodeValue.slice(0,u).replaceAll(m_,""))}else if(h===this.editorDiv){let T=f,k=0;for(const P of this.editorDiv.childNodes)k++===u&&(T=g),T.push(b(C=Ce,Fl,Tw).call(C,P))}v(this,Ds,`${f.join(`
`)}${s}${g.join(`
`)}`),b(this,fn,kw).call(this);const m=new Range;let A=f.reduce((T,k)=>T+k.length,0);for(const{firstChild:T}of this.editorDiv.childNodes)if(T.nodeType===Node.TEXT_NODE){const k=T.nodeValue.length;if(A<=k){m.setStart(T,A),m.setEnd(T,A);break}A-=k}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,i){var l;let s=null;if(e instanceof UO){const{data:{defaultAppearanceData:{fontSize:h,fontColor:u},rect:f,rotation:g,id:m,popupRef:A},textContent:_,textPosition:S,parent:{page:{pageNumber:C}}}=e;if(!_||_.length===0)return null;s=e={annotationType:zt.FREETEXT,color:Array.from(u),fontSize:h,value:_.join(`
`),position:S,pageIndex:C-1,rect:f.slice(0),rotation:g,id:m,deleted:!1,popupRef:A}}const o=await super.deserialize(e,n,i);return v(o,Fs,e.fontSize),v(o,ia,kt.makeHexColor(...e.color)),v(o,Ds,b(l=Ce,Fl,fT).call(l,e.value)),o.annotationElementId=e.id||null,o._initialData=s,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Ce._internalPadding*this.parentScale,i=this.getRect(n,n),s=ge._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,ia)),o={annotationType:zt.FREETEXT,color:s,fontSize:r(this,Fs),value:b(this,fn,QO).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!b(this,fn,JO).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${r(this,Fs)}px * var(--scale-factor))`,i.color=r(this,ia),n.replaceChildren();for(const o of r(this,Ds).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}const s=Ce._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:r(this,Ds)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};ia=new WeakMap,Ds=new WeakMap,xb=new WeakMap,Xd=new WeakMap,Fs=new WeakMap,fn=new WeakSet,XO=function(e){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-r(this,Fs))*this.parentScale),v(this,Fs,s),b(this,fn,Cw).call(this)},i=r(this,Fs);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},YO=function(e){const n=s=>{v(this,ia,this.editorDiv.style.color=s)},i=r(this,ia);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},KO=function(){var i;const e=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(b(i=Ce,Fl,Tw).call(i,s)),n=s);return e.join(`
`)},Cw=function(){const[e,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,h=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/n):(this.width=i.height/e,this.height=i.width/n),this.fixAndSetPosition()},Fl=new WeakSet,Tw=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(m_,"")},kw=function(){if(this.editorDiv.replaceChildren(),!!r(this,Ds))for(const e of r(this,Ds).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},QO=function(){return r(this,Ds).replaceAll(""," ")},fT=function(e){return e.replaceAll(" ","")},JO=function(e){const{value:n,fontSize:i,color:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==i||e.color.some((l,h)=>l!==s[h])||e.pageIndex!==o},E(Ce,Fl),lt(Ce,"_freeTextDefaultContent",""),lt(Ce,"_internalPadding",0),lt(Ce,"_defaultColor",null),lt(Ce,"_defaultFontSize",10),lt(Ce,"_type","freetext"),lt(Ce,"_editorType",zt.FREETEXT);let dT=Ce,ZO=class{toSVGPath(){Le("Abstract method `toSVGPath` must be implemented.")}get box(){Le("Abstract getter `box` must be implemented.")}serialize(t,e){Le("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Le("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Le("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}};var Os,sa,Jg,Zg,eo,Xt,Yd,Kd,Cb,Tb,tm,em,ph,kb,CE,TE,Cn,Uy,tN,eN,nN,iN,sN,rN;const Mo=class Mo{constructor({x:t,y:e},n,i,s,o,l=0){E(this,Cn);E(this,Os);E(this,sa,[]);E(this,Jg);E(this,Zg);E(this,eo,[]);E(this,Xt,new Float64Array(18));E(this,Yd);E(this,Kd);E(this,Cb);E(this,Tb);E(this,tm);E(this,em);E(this,ph,[]);v(this,Os,n),v(this,em,s*i),v(this,Zg,o),r(this,Xt).set([NaN,NaN,NaN,NaN,t,e],6),v(this,Jg,l),v(this,Tb,r(Mo,kb)*i),v(this,Cb,r(Mo,TE)*i),v(this,tm,i),r(this,ph).push(t,e)}isEmpty(){return isNaN(r(this,Xt)[8])}add({x:t,y:e}){var j;v(this,Yd,t),v(this,Kd,e);const[n,i,s,o]=r(this,Os);let[l,h,u,f]=r(this,Xt).subarray(8,12);const g=t-u,m=e-f,A=Math.hypot(g,m);if(A<r(this,Cb))return!1;const _=A-r(this,Tb),S=_/A,C=S*g,T=S*m;let k=l,P=h;l=u,h=f,u+=C,f+=T,(j=r(this,ph))==null||j.push(t,e);const L=-T/_,I=C/_,D=L*r(this,em),F=I*r(this,em);return r(this,Xt).set(r(this,Xt).subarray(2,8),0),r(this,Xt).set([u+D,f+F],4),r(this,Xt).set(r(this,Xt).subarray(14,18),12),r(this,Xt).set([u-D,f-F],16),isNaN(r(this,Xt)[6])?(r(this,eo).length===0&&(r(this,Xt).set([l+D,h+F],2),r(this,eo).push(NaN,NaN,NaN,NaN,(l+D-n)/s,(h+F-i)/o),r(this,Xt).set([l-D,h-F],14),r(this,sa).push(NaN,NaN,NaN,NaN,(l-D-n)/s,(h-F-i)/o)),r(this,Xt).set([k,P,l,h,u,f],6),!this.isEmpty()):(r(this,Xt).set([k,P,l,h,u,f],6),Math.abs(Math.atan2(P-h,k-l)-Math.atan2(T,C))<Math.PI/2?([l,h,u,f]=r(this,Xt).subarray(2,6),r(this,eo).push(NaN,NaN,NaN,NaN,((l+u)/2-n)/s,((h+f)/2-i)/o),[l,h,k,P]=r(this,Xt).subarray(14,18),r(this,sa).push(NaN,NaN,NaN,NaN,((k+l)/2-n)/s,((P+h)/2-i)/o),!0):([k,P,l,h,u,f]=r(this,Xt).subarray(0,6),r(this,eo).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+u)/6-n)/s,((5*h+f)/6-i)/o,((l+u)/2-n)/s,((h+f)/2-i)/o),[u,f,l,h,k,P]=r(this,Xt).subarray(12,18),r(this,sa).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+u)/6-n)/s,((5*h+f)/6-i)/o,((l+u)/2-n)/s,((h+f)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,eo),e=r(this,sa);if(isNaN(r(this,Xt)[6])&&!this.isEmpty())return b(this,Cn,tN).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);b(this,Cn,nN).call(this,n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return b(this,Cn,eN).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,i,s,o){return new aN(t,e,n,i,s,o)}getOutlines(){var g;const t=r(this,eo),e=r(this,sa),n=r(this,Xt),[i,s,o,l]=r(this,Os),h=new Float64Array((((g=r(this,ph))==null?void 0:g.length)??0)+2);for(let m=0,A=h.length-2;m<A;m+=2)h[m]=(r(this,ph)[m]-i)/o,h[m+1]=(r(this,ph)[m+1]-s)/l;if(h[h.length-2]=(r(this,Yd)-i)/o,h[h.length-1]=(r(this,Kd)-s)/l,isNaN(n[6])&&!this.isEmpty())return b(this,Cn,iN).call(this,h);const u=new Float64Array(r(this,eo).length+24+r(this,sa).length);let f=t.length;for(let m=0;m<f;m+=2){if(isNaN(t[m])){u[m]=u[m+1]=NaN;continue}u[m]=t[m],u[m+1]=t[m+1]}f=b(this,Cn,rN).call(this,u,f);for(let m=e.length-6;m>=6;m-=6)for(let A=0;A<6;A+=2){if(isNaN(e[m+A])){u[f]=u[f+1]=NaN,f+=2;continue}u[f]=e[m+A],u[f+1]=e[m+A+1],f+=2}return b(this,Cn,sN).call(this,u,f),this.newFreeDrawOutline(u,h,r(this,Os),r(this,tm),r(this,Jg),r(this,Zg))}};Os=new WeakMap,sa=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,eo=new WeakMap,Xt=new WeakMap,Yd=new WeakMap,Kd=new WeakMap,Cb=new WeakMap,Tb=new WeakMap,tm=new WeakMap,em=new WeakMap,ph=new WeakMap,kb=new WeakMap,CE=new WeakMap,TE=new WeakMap,Cn=new WeakSet,Uy=function(){const t=r(this,Xt).subarray(4,6),e=r(this,Xt).subarray(16,18),[n,i,s,o]=r(this,Os);return[(r(this,Yd)+(t[0]-e[0])/2-n)/s,(r(this,Kd)+(t[1]-e[1])/2-i)/o,(r(this,Yd)+(e[0]-t[0])/2-n)/s,(r(this,Kd)+(e[1]-t[1])/2-i)/o]},tN=function(){const[t,e,n,i]=r(this,Os),[s,o,l,h]=b(this,Cn,Uy).call(this);return`M${(r(this,Xt)[2]-t)/n} ${(r(this,Xt)[3]-e)/i} L${(r(this,Xt)[4]-t)/n} ${(r(this,Xt)[5]-e)/i} L${s} ${o} L${l} ${h} L${(r(this,Xt)[16]-t)/n} ${(r(this,Xt)[17]-e)/i} L${(r(this,Xt)[14]-t)/n} ${(r(this,Xt)[15]-e)/i} Z`},eN=function(t){const e=r(this,sa);t.push(`L${e[4]} ${e[5]} Z`)},nN=function(t){const[e,n,i,s]=r(this,Os),o=r(this,Xt).subarray(4,6),l=r(this,Xt).subarray(16,18),[h,u,f,g]=b(this,Cn,Uy).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-n)/s} L${h} ${u} L${f} ${g} L${(l[0]-e)/i} ${(l[1]-n)/s}`)},iN=function(t){const e=r(this,Xt),[n,i,s,o]=r(this,Os),[l,h,u,f]=b(this,Cn,Uy).call(this),g=new Float64Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/o],0),this.newFreeDrawOutline(g,t,r(this,Os),r(this,tm),r(this,Jg),r(this,Zg))},sN=function(t,e){const n=r(this,sa);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},rN=function(t,e){const n=r(this,Xt).subarray(4,6),i=r(this,Xt).subarray(16,18),[s,o,l,h]=r(this,Os),[u,f,g,m]=b(this,Cn,Uy).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/l,(n[1]-o)/h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/h],e),e+=24},E(Mo,kb,8),E(Mo,CE,2),E(Mo,TE,r(Mo,kb)+r(Mo,CE));let Vw=Mo;var nm,Qd,Al,Pb,Ns,Rb,en,us,Gy,Wy,oN;class aN extends ZO{constructor(e,n,i,s,o,l){super();E(this,us);E(this,nm);E(this,Qd,null);E(this,Al);E(this,Pb);E(this,Ns);E(this,Rb);E(this,en);v(this,en,e),v(this,Ns,n),v(this,nm,i),v(this,Rb,s),v(this,Al,o),v(this,Pb,l),b(this,us,oN).call(this,l);const{x:h,y:u,width:f,height:g}=r(this,Qd);for(let m=0,A=e.length;m<A;m+=2)e[m]=(e[m]-h)/f,e[m+1]=(e[m+1]-u)/g;for(let m=0,A=n.length;m<A;m+=2)n[m]=(n[m]-h)/f,n[m+1]=(n[m+1]-u)/g}toSVGPath(){const e=[`M${r(this,en)[4]} ${r(this,en)[5]}`];for(let n=6,i=r(this,en).length;n<i;n+=6){if(isNaN(r(this,en)[n])){e.push(`L${r(this,en)[n+4]} ${r(this,en)[n+5]}`);continue}e.push(`C${r(this,en)[n]} ${r(this,en)[n+1]} ${r(this,en)[n+2]} ${r(this,en)[n+3]} ${r(this,en)[n+4]} ${r(this,en)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,i,s],o){const l=i-e,h=s-n;let u,f;switch(o){case 0:u=b(this,us,Gy).call(this,r(this,en),e,s,l,-h),f=b(this,us,Gy).call(this,r(this,Ns),e,s,l,-h);break;case 90:u=b(this,us,Wy).call(this,r(this,en),e,n,l,h),f=b(this,us,Wy).call(this,r(this,Ns),e,n,l,h);break;case 180:u=b(this,us,Gy).call(this,r(this,en),i,n,-l,h),f=b(this,us,Gy).call(this,r(this,Ns),i,n,-l,h);break;case 270:u=b(this,us,Wy).call(this,r(this,en),i,s,-l,-h),f=b(this,us,Wy).call(this,r(this,Ns),i,s,-l,-h);break}return{outline:Array.from(u),points:[Array.from(f)]}}get box(){return r(this,Qd)}newOutliner(e,n,i,s,o,l=0){return new Vw(e,n,i,s,o,l)}getNewOutline(e,n){const{x:i,y:s,width:o,height:l}=r(this,Qd),[h,u,f,g]=r(this,nm),m=o*f,A=l*g,_=i*f+h,S=s*g+u,C=this.newOutliner({x:r(this,Ns)[0]*m+_,y:r(this,Ns)[1]*A+S},r(this,nm),r(this,Rb),e,r(this,Pb),n??r(this,Al));for(let T=2;T<r(this,Ns).length;T+=2)C.add({x:r(this,Ns)[T]*m+_,y:r(this,Ns)[T+1]*A+S});return C.getOutlines()}get mustRemoveSelfIntersections(){return!0}}nm=new WeakMap,Qd=new WeakMap,Al=new WeakMap,Pb=new WeakMap,Ns=new WeakMap,Rb=new WeakMap,en=new WeakMap,us=new WeakSet,Gy=function(e,n,i,s,o){const l=new Float64Array(e.length);for(let h=0,u=e.length;h<u;h+=2)l[h]=n+e[h]*s,l[h+1]=i+e[h+1]*o;return l},Wy=function(e,n,i,s,o){const l=new Float64Array(e.length);for(let h=0,u=e.length;h<u;h+=2)l[h]=n+e[h+1]*s,l[h+1]=i+e[h]*o;return l},oN=function(e){const n=r(this,en);let i=n[4],s=n[5],o=i,l=s,h=i,u=s,f=i,g=s;const m=e?Math.max:Math.min;for(let T=6,k=n.length;T<k;T+=6){if(isNaN(n[T]))o=Math.min(o,n[T+4]),l=Math.min(l,n[T+5]),h=Math.max(h,n[T+4]),u=Math.max(u,n[T+5]),g<n[T+5]?(f=n[T+4],g=n[T+5]):g===n[T+5]&&(f=m(f,n[T+4]));else{const P=kt.bezierBoundingBox(i,s,...n.slice(T,T+6));o=Math.min(o,P[0]),l=Math.min(l,P[1]),h=Math.max(h,P[2]),u=Math.max(u,P[3]),g<P[3]?(f=P[2],g=P[3]):g===P[3]&&(f=m(f,P[2]))}i=n[T+4],s=n[T+5]}const A=o-r(this,Al),_=l-r(this,Al),S=h-o+2*r(this,Al),C=u-l+2*r(this,Al);v(this,Qd,{x:A,y:_,width:S,height:C,lastPoint:[f,g]})};var Lb,gh,ra,Wi,lN,Pw,cN,hN,pT;class fM{constructor(t,e=0,n=0,i=!0){E(this,Wi);E(this,Lb);E(this,gh,[]);E(this,ra,[]);let s=1/0,o=-1/0,l=1/0,h=-1/0;const u=10**-4;for(const{x:C,y:T,width:k,height:P}of t){const L=Math.floor((C-e)/u)*u,I=Math.ceil((C+k+e)/u)*u,D=Math.floor((T-e)/u)*u,F=Math.ceil((T+P+e)/u)*u,H=[L,D,F,!0],j=[I,D,F,!1];r(this,gh).push(H,j),s=Math.min(s,L),o=Math.max(o,I),l=Math.min(l,D),h=Math.max(h,F)}const f=o-s+2*n,g=h-l+2*n,m=s-n,A=l-n,_=r(this,gh).at(i?-1:-2),S=[_[0],_[2]];for(const C of r(this,gh)){const[T,k,P]=C;C[0]=(T-m)/f,C[1]=(k-A)/g,C[2]=(P-A)/g}v(this,Lb,{x:m,y:A,width:f,height:g,lastPoint:S})}getOutlines(){r(this,gh).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of r(this,gh))e[3]?(t.push(...b(this,Wi,pT).call(this,e)),b(this,Wi,cN).call(this,e)):(b(this,Wi,hN).call(this,e),t.push(...b(this,Wi,pT).call(this,e)));return b(this,Wi,lN).call(this,t)}}Lb=new WeakMap,gh=new WeakMap,ra=new WeakMap,Wi=new WeakSet,lN=function(t){const e=[],n=new Set;for(const o of t){const[l,h,u]=o;e.push([l,h,o],[l,u,o])}e.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=e.length;o<l;o+=2){const h=e[o][2],u=e[o+1][2];h.push(u),u.push(h),n.add(h),n.add(u)}const i=[];let s;for(;n.size>0;){const o=n.values().next().value;let[l,h,u,f,g]=o;n.delete(o);let m=l,A=h;for(s=[l,u],i.push(s);;){let _;if(n.has(f))_=f;else if(n.has(g))_=g;else break;n.delete(_),[l,h,u,f,g]=_,m!==l&&(s.push(m,A,l,A===h?h:u),m=l),A=A===h?u:h}s.push(m,A)}return new q3(i,r(this,Lb))},Pw=function(t){const e=r(this,ra);let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,o=e[s][0];if(o===t)return s;o<t?n=s+1:i=s-1}return i+1},cN=function([,t,e]){const n=b(this,Wi,Pw).call(this,t);r(this,ra).splice(n,0,[t,e])},hN=function([,t,e]){const n=b(this,Wi,Pw).call(this,t);for(let i=n;i<r(this,ra).length;i++){const[s,o]=r(this,ra)[i];if(s!==t)break;if(s===t&&o===e){r(this,ra).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,o]=r(this,ra)[i];if(s!==t)break;if(s===t&&o===e){r(this,ra).splice(i,1);return}}},pT=function(t){const[e,n,i]=t,s=[[e,n,i]],o=b(this,Wi,Pw).call(this,i);for(let l=0;l<o;l++){const[h,u]=r(this,ra)[l];for(let f=0,g=s.length;f<g;f++){const[,m,A]=s[f];if(!(u<=m||A<=h)){if(m>=h){if(A>u)s[f][1]=u;else{if(g===1)return[];s.splice(f,1),f--,g--}continue}s[f][2]=h,A>u&&s.push([e,u,A])}}}return s};var Mb,im;class q3 extends ZO{constructor(e,n){super();E(this,Mb);E(this,im);v(this,im,e),v(this,Mb,n)}toSVGPath(){const e=[];for(const n of r(this,im)){let[i,s]=n;e.push(`M${i} ${s}`);for(let o=2;o<n.length;o+=2){const l=n[o],h=n[o+1];l===i?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${l}`),i=l)}e.push("Z")}return e.join(" ")}serialize([e,n,i,s],o){const l=[],h=i-e,u=s-n;for(const f of r(this,im)){const g=new Array(f.length);for(let m=0;m<f.length;m+=2)g[m]=e+f[m]*h,g[m+1]=s-f[m+1]*u;l.push(g)}return l}get box(){return r(this,Mb)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}Mb=new WeakMap,im=new WeakMap;class gT extends Vw{newFreeDrawOutline(t,e,n,i,s,o){return new X3(t,e,n,i,s,o)}get classNamesForDrawing(){return["highlight","free"]}}class X3 extends aN{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,n,i,s,o=0){return new gT(t,e,n,i,s,o)}}var aa,Jd,sm,_n,Ib,rm,Db,Fb,mh,oa,am,Ob,ve,mT,yT,vT,tu,uN,mc;const es=class es{constructor({editor:t=null,uiManager:e=null}){E(this,ve);E(this,aa,null);E(this,Jd,null);E(this,sm);E(this,_n,null);E(this,Ib,!1);E(this,rm,!1);E(this,Db,null);E(this,Fb);E(this,mh,null);E(this,oa,null);E(this,am);var n;t?(v(this,rm,!1),v(this,am,Ot.HIGHLIGHT_COLOR),v(this,Db,t)):(v(this,rm,!0),v(this,am,Ot.HIGHLIGHT_DEFAULT_COLOR)),v(this,oa,(t==null?void 0:t._uiManager)||e),v(this,Fb,r(this,oa)._eventBus),v(this,sm,(t==null?void 0:t.color)||((n=r(this,oa))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),r(es,Ob)||v(es,Ob,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Zt(this,"_keyboardManager",new Vb([[["Escape","mac+Escape"],es.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],es.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],es.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],es.prototype._moveToPrevious],[["Home","mac+Home"],es.prototype._moveToBeginning],[["End","mac+End"],es.prototype._moveToEnd]]))}renderButton(){const t=v(this,aa,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,oa)._signal;t.addEventListener("click",b(this,ve,tu).bind(this),{signal:e}),t.addEventListener("keydown",b(this,ve,vT).bind(this),{signal:e});const n=v(this,Jd,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=r(this,sm),t.append(n),t}renderMainDropdown(){const t=v(this,_n,b(this,ve,mT).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,aa)){b(this,ve,tu).call(this,t);return}const e=t.target.getAttribute("data-color");e&&b(this,ve,yT).call(this,e,t)}_moveToNext(t){var e,n;if(!r(this,ve,mc)){b(this,ve,tu).call(this,t);return}if(t.target===r(this,aa)){(e=r(this,_n).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=r(this,_n))==null?void 0:e.firstChild)||t.target===r(this,aa)){r(this,ve,mc)&&this._hideDropdownFromKeyboard();return}r(this,ve,mc)||b(this,ve,tu).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!r(this,ve,mc)){b(this,ve,tu).call(this,t);return}(e=r(this,_n).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,ve,mc)){b(this,ve,tu).call(this,t);return}(e=r(this,_n).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,_n))==null||t.classList.add("hidden"),(e=r(this,mh))==null||e.abort(),v(this,mh,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,rm)){if(!r(this,ve,mc)){(t=r(this,Db))==null||t.unselect();return}this.hideDropdown(),r(this,aa).focus({preventScroll:!0,focusVisible:r(this,Ib)})}}updateColor(t){if(r(this,Jd)&&(r(this,Jd).style.backgroundColor=t),!r(this,_n))return;const e=r(this,oa).highlightColors.values();for(const n of r(this,_n).children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,aa))==null||t.remove(),v(this,aa,null),v(this,Jd,null),(e=r(this,_n))==null||e.remove(),v(this,_n,null)}};aa=new WeakMap,Jd=new WeakMap,sm=new WeakMap,_n=new WeakMap,Ib=new WeakMap,rm=new WeakMap,Db=new WeakMap,Fb=new WeakMap,mh=new WeakMap,oa=new WeakMap,am=new WeakMap,Ob=new WeakMap,ve=new WeakSet,mT=function(){const t=document.createElement("div"),e=r(this,oa)._signal;t.addEventListener("contextmenu",wr,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of r(this,oa).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",r(es,Ob)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===r(this,sm)),s.addEventListener("click",b(this,ve,yT).bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",b(this,ve,vT).bind(this),{signal:e}),t},yT=function(t,e){e.stopPropagation(),r(this,Fb).dispatch("switchannotationeditorparams",{source:this,type:r(this,am),value:t})},vT=function(t){es._keyboardManager.exec(this,t)},tu=function(t){if(r(this,ve,mc)){this.hideDropdown();return}if(v(this,Ib,t.detail===0),r(this,mh)||(v(this,mh,new AbortController),window.addEventListener("pointerdown",b(this,ve,uN).bind(this),{signal:r(this,oa).combinedSignal(r(this,mh))})),r(this,_n)){r(this,_n).classList.remove("hidden");return}const e=v(this,_n,b(this,ve,mT).call(this));r(this,aa).append(e)},uN=function(t){var e;(e=r(this,_n))!=null&&e.contains(t.target)||this.hideDropdown()},mc=function(){return r(this,_n)&&!r(this,_n).classList.contains("hidden")},E(es,Ob,null);let qw=es;var om,Nb,bl,Zd,lm,ur,$b,jb,tf,la,Si,os,cm,_l,wn,hm,dr,Hb,Ht,AT,Rw,dN,fN,pN,bT,eu,Ar,ap,gN,Lw,Vy,mN,yN,vN,AN,bN;const re=class re extends ge{constructor(e){super({...e,name:"highlightEditor"});E(this,Ht);E(this,om,null);E(this,Nb,0);E(this,bl);E(this,Zd,null);E(this,lm,null);E(this,ur,null);E(this,$b,null);E(this,jb,0);E(this,tf,null);E(this,la,null);E(this,Si,null);E(this,os,!1);E(this,cm,null);E(this,_l);E(this,wn,null);E(this,hm,"");E(this,dr);E(this,Hb,"");this.color=e.color||re._defaultColor,v(this,dr,e.thickness||re._defaultThickness),v(this,_l,e.opacity||re._defaultOpacity),v(this,bl,e.boxes||null),v(this,Hb,e.methodOfCreation||""),v(this,hm,e.text||""),this._isDraggable=!1,e.highlightId>-1?(v(this,os,!0),b(this,Ht,Rw).call(this,e),b(this,Ht,eu).call(this)):r(this,bl)&&(v(this,om,e.anchorNode),v(this,Nb,e.anchorOffset),v(this,$b,e.focusNode),v(this,jb,e.focusOffset),b(this,Ht,AT).call(this),b(this,Ht,eu).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=re.prototype;return Zt(this,"_keyboardManager",new Vb([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,os)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,dr),methodOfCreation:r(this,Hb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var i;ge.initialize(e,n),re._defaultColor||(re._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Ot.HIGHLIGHT_DEFAULT_COLOR:re._defaultColor=n;break;case Ot.HIGHLIGHT_THICKNESS:re._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return r(this,cm)}updateParams(e,n){switch(e){case Ot.HIGHLIGHT_COLOR:b(this,Ht,dN).call(this,n);break;case Ot.HIGHLIGHT_THICKNESS:b(this,Ht,fN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ot.HIGHLIGHT_DEFAULT_COLOR,re._defaultColor],[Ot.HIGHLIGHT_THICKNESS,re._defaultThickness]]}get propertiesToUpdate(){return[[Ot.HIGHLIGHT_COLOR,this.color||re._defaultColor],[Ot.HIGHLIGHT_THICKNESS,r(this,dr)||re._defaultThickness],[Ot.HIGHLIGHT_FREE,r(this,os)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(v(this,lm,new qw({editor:this})),e.addColorPicker(r(this,lm))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(b(this,Ht,Vy).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,b(this,Ht,Vy).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){b(this,Ht,bT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(b(this,Ht,eu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?b(this,Ht,bT).call(this):e&&(b(this,Ht,eu).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var s,o,l;const{drawLayer:n}=this.parent;let i;r(this,os)?(e=(e-this.rotation+360)%360,i=b(s=re,Ar,ap).call(s,r(this,la).box,e)):i=b(o=re,Ar,ap).call(o,this,e),n.rotate(r(this,Si),e),n.rotate(r(this,wn),e),n.updateBox(r(this,Si),i),n.updateBox(r(this,wn),b(l=re,Ar,ap).call(l,r(this,ur).box,e))}render(){if(this.div)return this.div;const e=super.render();r(this,hm)&&(e.setAttribute("aria-label",r(this,hm)),e.setAttribute("role","mark")),r(this,os)?e.classList.add("free"):this.div.addEventListener("keydown",b(this,Ht,gN).bind(this),{signal:this._uiManager._signal});const n=v(this,tf,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=r(this,Zd);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),Gw(this,r(this,tf),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(r(this,wn),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(r(this,wn),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:b(this,Ht,Lw).call(this,!0);break;case 1:case 3:b(this,Ht,Lw).call(this,!1);break}}select(){var e,n;super.select(),r(this,wn)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,wn),"hovered"),(n=this.parent)==null||n.drawLayer.addClass(r(this,wn),"selected"))}unselect(){var e;super.unselect(),r(this,wn)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,wn),"selected"),r(this,os)||b(this,Ht,Lw).call(this,!1))}get _mustFixPosition(){return!r(this,os)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(r(this,Si),e),this.parent.drawLayer.show(r(this,wn),e))}static startHighlighting(e,n,{target:i,x:s,y:o}){const{x:l,y:h,width:u,height:f}=i.getBoundingClientRect(),g=new AbortController,m=e.combinedSignal(g),A=S=>{S.preventDefault(),S.stopPropagation()},_=S=>{g.abort(),b(this,Ar,AN).call(this,e,S)};window.addEventListener("blur",_,{signal:m}),window.addEventListener("pointerup",_,{signal:m}),window.addEventListener("pointerdown",A,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",wr,{signal:m}),i.addEventListener("pointermove",b(this,Ar,vN).bind(this,e),{signal:m}),this._freeHighlight=new gT({x:s,y:o},[l,h,u,f],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(e,n,i){var S,C,T,k;let s=null;if(e instanceof WO){const{data:{quadPoints:P,rect:L,rotation:I,id:D,color:F,opacity:H,popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:zt.HIGHLIGHT,color:Array.from(F),opacity:H,quadPoints:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}else if(e instanceof hk){const{data:{inkLists:P,rect:L,rotation:I,id:D,color:F,borderStyle:{rawWidth:H},popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:zt.HIGHLIGHT,color:Array.from(F),thickness:H,inkLists:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}const{color:o,quadPoints:l,inkLists:h,opacity:u}=e,f=await super.deserialize(e,n,i);f.color=kt.makeHexColor(...o),v(f,_l,u||1),h&&v(f,dr,e.thickness),f.annotationElementId=e.id||null,f._initialData=s;const[g,m]=f.pageDimensions,[A,_]=f.pageTranslation;if(l){const P=v(f,bl,[]);for(let L=0;L<l.length;L+=8)P.push({x:(l[L]-A)/g,y:1-(l[L+1]-_)/m,width:(l[L+2]-l[L])/g,height:(l[L+1]-l[L+5])/m});b(S=f,Ht,AT).call(S),b(C=f,Ht,eu).call(C),f.rotate(f.rotation)}else if(h){v(f,os,!0);const P=h[0],L={x:P[0]-A,y:m-(P[1]-_)},I=new gT(L,[0,0,g,m],1,r(f,dr)/2,!0,.001);for(let H=0,j=P.length;H<j;H+=2)L.x=P[H]-A,L.y=m-(P[H+1]-_),I.add(L);const{id:D,clipPathId:F}=n.drawLayer.draw(I,f.color,f._defaultOpacity,!0);b(T=f,Ht,Rw).call(T,{highlightOutlines:I.getOutlines(),highlightId:D,clipPathId:F}),b(k=f,Ht,eu).call(k)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=ge._colorManager.convert(this.color),s={annotationType:zt.HIGHLIGHT,color:i,opacity:r(this,_l),thickness:r(this,dr),quadPoints:b(this,Ht,mN).call(this),outlines:b(this,Ht,yN).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:b(this,Ht,Vy).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!b(this,Ht,bN).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};om=new WeakMap,Nb=new WeakMap,bl=new WeakMap,Zd=new WeakMap,lm=new WeakMap,ur=new WeakMap,$b=new WeakMap,jb=new WeakMap,tf=new WeakMap,la=new WeakMap,Si=new WeakMap,os=new WeakMap,cm=new WeakMap,_l=new WeakMap,wn=new WeakMap,hm=new WeakMap,dr=new WeakMap,Hb=new WeakMap,Ht=new WeakSet,AT=function(){const e=new fM(r(this,bl),.001);v(this,la,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=r(this,la).box;const n=new fM(r(this,bl),.0025,.001,this._uiManager.direction==="ltr");v(this,ur,n.getOutlines());const{lastPoint:i}=r(this,ur).box;v(this,cm,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Rw=function({highlightOutlines:e,highlightId:n,clipPathId:i}){var g,m;if(v(this,la,e),v(this,ur,e.getNewOutline(r(this,dr)/2+1.5,.0025)),n>=0)v(this,Si,n),v(this,Zd,i),this.parent.drawLayer.finalizeLine(n,e),v(this,wn,this.parent.drawLayer.drawOutline(r(this,ur)));else if(this.parent){const A=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(r(this,Si),e),this.parent.drawLayer.updateBox(r(this,Si),b(g=re,Ar,ap).call(g,r(this,la).box,(A-this.rotation+360)%360)),this.parent.drawLayer.updateLine(r(this,wn),r(this,ur)),this.parent.drawLayer.updateBox(r(this,wn),b(m=re,Ar,ap).call(m,r(this,ur).box,A))}const{x:o,y:l,width:h,height:u}=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=h,this.height=u;break;case 90:{const[A,_]=this.parentDimensions;this.x=l,this.y=1-o,this.width=h*_/A,this.height=u*A/_;break}case 180:this.x=1-o,this.y=1-l,this.width=h,this.height=u;break;case 270:{const[A,_]=this.parentDimensions;this.x=1-l,this.y=o,this.width=h*_/A,this.height=u*A/_;break}}const{lastPoint:f}=r(this,ur).box;v(this,cm,[(f[0]-o)/h,(f[1]-l)/u])},dN=function(e){const n=(o,l)=>{var h,u,f;this.color=o,(h=this.parent)==null||h.drawLayer.changeColor(r(this,Si),o),(u=r(this,lm))==null||u.updateColor(o),v(this,_l,l),(f=this.parent)==null||f.drawLayer.changeOpacity(r(this,Si),l)},i=this.color,s=r(this,_l);this.addCommands({cmd:n.bind(this,e,re._defaultOpacity),undo:n.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},fN=function(e){const n=r(this,dr),i=s=>{v(this,dr,s),b(this,Ht,pN).call(this,s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},pN=function(e){if(!r(this,os))return;b(this,Ht,Rw).call(this,{highlightOutlines:r(this,la).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},bT=function(){r(this,Si)===null||!this.parent||(this.parent.drawLayer.remove(r(this,Si)),v(this,Si,null),this.parent.drawLayer.remove(r(this,wn)),v(this,wn,null))},eu=function(e=this.parent){r(this,Si)===null&&({id:le(this,Si)._,clipPathId:le(this,Zd)._}=e.drawLayer.draw(r(this,la),this.color,r(this,_l)),v(this,wn,e.drawLayer.drawOutline(r(this,ur))),r(this,tf)&&(r(this,tf).style.clipPath=r(this,Zd)))},Ar=new WeakSet,ap=function({x:e,y:n,width:i,height:s},o){switch(o){case 90:return{x:1-n-s,y:e,width:s,height:i};case 180:return{x:1-e-i,y:1-n-s,width:i,height:s};case 270:return{x:n,y:1-e-i,width:s,height:i}}return{x:e,y:n,width:i,height:s}},gN=function(e){re._keyboardManager.exec(this,e)},Lw=function(e){if(!r(this,om))return;const n=window.getSelection();e?n.setPosition(r(this,om),r(this,Nb)):n.setPosition(r(this,$b),r(this,jb))},Vy=function(){return r(this,os)?this.rotation:0},mN=function(){if(r(this,os))return null;const[e,n]=this.pageDimensions,[i,s]=this.pageTranslation,o=r(this,bl),l=new Float32Array(o.length*8);let h=0;for(const{x:u,y:f,width:g,height:m}of o){const A=u*e+i,_=(1-f-m)*n+s;l[h]=l[h+4]=A,l[h+1]=l[h+3]=_,l[h+2]=l[h+6]=A+g*e,l[h+5]=l[h+7]=_+m*n,h+=8}return l},yN=function(e){return r(this,la).serialize(e,b(this,Ht,Vy).call(this))},vN=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},AN=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},bN=function(e){const{color:n}=this._initialData;return e.color.some((i,s)=>i!==n[s])},E(re,Ar),lt(re,"_defaultColor",null),lt(re,"_defaultOpacity",1),lt(re,"_defaultThickness",12),lt(re,"_type","highlight"),lt(re,"_editorType",zt.HIGHLIGHT),lt(re,"_freeHighlightId",-1),lt(re,"_freeHighlight",null),lt(re,"_freeHighlightClipId","");let Xw=re;var ef,nf,no,wl,fr,sf,rf,af,El,um,of,lf,yh,ft,_N,wN,EN,SN,wT,xN,ET,CN,TN,kN,PN,RN,nu,ST,xT,CT,Mw,Iw,op,TT,Dw,jl,LN,kT,MN,IN,PT,Fw,qy;const je=class je extends ge{constructor(e){super({...e,name:"inkEditor"});E(this,ft);E(this,ef,0);E(this,nf,0);E(this,no,null);E(this,wl,new Path2D);E(this,fr,!1);E(this,sf,null);E(this,rf,!1);E(this,af,!1);E(this,El,null);E(this,um,null);E(this,of,0);E(this,lf,0);E(this,yh,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,n){ge.initialize(e,n)}static updateDefaultParams(e,n){switch(e){case Ot.INK_THICKNESS:je._defaultThickness=n;break;case Ot.INK_COLOR:je._defaultColor=n;break;case Ot.INK_OPACITY:je._defaultOpacity=n/100;break}}updateParams(e,n){switch(e){case Ot.INK_THICKNESS:b(this,ft,_N).call(this,n);break;case Ot.INK_COLOR:b(this,ft,wN).call(this,n);break;case Ot.INK_OPACITY:b(this,ft,EN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ot.INK_THICKNESS,je._defaultThickness],[Ot.INK_COLOR,je._defaultColor||ge._defaultLineColor],[Ot.INK_OPACITY,Math.round(je._defaultOpacity*100)]]}get propertiesToUpdate(){return[[Ot.INK_THICKNESS,this.thickness||je._defaultThickness],[Ot.INK_COLOR,this.color||je._defaultColor||ge._defaultLineColor],[Ot.INK_OPACITY,Math.round(100*(this.opacity??je._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(b(this,ft,Mw).call(this),b(this,ft,Iw).call(this)),this.isAttachedToDOM||(this.parent.add(this),b(this,ft,op).call(this)),b(this,ft,qy).call(this)))}remove(){var e;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,no)&&(clearTimeout(r(this,no)),v(this,no,null)),(e=r(this,El))==null||e.disconnect(),v(this,El,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,n]=this.parentDimensions,i=this.width*e,s=this.height*n;this.setDimensions(i,s)}enableEditMode(){r(this,fr)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,b(this,ft,ST).call(this))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),b(this,ft,xT).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){r(this,fr)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),v(this,fr,!0),this.div.classList.add("disabled"),b(this,ft,qy).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||r(this,fr)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),b(this,ft,xN).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),b(this,ft,ET).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),b(this,ft,CT).call(this,e)}canvasPointerleave(e){b(this,ft,CT).call(this,e)}get isResizable(){return!this.isEmpty()&&r(this,fr)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,s,o,l]=b(this,ft,SN).call(this);if(this.setAt(i,s,0,0),this.setDims(o,l),b(this,ft,Mw).call(this),this.width){const[h,u]=this.parentDimensions;this.setAspectRatio(this.width*h,this.height*u),this.setAt(e*h,n*u,this.width*h,this.height*u),v(this,af,!0),b(this,ft,op).call(this),this.setDims(this.width*h,this.height*u),b(this,ft,nu).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return b(this,ft,Iw).call(this),this.div}setDimensions(e,n){const i=Math.round(e),s=Math.round(n);if(r(this,of)===i&&r(this,lf)===s)return;v(this,of,i),v(this,lf,s),this.canvas.style.visibility="hidden";const[o,l]=this.parentDimensions;this.width=e/o,this.height=n/l,this.fixAndSetPosition(),r(this,fr)&&b(this,ft,TT).call(this,e,n),b(this,ft,op).call(this),b(this,ft,nu).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(e,n,i){var C,T,k;if(e instanceof hk)return null;const s=await super.deserialize(e,n,i);s.thickness=e.thickness,s.color=kt.makeHexColor(...e.color),s.opacity=e.opacity;const[o,l]=s.pageDimensions,h=s.width*o,u=s.height*l,f=s.parentScale,g=e.thickness/2;v(s,fr,!0),v(s,of,Math.round(h)),v(s,lf,Math.round(u));const{paths:m,rect:A,rotation:_}=e;for(let{bezier:P}of m){P=b(C=je,jl,MN).call(C,P,A,_);const L=[];s.paths.push(L);let I=f*(P[0]-g),D=f*(P[1]-g);for(let H=2,j=P.length;H<j;H+=6){const Q=f*(P[H]-g),W=f*(P[H+1]-g),tt=f*(P[H+2]-g),Z=f*(P[H+3]-g),et=f*(P[H+4]-g),ht=f*(P[H+5]-g);L.push([[I,D],[Q,W],[tt,Z],[et,ht]]),I=et,D=ht}const F=b(this,jl,LN).call(this,L);s.bezierPath2D.push(F)}const S=b(T=s,ft,PT).call(T);return v(s,nf,Math.max(ge.MIN_SIZE,S[2]-S[0])),v(s,ef,Math.max(ge.MIN_SIZE,S[3]-S[1])),b(k=s,ft,TT).call(k,h,u),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),n=ge._colorManager.convert(this.ctx.strokeStyle);return{annotationType:zt.INK,color:n,thickness:this.thickness,opacity:this.opacity,paths:b(this,ft,IN).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ef=new WeakMap,nf=new WeakMap,no=new WeakMap,wl=new WeakMap,fr=new WeakMap,sf=new WeakMap,rf=new WeakMap,af=new WeakMap,El=new WeakMap,um=new WeakMap,of=new WeakMap,lf=new WeakMap,yh=new WeakMap,ft=new WeakSet,_N=function(e){const n=s=>{this.thickness=s,b(this,ft,qy).call(this)},i=this.thickness;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},wN=function(e){const n=s=>{this.color=s,b(this,ft,nu).call(this)},i=this.color;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},EN=function(e){const n=s=>{this.opacity=s,b(this,ft,nu).call(this)};e/=100;const i=this.opacity;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},SN=function(){const{parentRotation:e,parentDimensions:[n,i]}=this;switch(e){case 90:return[0,i,i,n];case 180:return[n,i,n,i];case 270:return[n,0,i,n];default:return[0,0,n,i]}},wT=function(){const{ctx:e,color:n,opacity:i,thickness:s,parentScale:o,scaleFactor:l}=this;e.lineWidth=s*o/l,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${n}${mz(i)}`},xN=function(e,n){this.canvas.addEventListener("contextmenu",wr,{signal:this._uiManager._signal}),b(this,ft,xT).call(this),v(this,sf,new AbortController);const i=this._uiManager.combinedSignal(r(this,sf));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:i}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:i}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:i}),this.isEditing=!0,r(this,af)||(v(this,af,!0),b(this,ft,op).call(this),this.thickness||(this.thickness=je._defaultThickness),this.color||(this.color=je._defaultColor||ge._defaultLineColor),this.opacity??(this.opacity=je._defaultOpacity)),this.currentPath.push([e,n]),v(this,rf,!1),b(this,ft,wT).call(this),v(this,yh,()=>{b(this,ft,kN).call(this),r(this,yh)&&window.requestAnimationFrame(r(this,yh))}),window.requestAnimationFrame(r(this,yh))},ET=function(e,n){const[i,s]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===i&&n===s)return;const o=this.currentPath;let l=r(this,wl);if(o.push([e,n]),v(this,rf,!0),o.length<=2){l.moveTo(...o[0]),l.lineTo(e,n);return}o.length===3&&(v(this,wl,l=new Path2D),l.moveTo(...o[0])),b(this,ft,PN).call(this,l,...o.at(-3),...o.at(-2),e,n)},CN=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);r(this,wl).lineTo(...e)},TN=function(e,n){v(this,yh,null),e=Math.min(Math.max(e,0),this.canvas.width),n=Math.min(Math.max(n,0),this.canvas.height),b(this,ft,ET).call(this,e,n),b(this,ft,CN).call(this);let i;if(this.currentPath.length!==1)i=b(this,ft,RN).call(this);else{const u=[e,n];i=[[u,u.slice(),u.slice(),u]]}const s=r(this,wl),o=this.currentPath;this.currentPath=[],v(this,wl,new Path2D);const l=()=>{this.allRawPaths.push(o),this.paths.push(i),this.bezierPath2D.push(s),this._uiManager.rebuild(this)},h=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(b(this,ft,Mw).call(this),b(this,ft,Iw).call(this)),b(this,ft,qy).call(this))};this.addCommands({cmd:l,undo:h,mustExec:!0})},kN=function(){if(!r(this,rf))return;v(this,rf,!1);const e=Math.ceil(this.thickness*this.parentScale),n=this.currentPath.slice(-3),i=n.map(l=>l[0]),s=n.map(l=>l[1]);Math.min(...i)-e,Math.max(...i)+e,Math.min(...s)-e,Math.max(...s)+e;const{ctx:o}=this;o.save(),o.clearRect(0,0,this.canvas.width,this.canvas.height);for(const l of this.bezierPath2D)o.stroke(l);o.stroke(r(this,wl)),o.restore()},PN=function(e,n,i,s,o,l,h){const u=(n+s)/2,f=(i+o)/2,g=(s+l)/2,m=(o+h)/2;e.bezierCurveTo(u+2*(s-u)/3,f+2*(o-f)/3,g+2*(s-g)/3,m+2*(o-m)/3,g,m)},RN=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const n=[];let i,[s,o]=e[0];for(i=1;i<e.length-2;i++){const[A,_]=e[i],[S,C]=e[i+1],T=(A+S)/2,k=(_+C)/2,P=[s+2*(A-s)/3,o+2*(_-o)/3],L=[T+2*(A-T)/3,k+2*(_-k)/3];n.push([[s,o],P,L,[T,k]]),[s,o]=[T,k]}const[l,h]=e[i],[u,f]=e[i+1],g=[s+2*(l-s)/3,o+2*(h-o)/3],m=[u+2*(l-u)/3,f+2*(h-f)/3];return n.push([[s,o],g,m,[u,f]]),n},nu=function(){if(this.isEmpty()){b(this,ft,Dw).call(this);return}b(this,ft,wT).call(this);const{canvas:e,ctx:n}=this;n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height),b(this,ft,Dw).call(this);for(const i of this.bezierPath2D)n.stroke(i)},ST=function(){if(r(this,um))return;v(this,um,new AbortController);const e=this._uiManager.combinedSignal(r(this,um));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})},xT=function(){var e;(e=this.pointerdownAC)==null||e.abort(),this.pointerdownAC=null},CT=function(e){var n;(n=r(this,sf))==null||n.abort(),v(this,sf,null),b(this,ft,ST).call(this),r(this,no)&&clearTimeout(r(this,no)),v(this,no,setTimeout(()=>{v(this,no,null),this.canvas.removeEventListener("contextmenu",wr)},10)),b(this,ft,TN).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Mw=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Iw=function(){v(this,El,new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&this.setDimensions(n.width,n.height)})),r(this,El).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,El))==null||e.disconnect(),v(this,El,null)},{once:!0})},op=function(){if(!r(this,af))return;const[e,n]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*n),b(this,ft,Dw).call(this)},TT=function(e,n){const i=b(this,ft,Fw).call(this),s=(e-i)/r(this,nf),o=(n-i)/r(this,ef);this.scaleFactor=Math.min(s,o)},Dw=function(){const e=b(this,ft,Fw).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},jl=new WeakSet,LN=function(e){const n=new Path2D;for(let i=0,s=e.length;i<s;i++){const[o,l,h,u]=e[i];i===0&&n.moveTo(...o),n.bezierCurveTo(l[0],l[1],h[0],h[1],u[0],u[1])}return n},kT=function(e,n,i){const[s,o,l,h]=n;switch(i){case 0:for(let u=0,f=e.length;u<f;u+=2)e[u]+=s,e[u+1]=h-e[u+1];break;case 90:for(let u=0,f=e.length;u<f;u+=2){const g=e[u];e[u]=e[u+1]+s,e[u+1]=g+o}break;case 180:for(let u=0,f=e.length;u<f;u+=2)e[u]=l-e[u],e[u+1]+=o;break;case 270:for(let u=0,f=e.length;u<f;u+=2){const g=e[u];e[u]=l-e[u+1],e[u+1]=h-g}break;default:throw new Error("Invalid rotation")}return e},MN=function(e,n,i){const[s,o,l,h]=n;switch(i){case 0:for(let u=0,f=e.length;u<f;u+=2)e[u]-=s,e[u+1]=h-e[u+1];break;case 90:for(let u=0,f=e.length;u<f;u+=2){const g=e[u];e[u]=e[u+1]-o,e[u+1]=g-s}break;case 180:for(let u=0,f=e.length;u<f;u+=2)e[u]=l-e[u],e[u+1]-=o;break;case 270:for(let u=0,f=e.length;u<f;u+=2){const g=e[u];e[u]=h-e[u+1],e[u+1]=l-g}break;default:throw new Error("Invalid rotation")}return e},IN=function(e,n,i,s){var f,g;const o=[],l=this.thickness/2,h=e*n+l,u=e*i+l;for(const m of this.paths){const A=[],_=[];for(let S=0,C=m.length;S<C;S++){const[T,k,P,L]=m[S];if(T[0]===L[0]&&T[1]===L[1]&&C===1){const Z=e*T[0]+h,et=e*T[1]+u;A.push(Z,et),_.push(Z,et);break}const I=e*T[0]+h,D=e*T[1]+u,F=e*k[0]+h,H=e*k[1]+u,j=e*P[0]+h,Q=e*P[1]+u,W=e*L[0]+h,tt=e*L[1]+u;S===0&&(A.push(I,D),_.push(I,D)),A.push(F,H,j,Q,W,tt),_.push(F,H),S===C-1&&_.push(W,tt)}o.push({bezier:b(f=je,jl,kT).call(f,A,s,this.rotation),points:b(g=je,jl,kT).call(g,_,s,this.rotation)})}return o},PT=function(){let e=1/0,n=-1/0,i=1/0,s=-1/0;for(const o of this.paths)for(const[l,h,u,f]of o){const g=kt.bezierBoundingBox(...l,...h,...u,...f);e=Math.min(e,g[0]),i=Math.min(i,g[1]),n=Math.max(n,g[2]),s=Math.max(s,g[3])}return[e,i,n,s]},Fw=function(){return r(this,fr)?Math.ceil(this.thickness*this.parentScale):0},qy=function(e=!1){if(this.isEmpty())return;if(!r(this,fr)){b(this,ft,nu).call(this);return}const n=b(this,ft,PT).call(this),i=b(this,ft,Fw).call(this);v(this,nf,Math.max(ge.MIN_SIZE,n[2]-n[0])),v(this,ef,Math.max(ge.MIN_SIZE,n[3]-n[1]));const s=Math.ceil(i+r(this,nf)*this.scaleFactor),o=Math.ceil(i+r(this,ef)*this.scaleFactor),[l,h]=this.parentDimensions;this.width=s/l,this.height=o/h,this.setAspectRatio(s,o);const u=this.translationX,f=this.translationY;this.translationX=-n[0],this.translationY=-n[1],b(this,ft,op).call(this),b(this,ft,nu).call(this),v(this,of,s),v(this,lf,o),this.setDims(s,o);const g=e?i/this.scaleFactor/2:0;this.translate(u-this.translationX-g,f-this.translationY-g)},E(je,jl),lt(je,"_defaultColor",null),lt(je,"_defaultOpacity",1),lt(je,"_defaultThickness",1),lt(je,"_type","ink"),lt(je,"_editorType",zt.INK);let _T=je;var Ue,ii,vh,Sl,Ah,dm,io,xl,so,$s,fm,Qt,Xy,Yy,Ow,LT,DN,Nw,MT,$w,FN,ON;const Zy=class Zy extends ge{constructor(e){super({...e,name:"stampEditor"});E(this,Qt);E(this,Ue,null);E(this,ii,null);E(this,vh,null);E(this,Sl,null);E(this,Ah,null);E(this,dm,"");E(this,io,null);E(this,xl,null);E(this,so,null);E(this,$s,!1);E(this,fm,!1);v(this,Sl,e.bitmapUrl),v(this,Ah,e.bitmapFile)}static initialize(e,n){ge.initialize(e,n)}static get supportedTypes(){return Zt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Zt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,n){n.pasteEditor(zt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=e||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const u=h.output;return await this.setGuessedAltText(u),n&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var e,n;r(this,ii)&&(v(this,Ue,null),this._uiManager.imageManager.deleteId(r(this,ii)),(e=r(this,io))==null||e.remove(),v(this,io,null),(n=r(this,xl))==null||n.disconnect(),v(this,xl,null),r(this,so)&&(clearTimeout(r(this,so)),v(this,so,null))),super.remove()}rebuild(){if(!this.parent){r(this,ii)&&b(this,Qt,Ow).call(this);return}super.rebuild(),this.div!==null&&(r(this,ii)&&r(this,io)===null&&b(this,Qt,Ow).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,vh)||r(this,Ue)||r(this,Sl)||r(this,Ah)||r(this,ii))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;if(this.width&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,Ue)?b(this,Qt,LT).call(this):b(this,Qt,Ow).call(this),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(e*i,n*s,this.width*i,this.height*s)}return this.div}copyCanvas(e,n,i=!1){var A;e||(e=224);const{width:s,height:o}=r(this,Ue),l=new CC;let h=r(this,Ue),u=s,f=o,g=null;if(n){if(s>n||o>n){const H=Math.min(n/s,n/o);u=Math.floor(s*H),f=Math.floor(o*H)}g=document.createElement("canvas");const _=g.width=Math.ceil(u*l.sx),S=g.height=Math.ceil(f*l.sy);r(this,$s)||(h=b(this,Qt,Nw).call(this,_,S));const C=g.getContext("2d");C.filter=this._uiManager.hcmFilter;let T="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(A=window.matchMedia)!=null&&A.call(window,"(prefers-color-scheme: dark)").matches&&(T="#8f8f9d",k="#42414d");const P=15,L=P*l.sx,I=P*l.sy,D=new OffscreenCanvas(L*2,I*2),F=D.getContext("2d");F.fillStyle=T,F.fillRect(0,0,L*2,I*2),F.fillStyle=k,F.fillRect(0,0,L,I),F.fillRect(L,I,L,I),C.fillStyle=C.createPattern(D,"repeat"),C.fillRect(0,0,_,S),C.drawImage(h,0,0,h.width,h.height,0,0,_,S)}let m=null;if(i){let _,S;if(l.symmetric&&h.width<e&&h.height<e)_=h.width,S=h.height;else if(h=r(this,Ue),s>e||o>e){const k=Math.min(e/s,e/o);_=Math.floor(s*k),S=Math.floor(o*k),r(this,$s)||(h=b(this,Qt,Nw).call(this,_,S))}const T=new OffscreenCanvas(_,S).getContext("2d",{willReadFrequently:!0});T.drawImage(h,0,0,h.width,h.height,0,0,_,S),m={width:_,height:S,data:T.getImageData(0,0,_,S).data}}return{canvas:g,width:u,height:f,imageData:m}}getImageForAltText(){return r(this,io)}static async deserialize(e,n,i){var S;let s=null;if(e instanceof VO){const{data:{rect:C,rotation:T,id:k,structParent:P,popupRef:L},container:I,parent:{page:{pageNumber:D}}}=e,F=I.querySelector("canvas"),H=i.imageManager.getFromCanvas(I.id,F);F.remove();const j=((S=await n._structTree.getAriaAttributes(`${ZT}${k}`))==null?void 0:S.get("aria-label"))||"";s=e={annotationType:zt.STAMP,bitmapId:H.id,bitmap:H.bitmap,pageIndex:D-1,rect:C.slice(0),rotation:T,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:P,popupRef:L}}const o=await super.deserialize(e,n,i),{rect:l,bitmap:h,bitmapUrl:u,bitmapId:f,isSvg:g,accessibilityData:m}=e;f&&i.imageManager.isValidId(f)?(v(o,ii,f),h&&v(o,Ue,h)):v(o,Sl,u),v(o,$s,g);const[A,_]=o.pageDimensions;return o.width=(l[2]-l[0])/A,o.height=(l[3]-l[1])/_,o.annotationElementId=e.id||null,m&&(o.altTextData=m),o._initialData=s,v(o,fm,!!s),o}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:zt.STAMP,bitmapId:r(this,ii),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,$s),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=b(this,Qt,$w).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const h=b(this,Qt,ON).call(this,i);if(h.isSame)return null;h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const l=r(this,$s)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(r(this,ii)))n.stamps.set(r(this,ii),{area:l,serialized:i}),i.bitmap=b(this,Qt,$w).call(this,!1);else if(r(this,$s)){const h=n.stamps.get(r(this,ii));l>h.area&&(h.area=l,h.serialized.bitmap.close(),h.serialized.bitmap=b(this,Qt,$w).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};Ue=new WeakMap,ii=new WeakMap,vh=new WeakMap,Sl=new WeakMap,Ah=new WeakMap,dm=new WeakMap,io=new WeakMap,xl=new WeakMap,so=new WeakMap,$s=new WeakMap,fm=new WeakMap,Qt=new WeakSet,Xy=function(e,n=!1){if(!e){this.remove();return}v(this,Ue,e.bitmap),n||(v(this,ii,e.id),v(this,$s,e.isSvg)),e.file&&v(this,dm,e.file.name),b(this,Qt,LT).call(this)},Yy=function(){if(v(this,vh,null),this._uiManager.enableWaiting(!1),!!r(this,io)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Ue)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Ue)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Ow=function(){if(r(this,ii)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,ii)).then(i=>b(this,Qt,Xy).call(this,i,!0)).finally(()=>b(this,Qt,Yy).call(this));return}if(r(this,Sl)){const i=r(this,Sl);v(this,Sl,null),this._uiManager.enableWaiting(!0),v(this,vh,this._uiManager.imageManager.getFromUrl(i).then(s=>b(this,Qt,Xy).call(this,s)).finally(()=>b(this,Qt,Yy).call(this)));return}if(r(this,Ah)){const i=r(this,Ah);v(this,Ah,null),this._uiManager.enableWaiting(!0),v(this,vh,this._uiManager.imageManager.getFromFile(i).then(s=>b(this,Qt,Xy).call(this,s)).finally(()=>b(this,Qt,Yy).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Zy.supportedTypesStr;const n=this._uiManager._signal;v(this,vh,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),b(this,Qt,Xy).call(this,s)}i()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>b(this,Qt,Yy).call(this))),e.click()},LT=function(){const{div:e}=this;let{width:n,height:i}=r(this,Ue);const[s,o]=this.pageDimensions,l=.75;if(this.width)n=this.width*s,i=this.height*o;else if(n>l*s||i>l*o){const g=Math.min(l*s/n,l*o/i);n*=g,i*=g}const[h,u]=this.parentDimensions;this.setDims(n*h/s,i*u/o),this._uiManager.enableWaiting(!1);const f=v(this,io,document.createElement("canvas"));f.setAttribute("role","img"),this.addContainer(f),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),b(this,Qt,MT).call(this,n,i),b(this,Qt,FN).call(this),r(this,fm)||(this.parent.addUndoableEditor(this),v(this,fm,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,dm)&&f.setAttribute("aria-label",r(this,dm))},DN=function(e,n){var l;const[i,s]=this.parentDimensions;this.width=e/i,this.height=n/s,(l=this._initialOptions)!=null&&l.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,r(this,so)!==null&&clearTimeout(r(this,so)),v(this,so,setTimeout(()=>{v(this,so,null),b(this,Qt,MT).call(this,e,n)},200))},Nw=function(e,n){const{width:i,height:s}=r(this,Ue);let o=i,l=s,h=r(this,Ue);for(;o>2*e||l>2*n;){const u=o,f=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*n&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(h,0,0,u,f,0,0,o,l),h=g.transferToImageBitmap()}return h},MT=function(e,n){const i=new CC,s=Math.ceil(e*i.sx),o=Math.ceil(n*i.sy),l=r(this,io);if(!l||l.width===s&&l.height===o)return;l.width=s,l.height=o;const h=r(this,$s)?r(this,Ue):b(this,Qt,Nw).call(this,s,o),u=l.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(h,0,0,h.width,h.height,0,0,s,o)},$w=function(e){if(e){if(r(this,$s)){const s=this._uiManager.imageManager.getSvgUrl(r(this,ii));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=r(this,Ue),n.getContext("2d").drawImage(r(this,Ue),0,0),n.toDataURL()}if(r(this,$s)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*xh.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*xh.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(r(this,Ue),0,0,r(this,Ue).width,r(this,Ue).height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(r(this,Ue))},FN=function(){this._uiManager._signal&&(v(this,xl,new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&b(this,Qt,DN).call(this,n.width,n.height)})),r(this,xl).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,xl))==null||e.disconnect(),v(this,xl,null)},{once:!0}))},ON=function(e){var u;const{rect:n,pageIndex:i,accessibilityData:{altText:s}}=this._initialData,o=e.rect.every((f,g)=>Math.abs(f-n[g])<1),l=e.pageIndex===i,h=(((u=e.accessibilityData)==null?void 0:u.alt)||"")===s;return{isSame:o&&l&&h,isSameAltText:h}},lt(Zy,"_type","stamp"),lt(Zy,"_editorType",zt.STAMP);let RT=Zy;var cf,pm,ro,bh,Cl,js,_h,gm,mm,xi,Tl,Rt,wh,ai,NN,DT,FT,OT,jw;const Fr=class Fr{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:h,viewport:u,l10n:f}){E(this,ai);E(this,cf);E(this,pm,!1);E(this,ro,null);E(this,bh,null);E(this,Cl,null);E(this,js,new Map);E(this,_h,!1);E(this,gm,!1);E(this,mm,!1);E(this,xi,null);E(this,Tl,null);E(this,Rt);const g=[...r(Fr,wh).values()];if(!Fr._initialized){Fr._initialized=!0;for(const m of g)m.initialize(f,t)}t.registerEditorTypes(g),v(this,Rt,t),this.pageIndex=e,this.div=n,v(this,cf,s),v(this,ro,o),this.viewport=u,v(this,xi,h),this.drawLayer=l,this._structTree=i,r(this,Rt).addLayer(this)}get isEmpty(){return r(this,js).size===0}get isInvisible(){return this.isEmpty&&r(this,Rt).getMode()===zt.NONE}updateToolbar(t){r(this,Rt).updateToolbar(t)}updateMode(t=r(this,Rt).getMode()){switch(b(this,ai,jw).call(this),t){case zt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case zt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case zt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of r(Fr,wh).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,xi))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(r(this,Rt).getMode()!==zt.INK)return;if(!t){for(const n of r(this,js).values())if(n.isEmpty()){n.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){r(this,Rt).setEditingState(t)}addCommands(t){r(this,Rt).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,ro))==null||e.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of r(this,js).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(r(this,Rt).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!r(this,ro))return;const e=r(this,ro).getEditableAnnotations();for(const n of e){if(n.hide(),r(this,Rt).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}}disable(){var i;v(this,mm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of r(this,js).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(i=this.getEditableAnnotation(s.annotationElementId))==null||i.show(),s.remove()}if(r(this,ro)){const s=r(this,ro).getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(r(this,Rt).isDeletedAnnotationElement(l))continue;let h=e.get(l);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=t.get(l),h&&(r(this,Rt).addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}b(this,ai,jw).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of r(Fr,wh).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,mm,!1)}getEditableAnnotation(t){var e;return((e=r(this,ro))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,Rt).getActive()!==t&&r(this,Rt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,xi))!=null&&t.div&&!r(this,Tl)){v(this,Tl,new AbortController);const e=r(this,Rt).combinedSignal(r(this,Tl));r(this,xi).div.addEventListener("pointerdown",b(this,ai,NN).bind(this),{signal:e}),r(this,xi).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,xi))!=null&&t.div&&r(this,Tl)&&(r(this,Tl).abort(),v(this,Tl,null),r(this,xi).div.classList.remove("highlighting"))}enableClick(){if(r(this,bh))return;v(this,bh,new AbortController);const t=r(this,Rt).combinedSignal(r(this,bh));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){var t;(t=r(this,bh))==null||t.abort(),v(this,bh,null)}attach(t){r(this,js).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,Rt).isDeletedAnnotationElement(e)&&r(this,Rt).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,js).delete(t.id),(e=r(this,cf))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,mm)&&t.annotationElementId&&r(this,Rt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,Rt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,r(this,gm)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,Rt).addDeletedAnnotationElement(t.annotationElementId),ge.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,Rt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),r(this,Rt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,Cl)&&(t._focusEventsAllowed=!1,v(this,Cl,setTimeout(()=>{v(this,Cl,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,Rt)._signal}),e.focus())},0))),t._structTreeParentId=(n=r(this,cf))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return r(this,Rt).getId()}combinedSignal(t){return r(this,Rt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,ai,DT))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,Rt).updateToolbar(t),r(this,Rt).updateMode(t);const{offsetX:n,offsetY:i}=b(this,ai,OT).call(this),s=this.getNextId(),o=b(this,ai,FT).call(this,{parent:this,id:s,x:n,y:i,uiManager:r(this,Rt),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=r(Fr,wh).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,Rt)))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),s=b(this,ai,FT).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:r(this,Rt),isCentered:e,...n});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(b(this,ai,OT).call(this),!0)}setSelected(t){r(this,Rt).setSelected(t)}toggleSelected(t){r(this,Rt).toggleSelected(t)}unselect(t){r(this,Rt).unselect(t)}pointerup(t){const{isMac:e}=Bi.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,_h)){if(v(this,_h,!1),!r(this,pm)){v(this,pm,!0);return}if(r(this,Rt).getMode()===zt.STAMP){r(this,Rt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(r(this,Rt).getMode()===zt.HIGHLIGHT&&this.enableTextSelection(),r(this,_h)){v(this,_h,!1);return}const{isMac:e}=Bi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;v(this,_h,!0);const n=r(this,Rt).getActive();v(this,pm,!n||n.isEmpty())}findNewParent(t,e,n){const i=r(this,Rt).findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}destroy(){var t,e;((t=r(this,Rt).getActive())==null?void 0:t.parent)===this&&(r(this,Rt).commitOrRemove(),r(this,Rt).setActiveEditor(null)),r(this,Cl)&&(clearTimeout(r(this,Cl)),v(this,Cl,null));for(const n of r(this,js).values())(e=r(this,cf))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,r(this,js).clear(),r(this,Rt).removeLayer(this)}render({viewport:t}){this.viewport=t,df(this.div,t);for(const e of r(this,Rt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,Rt).commitOrRemove(),b(this,ai,jw).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,df(this.div,{rotation:n}),e!==n)for(const i of r(this,js).values())i.rotate(n);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,Rt).viewParameters.realScale}};cf=new WeakMap,pm=new WeakMap,ro=new WeakMap,bh=new WeakMap,Cl=new WeakMap,js=new WeakMap,_h=new WeakMap,gm=new WeakMap,mm=new WeakMap,xi=new WeakMap,Tl=new WeakMap,Rt=new WeakMap,wh=new WeakMap,ai=new WeakSet,NN=function(t){r(this,Rt).unselectAll();const{target:e}=t;if(e===r(this,xi).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,xi).div.contains(e)){const{isMac:n}=Bi.platform;if(t.button!==0||t.ctrlKey&&n)return;r(this,Rt).showAllEditors("highlight",!0,!0),r(this,xi).div.classList.add("free"),this.toggleDrawing(),Xw.startHighlighting(this,r(this,Rt).direction==="ltr",{target:r(this,xi).div,x:t.x,y:t.y}),r(this,xi).div.addEventListener("pointerup",()=>{r(this,xi).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,Rt)._signal}),t.preventDefault()}},DT=function(){return r(Fr,wh).get(r(this,Rt).getMode())},FT=function(t){const e=r(this,ai,DT);return e?new e.prototype.constructor(t):null},OT=function(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),o=Math.max(0,e),l=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),u=(s+l)/2-t,f=(o+h)/2-e,[g,m]=this.viewport.rotation%180===0?[u,f]:[f,u];return{offsetX:g,offsetY:m}},jw=function(){v(this,gm,!0);for(const t of r(this,js).values())t.isEmpty()&&t.remove();v(this,gm,!1)},lt(Fr,"_initialized",!1),E(Fr,wh,new Map([dT,_T,RT,Xw].map(t=>[t._editorType,t])));let IT=Fr;var ao,Bb,hn,kl,zb,$T,yf,jT,$N;const Yn=class Yn{constructor({pageIndex:t}){E(this,yf);E(this,ao,null);E(this,Bb,0);E(this,hn,new Map);E(this,kl,new Map);this.pageIndex=t}setParent(t){if(!r(this,ao)){v(this,ao,t);return}if(r(this,ao)!==t){if(r(this,hn).size>0)for(const e of r(this,hn).values())e.remove(),t.append(e);v(this,ao,t)}}static get _svgFactory(){return Zt(this,"_svgFactory",new ck)}draw(t,e,n,i=!1){const s=le(this,Bb)._++,o=b(this,yf,jT).call(this,t.box);o.classList.add(...t.classNamesForDrawing);const l=Yn._svgFactory.createElement("defs");o.append(l);const h=Yn._svgFactory.createElement("path");l.append(h);const u=`path_p${this.pageIndex}_${s}`;h.setAttribute("id",u),h.setAttribute("d",t.toSVGPath()),i&&r(this,kl).set(s,h);const f=b(this,yf,$N).call(this,l,u),g=Yn._svgFactory.createElement("use");return o.append(g),o.setAttribute("fill",e),o.setAttribute("fill-opacity",n),g.setAttribute("href",`#${u}`),r(this,hn).set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(t){const e=le(this,Bb)._++,n=b(this,yf,jT).call(this,t.box);n.classList.add(...t.classNamesForOutlining);const i=Yn._svgFactory.createElement("defs");n.append(i);const s=Yn._svgFactory.createElement("path");i.append(s);const o=`path_p${this.pageIndex}_${e}`;s.setAttribute("id",o),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let l;if(t.mustRemoveSelfIntersections){const f=Yn._svgFactory.createElement("mask");i.append(f),l=`mask_p${this.pageIndex}_${e}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const g=Yn._svgFactory.createElement("rect");f.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const m=Yn._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const h=Yn._svgFactory.createElement("use");n.append(h),h.setAttribute("href",`#${o}`),l&&h.setAttribute("mask",`url(#${l})`);const u=h.cloneNode();return n.append(u),h.classList.add("mainOutline"),u.classList.add("secondaryOutline"),r(this,hn).set(e,n),e}finalizeLine(t,e){const n=r(this,kl).get(t);r(this,kl).delete(t),this.updateBox(t,e.box),n.setAttribute("d",e.toSVGPath())}updateLine(t,e){r(this,hn).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){r(this,kl).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var n;b(n=Yn,zb,$T).call(n,r(this,hn).get(t),e)}show(t,e){r(this,hn).get(t).classList.toggle("hidden",!e)}rotate(t,e){r(this,hn).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){r(this,hn).get(t).setAttribute("fill",e)}changeOpacity(t,e){r(this,hn).get(t).setAttribute("fill-opacity",e)}addClass(t,e){r(this,hn).get(t).classList.add(e)}removeClass(t,e){r(this,hn).get(t).classList.remove(e)}getSVGRoot(t){return r(this,hn).get(t)}remove(t){r(this,kl).delete(t),r(this,ao)!==null&&(r(this,hn).get(t).remove(),r(this,hn).delete(t))}destroy(){v(this,ao,null);for(const t of r(this,hn).values())t.remove();r(this,hn).clear(),r(this,kl).clear()}};ao=new WeakMap,Bb=new WeakMap,hn=new WeakMap,kl=new WeakMap,zb=new WeakSet,$T=function(t,{x:e=0,y:n=0,width:i=1,height:s=1}={}){const{style:o}=t;o.top=`${100*n}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},yf=new WeakSet,jT=function(t){var n;const e=Yn._svgFactory.create(1,1,!0);return r(this,ao).append(e),e.setAttribute("aria-hidden",!0),b(n=Yn,zb,$T).call(n,e,t),e},$N=function(t,e){const n=Yn._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=Yn._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i},E(Yn,zb);let NT=Yn;var Y3=Nt.AbortException,K3=Nt.AnnotationEditorLayer,Q3=Nt.AnnotationEditorParamsType,J3=Nt.AnnotationEditorType,Z3=Nt.AnnotationEditorUIManager,tU=Nt.AnnotationLayer,eU=Nt.AnnotationMode,nU=Nt.ColorPicker,iU=Nt.DOMSVGFactory,sU=Nt.DrawLayer,rU=Nt.FeatureTest,aU=Nt.GlobalWorkerOptions,oU=Nt.ImageKind,lU=Nt.InvalidPDFException,cU=Nt.MissingPDFException,hU=Nt.OPS,uU=Nt.OutputScale,dU=Nt.PDFDataRangeTransport,fU=Nt.PDFDateString,pU=Nt.PDFWorker,gU=Nt.PasswordResponses,mU=Nt.PermissionFlag,yU=Nt.PixelsPerInch,vU=Nt.RenderingCancelledException,AU=Nt.TextLayer,bU=Nt.UnexpectedResponseException,_U=Nt.Util,wU=Nt.VerbosityLevel,EU=Nt.XfaLayer,SU=Nt.build,xU=Nt.createValidAbsoluteUrl,CU=Nt.fetchData,TU=Nt.getDocument,kU=Nt.getFilenameFromUrl,PU=Nt.getPdfFilenameFromUrl,RU=Nt.getXfaPageViewport,LU=Nt.isDataScheme,MU=Nt.isPdfFile,IU=Nt.noContextMenu,DU=Nt.normalizeUnicode,FU=Nt.setLayerDimensions,OU=Nt.shadow,NU=Nt.version;const $U=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Y3,AnnotationEditorLayer:K3,AnnotationEditorParamsType:Q3,AnnotationEditorType:J3,AnnotationEditorUIManager:Z3,AnnotationLayer:tU,AnnotationMode:eU,ColorPicker:nU,DOMSVGFactory:iU,DrawLayer:sU,FeatureTest:rU,GlobalWorkerOptions:aU,ImageKind:oU,InvalidPDFException:lU,MissingPDFException:cU,OPS:hU,OutputScale:uU,PDFDataRangeTransport:dU,PDFDateString:fU,PDFWorker:pU,PasswordResponses:gU,PermissionFlag:mU,PixelsPerInch:yU,RenderingCancelledException:vU,TextLayer:AU,UnexpectedResponseException:bU,Util:_U,VerbosityLevel:wU,XfaLayer:EU,build:SU,createValidAbsoluteUrl:xU,fetchData:CU,getDocument:TU,getFilenameFromUrl:kU,getPdfFilenameFromUrl:PU,getXfaPageViewport:RU,isDataScheme:LU,isPdfFile:MU,noContextMenu:IU,normalizeUnicode:DU,setLayerDimensions:FU,shadow:OU,version:NU},Symbol.toStringTag,{value:"Module"})),Xb=z$($U);var Sa={},y_={},pM;function uk(){return pM||(pM=1,function(p){var t=y_.__spreadArray||function(n,i,s){if(s||arguments.length===2)for(var o=0,l=i.length,h;o<l;o++)(h||!(o in i))&&(h||(h=Array.prototype.slice.call(i,0,o)),h[o]=i[o]);return n.concat(h||Array.prototype.slice.call(i))};Object.defineProperty(p,"__esModule",{value:!0}),p.allEvents=p.changeEvents=p.otherEvents=p.transitionEvents=p.animationEvents=p.wheelEvents=p.uiEvents=p.pointerEvents=p.touchEvents=p.selectionEvents=p.dragEvents=p.mouseEvents=p.mediaEvents=p.keyboardEvents=p.imageEvents=p.formEvents=p.focusEvents=p.compositionEvents=p.clipboardEvents=void 0,p.clipboardEvents=["onCopy","onCut","onPaste"],p.compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],p.focusEvents=["onFocus","onBlur"],p.formEvents=["onInput","onInvalid","onReset","onSubmit"],p.imageEvents=["onLoad","onError"],p.keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],p.mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],p.mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],p.dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],p.selectionEvents=["onSelect"],p.touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],p.pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],p.uiEvents=["onScroll"],p.wheelEvents=["onWheel"],p.animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],p.transitionEvents=["onTransitionEnd"],p.otherEvents=["onToggle"],p.changeEvents=["onChange"],p.allEvents=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t([],p.clipboardEvents,!0),p.compositionEvents,!0),p.focusEvents,!0),p.formEvents,!0),p.imageEvents,!0),p.keyboardEvents,!0),p.mediaEvents,!0),p.mouseEvents,!0),p.dragEvents,!0),p.selectionEvents,!0),p.touchEvents,!0),p.pointerEvents,!0),p.uiEvents,!0),p.wheelEvents,!0),p.animationEvents,!0),p.transitionEvents,!0),p.changeEvents,!0),p.otherEvents,!0);function e(n,i){var s={};return p.allEvents.forEach(function(o){var l=n[o];l&&(i?s[o]=function(h){return l(h,i(o))}:s[o]=l)}),s}p.default=e}(y_)),y_}var v_={},gM;function vm(){if(gM)return v_;gM=1,Object.defineProperty(v_,"__esModule",{value:!0});function p(t){var e=!1,n=new Promise(function(i,s){t.then(function(o){return!e&&i(o)}).catch(function(o){return!e&&s(o)})});return{promise:n,cancel:function(){e=!0}}}return v_.default=p,v_}var A_={exports:{}},mM;function Am(){if(mM)return A_.exports;mM=1;function p(e){var n,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(n=0;n<o;n++)e[n]&&(i=p(e[n]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function t(){for(var e,n,i=0,s="",o=arguments.length;i<o;i++)(e=arguments[i])&&(n=p(e))&&(s&&(s+=" "),s+=n);return s}return A_.exports=t,A_.exports.clsx=t,A_.exports}var ux,yM;function fa(){if(yM)return ux;yM=1;var p="Invariant failed";function t(e,n){if(!e)throw new Error(p)}return ux=t,ux}var dx,vM;function Mh(){if(vM)return dx;vM=1;var p=function(){};return dx=p,dx}var fx={},AM;function jU(){if(AM)return fx;AM=1;var p=Object.prototype.hasOwnProperty;function t(n,i,s){for(s of n.keys())if(e(s,i))return s}function e(n,i){var s,o,l;if(n===i)return!0;if(n&&i&&(s=n.constructor)===i.constructor){if(s===Date)return n.getTime()===i.getTime();if(s===RegExp)return n.toString()===i.toString();if(s===Array){if((o=n.length)===i.length)for(;o--&&e(n[o],i[o]););return o===-1}if(s===Set){if(n.size!==i.size)return!1;for(o of n)if(l=o,l&&typeof l=="object"&&(l=t(i,l),!l)||!i.has(l))return!1;return!0}if(s===Map){if(n.size!==i.size)return!1;for(o of n)if(l=o[0],l&&typeof l=="object"&&(l=t(i,l),!l)||!e(o[1],i.get(l)))return!1;return!0}if(s===ArrayBuffer)n=new Uint8Array(n),i=new Uint8Array(i);else if(s===DataView){if((o=n.byteLength)===i.byteLength)for(;o--&&n.getInt8(o)===i.getInt8(o););return o===-1}if(ArrayBuffer.isView(n)){if((o=n.byteLength)===i.byteLength)for(;o--&&n[o]===i[o];);return o===-1}if(!s||typeof n=="object"){o=0;for(s in n)if(p.call(n,s)&&++o&&!p.call(i,s)||!(s in i)||!e(n[s],i[s]))return!1;return Object.keys(i).length===o}}return n!==n&&i!==i}return fx.dequal=e,fx}var b_={},bM;function jN(){if(bM)return b_;bM=1,Object.defineProperty(b_,"__esModule",{value:!0});const t=(0,kn().createContext)(null);return b_.default=t,b_}var __={},_M;function HN(){if(_M)return __;_M=1,Object.defineProperty(__,"__esModule",{value:!0}),__.default=t;const p=Er();function t({children:e,type:n}){return(0,p.jsx)("div",{className:`react-pdf__message react-pdf__message--${n}`,children:e})}return __}var fy={},wM;function HU(){if(wM)return fy;wM=1;var p=fy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(fy,"__esModule",{value:!0});const t=p(fa()),e="noopener noreferrer nofollow";let n=class{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(s){this.pdfDocument=s}setViewer(s){this.pdfViewer=s}setExternalLinkRel(s){this.externalLinkRel=s}setExternalLinkTarget(s){this.externalLinkTarget=s}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(s){(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=s}get rotation(){return 0}set rotation(s){}goToDestination(s){return new Promise(o=>{(0,t.default)(this.pdfDocument,"PDF document not loaded."),(0,t.default)(s,"Destination is not specified."),typeof s=="string"?this.pdfDocument.getDestination(s).then(o):Array.isArray(s)?o(s):s.then(o)}).then(o=>{(0,t.default)(Array.isArray(o),`"${o}" is not a valid destination array.`);const l=o[0];new Promise(h=>{(0,t.default)(this.pdfDocument,"PDF document not loaded."),l instanceof Object?this.pdfDocument.getPageIndex(l).then(u=>{h(u)}).catch(()=>{(0,t.default)(!1,`"${l}" is not a valid page reference.`)}):typeof l=="number"?h(l):(0,t.default)(!1,`"${l}" is not a valid destination reference.`)}).then(h=>{const u=h+1;(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),(0,t.default)(u>=1&&u<=this.pagesCount,`"${u}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:o,pageIndex:h,pageNumber:u})})})}navigateTo(s){this.goToDestination(s)}goToPage(s){const o=s-1;(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),(0,t.default)(s>=1&&s<=this.pagesCount,`"${s}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:o,pageNumber:s})}addLinkAttributes(s,o,l){s.href=o,s.rel=this.externalLinkRel||e,s.target=l?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}};return fy.default=n,fy}var w_={},EM;function BN(){if(EM)return w_;EM=1,Object.defineProperty(w_,"__esModule",{value:!0});const p={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};return w_.default=p,w_}var E_={},SM;function ho(){return SM||(SM=1,function(p){var t=E_.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(p,"__esModule",{value:!0}),p.isLocalFileSystem=p.isBrowser=void 0,p.isDefined=i,p.isProvided=s,p.isString=o,p.isArrayBuffer=l,p.isBlob=h,p.isDataURI=u,p.dataURItoByteString=f,p.getDevicePixelRatio=g,p.displayCORSWarning=A,p.displayWorkerWarning=_,p.cancelRunningTask=S,p.makePageCallback=C,p.isCancelException=T,p.loadFromFile=k;const e=t(fa()),n=t(Mh());p.isBrowser=typeof window<"u",p.isLocalFileSystem=p.isBrowser&&window.location.protocol==="file:";function i(P){return typeof P<"u"}function s(P){return i(P)&&P!==null}function o(P){return typeof P=="string"}function l(P){return P instanceof ArrayBuffer}function h(P){return(0,e.default)(p.isBrowser,"isBlob can only be used in a browser environment"),P instanceof Blob}function u(P){return o(P)&&/^data:/.test(P)}function f(P){(0,e.default)(u(P),"Invalid data URI.");const[L="",I=""]=P.split(",");return L.split(";").indexOf("base64")!==-1?atob(I):unescape(I)}function g(){return p.isBrowser&&window.devicePixelRatio||1}const m="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function A(){(0,n.default)(!p.isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${m}`)}function _(){(0,n.default)(!p.isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${m}`)}function S(P){P!=null&&P.cancel&&P.cancel()}function C(P,L){return Object.defineProperty(P,"width",{get(){return this.view[2]*L},configurable:!0}),Object.defineProperty(P,"height",{get(){return this.view[3]*L},configurable:!0}),Object.defineProperty(P,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(P,"originalHeight",{get(){return this.view[3]},configurable:!0}),P}function T(P){return P.name==="RenderingCancelledException"}function k(P){return new Promise((L,I)=>{const D=new FileReader;D.onload=()=>{if(!D.result)return I(new Error("Error while reading a file."));L(D.result)},D.onerror=F=>{if(!F.target)return I(new Error("Error while reading a file."));const{error:H}=F.target;if(!H)return I(new Error("Error while reading a file."));switch(H.code){case H.NOT_FOUND_ERR:return I(new Error("Error while reading a file: File not found."));case H.SECURITY_ERR:return I(new Error("Error while reading a file: Security error."));case H.ABORT_ERR:return I(new Error("Error while reading a file: Aborted."));default:return I(new Error("Error while reading a file."))}},D.readAsArrayBuffer(P)})}}(E_)),E_}var S_={},xM;function bm(){if(xM)return S_;xM=1,Object.defineProperty(S_,"__esModule",{value:!0}),S_.default=e;const p=kn();function t(n,i){switch(i.type){case"RESOLVE":return{value:i.value,error:void 0};case"REJECT":return{value:!1,error:i.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function e(){return(0,p.useReducer)(t,{value:void 0,error:void 0})}return S_}var CM;function BU(){if(CM)return Sa;CM=1;var p=Sa.__createBinding||(Object.create?function(j,Q,W,tt){tt===void 0&&(tt=W);var Z=Object.getOwnPropertyDescriptor(Q,W);(!Z||("get"in Z?!Q.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return Q[W]}}),Object.defineProperty(j,tt,Z)}:function(j,Q,W,tt){tt===void 0&&(tt=W),j[tt]=Q[W]}),t=Sa.__setModuleDefault||(Object.create?function(j,Q){Object.defineProperty(j,"default",{enumerable:!0,value:Q})}:function(j,Q){j.default=Q}),e=Sa.__importStar||function(j){if(j&&j.__esModule)return j;var Q={};if(j!=null)for(var W in j)W!=="default"&&Object.prototype.hasOwnProperty.call(j,W)&&p(Q,j,W);return t(Q,j),Q},n=Sa.__awaiter||function(j,Q,W,tt){function Z(et){return et instanceof W?et:new W(function(ht){ht(et)})}return new(W||(W=Promise))(function(et,ht){function J(U){try{q(tt.next(U))}catch(N){ht(N)}}function G(U){try{q(tt.throw(U))}catch(N){ht(N)}}function q(U){U.done?et(U.value):Z(U.value).then(J,G)}q((tt=tt.apply(j,Q||[])).next())})},i=Sa.__rest||function(j,Q){var W={};for(var tt in j)Object.prototype.hasOwnProperty.call(j,tt)&&Q.indexOf(tt)<0&&(W[tt]=j[tt]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Z=0,tt=Object.getOwnPropertySymbols(j);Z<tt.length;Z++)Q.indexOf(tt[Z])<0&&Object.prototype.propertyIsEnumerable.call(j,tt[Z])&&(W[tt[Z]]=j[tt[Z]]);return W},s=Sa.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(Sa,"__esModule",{value:!0});const o=Er(),l=kn(),h=s(uk()),u=s(vm()),f=s(Am()),g=s(fa()),m=s(Mh()),A=jU(),_=e(Xb),S=s(jN()),C=s(HN()),T=s(HU()),k=s(BN()),P=ho(),L=s(bm()),{PDFDataRangeTransport:I}=_,D=(j,Q)=>{switch(Q){case k.default.NEED_PASSWORD:{const W=prompt("Enter the password to open this PDF file.");j(W);break}case k.default.INCORRECT_PASSWORD:{const W=prompt("Invalid password. Please try again.");j(W);break}}};function F(j){return typeof j=="object"&&j!==null&&("data"in j||"range"in j||"url"in j)}const H=(0,l.forwardRef)(function(Q,W){var{children:tt,className:Z,error:et="Failed to load PDF file.",externalLinkRel:ht,externalLinkTarget:J,file:G,inputRef:q,imageResourcesPath:U,loading:N="Loading PDF",noData:M="No PDF file specified.",onItemClick:B,onLoadError:Y,onLoadProgress:it,onLoadSuccess:dt,onPassword:at=D,onSourceError:nt,onSourceSuccess:yt,options:ut,renderMode:St,rotate:Kt}=Q,Ee=i(Q,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[Me,Se]=(0,L.default)(),{value:rn,error:oi}=Me,[li,Sr]=(0,L.default)(),{value:an,error:qs}=li,Pi=(0,l.useRef)(new T.default),ds=(0,l.useRef)([]),pa=(0,l.useRef)(void 0),xr=(0,l.useRef)(void 0);G&&G!==pa.current&&F(G)&&((0,m.default)(!(0,A.dequal)(G,pa.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),pa.current=G),ut&&ut!==xr.current&&((0,m.default)(!(0,A.dequal)(ut,xr.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),xr.current=ut);const uo=(0,l.useRef)({scrollPageIntoView:Ke=>{const{dest:Vn,pageNumber:Ri,pageIndex:Pn=Ri-1}=Ke;if(B){B({dest:Vn,pageIndex:Pn,pageNumber:Ri});return}const ps=ds.current[Pn];if(ps){ps.scrollIntoView();return}(0,m.default)(!1,`An internal link leading to page ${Ri} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});(0,l.useImperativeHandle)(W,()=>({linkService:Pi,pages:ds,viewer:uo}),[]);function fo(){yt&&yt()}function Hl(){oi&&((0,m.default)(!1,oi.toString()),nt&&nt(oi))}function Bl(){Se({type:"RESET"})}(0,l.useEffect)(Bl,[G,Se]);const Cr=(0,l.useCallback)(()=>n(this,void 0,void 0,function*(){if(!G)return null;if(typeof G=="string")return(0,P.isDataURI)(G)?{data:(0,P.dataURItoByteString)(G)}:((0,P.displayCORSWarning)(),{url:G});if(G instanceof I)return{range:G};if((0,P.isArrayBuffer)(G))return{data:G};if(P.isBrowser&&(0,P.isBlob)(G))return{data:yield(0,P.loadFromFile)(G)};if((0,g.default)(typeof G=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),(0,g.default)(F(G),"Invalid parameter object: need either .data, .range or .url"),"url"in G&&typeof G.url=="string"){if((0,P.isDataURI)(G.url)){const{url:Ke}=G,Vn=i(G,["url"]),Ri=(0,P.dataURItoByteString)(Ke);return Object.assign({data:Ri},Vn)}(0,P.displayCORSWarning)()}return G}),[G]);(0,l.useEffect)(()=>{const Ke=(0,u.default)(Cr());return Ke.promise.then(Vn=>{Se({type:"RESOLVE",value:Vn})}).catch(Vn=>{Se({type:"REJECT",error:Vn})}),()=>{(0,P.cancelRunningTask)(Ke)}},[Cr,Se]),(0,l.useEffect)(()=>{if(!(typeof rn>"u")){if(rn===!1){Hl();return}fo()}},[rn]);function me(){an&&(dt&&dt(an),ds.current=new Array(an.numPages),Pi.current.setDocument(an))}function Tr(){qs&&((0,m.default)(!1,qs.toString()),Y&&Y(qs))}(0,l.useEffect)(function(){Sr({type:"RESET"})},[Sr,rn]),(0,l.useEffect)(function(){if(!rn)return;const Vn=ut?Object.assign(Object.assign({},rn),ut):rn,Ri=_.getDocument(Vn);it&&(Ri.onProgress=it),at&&(Ri.onPassword=at);const Pn=Ri,ps=Pn.promise.then(Ul=>{Sr({type:"RESOLVE",value:Ul})}).catch(Ul=>{Pn.destroyed||Sr({type:"REJECT",error:Ul})});return()=>{ps.finally(()=>Pn.destroy())}},[ut,Sr,rn]),(0,l.useEffect)(()=>{if(!(typeof an>"u")){if(an===!1){Tr();return}me()}},[an]),(0,l.useEffect)(function(){Pi.current.setViewer(uo.current),Pi.current.setExternalLinkRel(ht),Pi.current.setExternalLinkTarget(J)},[ht,J]);const zl=(0,l.useCallback)((Ke,Vn)=>{ds.current[Ke]=Vn},[]),ci=(0,l.useCallback)(Ke=>{delete ds.current[Ke]},[]),fs=(0,l.useMemo)(()=>({imageResourcesPath:U,linkService:Pi.current,onItemClick:B,pdf:an,registerPage:zl,renderMode:St,rotate:Kt,unregisterPage:ci}),[U,B,an,zl,St,Kt,ci]),ga=(0,l.useMemo)(()=>(0,h.default)(Ee,()=>an),[Ee,an]);function Wn(){return(0,o.jsx)(S.default.Provider,{value:fs,children:tt})}function Ih(){return G?an==null?(0,o.jsx)(C.default,{type:"loading",children:typeof N=="function"?N():N}):an===!1?(0,o.jsx)(C.default,{type:"error",children:typeof et=="function"?et():et}):Wn():(0,o.jsx)(C.default,{type:"no-data",children:typeof M=="function"?M():M})}return(0,o.jsx)("div",Object.assign({className:(0,f.default)("react-pdf__Document",Z),ref:q,style:{"--scale-factor":"1"}},ga,{children:Ih()}))});return Sa.default=H,Sa}var Gf={},x_={},TM;function zN(){if(TM)return x_;TM=1,Object.defineProperty(x_,"__esModule",{value:!0});const t=(0,kn().createContext)(null);return x_.default=t,x_}var Xh={},C_={},kM;function zU(){if(kM)return C_;kM=1,Object.defineProperty(C_,"__esModule",{value:!0});let p=class{constructor({num:e,gen:n}){this.num=e,this.gen=n}toString(){let e=`${this.num}R`;return this.gen!==0&&(e+=this.gen),e}};return C_.default=p,C_}var T_={},PM;function UU(){if(PM)return T_;PM=1,Object.defineProperty(T_,"__esModule",{value:!0}),T_.default=e;const p=kn(),t=ho();function e(n){const i=(0,p.useRef)(void 0),s=i.current;return(0,t.isDefined)(s)?()=>s:()=>{const o=n();return i.current=o,o}}return T_}var py={},RM;function _m(){if(RM)return py;RM=1;var p=py.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(py,"__esModule",{value:!0}),py.default=n;const t=kn(),e=p(jN());function n(){return(0,t.useContext)(e.default)}return py}var gy={},LM;function UN(){if(LM)return gy;LM=1;var p=gy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(gy,"__esModule",{value:!0}),gy.default=n;const t=kn(),e=p(zN());function n(){return(0,t.useContext)(e.default)}return gy}var MM;function GU(){if(MM)return Xh;MM=1;var p=Xh.__awaiter||function(f,g,m,A){function _(S){return S instanceof m?S:new m(function(C){C(S)})}return new(m||(m=Promise))(function(S,C){function T(L){try{P(A.next(L))}catch(I){C(I)}}function k(L){try{P(A.throw(L))}catch(I){C(I)}}function P(L){L.done?S(L.value):_(L.value).then(T,k)}P((A=A.apply(f,g||[])).next())})},t=Xh.__rest||function(f,g){var m={};for(var A in f)Object.prototype.hasOwnProperty.call(f,A)&&g.indexOf(A)<0&&(m[A]=f[A]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,A=Object.getOwnPropertySymbols(f);_<A.length;_++)g.indexOf(A[_])<0&&Object.prototype.propertyIsEnumerable.call(f,A[_])&&(m[A[_]]=f[A[_]]);return m},e=Xh.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Xh,"__esModule",{value:!0}),Xh.default=u;const n=Er(),i=e(fa()),s=e(zU()),o=e(UU()),l=e(_m()),h=e(UN());function u(f){const g=(0,l.default)(),m=(0,h.default)();(0,i.default)(m,"Unable to find Outline context.");const A=Object.assign(Object.assign(Object.assign({},g),m),f),{item:_,linkService:S,onItemClick:C,pdf:T}=A,k=t(A,["item","linkService","onItemClick","pdf"]);(0,i.default)(T,"Attempted to load an outline, but no document was specified. Wrap <Outline /> in a <Document /> or pass explicit `pdf` prop.");const P=(0,o.default)(()=>typeof _.dest=="string"?T.getDestination(_.dest):_.dest),L=(0,o.default)(()=>p(this,void 0,void 0,function*(){const H=yield P();if(!H)throw new Error("Destination not found.");const[j]=H;return T.getPageIndex(new s.default(j))})),I=(0,o.default)(()=>p(this,void 0,void 0,function*(){return(yield L())+1}));function D(H){H.preventDefault(),(0,i.default)(C||S,"Either onItemClick callback or linkService must be defined in order to navigate to an outline item."),C?Promise.all([P(),L(),I()]).then(([j,Q,W])=>{C({dest:j,pageIndex:Q,pageNumber:W})}):S&&S.goToDestination(_.dest)}function F(){if(!_.items||!_.items.length)return null;const{items:H}=_;return(0,n.jsx)("ul",{children:H.map((j,Q)=>(0,n.jsx)(u,Object.assign({item:j,pdf:T},k),typeof j.dest=="string"?j.dest:Q))})}return(0,n.jsxs)("li",{children:[(0,n.jsx)("a",{href:"#",onClick:D,children:_.title}),F()]})}return Xh}var IM;function WU(){if(IM)return Gf;IM=1;var p=Gf.__rest||function(S,C){var T={};for(var k in S)Object.prototype.hasOwnProperty.call(S,k)&&C.indexOf(k)<0&&(T[k]=S[k]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,k=Object.getOwnPropertySymbols(S);P<k.length;P++)C.indexOf(k[P])<0&&Object.prototype.propertyIsEnumerable.call(S,k[P])&&(T[k[P]]=S[k[P]]);return T},t=Gf.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.default=_;const e=Er(),n=kn(),i=t(vm()),s=t(uk()),o=t(Am()),l=t(fa()),h=t(Mh()),u=t(zN()),f=t(GU()),g=ho(),m=t(_m()),A=t(bm());function _(S){const C=(0,m.default)(),T=Object.assign(Object.assign({},C),S),{className:k,inputRef:P,onItemClick:L,onLoadError:I,onLoadSuccess:D,pdf:F}=T,H=p(T,["className","inputRef","onItemClick","onLoadError","onLoadSuccess","pdf"]);(0,l.default)(F,"Attempted to load an outline, but no document was specified. Wrap <Outline /> in a <Document /> or pass explicit `pdf` prop.");const[j,Q]=(0,A.default)(),{value:W,error:tt}=j;function Z(){typeof W>"u"||W===!1||D&&D(W)}function et(){tt&&((0,h.default)(!1,tt.toString()),I&&I(tt))}(0,n.useEffect)(function(){Q({type:"RESET"})},[Q,F]),(0,n.useEffect)(function(){if(!F)return;const U=(0,i.default)(F.getOutline()),N=U;return U.promise.then(M=>{Q({type:"RESOLVE",value:M})}).catch(M=>{Q({type:"REJECT",error:M})}),()=>(0,g.cancelRunningTask)(N)},[Q,F]),(0,n.useEffect)(()=>{if(W!==void 0){if(W===!1){et();return}Z()}},[W]);const ht=(0,n.useMemo)(()=>({onItemClick:L}),[L]),J=(0,n.useMemo)(()=>(0,s.default)(H,()=>W),[H,W]);if(!W)return null;function G(){return W?(0,e.jsx)("ul",{children:W.map((q,U)=>(0,e.jsx)(f.default,{item:q,pdf:F},typeof q.dest=="string"?q.dest:U))}):null}return(0,e.jsx)("div",Object.assign({className:(0,o.default)("react-pdf__Outline",k),ref:P},J,{children:(0,e.jsx)(u.default.Provider,{value:ht,children:G()})}))}return Gf}var Wf={},k_={},DM;function GN(){if(DM)return k_;DM=1,Object.defineProperty(k_,"__esModule",{value:!0});function p(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter(Boolean);if(n.length<=1){var i=n[0];return i||null}return function(o){n.forEach(function(l){typeof l=="function"?l(o):l&&(l.current=o)})}}return k_.default=p,k_}var P_={},FM;function WN(){if(FM)return P_;FM=1,Object.defineProperty(P_,"__esModule",{value:!0});const t=(0,kn().createContext)(null);return P_.default=t,P_}var hc={},my={},R_={},Co={},Yh={},OM;function VU(){return OM||(OM=1,Object.defineProperty(Yh,"__esModule",{value:!0}),Yh.HEADING_PATTERN=Yh.PDF_ROLE_TO_HTML_ROLE=void 0,Yh.PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Yh.HEADING_PATTERN=/^H(\d+)$/),Yh}var NM;function qU(){if(NM)return Co;NM=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.isPdfRole=t,Co.isStructTreeNode=e,Co.isStructTreeNodeWithOnlyContentChild=n,Co.getRoleAttributes=i,Co.getBaseAttributes=s,Co.getAttributes=o;const p=VU();function t(l){return l in p.PDF_ROLE_TO_HTML_ROLE}function e(l){return"children"in l}function n(l){return e(l)?l.children.length===1&&0 in l.children&&"id"in l.children[0]:!1}function i(l){const h={};if(e(l)){const{role:u}=l,f=u.match(p.HEADING_PATTERN);if(f)h.role="heading",h["aria-level"]=Number(f[1]);else if(t(u)){const g=p.PDF_ROLE_TO_HTML_ROLE[u];g&&(h.role=g)}}return h}function s(l){const h={};if(e(l)){if(l.alt!==void 0&&(h["aria-label"]=l.alt),l.lang!==void 0&&(h.lang=l.lang),n(l)){const[u]=l.children;if(u){const f=s(u);return Object.assign(Object.assign({},h),f)}}}else"id"in l&&(h["aria-owns"]=l.id);return h}function o(l){return l?Object.assign(Object.assign({},i(l)),s(l)):null}return Co}var $M;function XU(){if($M)return R_;$M=1,Object.defineProperty(R_,"__esModule",{value:!0}),R_.default=n;const p=Er(),t=kn(),e=qU();function n({className:i,node:s}){const o=(0,t.useMemo)(()=>(0,e.getAttributes)(s),[s]),l=(0,t.useMemo)(()=>!(0,e.isStructTreeNode)(s)||(0,e.isStructTreeNodeWithOnlyContentChild)(s)?null:s.children.map((h,u)=>(0,p.jsx)(n,{node:h},u)),[s]);return(0,p.jsx)("span",Object.assign({className:i},o,{children:l}))}return R_}var yy={},jM;function Yb(){if(jM)return yy;jM=1;var p=yy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(yy,"__esModule",{value:!0}),yy.default=n;const t=kn(),e=p(WN());function n(){return(0,t.useContext)(e.default)}return yy}var HM;function YU(){if(HM)return my;HM=1;var p=my.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(my,"__esModule",{value:!0}),my.default=f;const t=Er(),e=kn(),n=p(vm()),i=p(fa()),s=p(Mh()),o=p(XU()),l=p(Yb()),h=p(bm()),u=ho();function f(){const g=(0,l.default)();(0,i.default)(g,"Unable to find Page context.");const{onGetStructTreeError:m,onGetStructTreeSuccess:A}=g,[_,S]=(0,h.default)(),{value:C,error:T}=_,{customTextRenderer:k,page:P}=g;function L(){C&&A&&A(C)}function I(){T&&((0,s.default)(!1,T.toString()),m&&m(T))}return(0,e.useEffect)(function(){S({type:"RESET"})},[S,P]),(0,e.useEffect)(function(){if(k||!P)return;const F=(0,n.default)(P.getStructTree()),H=F;return F.promise.then(j=>{S({type:"RESOLVE",value:j})}).catch(j=>{S({type:"REJECT",error:j})}),()=>(0,u.cancelRunningTask)(H)},[k,P,S]),(0,e.useEffect)(()=>{if(C!==void 0){if(C===!1){I();return}L()}},[C]),C?(0,t.jsx)(o.default,{className:"react-pdf__Page__structTree structTree",node:C}):null}return my}var BM;function KU(){if(BM)return hc;BM=1;var p=hc.__createBinding||(Object.create?function(S,C,T,k){k===void 0&&(k=T);var P=Object.getOwnPropertyDescriptor(C,T);(!P||("get"in P?!C.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return C[T]}}),Object.defineProperty(S,k,P)}:function(S,C,T,k){k===void 0&&(k=T),S[k]=C[T]}),t=hc.__setModuleDefault||(Object.create?function(S,C){Object.defineProperty(S,"default",{enumerable:!0,value:C})}:function(S,C){S.default=C}),e=hc.__importStar||function(S){if(S&&S.__esModule)return S;var C={};if(S!=null)for(var T in S)T!=="default"&&Object.prototype.hasOwnProperty.call(S,T)&&p(C,S,T);return t(C,S),C},n=hc.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(hc,"__esModule",{value:!0}),hc.default=_;const i=Er(),s=kn(),o=n(GN()),l=n(fa()),h=n(Mh()),u=e(Xb),f=n(YU()),g=n(Yb()),m=ho(),A=u.AnnotationMode;function _(S){const C=(0,g.default)();(0,l.default)(C,"Unable to find Page context.");const T=Object.assign(Object.assign({},C),S),{_className:k,canvasBackground:P,devicePixelRatio:L=(0,m.getDevicePixelRatio)(),onRenderError:I,onRenderSuccess:D,page:F,renderForms:H,renderTextLayer:j,rotate:Q,scale:W}=T,{canvasRef:tt}=S;(0,l.default)(F,"Attempted to render page canvas, but no page was specified.");const Z=(0,s.useRef)(null);function et(){F&&D&&D((0,m.makePageCallback)(F,W))}function ht(U){(0,m.isCancelException)(U)||((0,h.default)(!1,U.toString()),I&&I(U))}const J=(0,s.useMemo)(()=>F.getViewport({scale:W*L,rotation:Q}),[L,F,Q,W]),G=(0,s.useMemo)(()=>F.getViewport({scale:W,rotation:Q}),[F,Q,W]);(0,s.useEffect)(function(){if(!F)return;F.cleanup();const{current:N}=Z;if(!N)return;N.width=J.width,N.height=J.height,N.style.width=`${Math.floor(G.width)}px`,N.style.height=`${Math.floor(G.height)}px`,N.style.visibility="hidden";const M={annotationMode:H?A.ENABLE_FORMS:A.ENABLE,canvasContext:N.getContext("2d",{alpha:!1}),viewport:J};P&&(M.background=P);const B=F.render(M),Y=B;return B.promise.then(()=>{N.style.visibility="",et()}).catch(ht),()=>(0,m.cancelRunningTask)(Y)},[P,F,H,J,G]);const q=(0,s.useCallback)(()=>{const{current:U}=Z;U&&(U.width=0,U.height=0)},[]);return(0,s.useEffect)(()=>q,[q]),(0,i.jsx)("canvas",{className:`${k}__canvas`,dir:"ltr",ref:(0,o.default)(tt,Z),style:{display:"block",userSelect:"none"},children:j?(0,i.jsx)(f.default,{}):null})}return hc}var uc={},zM;function QU(){if(zM)return uc;zM=1;var p=uc.__createBinding||(Object.create?function(C,T,k,P){P===void 0&&(P=k);var L=Object.getOwnPropertyDescriptor(T,k);(!L||("get"in L?!T.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return T[k]}}),Object.defineProperty(C,P,L)}:function(C,T,k,P){P===void 0&&(P=k),C[P]=T[k]}),t=uc.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),e=uc.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var k in C)k!=="default"&&Object.prototype.hasOwnProperty.call(C,k)&&p(T,C,k);return t(T,C),T},n=uc.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(uc,"__esModule",{value:!0}),uc.default=S;const i=Er(),s=kn(),o=n(vm()),l=n(Am()),h=n(fa()),u=n(Mh()),f=e(Xb),g=n(Yb()),m=n(bm()),A=ho();function _(C){return"str"in C}function S(){const C=(0,g.default)();(0,h.default)(C,"Unable to find Page context.");const{customTextRenderer:T,onGetTextError:k,onGetTextSuccess:P,onRenderTextLayerError:L,onRenderTextLayerSuccess:I,page:D,pageIndex:F,pageNumber:H,rotate:j,scale:Q}=C;(0,h.default)(D,"Attempted to load page text content, but no page was specified.");const[W,tt]=(0,m.default)(),{value:Z,error:et}=W,ht=(0,s.useRef)(null);(0,u.default)(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function J(){Z&&P&&P(Z)}function G(){et&&((0,u.default)(!1,et.toString()),k&&k(et))}(0,s.useEffect)(function(){tt({type:"RESET"})},[D,tt]),(0,s.useEffect)(function(){if(!D)return;const it=(0,o.default)(D.getTextContent()),dt=it;return it.promise.then(at=>{tt({type:"RESOLVE",value:at})}).catch(at=>{tt({type:"REJECT",error:at})}),()=>(0,A.cancelRunningTask)(dt)},[D,tt]),(0,s.useEffect)(()=>{if(Z!==void 0){if(Z===!1){G();return}J()}},[Z]);const q=(0,s.useCallback)(()=>{I&&I()},[I]),U=(0,s.useCallback)(Y=>{(0,u.default)(!1,Y.toString()),L&&L(Y)},[L]);function N(){const Y=ht.current;Y&&Y.classList.add("selecting")}function M(){const Y=ht.current;Y&&Y.classList.remove("selecting")}const B=(0,s.useMemo)(()=>D.getViewport({scale:Q,rotation:j}),[D,j,Q]);return(0,s.useLayoutEffect)(function(){if(!D||!Z)return;const{current:it}=ht;if(!it)return;it.innerHTML="";const dt=D.streamTextContent({includeMarkedContent:!0}),at={container:it,textContentSource:dt,viewport:B},nt=new f.TextLayer(at),yt=nt;return nt.render().then(()=>{const ut=document.createElement("div");ut.className="endOfContent",it.append(ut);const St=it.querySelectorAll('[role="presentation"]');if(T){let Kt=0;Z.items.forEach((Ee,Me)=>{if(!_(Ee))return;const Se=St[Kt];if(!Se)return;const rn=T(Object.assign({pageIndex:F,pageNumber:H,itemIndex:Me},Ee));Se.innerHTML=rn,Kt+=Ee.str&&Ee.hasEOL?2:1})}q()}).catch(U),()=>(0,A.cancelRunningTask)(yt)},[T,U,q,D,F,H,Z,B]),(0,i.jsx)("div",{className:(0,l.default)("react-pdf__Page__textContent","textLayer"),onMouseUp:M,onMouseDown:N,ref:ht})}return uc}var dc={},UM;function JU(){if(UM)return dc;UM=1;var p=dc.__createBinding||(Object.create?function(C,T,k,P){P===void 0&&(P=k);var L=Object.getOwnPropertyDescriptor(T,k);(!L||("get"in L?!T.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return T[k]}}),Object.defineProperty(C,P,L)}:function(C,T,k,P){P===void 0&&(P=k),C[P]=T[k]}),t=dc.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),e=dc.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var k in C)k!=="default"&&Object.prototype.hasOwnProperty.call(C,k)&&p(T,C,k);return t(T,C),T},n=dc.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(dc,"__esModule",{value:!0}),dc.default=S;const i=Er(),s=kn(),o=n(vm()),l=n(Am()),h=n(fa()),u=n(Mh()),f=e(Xb),g=n(_m()),m=n(Yb()),A=n(bm()),_=ho();function S(){const C=(0,g.default)(),T=(0,m.default)();(0,h.default)(T,"Unable to find Page context.");const k=Object.assign(Object.assign({},C),T),{imageResourcesPath:P,linkService:L,onGetAnnotationsError:I,onGetAnnotationsSuccess:D,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:H,page:j,pdf:Q,renderForms:W,rotate:tt,scale:Z=1}=k;(0,h.default)(Q,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),(0,h.default)(j,"Attempted to load page annotations, but no page was specified."),(0,h.default)(L,"Attempted to load page annotations, but no linkService was specified.");const[et,ht]=(0,A.default)(),{value:J,error:G}=et,q=(0,s.useRef)(null);(0,u.default)(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function U(){J&&D&&D(J)}function N(){G&&((0,u.default)(!1,G.toString()),I&&I(G))}(0,s.useEffect)(function(){ht({type:"RESET"})},[ht,j]),(0,s.useEffect)(function(){if(!j)return;const dt=(0,o.default)(j.getAnnotations()),at=dt;return dt.promise.then(nt=>{ht({type:"RESOLVE",value:nt})}).catch(nt=>{ht({type:"REJECT",error:nt})}),()=>{(0,_.cancelRunningTask)(at)}},[ht,j]),(0,s.useEffect)(()=>{if(J!==void 0){if(J===!1){N();return}U()}},[J]);function M(){H&&H()}function B(it){(0,u.default)(!1,`${it}`),F&&F(it)}const Y=(0,s.useMemo)(()=>j.getViewport({scale:Z,rotation:tt}),[j,tt,Z]);return(0,s.useEffect)(function(){if(!Q||!j||!L||!J)return;const{current:dt}=q;if(!dt)return;const at=Y.clone({dontFlip:!0}),nt={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:dt,l10n:null,page:j,structTreeLayer:null,viewport:at},yt={annotations:J,annotationStorage:Q.annotationStorage,div:dt,imageResourcesPath:P,linkService:L,page:j,renderForms:W,viewport:at};dt.innerHTML="";try{new f.AnnotationLayer(nt).render(yt),M()}catch(ut){B(ut)}return()=>{}},[J,P,L,j,Q,W,Y]),(0,i.jsx)("div",{className:(0,l.default)("react-pdf__Page__annotations","annotationLayer"),ref:q})}return dc}var GM;function VN(){if(GM)return Wf;GM=1;var p=Wf.__rest||function(L,I){var D={};for(var F in L)Object.prototype.hasOwnProperty.call(L,F)&&I.indexOf(F)<0&&(D[F]=L[F]);if(L!=null&&typeof Object.getOwnPropertySymbols=="function")for(var H=0,F=Object.getOwnPropertySymbols(L);H<F.length;H++)I.indexOf(F[H])<0&&Object.prototype.propertyIsEnumerable.call(L,F[H])&&(D[F[H]]=L[F[H]]);return D},t=Wf.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.default=P;const e=Er(),n=kn(),i=t(vm()),s=t(uk()),o=t(Am()),l=t(GN()),h=t(fa()),u=t(Mh()),f=t(WN()),g=t(HN()),m=t(KU()),A=t(QU()),_=t(JU()),S=ho(),C=t(_m()),T=t(bm()),k=1;function P(L){const I=(0,C.default)(),D=Object.assign(Object.assign({},I),L),{_className:F="react-pdf__Page",_enableRegisterUnregisterPage:H=!0,canvasBackground:j,canvasRef:Q,children:W,className:tt,customRenderer:Z,customTextRenderer:et,devicePixelRatio:ht,error:J="Failed to load the page.",height:G,inputRef:q,loading:U="Loading page",noData:N="No page specified.",onGetAnnotationsError:M,onGetAnnotationsSuccess:B,onGetStructTreeError:Y,onGetStructTreeSuccess:it,onGetTextError:dt,onGetTextSuccess:at,onLoadError:nt,onLoadSuccess:yt,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:St,onRenderError:Kt,onRenderSuccess:Ee,onRenderTextLayerError:Me,onRenderTextLayerSuccess:Se,pageIndex:rn,pageNumber:oi,pdf:li,registerPage:Sr,renderAnnotationLayer:an=!0,renderForms:qs=!1,renderMode:Pi="canvas",renderTextLayer:ds=!0,rotate:pa,scale:xr=k,unregisterPage:uo,width:fo}=D,Hl=p(D,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Bl,Cr]=(0,T.default)(),{value:me,error:Tr}=Bl,zl=(0,n.useRef)(null);(0,h.default)(li,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const ci=(0,S.isProvided)(oi)?oi-1:rn??null,fs=oi??((0,S.isProvided)(rn)?rn+1:null),ga=pa??(me?me.rotate:null),Wn=(0,n.useMemo)(()=>{if(!me)return null;let po=1;const Gl=xr??k;if(fo||G){const Dh=me.getViewport({scale:1,rotation:ga});fo?po=fo/Dh.width:G&&(po=G/Dh.height)}return Gl*po},[G,me,ga,xr,fo]);(0,n.useEffect)(function(){return()=>{(0,S.isProvided)(ci)&&H&&uo&&uo(ci)}},[H,li,ci,uo]);function Ih(){if(yt){if(!me||!Wn)return;yt((0,S.makePageCallback)(me,Wn))}if(H&&Sr){if(!(0,S.isProvided)(ci)||!zl.current)return;Sr(ci,zl.current)}}function Ke(){Tr&&((0,u.default)(!1,Tr.toString()),nt&&nt(Tr))}(0,n.useEffect)(function(){Cr({type:"RESET"})},[Cr,li,ci]),(0,n.useEffect)(function(){if(!li||!fs)return;const Gl=(0,i.default)(li.getPage(fs)),Dh=Gl;return Gl.promise.then(go=>{Cr({type:"RESOLVE",value:go})}).catch(go=>{Cr({type:"REJECT",error:go})}),()=>(0,S.cancelRunningTask)(Dh)},[Cr,li,fs]),(0,n.useEffect)(()=>{if(me!==void 0){if(me===!1){Ke();return}Ih()}},[me,Wn]);const Vn=(0,n.useMemo)(()=>me&&(0,S.isProvided)(ci)&&fs&&(0,S.isProvided)(ga)&&(0,S.isProvided)(Wn)?{_className:F,canvasBackground:j,customTextRenderer:et,devicePixelRatio:ht,onGetAnnotationsError:M,onGetAnnotationsSuccess:B,onGetStructTreeError:Y,onGetStructTreeSuccess:it,onGetTextError:dt,onGetTextSuccess:at,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:St,onRenderError:Kt,onRenderSuccess:Ee,onRenderTextLayerError:Me,onRenderTextLayerSuccess:Se,page:me,pageIndex:ci,pageNumber:fs,renderForms:qs,renderTextLayer:ds,rotate:ga,scale:Wn}:null,[F,j,et,ht,M,B,Y,it,dt,at,ut,St,Kt,Ee,Me,Se,me,ci,fs,qs,ds,ga,Wn]),Ri=(0,n.useMemo)(()=>(0,s.default)(Hl,()=>me&&(Wn?(0,S.makePageCallback)(me,Wn):void 0)),[Hl,me,Wn]),Pn=`${ci}@${Wn}/${ga}`;function ps(){switch(Pi){case"custom":return(0,h.default)(Z,'renderMode was set to "custom", but no customRenderer was passed.'),(0,e.jsx)(Z,{},`${Pn}_custom`);case"none":return null;case"canvas":default:return(0,e.jsx)(m.default,{canvasRef:Q},`${Pn}_canvas`)}}function Ul(){return ds?(0,e.jsx)(A.default,{},`${Pn}_text`):null}function Kb(){return an?(0,e.jsx)(_.default,{},`${Pn}_annotations`):null}function Qb(){return(0,e.jsxs)(f.default.Provider,{value:Vn,children:[ps(),Ul(),Kb(),W]})}function Jb(){return fs?li===null||me===void 0||me===null?(0,e.jsx)(g.default,{type:"loading",children:typeof U=="function"?U():U}):li===!1||me===!1?(0,e.jsx)(g.default,{type:"error",children:typeof J=="function"?J():J}):Qb():(0,e.jsx)(g.default,{type:"no-data",children:typeof N=="function"?N():N})}return(0,e.jsx)("div",Object.assign({className:(0,o.default)(F,tt),"data-page-number":fs,ref:(0,l.default)(q,zl),style:{"--scale-factor":`${Wn}`,backgroundColor:j||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Ri,{children:Jb()}))}return Wf}var Vf={},WM;function ZU(){if(WM)return Vf;WM=1;var p=Vf.__rest||function(u,f){var g={};for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&f.indexOf(m)<0&&(g[m]=u[m]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var A=0,m=Object.getOwnPropertySymbols(u);A<m.length;A++)f.indexOf(m[A])<0&&Object.prototype.propertyIsEnumerable.call(u,m[A])&&(g[m[A]]=u[m[A]]);return g},t=Vf.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.default=h;const e=Er(),n=t(Am()),i=t(fa()),s=t(VN()),o=ho(),l=t(_m());function h(u){const f=(0,l.default)(),g=Object.assign(Object.assign({},f),u),{className:m,linkService:A,onItemClick:_,pageIndex:S,pageNumber:C,pdf:T}=g;(0,i.default)(T,"Attempted to load a thumbnail, but no document was specified. Wrap <Thumbnail /> in a <Document /> or pass explicit `pdf` prop.");const k=(0,o.isProvided)(C)?C-1:S??null,P=C??((0,o.isProvided)(S)?S+1:null);function L(D){D.preventDefault(),!(!(0,o.isProvided)(k)||!P)&&((0,i.default)(_||A,"Either onItemClick callback or linkService must be defined in order to navigate to an outline item."),_?_({pageIndex:k,pageNumber:P}):A&&A.goToPage(P))}const I=p(u,["className","onItemClick"]);return(0,e.jsx)("a",{className:(0,n.default)("react-pdf__Thumbnail",m),href:P?"#":void 0,onClick:L,children:(0,e.jsx)(s.default,Object.assign({},I,{_className:"react-pdf__Thumbnail__page",_enableRegisterUnregisterPage:!1,renderAnnotationLayer:!1,renderTextLayer:!1}))})}return Vf}var VM;function tG(){if(VM)return Pe;VM=1;var p=Pe.__createBinding||(Object.create?function(_,S,C,T){T===void 0&&(T=C);var k=Object.getOwnPropertyDescriptor(S,C);(!k||("get"in k?!S.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return S[C]}}),Object.defineProperty(_,T,k)}:function(_,S,C,T){T===void 0&&(T=C),_[T]=S[C]}),t=Pe.__setModuleDefault||(Object.create?function(_,S){Object.defineProperty(_,"default",{enumerable:!0,value:S})}:function(_,S){_.default=S}),e=Pe.__importStar||function(_){if(_&&_.__esModule)return _;var S={};if(_!=null)for(var C in _)C!=="default"&&Object.prototype.hasOwnProperty.call(_,C)&&p(S,_,C);return t(S,_),S},n=Pe.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.PasswordResponses=Pe.usePageContext=Pe.useOutlineContext=Pe.useDocumentContext=Pe.Thumbnail=Pe.Page=Pe.Outline=Pe.Document=Pe.pdfjs=void 0;const i=e(Xb);Pe.pdfjs=i;const s=n(BU());Pe.Document=s.default;const o=n(WU());Pe.Outline=o.default;const l=n(VN());Pe.Page=l.default;const h=n(ZU());Pe.Thumbnail=h.default;const u=n(_m());Pe.useDocumentContext=u.default;const f=n(UN());Pe.useOutlineContext=f.default;const g=n(Yb());Pe.usePageContext=g.default;const m=n(BN());return Pe.PasswordResponses=m.default,(0,ho().displayWorkerWarning)(),i.GlobalWorkerOptions.workerSrc="pdf.worker.mjs",Pe}var qM;function eG(){if(qM)return cy;qM=1;var p=cy.__awaiter||function(n,i,s,o){function l(h){return h instanceof s?h:new s(function(u){u(h)})}return new(s||(s=Promise))(function(h,u){function f(A){try{m(o.next(A))}catch(_){u(_)}}function g(A){try{m(o.throw(A))}catch(_){u(_)}}function m(A){A.done?h(A.value):l(A.value).then(f,g)}m((o=o.apply(n,i||[])).next())})};Object.defineProperty(cy,"__esModule",{value:!0});const t=tG();t.pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${t.pdfjs.version}/pdf.worker.mjs`;const e=n=>p(void 0,void 0,void 0,function*(){const i=URL.createObjectURL(n),s=t.pdfjs.getDocument(i);let o="";try{const l=yield s.promise,h=l.numPages;for(let u=1;u<=h;u++){const m=(yield(yield l.getPage(u)).getTextContent()).items.map(A=>"str"in A?A.str:"").join(" ");o+=m}}catch(l){throw new Error(`Failed to extract text from PDF: ${l}`)}finally{URL.revokeObjectURL(i),s.destroy()}return o});return cy.default=e,cy}var nG=eG();const iG=TI(nG);LF.workerSrc="../pdf.worker.mjs";const sG=async(p,t)=>{if(!p){alert("Please upload a PDF or image file first.");return}if(t==="Unknown"){alert("Please upload a supported file type (PDF or Image).");return}let e="",n,i;if(iG(p).then(s=>{e=s,i=e.split(" ").filter(o=>o.trim()!==""),console.log(i)}).catch(s=>console.log(s+"Failed to extract text from pdf")),t==="PDF")try{const s=await p.arrayBuffer(),o=await oB(s).promise,l=o.numPages;for(let h=1;h<=l;h++){const u=await o.getPage(h),f=u.getViewport({scale:1}),g=document.createElement("canvas"),m=g.getContext("2d");if(!m)continue;g.height=f.height,g.width=f.width;const A={canvasContext:m,viewport:f};await u.render(A).promise,n=g.toDataURL("image/png");const{data:_}=await qL.recognize(n,"pol",{});e+=_.text}}catch(s){console.error("Error processing PDF:",s)}else if(t==="Image"){const s=URL.createObjectURL(p);try{const{data:o}=await qL.recognize(s,"pol",{logger:h=>console.log(h)});i=o.text.split(`
`).filter(h=>h.trim()!=="")}catch(o){console.error("Error recognizing text from image:",o)}}return{dataUrl:n,lines:i}};LF.workerSrc="../pdf.worker.mjs";const rG=()=>{const[p,t]=fc.useState(null),[e,n]=fc.useState([]),[i,s]=fc.useState(!1),[o,l]=fc.useState(""),[h,u]=fc.useState(""),[f,g]=fc.useState(null),m=_=>{const S=lB(_);S&&(u(S.fileType),t(S.file))},A=async()=>{if(p){s(!0);const _=await sG(p,h);_&&_.dataUrl&&_.lines&&(l(_.dataUrl),n(_.lines),s(!1))}};return fc.useEffect(()=>{if(p){const _=async()=>{const C=new FormData;C.append("file",p);try{console.log("wysyam");const T=await fetch("http://localhost:3000/ask",{method:"POST",body:C});if(T.ok){const k=await T.json();return console.log("Plik wysany pomylnie:",k),k.data}else console.error("Bd podczas wysyania:",T.statusText)}catch(T){console.error("Wystpi bd:",T)}};(async()=>{const C=await _();if(C){console.log(C);const T=ce.jsxs(ce.Fragment,{children:[ce.jsxs("div",{children:[ce.jsx("p",{children:"Nazwa Firmy:"}),ce.jsx("p",{children:C.name})]}),ce.jsxs("div",{children:[ce.jsx("p",{children:"Numer fakury:"}),ce.jsx("p",{children:C.invoiceNo})]}),ce.jsxs("div",{children:[ce.jsx("p",{children:"Data fakury:"}),ce.jsx("p",{children:C.invoiceDate})]}),ce.jsxs("div",{children:[ce.jsx("p",{children:"Kwota:"}),ce.jsx("p",{children:C.value})]}),ce.jsxs("div",{children:[ce.jsx("p",{children:"Termin patnoci:"}),ce.jsx("p",{children:C.paymentDate})]})]});g(T)}})()}},[e,p,g]),ce.jsxs("div",{className:"App",children:[ce.jsx("h1",{children:"Extract Text from PDF or Image"}),ce.jsx("input",{type:"file",accept:".pdf,image/*",onChange:m}),ce.jsx("button",{onClick:A,disabled:i,children:i?"Processing...":"Extract Text"}),f&&ce.jsxs("div",{children:[ce.jsx("h2",{children:"Found Invoice Data:"}),f]}),ce.jsxs("div",{children:[ce.jsx("h2",{children:"Extracted Text:"}),!!e&&e.map((_,S)=>ce.jsx("button",{onClick:C=>console.log(C.target),children:_},S))]}),!!e&&ce.jsx("img",{src:o,alt:"Canvas to Image"})]})};K$.createRoot(document.getElementById("root")).render(ce.jsx(fc.StrictMode,{children:ce.jsx(rG,{})}));
