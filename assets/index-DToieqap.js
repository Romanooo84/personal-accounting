var Cj=Object.defineProperty;var yL=u=>{throw TypeError(u)};var Tj=(u,t,e)=>t in u?Cj(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e;var lt=(u,t,e)=>Tj(u,typeof t!="symbol"?t+"":t,e),N1=(u,t,e)=>t.has(u)||yL("Cannot "+e);var r=(u,t,e)=>(N1(u,t,"read from private field"),e?e.call(u):t.get(u)),E=(u,t,e)=>t.has(u)?yL("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(u):t.set(u,e),v=(u,t,e,n)=>(N1(u,t,"write to private field"),n?n.call(u,e):t.set(u,e),e),A=(u,t,e)=>(N1(u,t,"access private method"),e);var he=(u,t,e,n)=>({set _(i){v(u,t,i,e)},get _(){return r(u,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function iD(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function kj(u){if(u.__esModule)return u;var t=u.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(u).forEach(function(n){var i=Object.getOwnPropertyDescriptor(u,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return u[n]}})}),e}var $1={exports:{}},cy={},j1={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vL;function Pj(){if(vL)return qt;vL=1;var u=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function m(M){return M===null||typeof M!="object"?null:(M=g&&M[g]||M["@@iterator"],typeof M=="function"?M:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function C(M,B,Y){this.props=M,this.context=B,this.refs=S,this.updater=Y||b}C.prototype.isReactComponent={},C.prototype.setState=function(M,B){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,B,"setState")},C.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function T(){}T.prototype=C.prototype;function k(M,B,Y){this.props=M,this.context=B,this.refs=S,this.updater=Y||b}var P=k.prototype=new T;P.constructor=k,_(P,C.prototype),P.isPureReactComponent=!0;var L=Array.isArray,I=Object.prototype.hasOwnProperty,D={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function H(M,B,Y){var it,dt={},at=null,nt=null;if(B!=null)for(it in B.ref!==void 0&&(nt=B.ref),B.key!==void 0&&(at=""+B.key),B)I.call(B,it)&&!F.hasOwnProperty(it)&&(dt[it]=B[it]);var vt=arguments.length-2;if(vt===1)dt.children=Y;else if(1<vt){for(var ut=Array(vt),xt=0;xt<vt;xt++)ut[xt]=arguments[xt+2];dt.children=ut}if(M&&M.defaultProps)for(it in vt=M.defaultProps,vt)dt[it]===void 0&&(dt[it]=vt[it]);return{$$typeof:u,type:M,key:at,ref:nt,props:dt,_owner:D.current}}function j(M,B){return{$$typeof:u,type:M.type,key:B,ref:M.ref,props:M.props,_owner:M._owner}}function Q(M){return typeof M=="object"&&M!==null&&M.$$typeof===u}function V(M){var B={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(Y){return B[Y]})}var tt=/\/+/g;function Z(M,B){return typeof M=="object"&&M!==null&&M.key!=null?V(""+M.key):B.toString(36)}function et(M,B,Y,it,dt){var at=typeof M;(at==="undefined"||at==="boolean")&&(M=null);var nt=!1;if(M===null)nt=!0;else switch(at){case"string":case"number":nt=!0;break;case"object":switch(M.$$typeof){case u:case t:nt=!0}}if(nt)return nt=M,dt=dt(nt),M=it===""?"."+Z(nt,0):it,L(dt)?(Y="",M!=null&&(Y=M.replace(tt,"$&/")+"/"),et(dt,B,Y,"",function(xt){return xt})):dt!=null&&(Q(dt)&&(dt=j(dt,Y+(!dt.key||nt&&nt.key===dt.key?"":(""+dt.key).replace(tt,"$&/")+"/")+M)),B.push(dt)),1;if(nt=0,it=it===""?".":it+":",L(M))for(var vt=0;vt<M.length;vt++){at=M[vt];var ut=it+Z(at,vt);nt+=et(at,B,Y,ut,dt)}else if(ut=m(M),typeof ut=="function")for(M=ut.call(M),vt=0;!(at=M.next()).done;)at=at.value,ut=it+Z(at,vt++),nt+=et(at,B,Y,ut,dt);else if(at==="object")throw B=String(M),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return nt}function ht(M,B,Y){if(M==null)return M;var it=[],dt=0;return et(M,it,"","",function(at){return B.call(Y,at,dt++)}),it}function J(M){if(M._status===-1){var B=M._result;B=B(),B.then(function(Y){(M._status===0||M._status===-1)&&(M._status=1,M._result=Y)},function(Y){(M._status===0||M._status===-1)&&(M._status=2,M._result=Y)}),M._status===-1&&(M._status=0,M._result=B)}if(M._status===1)return M._result.default;throw M._result}var G={current:null},q={transition:null},U={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:q,ReactCurrentOwner:D};function N(){throw Error("act(...) is not supported in production builds of React.")}return qt.Children={map:ht,forEach:function(M,B,Y){ht(M,function(){B.apply(this,arguments)},Y)},count:function(M){var B=0;return ht(M,function(){B++}),B},toArray:function(M){return ht(M,function(B){return B})||[]},only:function(M){if(!Q(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},qt.Component=C,qt.Fragment=e,qt.Profiler=i,qt.PureComponent=k,qt.StrictMode=n,qt.Suspense=h,qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,qt.act=N,qt.cloneElement=function(M,B,Y){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var it=_({},M.props),dt=M.key,at=M.ref,nt=M._owner;if(B!=null){if(B.ref!==void 0&&(at=B.ref,nt=D.current),B.key!==void 0&&(dt=""+B.key),M.type&&M.type.defaultProps)var vt=M.type.defaultProps;for(ut in B)I.call(B,ut)&&!F.hasOwnProperty(ut)&&(it[ut]=B[ut]===void 0&&vt!==void 0?vt[ut]:B[ut])}var ut=arguments.length-2;if(ut===1)it.children=Y;else if(1<ut){vt=Array(ut);for(var xt=0;xt<ut;xt++)vt[xt]=arguments[xt+2];it.children=vt}return{$$typeof:u,type:M.type,key:dt,ref:at,props:it,_owner:nt}},qt.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:s,_context:M},M.Consumer=M},qt.createElement=H,qt.createFactory=function(M){var B=H.bind(null,M);return B.type=M,B},qt.createRef=function(){return{current:null}},qt.forwardRef=function(M){return{$$typeof:l,render:M}},qt.isValidElement=Q,qt.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:J}},qt.memo=function(M,B){return{$$typeof:d,type:M,compare:B===void 0?null:B}},qt.startTransition=function(M){var B=q.transition;q.transition={};try{M()}finally{q.transition=B}},qt.unstable_act=N,qt.useCallback=function(M,B){return G.current.useCallback(M,B)},qt.useContext=function(M){return G.current.useContext(M)},qt.useDebugValue=function(){},qt.useDeferredValue=function(M){return G.current.useDeferredValue(M)},qt.useEffect=function(M,B){return G.current.useEffect(M,B)},qt.useId=function(){return G.current.useId()},qt.useImperativeHandle=function(M,B,Y){return G.current.useImperativeHandle(M,B,Y)},qt.useInsertionEffect=function(M,B){return G.current.useInsertionEffect(M,B)},qt.useLayoutEffect=function(M,B){return G.current.useLayoutEffect(M,B)},qt.useMemo=function(M,B){return G.current.useMemo(M,B)},qt.useReducer=function(M,B,Y){return G.current.useReducer(M,B,Y)},qt.useRef=function(M){return G.current.useRef(M)},qt.useState=function(M){return G.current.useState(M)},qt.useSyncExternalStore=function(M,B,Y){return G.current.useSyncExternalStore(M,B,Y)},qt.useTransition=function(){return G.current.useTransition()},qt.version="18.3.1",qt}var bL;function Rn(){return bL||(bL=1,j1.exports=Pj()),j1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AL;function Rj(){if(AL)return cy;AL=1;var u=Rn(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,h,d){var p,g={},m=null,b=null;d!==void 0&&(m=""+d),h.key!==void 0&&(m=""+h.key),h.ref!==void 0&&(b=h.ref);for(p in h)n.call(h,p)&&!s.hasOwnProperty(p)&&(g[p]=h[p]);if(l&&l.defaultProps)for(p in h=l.defaultProps,h)g[p]===void 0&&(g[p]=h[p]);return{$$typeof:t,type:l,key:m,ref:b,props:g,_owner:i.current}}return cy.Fragment=e,cy.jsx=o,cy.jsxs=o,cy}var _L;function xr(){return _L||(_L=1,$1.exports=Rj()),$1.exports}var Jt=xr(),Qe=Rn(),g_={},H1={exports:{}},Zi={},B1={exports:{}},z1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wL;function Lj(){return wL||(wL=1,function(u){function t(q,U){var N=q.length;q.push(U);t:for(;0<N;){var M=N-1>>>1,B=q[M];if(0<i(B,U))q[M]=U,q[N]=B,N=M;else break t}}function e(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var U=q[0],N=q.pop();if(N!==U){q[0]=N;t:for(var M=0,B=q.length,Y=B>>>1;M<Y;){var it=2*(M+1)-1,dt=q[it],at=it+1,nt=q[at];if(0>i(dt,N))at<B&&0>i(nt,dt)?(q[M]=nt,q[at]=N,M=at):(q[M]=dt,q[it]=N,M=it);else if(at<B&&0>i(nt,N))q[M]=nt,q[at]=N,M=at;else break t}}return U}function i(q,U){var N=q.sortIndex-U.sortIndex;return N!==0?N:q.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;u.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();u.unstable_now=function(){return o.now()-l}}var h=[],d=[],p=1,g=null,m=3,b=!1,_=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(q){for(var U=e(d);U!==null;){if(U.callback===null)n(d);else if(U.startTime<=q)n(d),U.sortIndex=U.expirationTime,t(h,U);else break;U=e(d)}}function L(q){if(S=!1,P(q),!_)if(e(h)!==null)_=!0,J(I);else{var U=e(d);U!==null&&G(L,U.startTime-q)}}function I(q,U){_=!1,S&&(S=!1,T(H),H=-1),b=!0;var N=m;try{for(P(U),g=e(h);g!==null&&(!(g.expirationTime>U)||q&&!V());){var M=g.callback;if(typeof M=="function"){g.callback=null,m=g.priorityLevel;var B=M(g.expirationTime<=U);U=u.unstable_now(),typeof B=="function"?g.callback=B:g===e(h)&&n(h),P(U)}else n(h);g=e(h)}if(g!==null)var Y=!0;else{var it=e(d);it!==null&&G(L,it.startTime-U),Y=!1}return Y}finally{g=null,m=N,b=!1}}var D=!1,F=null,H=-1,j=5,Q=-1;function V(){return!(u.unstable_now()-Q<j)}function tt(){if(F!==null){var q=u.unstable_now();Q=q;var U=!0;try{U=F(!0,q)}finally{U?Z():(D=!1,F=null)}}else D=!1}var Z;if(typeof k=="function")Z=function(){k(tt)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,ht=et.port2;et.port1.onmessage=tt,Z=function(){ht.postMessage(null)}}else Z=function(){C(tt,0)};function J(q){F=q,D||(D=!0,Z())}function G(q,U){H=C(function(){q(u.unstable_now())},U)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(q){q.callback=null},u.unstable_continueExecution=function(){_||b||(_=!0,J(I))},u.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<q?Math.floor(1e3/q):5},u.unstable_getCurrentPriorityLevel=function(){return m},u.unstable_getFirstCallbackNode=function(){return e(h)},u.unstable_next=function(q){switch(m){case 1:case 2:case 3:var U=3;break;default:U=m}var N=m;m=U;try{return q()}finally{m=N}},u.unstable_pauseExecution=function(){},u.unstable_requestPaint=function(){},u.unstable_runWithPriority=function(q,U){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var N=m;m=q;try{return U()}finally{m=N}},u.unstable_scheduleCallback=function(q,U,N){var M=u.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?M+N:M):N=M,q){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=N+B,q={id:p++,callback:U,priorityLevel:q,startTime:N,expirationTime:B,sortIndex:-1},N>M?(q.sortIndex=N,t(d,q),e(h)===null&&q===e(d)&&(S?(T(H),H=-1):S=!0,G(L,N-M))):(q.sortIndex=B,t(h,q),_||b||(_=!0,J(I))),q},u.unstable_shouldYield=V,u.unstable_wrapCallback=function(q){var U=m;return function(){var N=m;m=U;try{return q.apply(this,arguments)}finally{m=N}}}}(z1)),z1}var EL;function Mj(){return EL||(EL=1,B1.exports=Lj()),B1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SL;function Ij(){if(SL)return Zi;SL=1;var u=Rn(),t=Mj();function e(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(i[a]=c,a=0;a<c.length;a++)n.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function m(a){return h.call(g,a)?!0:h.call(p,a)?!1:d.test(a)?g[a]=!0:(p[a]=!0,!1)}function b(a,c,f,y){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function _(a,c,f,y){if(c===null||typeof c>"u"||b(a,c,f,y))return!0;if(y)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function S(a,c,f,y,w,x,R){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=w,this.mustUseProperty=f,this.propertyName=a,this.type=c,this.sanitizeURL=x,this.removeEmptyString=R}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){C[a]=new S(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];C[c]=new S(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){C[a]=new S(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){C[a]=new S(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){C[a]=new S(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){C[a]=new S(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){C[a]=new S(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){C[a]=new S(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){C[a]=new S(a,5,!1,a.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function k(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(T,k);C[c]=new S(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){C[a]=new S(a,1,!1,a.toLowerCase(),null,!1,!1)}),C.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){C[a]=new S(a,1,!1,a.toLowerCase(),null,!0,!0)});function P(a,c,f,y){var w=C.hasOwnProperty(c)?C[c]:null;(w!==null?w.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(_(c,f,w,y)&&(f=null),y||w===null?m(c)&&(f===null?a.removeAttribute(c):a.setAttribute(c,""+f)):w.mustUseProperty?a[w.propertyName]=f===null?w.type===3?!1:"":f:(c=w.attributeName,y=w.attributeNamespace,f===null?a.removeAttribute(c):(w=w.type,f=w===3||w===4&&f===!0?"":""+f,y?a.setAttributeNS(y,c,f):a.setAttribute(c,f))))}var L=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),Q=Symbol.for("react.provider"),V=Symbol.for("react.context"),tt=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),et=Symbol.for("react.suspense_list"),ht=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),q=Symbol.iterator;function U(a){return a===null||typeof a!="object"?null:(a=q&&a[q]||a["@@iterator"],typeof a=="function"?a:null)}var N=Object.assign,M;function B(a){if(M===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);M=c&&c[1]||""}return`
`+M+a}var Y=!1;function it(a,c){if(!a||Y)return"";Y=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(K){var y=K}Reflect.construct(a,[],c)}else{try{c.call()}catch(K){y=K}a.call(c.prototype)}else{try{throw Error()}catch(K){y=K}a()}}catch(K){if(K&&y&&typeof K.stack=="string"){for(var w=K.stack.split(`
`),x=y.stack.split(`
`),R=w.length-1,O=x.length-1;1<=R&&0<=O&&w[R]!==x[O];)O--;for(;1<=R&&0<=O;R--,O--)if(w[R]!==x[O]){if(R!==1||O!==1)do if(R--,O--,0>O||w[R]!==x[O]){var $=`
`+w[R].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=R&&0<=O);break}}}finally{Y=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?B(a):""}function dt(a){switch(a.tag){case 5:return B(a.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return a=it(a.type,!1),a;case 11:return a=it(a.type.render,!1),a;case 1:return a=it(a.type,!0),a;default:return""}}function at(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case F:return"Fragment";case D:return"Portal";case j:return"Profiler";case H:return"StrictMode";case Z:return"Suspense";case et:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case Q:return(a._context.displayName||"Context")+".Provider";case tt:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ht:return c=a.displayName||null,c!==null?c:at(a.type)||"Memo";case J:c=a._payload,a=a._init;try{return at(a(c))}catch{}}return null}function nt(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return at(c);case 8:return c===H?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function vt(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function ut(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function xt(a){var c=ut(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var w=f.get,x=f.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return w.call(this)},set:function(R){y=""+R,x.call(this,R)}}),Object.defineProperty(a,c,{enumerable:f.enumerable}),{getValue:function(){return y},setValue:function(R){y=""+R},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Qt(a){a._valueTracker||(a._valueTracker=xt(a))}function Se(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),y="";return a&&(y=ut(a)?a.checked?"true":"false":a.value),a=y,a!==f?(c.setValue(a),!0):!1}function Ie(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function xe(a,c){var f=c.checked;return N({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function on(a,c){var f=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;f=vt(c.value!=null?c.value:f),a._wrapperState={initialChecked:y,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ci(a,c){c=c.checked,c!=null&&P(a,"checked",c,!1)}function hi(a,c){ci(a,c);var f=vt(c.value),y=c.type;if(f!=null)y==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?ln(a,c.type,f):c.hasOwnProperty("defaultValue")&&ln(a,c.type,vt(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Cr(a,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,f||c===a.value||(a.value=c),a.defaultValue=c}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function ln(a,c,f){(c!=="number"||Ie(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Ys=Array.isArray;function Li(a,c,f,y){if(a=a.options,c){c={};for(var w=0;w<f.length;w++)c["$"+f[w]]=!0;for(f=0;f<a.length;f++)w=c.hasOwnProperty("$"+a[f].value),a[f].selected!==w&&(a[f].selected=w),w&&y&&(a[f].defaultSelected=!0)}else{for(f=""+vt(f),c=null,w=0;w<a.length;w++){if(a[w].value===f){a[w].selected=!0,y&&(a[w].defaultSelected=!0);return}c!==null||a[w].disabled||(c=a[w])}c!==null&&(c.selected=!0)}}function ps(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(e(91));return N({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function ma(a,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(e(92));if(Ys(f)){if(1<f.length)throw Error(e(93));f=f[0]}c=f}c==null&&(c=""),f=c}a._wrapperState={initialValue:vt(f)}}function Tr(a,c){var f=vt(c.value),y=vt(c.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),c.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),y!=null&&(a.defaultValue=""+y)}function po(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function go(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ul(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?go(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Gl,kr=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,y,w){MSApp.execUnsafeLocalFunction(function(){return a(c,f,y,w)})}:a}(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Gl=Gl||document.createElement("div"),Gl.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Gl.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function ye(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var Pr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vl=["Webkit","ms","Moz","O"];Object.keys(Pr).forEach(function(a){Vl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Pr[c]=Pr[a]})});function ui(a,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||Pr.hasOwnProperty(a)&&Pr[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var f in c)if(c.hasOwnProperty(f)){var y=f.indexOf("--")===0,w=ui(f,c[f],y);f==="float"&&(f="cssFloat"),y?a.setProperty(f,w):a[f]=w}}var ya=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qn(a,c){if(c){if(ya[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(e(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(e(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(e(61))}if(c.style!=null&&typeof c.style!="object")throw Error(e(62))}}function Fh(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Je=null;function Xn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Mi=null,Ln=null,ms=null;function Wl(a){if(a=Xm(a)){if(typeof Mi!="function")throw Error(e(280));var c=a.stateNode;c&&(c=RA(c),Mi(a.stateNode,a.type,c))}}function rA(a){Ln?ms?ms.push(a):ms=[a]:Ln=a}function aA(){if(Ln){var a=Ln,c=ms;if(ms=Ln=null,Wl(a),c)for(a=0;a<c.length;a++)Wl(c[a])}}function oA(a,c){return a(c)}function mo(){}var ql=!1;function Oh(a,c,f){if(ql)return a(c,f);ql=!0;try{return oA(a,c,f)}finally{ql=!1,(Ln!==null||ms!==null)&&(mo(),aA())}}function yo(a,c){var f=a.stateNode;if(f===null)return null;var y=RA(f);if(y===null)return null;f=y[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break t;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(e(231,c,typeof f));return f}var eS=!1;if(l)try{var km={};Object.defineProperty(km,"passive",{get:function(){eS=!0}}),window.addEventListener("test",km,km),window.removeEventListener("test",km,km)}catch{eS=!1}function I2(a,c,f,y,w,x,R,O,$){var K=Array.prototype.slice.call(arguments,3);try{c.apply(f,K)}catch(rt){this.onError(rt)}}var Pm=!1,lA=null,cA=!1,nS=null,D2={onError:function(a){Pm=!0,lA=a}};function F2(a,c,f,y,w,x,R,O,$){Pm=!1,lA=null,I2.apply(D2,arguments)}function O2(a,c,f,y,w,x,R,O,$){if(F2.apply(this,arguments),Pm){if(Pm){var K=lA;Pm=!1,lA=null}else throw Error(e(198));cA||(cA=!0,nS=K)}}function Nh(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,c.flags&4098&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function Hk(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Bk(a){if(Nh(a)!==a)throw Error(e(188))}function N2(a){var c=a.alternate;if(!c){if(c=Nh(a),c===null)throw Error(e(188));return c!==a?null:a}for(var f=a,y=c;;){var w=f.return;if(w===null)break;var x=w.alternate;if(x===null){if(y=w.return,y!==null){f=y;continue}break}if(w.child===x.child){for(x=w.child;x;){if(x===f)return Bk(w),a;if(x===y)return Bk(w),c;x=x.sibling}throw Error(e(188))}if(f.return!==y.return)f=w,y=x;else{for(var R=!1,O=w.child;O;){if(O===f){R=!0,f=w,y=x;break}if(O===y){R=!0,y=w,f=x;break}O=O.sibling}if(!R){for(O=x.child;O;){if(O===f){R=!0,f=x,y=w;break}if(O===y){R=!0,y=x,f=w;break}O=O.sibling}if(!R)throw Error(e(189))}}if(f.alternate!==y)throw Error(e(190))}if(f.tag!==3)throw Error(e(188));return f.stateNode.current===f?a:c}function zk(a){return a=N2(a),a!==null?Uk(a):null}function Uk(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=Uk(a);if(c!==null)return c;a=a.sibling}return null}var Gk=t.unstable_scheduleCallback,Vk=t.unstable_cancelCallback,$2=t.unstable_shouldYield,j2=t.unstable_requestPaint,Ze=t.unstable_now,H2=t.unstable_getCurrentPriorityLevel,iS=t.unstable_ImmediatePriority,Wk=t.unstable_UserBlockingPriority,hA=t.unstable_NormalPriority,B2=t.unstable_LowPriority,qk=t.unstable_IdlePriority,uA=null,va=null;function z2(a){if(va&&typeof va.onCommitFiberRoot=="function")try{va.onCommitFiberRoot(uA,a,void 0,(a.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:V2,U2=Math.log,G2=Math.LN2;function V2(a){return a>>>=0,a===0?32:31-(U2(a)/G2|0)|0}var dA=64,fA=4194304;function Rm(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function pA(a,c){var f=a.pendingLanes;if(f===0)return 0;var y=0,w=a.suspendedLanes,x=a.pingedLanes,R=f&268435455;if(R!==0){var O=R&~w;O!==0?y=Rm(O):(x&=R,x!==0&&(y=Rm(x)))}else R=f&~w,R!==0?y=Rm(R):x!==0&&(y=Rm(x));if(y===0)return 0;if(c!==0&&c!==y&&!(c&w)&&(w=y&-y,x=c&-c,w>=x||w===16&&(x&4194240)!==0))return c;if(y&4&&(y|=f&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)f=31-Rr(c),w=1<<f,y|=a[f],c&=~w;return y}function W2(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q2(a,c){for(var f=a.suspendedLanes,y=a.pingedLanes,w=a.expirationTimes,x=a.pendingLanes;0<x;){var R=31-Rr(x),O=1<<R,$=w[R];$===-1?(!(O&f)||O&y)&&(w[R]=W2(O,c)):$<=c&&(a.expiredLanes|=O),x&=~O}}function sS(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Xk(){var a=dA;return dA<<=1,!(dA&4194240)&&(dA=64),a}function rS(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function Lm(a,c,f){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-Rr(c),a[c]=f}function X2(a,c){var f=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<f;){var w=31-Rr(f),x=1<<w;c[w]=0,y[w]=-1,a[w]=-1,f&=~x}}function aS(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var y=31-Rr(f),w=1<<y;w&c|a[y]&c&&(a[y]|=c),f&=~w}}var ce=0;function Yk(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Kk,oS,Qk,Jk,Zk,lS=!1,gA=[],Xl=null,Yl=null,Kl=null,Mm=new Map,Im=new Map,Ql=[],Y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tP(a,c){switch(a){case"focusin":case"focusout":Xl=null;break;case"dragenter":case"dragleave":Yl=null;break;case"mouseover":case"mouseout":Kl=null;break;case"pointerover":case"pointerout":Mm.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Im.delete(c.pointerId)}}function Dm(a,c,f,y,w,x){return a===null||a.nativeEvent!==x?(a={blockedOn:c,domEventName:f,eventSystemFlags:y,nativeEvent:x,targetContainers:[w]},c!==null&&(c=Xm(c),c!==null&&oS(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),a)}function K2(a,c,f,y,w){switch(c){case"focusin":return Xl=Dm(Xl,a,c,f,y,w),!0;case"dragenter":return Yl=Dm(Yl,a,c,f,y,w),!0;case"mouseover":return Kl=Dm(Kl,a,c,f,y,w),!0;case"pointerover":var x=w.pointerId;return Mm.set(x,Dm(Mm.get(x)||null,a,c,f,y,w)),!0;case"gotpointercapture":return x=w.pointerId,Im.set(x,Dm(Im.get(x)||null,a,c,f,y,w)),!0}return!1}function eP(a){var c=$h(a.target);if(c!==null){var f=Nh(c);if(f!==null){if(c=f.tag,c===13){if(c=Hk(f),c!==null){a.blockedOn=c,Zk(a.priority,function(){Qk(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function mA(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=hS(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var y=new f.constructor(f.type,f);Je=y,f.target.dispatchEvent(y),Je=null}else return c=Xm(f),c!==null&&oS(c),a.blockedOn=f,!1;c.shift()}return!0}function nP(a,c,f){mA(a)&&f.delete(c)}function Q2(){lS=!1,Xl!==null&&mA(Xl)&&(Xl=null),Yl!==null&&mA(Yl)&&(Yl=null),Kl!==null&&mA(Kl)&&(Kl=null),Mm.forEach(nP),Im.forEach(nP)}function Fm(a,c){a.blockedOn===c&&(a.blockedOn=null,lS||(lS=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Q2)))}function Om(a){function c(w){return Fm(w,a)}if(0<gA.length){Fm(gA[0],a);for(var f=1;f<gA.length;f++){var y=gA[f];y.blockedOn===a&&(y.blockedOn=null)}}for(Xl!==null&&Fm(Xl,a),Yl!==null&&Fm(Yl,a),Kl!==null&&Fm(Kl,a),Mm.forEach(c),Im.forEach(c),f=0;f<Ql.length;f++)y=Ql[f],y.blockedOn===a&&(y.blockedOn=null);for(;0<Ql.length&&(f=Ql[0],f.blockedOn===null);)eP(f),f.blockedOn===null&&Ql.shift()}var xf=L.ReactCurrentBatchConfig,yA=!0;function J2(a,c,f,y){var w=ce,x=xf.transition;xf.transition=null;try{ce=1,cS(a,c,f,y)}finally{ce=w,xf.transition=x}}function Z2(a,c,f,y){var w=ce,x=xf.transition;xf.transition=null;try{ce=4,cS(a,c,f,y)}finally{ce=w,xf.transition=x}}function cS(a,c,f,y){if(yA){var w=hS(a,c,f,y);if(w===null)TS(a,c,y,vA,f),tP(a,y);else if(K2(w,a,c,f,y))y.stopPropagation();else if(tP(a,y),c&4&&-1<Y2.indexOf(a)){for(;w!==null;){var x=Xm(w);if(x!==null&&Kk(x),x=hS(a,c,f,y),x===null&&TS(a,c,y,vA,f),x===w)break;w=x}w!==null&&y.stopPropagation()}else TS(a,c,y,null,f)}}var vA=null;function hS(a,c,f,y){if(vA=null,a=Xn(y),a=$h(a),a!==null)if(c=Nh(a),c===null)a=null;else if(f=c.tag,f===13){if(a=Hk(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return vA=a,null}function iP(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(H2()){case iS:return 1;case Wk:return 4;case hA:case B2:return 16;case qk:return 536870912;default:return 16}default:return 16}}var Jl=null,uS=null,bA=null;function sP(){if(bA)return bA;var a,c=uS,f=c.length,y,w="value"in Jl?Jl.value:Jl.textContent,x=w.length;for(a=0;a<f&&c[a]===w[a];a++);var R=f-a;for(y=1;y<=R&&c[f-y]===w[x-y];y++);return bA=w.slice(a,1<y?1-y:void 0)}function AA(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function _A(){return!0}function rP(){return!1}function ys(a){function c(f,y,w,x,R){this._reactName=f,this._targetInst=w,this.type=y,this.nativeEvent=x,this.target=R,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(f=a[O],this[O]=f?f(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?_A:rP,this.isPropagationStopped=rP,this}return N(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=_A)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=_A)},persist:function(){},isPersistent:_A}),c}var Cf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dS=ys(Cf),Nm=N({},Cf,{view:0,detail:0}),t$=ys(Nm),fS,pS,$m,wA=N({},Nm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mS,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==$m&&($m&&a.type==="mousemove"?(fS=a.screenX-$m.screenX,pS=a.screenY-$m.screenY):pS=fS=0,$m=a),fS)},movementY:function(a){return"movementY"in a?a.movementY:pS}}),aP=ys(wA),e$=N({},wA,{dataTransfer:0}),n$=ys(e$),i$=N({},Nm,{relatedTarget:0}),gS=ys(i$),s$=N({},Cf,{animationName:0,elapsedTime:0,pseudoElement:0}),r$=ys(s$),a$=N({},Cf,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),o$=ys(a$),l$=N({},Cf,{data:0}),oP=ys(l$),c$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function d$(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=u$[a])?!!c[a]:!1}function mS(){return d$}var f$=N({},Nm,{key:function(a){if(a.key){var c=c$[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=AA(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?h$[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mS,charCode:function(a){return a.type==="keypress"?AA(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?AA(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),p$=ys(f$),g$=N({},wA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lP=ys(g$),m$=N({},Nm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mS}),y$=ys(m$),v$=N({},Cf,{propertyName:0,elapsedTime:0,pseudoElement:0}),b$=ys(v$),A$=N({},wA,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),_$=ys(A$),w$=[9,13,27,32],yS=l&&"CompositionEvent"in window,jm=null;l&&"documentMode"in document&&(jm=document.documentMode);var E$=l&&"TextEvent"in window&&!jm,cP=l&&(!yS||jm&&8<jm&&11>=jm),hP=" ",uP=!1;function dP(a,c){switch(a){case"keyup":return w$.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fP(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Tf=!1;function S$(a,c){switch(a){case"compositionend":return fP(c);case"keypress":return c.which!==32?null:(uP=!0,hP);case"textInput":return a=c.data,a===hP&&uP?null:a;default:return null}}function x$(a,c){if(Tf)return a==="compositionend"||!yS&&dP(a,c)?(a=sP(),bA=uS=Jl=null,Tf=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return cP&&c.locale!=="ko"?null:c.data;default:return null}}var C$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pP(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!C$[a.type]:c==="textarea"}function gP(a,c,f,y){rA(y),c=TA(c,"onChange"),0<c.length&&(f=new dS("onChange","change",null,f,y),a.push({event:f,listeners:c}))}var Hm=null,Bm=null;function T$(a){IP(a,0)}function EA(a){var c=Mf(a);if(Se(c))return a}function k$(a,c){if(a==="change")return c}var mP=!1;if(l){var vS;if(l){var bS="oninput"in document;if(!bS){var yP=document.createElement("div");yP.setAttribute("oninput","return;"),bS=typeof yP.oninput=="function"}vS=bS}else vS=!1;mP=vS&&(!document.documentMode||9<document.documentMode)}function vP(){Hm&&(Hm.detachEvent("onpropertychange",bP),Bm=Hm=null)}function bP(a){if(a.propertyName==="value"&&EA(Bm)){var c=[];gP(c,Bm,a,Xn(a)),Oh(T$,c)}}function P$(a,c,f){a==="focusin"?(vP(),Hm=c,Bm=f,Hm.attachEvent("onpropertychange",bP)):a==="focusout"&&vP()}function R$(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return EA(Bm)}function L$(a,c){if(a==="click")return EA(c)}function M$(a,c){if(a==="input"||a==="change")return EA(c)}function I$(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Lr=typeof Object.is=="function"?Object.is:I$;function zm(a,c){if(Lr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),y=Object.keys(c);if(f.length!==y.length)return!1;for(y=0;y<f.length;y++){var w=f[y];if(!h.call(c,w)||!Lr(a[w],c[w]))return!1}return!0}function AP(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function _P(a,c){var f=AP(a);a=0;for(var y;f;){if(f.nodeType===3){if(y=a+f.textContent.length,a<=c&&y>=c)return{node:f,offset:c-a};a=y}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=AP(f)}}function wP(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?wP(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function EP(){for(var a=window,c=Ie();c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=Ie(a.document)}return c}function AS(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function D$(a){var c=EP(),f=a.focusedElem,y=a.selectionRange;if(c!==f&&f&&f.ownerDocument&&wP(f.ownerDocument.documentElement,f)){if(y!==null&&AS(f)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(a,f.value.length);else if(a=(c=f.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var w=f.textContent.length,x=Math.min(y.start,w);y=y.end===void 0?x:Math.min(y.end,w),!a.extend&&x>y&&(w=y,y=x,x=w),w=_P(f,x);var R=_P(f,y);w&&R&&(a.rangeCount!==1||a.anchorNode!==w.node||a.anchorOffset!==w.offset||a.focusNode!==R.node||a.focusOffset!==R.offset)&&(c=c.createRange(),c.setStart(w.node,w.offset),a.removeAllRanges(),x>y?(a.addRange(c),a.extend(R.node,R.offset)):(c.setEnd(R.node,R.offset),a.addRange(c)))}}for(c=[],a=f;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)a=c[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var F$=l&&"documentMode"in document&&11>=document.documentMode,kf=null,_S=null,Um=null,wS=!1;function SP(a,c,f){var y=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;wS||kf==null||kf!==Ie(y)||(y=kf,"selectionStart"in y&&AS(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Um&&zm(Um,y)||(Um=y,y=TA(_S,"onSelect"),0<y.length&&(c=new dS("onSelect","select",null,c,f),a.push({event:c,listeners:y}),c.target=kf)))}function SA(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var Pf={animationend:SA("Animation","AnimationEnd"),animationiteration:SA("Animation","AnimationIteration"),animationstart:SA("Animation","AnimationStart"),transitionend:SA("Transition","TransitionEnd")},ES={},xP={};l&&(xP=document.createElement("div").style,"AnimationEvent"in window||(delete Pf.animationend.animation,delete Pf.animationiteration.animation,delete Pf.animationstart.animation),"TransitionEvent"in window||delete Pf.transitionend.transition);function xA(a){if(ES[a])return ES[a];if(!Pf[a])return a;var c=Pf[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in xP)return ES[a]=c[f];return a}var CP=xA("animationend"),TP=xA("animationiteration"),kP=xA("animationstart"),PP=xA("transitionend"),RP=new Map,LP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zl(a,c){RP.set(a,c),s(c,[a])}for(var SS=0;SS<LP.length;SS++){var xS=LP[SS],O$=xS.toLowerCase(),N$=xS[0].toUpperCase()+xS.slice(1);Zl(O$,"on"+N$)}Zl(CP,"onAnimationEnd"),Zl(TP,"onAnimationIteration"),Zl(kP,"onAnimationStart"),Zl("dblclick","onDoubleClick"),Zl("focusin","onFocus"),Zl("focusout","onBlur"),Zl(PP,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$$=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gm));function MP(a,c,f){var y=a.type||"unknown-event";a.currentTarget=f,O2(y,c,void 0,a),a.currentTarget=null}function IP(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var y=a[f],w=y.event;y=y.listeners;t:{var x=void 0;if(c)for(var R=y.length-1;0<=R;R--){var O=y[R],$=O.instance,K=O.currentTarget;if(O=O.listener,$!==x&&w.isPropagationStopped())break t;MP(w,O,K),x=$}else for(R=0;R<y.length;R++){if(O=y[R],$=O.instance,K=O.currentTarget,O=O.listener,$!==x&&w.isPropagationStopped())break t;MP(w,O,K),x=$}}}if(cA)throw a=nS,cA=!1,nS=null,a}function ke(a,c){var f=c[IS];f===void 0&&(f=c[IS]=new Set);var y=a+"__bubble";f.has(y)||(DP(c,a,2,!1),f.add(y))}function CS(a,c,f){var y=0;c&&(y|=4),DP(f,a,y,c)}var CA="_reactListening"+Math.random().toString(36).slice(2);function Vm(a){if(!a[CA]){a[CA]=!0,n.forEach(function(f){f!=="selectionchange"&&($$.has(f)||CS(f,!1,a),CS(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[CA]||(c[CA]=!0,CS("selectionchange",!1,c))}}function DP(a,c,f,y){switch(iP(c)){case 1:var w=J2;break;case 4:w=Z2;break;default:w=cS}f=w.bind(null,c,f,a),w=void 0,!eS||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),y?w!==void 0?a.addEventListener(c,f,{capture:!0,passive:w}):a.addEventListener(c,f,!0):w!==void 0?a.addEventListener(c,f,{passive:w}):a.addEventListener(c,f,!1)}function TS(a,c,f,y,w){var x=y;if(!(c&1)&&!(c&2)&&y!==null)t:for(;;){if(y===null)return;var R=y.tag;if(R===3||R===4){var O=y.stateNode.containerInfo;if(O===w||O.nodeType===8&&O.parentNode===w)break;if(R===4)for(R=y.return;R!==null;){var $=R.tag;if(($===3||$===4)&&($=R.stateNode.containerInfo,$===w||$.nodeType===8&&$.parentNode===w))return;R=R.return}for(;O!==null;){if(R=$h(O),R===null)return;if($=R.tag,$===5||$===6){y=x=R;continue t}O=O.parentNode}}y=y.return}Oh(function(){var K=x,rt=Xn(f),ot=[];t:{var st=RP.get(a);if(st!==void 0){var yt=dS,St=a;switch(a){case"keypress":if(AA(f)===0)break t;case"keydown":case"keyup":yt=p$;break;case"focusin":St="focus",yt=gS;break;case"focusout":St="blur",yt=gS;break;case"beforeblur":case"afterblur":yt=gS;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=aP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=n$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=y$;break;case CP:case TP:case kP:yt=r$;break;case PP:yt=b$;break;case"scroll":yt=t$;break;case"wheel":yt=_$;break;case"copy":case"cut":case"paste":yt=o$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=lP}var Ct=(c&4)!==0,tn=!Ct&&a==="scroll",W=Ct?st!==null?st+"Capture":null:st;Ct=[];for(var z=K,X;z!==null;){X=z;var ct=X.stateNode;if(X.tag===5&&ct!==null&&(X=ct,W!==null&&(ct=yo(z,W),ct!=null&&Ct.push(Wm(z,ct,X)))),tn)break;z=z.return}0<Ct.length&&(st=new yt(st,St,null,f,rt),ot.push({event:st,listeners:Ct}))}}if(!(c&7)){t:{if(st=a==="mouseover"||a==="pointerover",yt=a==="mouseout"||a==="pointerout",st&&f!==Je&&(St=f.relatedTarget||f.fromElement)&&($h(St)||St[vo]))break t;if((yt||st)&&(st=rt.window===rt?rt:(st=rt.ownerDocument)?st.defaultView||st.parentWindow:window,yt?(St=f.relatedTarget||f.toElement,yt=K,St=St?$h(St):null,St!==null&&(tn=Nh(St),St!==tn||St.tag!==5&&St.tag!==6)&&(St=null)):(yt=null,St=K),yt!==St)){if(Ct=aP,ct="onMouseLeave",W="onMouseEnter",z="mouse",(a==="pointerout"||a==="pointerover")&&(Ct=lP,ct="onPointerLeave",W="onPointerEnter",z="pointer"),tn=yt==null?st:Mf(yt),X=St==null?st:Mf(St),st=new Ct(ct,z+"leave",yt,f,rt),st.target=tn,st.relatedTarget=X,ct=null,$h(rt)===K&&(Ct=new Ct(W,z+"enter",St,f,rt),Ct.target=X,Ct.relatedTarget=tn,ct=Ct),tn=ct,yt&&St)e:{for(Ct=yt,W=St,z=0,X=Ct;X;X=Rf(X))z++;for(X=0,ct=W;ct;ct=Rf(ct))X++;for(;0<z-X;)Ct=Rf(Ct),z--;for(;0<X-z;)W=Rf(W),X--;for(;z--;){if(Ct===W||W!==null&&Ct===W.alternate)break e;Ct=Rf(Ct),W=Rf(W)}Ct=null}else Ct=null;yt!==null&&FP(ot,st,yt,Ct,!1),St!==null&&tn!==null&&FP(ot,tn,St,Ct,!0)}}t:{if(st=K?Mf(K):window,yt=st.nodeName&&st.nodeName.toLowerCase(),yt==="select"||yt==="input"&&st.type==="file")var Tt=k$;else if(pP(st))if(mP)Tt=M$;else{Tt=R$;var Mt=P$}else(yt=st.nodeName)&&yt.toLowerCase()==="input"&&(st.type==="checkbox"||st.type==="radio")&&(Tt=L$);if(Tt&&(Tt=Tt(a,K))){gP(ot,Tt,f,rt);break t}Mt&&Mt(a,st,K),a==="focusout"&&(Mt=st._wrapperState)&&Mt.controlled&&st.type==="number"&&ln(st,"number",st.value)}switch(Mt=K?Mf(K):window,a){case"focusin":(pP(Mt)||Mt.contentEditable==="true")&&(kf=Mt,_S=K,Um=null);break;case"focusout":Um=_S=kf=null;break;case"mousedown":wS=!0;break;case"contextmenu":case"mouseup":case"dragend":wS=!1,SP(ot,f,rt);break;case"selectionchange":if(F$)break;case"keydown":case"keyup":SP(ot,f,rt)}var It;if(yS)t:{switch(a){case"compositionstart":var Ft="onCompositionStart";break t;case"compositionend":Ft="onCompositionEnd";break t;case"compositionupdate":Ft="onCompositionUpdate";break t}Ft=void 0}else Tf?dP(a,f)&&(Ft="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(Ft="onCompositionStart");Ft&&(cP&&f.locale!=="ko"&&(Tf||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&Tf&&(It=sP()):(Jl=rt,uS="value"in Jl?Jl.value:Jl.textContent,Tf=!0)),Mt=TA(K,Ft),0<Mt.length&&(Ft=new oP(Ft,a,null,f,rt),ot.push({event:Ft,listeners:Mt}),It?Ft.data=It:(It=fP(f),It!==null&&(Ft.data=It)))),(It=E$?S$(a,f):x$(a,f))&&(K=TA(K,"onBeforeInput"),0<K.length&&(rt=new oP("onBeforeInput","beforeinput",null,f,rt),ot.push({event:rt,listeners:K}),rt.data=It))}IP(ot,c)})}function Wm(a,c,f){return{instance:a,listener:c,currentTarget:f}}function TA(a,c){for(var f=c+"Capture",y=[];a!==null;){var w=a,x=w.stateNode;w.tag===5&&x!==null&&(w=x,x=yo(a,f),x!=null&&y.unshift(Wm(a,x,w)),x=yo(a,c),x!=null&&y.push(Wm(a,x,w))),a=a.return}return y}function Rf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function FP(a,c,f,y,w){for(var x=c._reactName,R=[];f!==null&&f!==y;){var O=f,$=O.alternate,K=O.stateNode;if($!==null&&$===y)break;O.tag===5&&K!==null&&(O=K,w?($=yo(f,x),$!=null&&R.unshift(Wm(f,$,O))):w||($=yo(f,x),$!=null&&R.push(Wm(f,$,O)))),f=f.return}R.length!==0&&a.push({event:c,listeners:R})}var j$=/\r\n?/g,H$=/\u0000|\uFFFD/g;function OP(a){return(typeof a=="string"?a:""+a).replace(j$,`
`).replace(H$,"")}function kA(a,c,f){if(c=OP(c),OP(a)!==c&&f)throw Error(e(425))}function PA(){}var kS=null,PS=null;function RS(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var LS=typeof setTimeout=="function"?setTimeout:void 0,B$=typeof clearTimeout=="function"?clearTimeout:void 0,NP=typeof Promise=="function"?Promise:void 0,z$=typeof queueMicrotask=="function"?queueMicrotask:typeof NP<"u"?function(a){return NP.resolve(null).then(a).catch(U$)}:LS;function U$(a){setTimeout(function(){throw a})}function MS(a,c){var f=c,y=0;do{var w=f.nextSibling;if(a.removeChild(f),w&&w.nodeType===8)if(f=w.data,f==="/$"){if(y===0){a.removeChild(w),Om(c);return}y--}else f!=="$"&&f!=="$?"&&f!=="$!"||y++;f=w}while(f);Om(c)}function tc(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function $P(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return a;c--}else f==="/$"&&c++}a=a.previousSibling}return null}var Lf=Math.random().toString(36).slice(2),ba="__reactFiber$"+Lf,qm="__reactProps$"+Lf,vo="__reactContainer$"+Lf,IS="__reactEvents$"+Lf,G$="__reactListeners$"+Lf,V$="__reactHandles$"+Lf;function $h(a){var c=a[ba];if(c)return c;for(var f=a.parentNode;f;){if(c=f[vo]||f[ba]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=$P(a);a!==null;){if(f=a[ba])return f;a=$P(a)}return c}a=f,f=a.parentNode}return null}function Xm(a){return a=a[ba]||a[vo],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Mf(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(e(33))}function RA(a){return a[qm]||null}var DS=[],If=-1;function ec(a){return{current:a}}function Pe(a){0>If||(a.current=DS[If],DS[If]=null,If--)}function Ce(a,c){If++,DS[If]=a.current,a.current=c}var nc={},di=ec(nc),Xi=ec(!1),jh=nc;function Df(a,c){var f=a.type.contextTypes;if(!f)return nc;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var w={},x;for(x in f)w[x]=c[x];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=w),w}function Yi(a){return a=a.childContextTypes,a!=null}function LA(){Pe(Xi),Pe(di)}function jP(a,c,f){if(di.current!==nc)throw Error(e(168));Ce(di,c),Ce(Xi,f)}function HP(a,c,f){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return f;y=y.getChildContext();for(var w in y)if(!(w in c))throw Error(e(108,nt(a)||"Unknown",w));return N({},f,y)}function MA(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||nc,jh=di.current,Ce(di,a),Ce(Xi,Xi.current),!0}function BP(a,c,f){var y=a.stateNode;if(!y)throw Error(e(169));f?(a=HP(a,c,jh),y.__reactInternalMemoizedMergedChildContext=a,Pe(Xi),Pe(di),Ce(di,a)):Pe(Xi),Ce(Xi,f)}var bo=null,IA=!1,FS=!1;function zP(a){bo===null?bo=[a]:bo.push(a)}function W$(a){IA=!0,zP(a)}function ic(){if(!FS&&bo!==null){FS=!0;var a=0,c=ce;try{var f=bo;for(ce=1;a<f.length;a++){var y=f[a];do y=y(!0);while(y!==null)}bo=null,IA=!1}catch(w){throw bo!==null&&(bo=bo.slice(a+1)),Gk(iS,ic),w}finally{ce=c,FS=!1}}return null}var Ff=[],Of=0,DA=null,FA=0,Ks=[],Qs=0,Hh=null,Ao=1,_o="";function Bh(a,c){Ff[Of++]=FA,Ff[Of++]=DA,DA=a,FA=c}function UP(a,c,f){Ks[Qs++]=Ao,Ks[Qs++]=_o,Ks[Qs++]=Hh,Hh=a;var y=Ao;a=_o;var w=32-Rr(y)-1;y&=~(1<<w),f+=1;var x=32-Rr(c)+w;if(30<x){var R=w-w%5;x=(y&(1<<R)-1).toString(32),y>>=R,w-=R,Ao=1<<32-Rr(c)+w|f<<w|y,_o=x+a}else Ao=1<<x|f<<w|y,_o=a}function OS(a){a.return!==null&&(Bh(a,1),UP(a,1,0))}function NS(a){for(;a===DA;)DA=Ff[--Of],Ff[Of]=null,FA=Ff[--Of],Ff[Of]=null;for(;a===Hh;)Hh=Ks[--Qs],Ks[Qs]=null,_o=Ks[--Qs],Ks[Qs]=null,Ao=Ks[--Qs],Ks[Qs]=null}var vs=null,bs=null,De=!1,Mr=null;function GP(a,c){var f=er(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=a,c=a.deletions,c===null?(a.deletions=[f],a.flags|=16):c.push(f)}function VP(a,c){switch(a.tag){case 5:var f=a.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,vs=a,bs=tc(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,vs=a,bs=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=Hh!==null?{id:Ao,overflow:_o}:null,a.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=er(18,null,null,0),f.stateNode=c,f.return=a,a.child=f,vs=a,bs=null,!0):!1;default:return!1}}function $S(a){return(a.mode&1)!==0&&(a.flags&128)===0}function jS(a){if(De){var c=bs;if(c){var f=c;if(!VP(a,c)){if($S(a))throw Error(e(418));c=tc(f.nextSibling);var y=vs;c&&VP(a,c)?GP(y,f):(a.flags=a.flags&-4097|2,De=!1,vs=a)}}else{if($S(a))throw Error(e(418));a.flags=a.flags&-4097|2,De=!1,vs=a}}}function WP(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;vs=a}function OA(a){if(a!==vs)return!1;if(!De)return WP(a),De=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!RS(a.type,a.memoizedProps)),c&&(c=bs)){if($S(a))throw qP(),Error(e(418));for(;c;)GP(a,c),c=tc(c.nextSibling)}if(WP(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(e(317));t:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(c===0){bs=tc(a.nextSibling);break t}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}a=a.nextSibling}bs=null}}else bs=vs?tc(a.stateNode.nextSibling):null;return!0}function qP(){for(var a=bs;a;)a=tc(a.nextSibling)}function Nf(){bs=vs=null,De=!1}function HS(a){Mr===null?Mr=[a]:Mr.push(a)}var q$=L.ReactCurrentBatchConfig;function Ym(a,c,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(e(309));var y=f.stateNode}if(!y)throw Error(e(147,a));var w=y,x=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(R){var O=w.refs;R===null?delete O[x]:O[x]=R},c._stringRef=x,c)}if(typeof a!="string")throw Error(e(284));if(!f._owner)throw Error(e(290,a))}return a}function NA(a,c){throw a=Object.prototype.toString.call(c),Error(e(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function XP(a){var c=a._init;return c(a._payload)}function YP(a){function c(W,z){if(a){var X=W.deletions;X===null?(W.deletions=[z],W.flags|=16):X.push(z)}}function f(W,z){if(!a)return null;for(;z!==null;)c(W,z),z=z.sibling;return null}function y(W,z){for(W=new Map;z!==null;)z.key!==null?W.set(z.key,z):W.set(z.index,z),z=z.sibling;return W}function w(W,z){return W=uc(W,z),W.index=0,W.sibling=null,W}function x(W,z,X){return W.index=X,a?(X=W.alternate,X!==null?(X=X.index,X<z?(W.flags|=2,z):X):(W.flags|=2,z)):(W.flags|=1048576,z)}function R(W){return a&&W.alternate===null&&(W.flags|=2),W}function O(W,z,X,ct){return z===null||z.tag!==6?(z=L1(X,W.mode,ct),z.return=W,z):(z=w(z,X),z.return=W,z)}function $(W,z,X,ct){var Tt=X.type;return Tt===F?rt(W,z,X.props.children,ct,X.key):z!==null&&(z.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===J&&XP(Tt)===z.type)?(ct=w(z,X.props),ct.ref=Ym(W,z,X),ct.return=W,ct):(ct=o_(X.type,X.key,X.props,null,W.mode,ct),ct.ref=Ym(W,z,X),ct.return=W,ct)}function K(W,z,X,ct){return z===null||z.tag!==4||z.stateNode.containerInfo!==X.containerInfo||z.stateNode.implementation!==X.implementation?(z=M1(X,W.mode,ct),z.return=W,z):(z=w(z,X.children||[]),z.return=W,z)}function rt(W,z,X,ct,Tt){return z===null||z.tag!==7?(z=Yh(X,W.mode,ct,Tt),z.return=W,z):(z=w(z,X),z.return=W,z)}function ot(W,z,X){if(typeof z=="string"&&z!==""||typeof z=="number")return z=L1(""+z,W.mode,X),z.return=W,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case I:return X=o_(z.type,z.key,z.props,null,W.mode,X),X.ref=Ym(W,null,z),X.return=W,X;case D:return z=M1(z,W.mode,X),z.return=W,z;case J:var ct=z._init;return ot(W,ct(z._payload),X)}if(Ys(z)||U(z))return z=Yh(z,W.mode,X,null),z.return=W,z;NA(W,z)}return null}function st(W,z,X,ct){var Tt=z!==null?z.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Tt!==null?null:O(W,z,""+X,ct);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case I:return X.key===Tt?$(W,z,X,ct):null;case D:return X.key===Tt?K(W,z,X,ct):null;case J:return Tt=X._init,st(W,z,Tt(X._payload),ct)}if(Ys(X)||U(X))return Tt!==null?null:rt(W,z,X,ct,null);NA(W,X)}return null}function yt(W,z,X,ct,Tt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return W=W.get(X)||null,O(z,W,""+ct,Tt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case I:return W=W.get(ct.key===null?X:ct.key)||null,$(z,W,ct,Tt);case D:return W=W.get(ct.key===null?X:ct.key)||null,K(z,W,ct,Tt);case J:var Mt=ct._init;return yt(W,z,X,Mt(ct._payload),Tt)}if(Ys(ct)||U(ct))return W=W.get(X)||null,rt(z,W,ct,Tt,null);NA(z,ct)}return null}function St(W,z,X,ct){for(var Tt=null,Mt=null,It=z,Ft=z=0,Dn=null;It!==null&&Ft<X.length;Ft++){It.index>Ft?(Dn=It,It=null):Dn=It.sibling;var re=st(W,It,X[Ft],ct);if(re===null){It===null&&(It=Dn);break}a&&It&&re.alternate===null&&c(W,It),z=x(re,z,Ft),Mt===null?Tt=re:Mt.sibling=re,Mt=re,It=Dn}if(Ft===X.length)return f(W,It),De&&Bh(W,Ft),Tt;if(It===null){for(;Ft<X.length;Ft++)It=ot(W,X[Ft],ct),It!==null&&(z=x(It,z,Ft),Mt===null?Tt=It:Mt.sibling=It,Mt=It);return De&&Bh(W,Ft),Tt}for(It=y(W,It);Ft<X.length;Ft++)Dn=yt(It,W,Ft,X[Ft],ct),Dn!==null&&(a&&Dn.alternate!==null&&It.delete(Dn.key===null?Ft:Dn.key),z=x(Dn,z,Ft),Mt===null?Tt=Dn:Mt.sibling=Dn,Mt=Dn);return a&&It.forEach(function(dc){return c(W,dc)}),De&&Bh(W,Ft),Tt}function Ct(W,z,X,ct){var Tt=U(X);if(typeof Tt!="function")throw Error(e(150));if(X=Tt.call(X),X==null)throw Error(e(151));for(var Mt=Tt=null,It=z,Ft=z=0,Dn=null,re=X.next();It!==null&&!re.done;Ft++,re=X.next()){It.index>Ft?(Dn=It,It=null):Dn=It.sibling;var dc=st(W,It,re.value,ct);if(dc===null){It===null&&(It=Dn);break}a&&It&&dc.alternate===null&&c(W,It),z=x(dc,z,Ft),Mt===null?Tt=dc:Mt.sibling=dc,Mt=dc,It=Dn}if(re.done)return f(W,It),De&&Bh(W,Ft),Tt;if(It===null){for(;!re.done;Ft++,re=X.next())re=ot(W,re.value,ct),re!==null&&(z=x(re,z,Ft),Mt===null?Tt=re:Mt.sibling=re,Mt=re);return De&&Bh(W,Ft),Tt}for(It=y(W,It);!re.done;Ft++,re=X.next())re=yt(It,W,Ft,re.value,ct),re!==null&&(a&&re.alternate!==null&&It.delete(re.key===null?Ft:re.key),z=x(re,z,Ft),Mt===null?Tt=re:Mt.sibling=re,Mt=re);return a&&It.forEach(function(xj){return c(W,xj)}),De&&Bh(W,Ft),Tt}function tn(W,z,X,ct){if(typeof X=="object"&&X!==null&&X.type===F&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case I:t:{for(var Tt=X.key,Mt=z;Mt!==null;){if(Mt.key===Tt){if(Tt=X.type,Tt===F){if(Mt.tag===7){f(W,Mt.sibling),z=w(Mt,X.props.children),z.return=W,W=z;break t}}else if(Mt.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===J&&XP(Tt)===Mt.type){f(W,Mt.sibling),z=w(Mt,X.props),z.ref=Ym(W,Mt,X),z.return=W,W=z;break t}f(W,Mt);break}else c(W,Mt);Mt=Mt.sibling}X.type===F?(z=Yh(X.props.children,W.mode,ct,X.key),z.return=W,W=z):(ct=o_(X.type,X.key,X.props,null,W.mode,ct),ct.ref=Ym(W,z,X),ct.return=W,W=ct)}return R(W);case D:t:{for(Mt=X.key;z!==null;){if(z.key===Mt)if(z.tag===4&&z.stateNode.containerInfo===X.containerInfo&&z.stateNode.implementation===X.implementation){f(W,z.sibling),z=w(z,X.children||[]),z.return=W,W=z;break t}else{f(W,z);break}else c(W,z);z=z.sibling}z=M1(X,W.mode,ct),z.return=W,W=z}return R(W);case J:return Mt=X._init,tn(W,z,Mt(X._payload),ct)}if(Ys(X))return St(W,z,X,ct);if(U(X))return Ct(W,z,X,ct);NA(W,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,z!==null&&z.tag===6?(f(W,z.sibling),z=w(z,X),z.return=W,W=z):(f(W,z),z=L1(X,W.mode,ct),z.return=W,W=z),R(W)):f(W,z)}return tn}var $f=YP(!0),KP=YP(!1),$A=ec(null),jA=null,jf=null,BS=null;function zS(){BS=jf=jA=null}function US(a){var c=$A.current;Pe($A),a._currentValue=c}function GS(a,c,f){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===f)break;a=a.return}}function Hf(a,c){jA=a,BS=jf=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&c&&(Ki=!0),a.firstContext=null)}function Js(a){var c=a._currentValue;if(BS!==a)if(a={context:a,memoizedValue:c,next:null},jf===null){if(jA===null)throw Error(e(308));jf=a,jA.dependencies={lanes:0,firstContext:a}}else jf=jf.next=a;return c}var zh=null;function VS(a){zh===null?zh=[a]:zh.push(a)}function QP(a,c,f,y){var w=c.interleaved;return w===null?(f.next=f,VS(c)):(f.next=w.next,w.next=f),c.interleaved=f,wo(a,y)}function wo(a,c){a.lanes|=c;var f=a.alternate;for(f!==null&&(f.lanes|=c),f=a,a=a.return;a!==null;)a.childLanes|=c,f=a.alternate,f!==null&&(f.childLanes|=c),f=a,a=a.return;return f.tag===3?f.stateNode:null}var sc=!1;function WS(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JP(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Eo(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function rc(a,c,f){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,ie&2){var w=y.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),y.pending=c,wo(a,f)}return w=y.interleaved,w===null?(c.next=c,VS(y)):(c.next=w.next,w.next=c),y.interleaved=c,wo(a,f)}function HA(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,f|=y,c.lanes=f,aS(a,f)}}function ZP(a,c){var f=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,f===y)){var w=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var R={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?w=x=R:x=x.next=R,f=f.next}while(f!==null);x===null?w=x=c:x=x.next=c}else w=x=c;f={baseState:y.baseState,firstBaseUpdate:w,lastBaseUpdate:x,shared:y.shared,effects:y.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}function BA(a,c,f,y){var w=a.updateQueue;sc=!1;var x=w.firstBaseUpdate,R=w.lastBaseUpdate,O=w.shared.pending;if(O!==null){w.shared.pending=null;var $=O,K=$.next;$.next=null,R===null?x=K:R.next=K,R=$;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,O=rt.lastBaseUpdate,O!==R&&(O===null?rt.firstBaseUpdate=K:O.next=K,rt.lastBaseUpdate=$))}if(x!==null){var ot=w.baseState;R=0,rt=K=$=null,O=x;do{var st=O.lane,yt=O.eventTime;if((y&st)===st){rt!==null&&(rt=rt.next={eventTime:yt,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});t:{var St=a,Ct=O;switch(st=c,yt=f,Ct.tag){case 1:if(St=Ct.payload,typeof St=="function"){ot=St.call(yt,ot,st);break t}ot=St;break t;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Ct.payload,st=typeof St=="function"?St.call(yt,ot,st):St,st==null)break t;ot=N({},ot,st);break t;case 2:sc=!0}}O.callback!==null&&O.lane!==0&&(a.flags|=64,st=w.effects,st===null?w.effects=[O]:st.push(O))}else yt={eventTime:yt,lane:st,tag:O.tag,payload:O.payload,callback:O.callback,next:null},rt===null?(K=rt=yt,$=ot):rt=rt.next=yt,R|=st;if(O=O.next,O===null){if(O=w.shared.pending,O===null)break;st=O,O=st.next,st.next=null,w.lastBaseUpdate=st,w.shared.pending=null}}while(!0);if(rt===null&&($=ot),w.baseState=$,w.firstBaseUpdate=K,w.lastBaseUpdate=rt,c=w.shared.interleaved,c!==null){w=c;do R|=w.lane,w=w.next;while(w!==c)}else x===null&&(w.shared.lanes=0);Vh|=R,a.lanes=R,a.memoizedState=ot}}function tR(a,c,f){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],w=y.callback;if(w!==null){if(y.callback=null,y=f,typeof w!="function")throw Error(e(191,w));w.call(y)}}}var Km={},Aa=ec(Km),Qm=ec(Km),Jm=ec(Km);function Uh(a){if(a===Km)throw Error(e(174));return a}function qS(a,c){switch(Ce(Jm,c),Ce(Qm,a),Ce(Aa,Km),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ul(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Ul(c,a)}Pe(Aa),Ce(Aa,c)}function Bf(){Pe(Aa),Pe(Qm),Pe(Jm)}function eR(a){Uh(Jm.current);var c=Uh(Aa.current),f=Ul(c,a.type);c!==f&&(Ce(Qm,a),Ce(Aa,f))}function XS(a){Qm.current===a&&(Pe(Aa),Pe(Qm))}var $e=ec(0);function zA(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var YS=[];function KS(){for(var a=0;a<YS.length;a++)YS[a]._workInProgressVersionPrimary=null;YS.length=0}var UA=L.ReactCurrentDispatcher,QS=L.ReactCurrentBatchConfig,Gh=0,je=null,mn=null,Mn=null,GA=!1,Zm=!1,ty=0,X$=0;function fi(){throw Error(e(321))}function JS(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!Lr(a[f],c[f]))return!1;return!0}function ZS(a,c,f,y,w,x){if(Gh=x,je=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,UA.current=a===null||a.memoizedState===null?J$:Z$,a=f(y,w),Zm){x=0;do{if(Zm=!1,ty=0,25<=x)throw Error(e(301));x+=1,Mn=mn=null,c.updateQueue=null,UA.current=tj,a=f(y,w)}while(Zm)}if(UA.current=qA,c=mn!==null&&mn.next!==null,Gh=0,Mn=mn=je=null,GA=!1,c)throw Error(e(300));return a}function t1(){var a=ty!==0;return ty=0,a}function _a(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?je.memoizedState=Mn=a:Mn=Mn.next=a,Mn}function Zs(){if(mn===null){var a=je.alternate;a=a!==null?a.memoizedState:null}else a=mn.next;var c=Mn===null?je.memoizedState:Mn.next;if(c!==null)Mn=c,mn=a;else{if(a===null)throw Error(e(310));mn=a,a={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},Mn===null?je.memoizedState=Mn=a:Mn=Mn.next=a}return Mn}function ey(a,c){return typeof c=="function"?c(a):c}function e1(a){var c=Zs(),f=c.queue;if(f===null)throw Error(e(311));f.lastRenderedReducer=a;var y=mn,w=y.baseQueue,x=f.pending;if(x!==null){if(w!==null){var R=w.next;w.next=x.next,x.next=R}y.baseQueue=w=x,f.pending=null}if(w!==null){x=w.next,y=y.baseState;var O=R=null,$=null,K=x;do{var rt=K.lane;if((Gh&rt)===rt)$!==null&&($=$.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),y=K.hasEagerState?K.eagerState:a(y,K.action);else{var ot={lane:rt,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};$===null?(O=$=ot,R=y):$=$.next=ot,je.lanes|=rt,Vh|=rt}K=K.next}while(K!==null&&K!==x);$===null?R=y:$.next=O,Lr(y,c.memoizedState)||(Ki=!0),c.memoizedState=y,c.baseState=R,c.baseQueue=$,f.lastRenderedState=y}if(a=f.interleaved,a!==null){w=a;do x=w.lane,je.lanes|=x,Vh|=x,w=w.next;while(w!==a)}else w===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function n1(a){var c=Zs(),f=c.queue;if(f===null)throw Error(e(311));f.lastRenderedReducer=a;var y=f.dispatch,w=f.pending,x=c.memoizedState;if(w!==null){f.pending=null;var R=w=w.next;do x=a(x,R.action),R=R.next;while(R!==w);Lr(x,c.memoizedState)||(Ki=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),f.lastRenderedState=x}return[x,y]}function nR(){}function iR(a,c){var f=je,y=Zs(),w=c(),x=!Lr(y.memoizedState,w);if(x&&(y.memoizedState=w,Ki=!0),y=y.queue,i1(aR.bind(null,f,y,a),[a]),y.getSnapshot!==c||x||Mn!==null&&Mn.memoizedState.tag&1){if(f.flags|=2048,ny(9,rR.bind(null,f,y,w,c),void 0,null),In===null)throw Error(e(349));Gh&30||sR(f,c,w)}return w}function sR(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=je.updateQueue,c===null?(c={lastEffect:null,stores:null},je.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function rR(a,c,f,y){c.value=f,c.getSnapshot=y,oR(c)&&lR(a)}function aR(a,c,f){return f(function(){oR(c)&&lR(a)})}function oR(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!Lr(a,f)}catch{return!0}}function lR(a){var c=wo(a,1);c!==null&&Or(c,a,1,-1)}function cR(a){var c=_a();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ey,lastRenderedState:a},c.queue=a,a=a.dispatch=Q$.bind(null,je,a),[c.memoizedState,a]}function ny(a,c,f,y){return a={tag:a,create:c,destroy:f,deps:y,next:null},c=je.updateQueue,c===null?(c={lastEffect:null,stores:null},je.updateQueue=c,c.lastEffect=a.next=a):(f=c.lastEffect,f===null?c.lastEffect=a.next=a:(y=f.next,f.next=a,a.next=y,c.lastEffect=a)),a}function hR(){return Zs().memoizedState}function VA(a,c,f,y){var w=_a();je.flags|=a,w.memoizedState=ny(1|c,f,void 0,y===void 0?null:y)}function WA(a,c,f,y){var w=Zs();y=y===void 0?null:y;var x=void 0;if(mn!==null){var R=mn.memoizedState;if(x=R.destroy,y!==null&&JS(y,R.deps)){w.memoizedState=ny(c,f,x,y);return}}je.flags|=a,w.memoizedState=ny(1|c,f,x,y)}function uR(a,c){return VA(8390656,8,a,c)}function i1(a,c){return WA(2048,8,a,c)}function dR(a,c){return WA(4,2,a,c)}function fR(a,c){return WA(4,4,a,c)}function pR(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function gR(a,c,f){return f=f!=null?f.concat([a]):null,WA(4,4,pR.bind(null,c,a),f)}function s1(){}function mR(a,c){var f=Zs();c=c===void 0?null:c;var y=f.memoizedState;return y!==null&&c!==null&&JS(c,y[1])?y[0]:(f.memoizedState=[a,c],a)}function yR(a,c){var f=Zs();c=c===void 0?null:c;var y=f.memoizedState;return y!==null&&c!==null&&JS(c,y[1])?y[0]:(a=a(),f.memoizedState=[a,c],a)}function vR(a,c,f){return Gh&21?(Lr(f,c)||(f=Xk(),je.lanes|=f,Vh|=f,a.baseState=!0),c):(a.baseState&&(a.baseState=!1,Ki=!0),a.memoizedState=f)}function Y$(a,c){var f=ce;ce=f!==0&&4>f?f:4,a(!0);var y=QS.transition;QS.transition={};try{a(!1),c()}finally{ce=f,QS.transition=y}}function bR(){return Zs().memoizedState}function K$(a,c,f){var y=cc(a);if(f={lane:y,action:f,hasEagerState:!1,eagerState:null,next:null},AR(a))_R(c,f);else if(f=QP(a,c,f,y),f!==null){var w=Di();Or(f,a,y,w),wR(f,c,y)}}function Q$(a,c,f){var y=cc(a),w={lane:y,action:f,hasEagerState:!1,eagerState:null,next:null};if(AR(a))_R(c,w);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var R=c.lastRenderedState,O=x(R,f);if(w.hasEagerState=!0,w.eagerState=O,Lr(O,R)){var $=c.interleaved;$===null?(w.next=w,VS(c)):(w.next=$.next,$.next=w),c.interleaved=w;return}}catch{}finally{}f=QP(a,c,w,y),f!==null&&(w=Di(),Or(f,a,y,w),wR(f,c,y))}}function AR(a){var c=a.alternate;return a===je||c!==null&&c===je}function _R(a,c){Zm=GA=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function wR(a,c,f){if(f&4194240){var y=c.lanes;y&=a.pendingLanes,f|=y,c.lanes=f,aS(a,f)}}var qA={readContext:Js,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},J$={readContext:Js,useCallback:function(a,c){return _a().memoizedState=[a,c===void 0?null:c],a},useContext:Js,useEffect:uR,useImperativeHandle:function(a,c,f){return f=f!=null?f.concat([a]):null,VA(4194308,4,pR.bind(null,c,a),f)},useLayoutEffect:function(a,c){return VA(4194308,4,a,c)},useInsertionEffect:function(a,c){return VA(4,2,a,c)},useMemo:function(a,c){var f=_a();return c=c===void 0?null:c,a=a(),f.memoizedState=[a,c],a},useReducer:function(a,c,f){var y=_a();return c=f!==void 0?f(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=K$.bind(null,je,a),[y.memoizedState,a]},useRef:function(a){var c=_a();return a={current:a},c.memoizedState=a},useState:cR,useDebugValue:s1,useDeferredValue:function(a){return _a().memoizedState=a},useTransition:function(){var a=cR(!1),c=a[0];return a=Y$.bind(null,a[1]),_a().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,f){var y=je,w=_a();if(De){if(f===void 0)throw Error(e(407));f=f()}else{if(f=c(),In===null)throw Error(e(349));Gh&30||sR(y,c,f)}w.memoizedState=f;var x={value:f,getSnapshot:c};return w.queue=x,uR(aR.bind(null,y,x,a),[a]),y.flags|=2048,ny(9,rR.bind(null,y,x,f,c),void 0,null),f},useId:function(){var a=_a(),c=In.identifierPrefix;if(De){var f=_o,y=Ao;f=(y&~(1<<32-Rr(y)-1)).toString(32)+f,c=":"+c+"R"+f,f=ty++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=X$++,c=":"+c+"r"+f.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},Z$={readContext:Js,useCallback:mR,useContext:Js,useEffect:i1,useImperativeHandle:gR,useInsertionEffect:dR,useLayoutEffect:fR,useMemo:yR,useReducer:e1,useRef:hR,useState:function(){return e1(ey)},useDebugValue:s1,useDeferredValue:function(a){var c=Zs();return vR(c,mn.memoizedState,a)},useTransition:function(){var a=e1(ey)[0],c=Zs().memoizedState;return[a,c]},useMutableSource:nR,useSyncExternalStore:iR,useId:bR,unstable_isNewReconciler:!1},tj={readContext:Js,useCallback:mR,useContext:Js,useEffect:i1,useImperativeHandle:gR,useInsertionEffect:dR,useLayoutEffect:fR,useMemo:yR,useReducer:n1,useRef:hR,useState:function(){return n1(ey)},useDebugValue:s1,useDeferredValue:function(a){var c=Zs();return mn===null?c.memoizedState=a:vR(c,mn.memoizedState,a)},useTransition:function(){var a=n1(ey)[0],c=Zs().memoizedState;return[a,c]},useMutableSource:nR,useSyncExternalStore:iR,useId:bR,unstable_isNewReconciler:!1};function Ir(a,c){if(a&&a.defaultProps){c=N({},c),a=a.defaultProps;for(var f in a)c[f]===void 0&&(c[f]=a[f]);return c}return c}function r1(a,c,f,y){c=a.memoizedState,f=f(y,c),f=f==null?c:N({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var XA={isMounted:function(a){return(a=a._reactInternals)?Nh(a)===a:!1},enqueueSetState:function(a,c,f){a=a._reactInternals;var y=Di(),w=cc(a),x=Eo(y,w);x.payload=c,f!=null&&(x.callback=f),c=rc(a,x,w),c!==null&&(Or(c,a,w,y),HA(c,a,w))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var y=Di(),w=cc(a),x=Eo(y,w);x.tag=1,x.payload=c,f!=null&&(x.callback=f),c=rc(a,x,w),c!==null&&(Or(c,a,w,y),HA(c,a,w))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=Di(),y=cc(a),w=Eo(f,y);w.tag=2,c!=null&&(w.callback=c),c=rc(a,w,y),c!==null&&(Or(c,a,y,f),HA(c,a,y))}};function ER(a,c,f,y,w,x,R){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,x,R):c.prototype&&c.prototype.isPureReactComponent?!zm(f,y)||!zm(w,x):!0}function SR(a,c,f){var y=!1,w=nc,x=c.contextType;return typeof x=="object"&&x!==null?x=Js(x):(w=Yi(c)?jh:di.current,y=c.contextTypes,x=(y=y!=null)?Df(a,w):nc),c=new c(f,x),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=XA,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=w,a.__reactInternalMemoizedMaskedChildContext=x),c}function xR(a,c,f,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,y),c.state!==a&&XA.enqueueReplaceState(c,c.state,null)}function a1(a,c,f,y){var w=a.stateNode;w.props=f,w.state=a.memoizedState,w.refs={},WS(a);var x=c.contextType;typeof x=="object"&&x!==null?w.context=Js(x):(x=Yi(c)?jh:di.current,w.context=Df(a,x)),w.state=a.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(r1(a,c,x,f),w.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(c=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),c!==w.state&&XA.enqueueReplaceState(w,w.state,null),BA(a,f,w,y),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308)}function zf(a,c){try{var f="",y=c;do f+=dt(y),y=y.return;while(y);var w=f}catch(x){w=`
Error generating stack: `+x.message+`
`+x.stack}return{value:a,source:c,stack:w,digest:null}}function o1(a,c,f){return{value:a,source:null,stack:f??null,digest:c??null}}function l1(a,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var ej=typeof WeakMap=="function"?WeakMap:Map;function CR(a,c,f){f=Eo(-1,f),f.tag=3,f.payload={element:null};var y=c.value;return f.callback=function(){e_||(e_=!0,E1=y),l1(a,c)},f}function TR(a,c,f){f=Eo(-1,f),f.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var w=c.value;f.payload=function(){return y(w)},f.callback=function(){l1(a,c)}}var x=a.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){l1(a,c),typeof y!="function"&&(oc===null?oc=new Set([this]):oc.add(this));var R=c.stack;this.componentDidCatch(c.value,{componentStack:R!==null?R:""})}),f}function kR(a,c,f){var y=a.pingCache;if(y===null){y=a.pingCache=new ej;var w=new Set;y.set(c,w)}else w=y.get(c),w===void 0&&(w=new Set,y.set(c,w));w.has(f)||(w.add(f),a=gj.bind(null,a,c,f),c.then(a,a))}function PR(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function RR(a,c,f,y,w){return a.mode&1?(a.flags|=65536,a.lanes=w,a):(a===c?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=Eo(-1,1),c.tag=2,rc(f,c,1))),f.lanes|=1),a)}var nj=L.ReactCurrentOwner,Ki=!1;function Ii(a,c,f,y){c.child=a===null?KP(c,null,f,y):$f(c,a.child,f,y)}function LR(a,c,f,y,w){f=f.render;var x=c.ref;return Hf(c,w),y=ZS(a,c,f,y,x,w),f=t1(),a!==null&&!Ki?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~w,So(a,c,w)):(De&&f&&OS(c),c.flags|=1,Ii(a,c,y,w),c.child)}function MR(a,c,f,y,w){if(a===null){var x=f.type;return typeof x=="function"&&!R1(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=x,IR(a,c,x,y,w)):(a=o_(f.type,null,y,c,c.mode,w),a.ref=c.ref,a.return=c,c.child=a)}if(x=a.child,!(a.lanes&w)){var R=x.memoizedProps;if(f=f.compare,f=f!==null?f:zm,f(R,y)&&a.ref===c.ref)return So(a,c,w)}return c.flags|=1,a=uc(x,y),a.ref=c.ref,a.return=c,c.child=a}function IR(a,c,f,y,w){if(a!==null){var x=a.memoizedProps;if(zm(x,y)&&a.ref===c.ref)if(Ki=!1,c.pendingProps=y=x,(a.lanes&w)!==0)a.flags&131072&&(Ki=!0);else return c.lanes=a.lanes,So(a,c,w)}return c1(a,c,f,y,w)}function DR(a,c,f){var y=c.pendingProps,w=y.children,x=a!==null?a.memoizedState:null;if(y.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(Gf,As),As|=f;else{if(!(f&1073741824))return a=x!==null?x.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,Ce(Gf,As),As|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=x!==null?x.baseLanes:f,Ce(Gf,As),As|=y}else x!==null?(y=x.baseLanes|f,c.memoizedState=null):y=f,Ce(Gf,As),As|=y;return Ii(a,c,w,f),c.child}function FR(a,c){var f=c.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function c1(a,c,f,y,w){var x=Yi(f)?jh:di.current;return x=Df(c,x),Hf(c,w),f=ZS(a,c,f,y,x,w),y=t1(),a!==null&&!Ki?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~w,So(a,c,w)):(De&&y&&OS(c),c.flags|=1,Ii(a,c,f,w),c.child)}function OR(a,c,f,y,w){if(Yi(f)){var x=!0;MA(c)}else x=!1;if(Hf(c,w),c.stateNode===null)KA(a,c),SR(c,f,y),a1(c,f,y,w),y=!0;else if(a===null){var R=c.stateNode,O=c.memoizedProps;R.props=O;var $=R.context,K=f.contextType;typeof K=="object"&&K!==null?K=Js(K):(K=Yi(f)?jh:di.current,K=Df(c,K));var rt=f.getDerivedStateFromProps,ot=typeof rt=="function"||typeof R.getSnapshotBeforeUpdate=="function";ot||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(O!==y||$!==K)&&xR(c,R,y,K),sc=!1;var st=c.memoizedState;R.state=st,BA(c,y,R,w),$=c.memoizedState,O!==y||st!==$||Xi.current||sc?(typeof rt=="function"&&(r1(c,f,rt,y),$=c.memoizedState),(O=sc||ER(c,f,O,y,st,$,K))?(ot||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(c.flags|=4194308)):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=$),R.props=y,R.state=$,R.context=K,y=O):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{R=c.stateNode,JP(a,c),O=c.memoizedProps,K=c.type===c.elementType?O:Ir(c.type,O),R.props=K,ot=c.pendingProps,st=R.context,$=f.contextType,typeof $=="object"&&$!==null?$=Js($):($=Yi(f)?jh:di.current,$=Df(c,$));var yt=f.getDerivedStateFromProps;(rt=typeof yt=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(O!==ot||st!==$)&&xR(c,R,y,$),sc=!1,st=c.memoizedState,R.state=st,BA(c,y,R,w);var St=c.memoizedState;O!==ot||st!==St||Xi.current||sc?(typeof yt=="function"&&(r1(c,f,yt,y),St=c.memoizedState),(K=sc||ER(c,f,K,y,st,St,$)||!1)?(rt||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(y,St,$),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(y,St,$)),typeof R.componentDidUpdate=="function"&&(c.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof R.componentDidUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=St),R.props=y,R.state=St,R.context=$,y=K):(typeof R.componentDidUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&st===a.memoizedState||(c.flags|=1024),y=!1)}return h1(a,c,f,y,x,w)}function h1(a,c,f,y,w,x){FR(a,c);var R=(c.flags&128)!==0;if(!y&&!R)return w&&BP(c,f,!1),So(a,c,x);y=c.stateNode,nj.current=c;var O=R&&typeof f.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&R?(c.child=$f(c,a.child,null,x),c.child=$f(c,null,O,x)):Ii(a,c,O,x),c.memoizedState=y.state,w&&BP(c,f,!0),c.child}function NR(a){var c=a.stateNode;c.pendingContext?jP(a,c.pendingContext,c.pendingContext!==c.context):c.context&&jP(a,c.context,!1),qS(a,c.containerInfo)}function $R(a,c,f,y,w){return Nf(),HS(w),c.flags|=256,Ii(a,c,f,y),c.child}var u1={dehydrated:null,treeContext:null,retryLane:0};function d1(a){return{baseLanes:a,cachePool:null,transitions:null}}function jR(a,c,f){var y=c.pendingProps,w=$e.current,x=!1,R=(c.flags&128)!==0,O;if((O=R)||(O=a!==null&&a.memoizedState===null?!1:(w&2)!==0),O?(x=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(w|=1),Ce($e,w&1),a===null)return jS(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(c.mode&1?a.data==="$!"?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(R=y.children,a=y.fallback,x?(y=c.mode,x=c.child,R={mode:"hidden",children:R},!(y&1)&&x!==null?(x.childLanes=0,x.pendingProps=R):x=l_(R,y,0,null),a=Yh(a,y,f,null),x.return=c,a.return=c,x.sibling=a,c.child=x,c.child.memoizedState=d1(f),c.memoizedState=u1,a):f1(c,R));if(w=a.memoizedState,w!==null&&(O=w.dehydrated,O!==null))return ij(a,c,R,y,O,w,f);if(x){x=y.fallback,R=c.mode,w=a.child,O=w.sibling;var $={mode:"hidden",children:y.children};return!(R&1)&&c.child!==w?(y=c.child,y.childLanes=0,y.pendingProps=$,c.deletions=null):(y=uc(w,$),y.subtreeFlags=w.subtreeFlags&14680064),O!==null?x=uc(O,x):(x=Yh(x,R,f,null),x.flags|=2),x.return=c,y.return=c,y.sibling=x,c.child=y,y=x,x=c.child,R=a.child.memoizedState,R=R===null?d1(f):{baseLanes:R.baseLanes|f,cachePool:null,transitions:R.transitions},x.memoizedState=R,x.childLanes=a.childLanes&~f,c.memoizedState=u1,y}return x=a.child,a=x.sibling,y=uc(x,{mode:"visible",children:y.children}),!(c.mode&1)&&(y.lanes=f),y.return=c,y.sibling=null,a!==null&&(f=c.deletions,f===null?(c.deletions=[a],c.flags|=16):f.push(a)),c.child=y,c.memoizedState=null,y}function f1(a,c){return c=l_({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function YA(a,c,f,y){return y!==null&&HS(y),$f(c,a.child,null,f),a=f1(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function ij(a,c,f,y,w,x,R){if(f)return c.flags&256?(c.flags&=-257,y=o1(Error(e(422))),YA(a,c,R,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(x=y.fallback,w=c.mode,y=l_({mode:"visible",children:y.children},w,0,null),x=Yh(x,w,R,null),x.flags|=2,y.return=c,x.return=c,y.sibling=x,c.child=y,c.mode&1&&$f(c,a.child,null,R),c.child.memoizedState=d1(R),c.memoizedState=u1,x);if(!(c.mode&1))return YA(a,c,R,null);if(w.data==="$!"){if(y=w.nextSibling&&w.nextSibling.dataset,y)var O=y.dgst;return y=O,x=Error(e(419)),y=o1(x,y,void 0),YA(a,c,R,y)}if(O=(R&a.childLanes)!==0,Ki||O){if(y=In,y!==null){switch(R&-R){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=w&(y.suspendedLanes|R)?0:w,w!==0&&w!==x.retryLane&&(x.retryLane=w,wo(a,w),Or(y,a,w,-1))}return P1(),y=o1(Error(e(421))),YA(a,c,R,y)}return w.data==="$?"?(c.flags|=128,c.child=a.child,c=mj.bind(null,a),w._reactRetry=c,null):(a=x.treeContext,bs=tc(w.nextSibling),vs=c,De=!0,Mr=null,a!==null&&(Ks[Qs++]=Ao,Ks[Qs++]=_o,Ks[Qs++]=Hh,Ao=a.id,_o=a.overflow,Hh=c),c=f1(c,y.children),c.flags|=4096,c)}function HR(a,c,f){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),GS(a.return,c,f)}function p1(a,c,f,y,w){var x=a.memoizedState;x===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:f,tailMode:w}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=y,x.tail=f,x.tailMode=w)}function BR(a,c,f){var y=c.pendingProps,w=y.revealOrder,x=y.tail;if(Ii(a,c,y.children,f),y=$e.current,y&2)y=y&1|2,c.flags|=128;else{if(a!==null&&a.flags&128)t:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&HR(a,f,c);else if(a.tag===19)HR(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break t;for(;a.sibling===null;){if(a.return===null||a.return===c)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(Ce($e,y),!(c.mode&1))c.memoizedState=null;else switch(w){case"forwards":for(f=c.child,w=null;f!==null;)a=f.alternate,a!==null&&zA(a)===null&&(w=f),f=f.sibling;f=w,f===null?(w=c.child,c.child=null):(w=f.sibling,f.sibling=null),p1(c,!1,w,f,x);break;case"backwards":for(f=null,w=c.child,c.child=null;w!==null;){if(a=w.alternate,a!==null&&zA(a)===null){c.child=w;break}a=w.sibling,w.sibling=f,f=w,w=a}p1(c,!0,f,null,x);break;case"together":p1(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function KA(a,c){!(c.mode&1)&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function So(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),Vh|=c.lanes,!(f&c.childLanes))return null;if(a!==null&&c.child!==a.child)throw Error(e(153));if(c.child!==null){for(a=c.child,f=uc(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=uc(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function sj(a,c,f){switch(c.tag){case 3:NR(c),Nf();break;case 5:eR(c);break;case 1:Yi(c.type)&&MA(c);break;case 4:qS(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,w=c.memoizedProps.value;Ce($A,y._currentValue),y._currentValue=w;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(Ce($e,$e.current&1),c.flags|=128,null):f&c.child.childLanes?jR(a,c,f):(Ce($e,$e.current&1),a=So(a,c,f),a!==null?a.sibling:null);Ce($e,$e.current&1);break;case 19:if(y=(f&c.childLanes)!==0,a.flags&128){if(y)return BR(a,c,f);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ce($e,$e.current),y)break;return null;case 22:case 23:return c.lanes=0,DR(a,c,f)}return So(a,c,f)}var zR,g1,UR,GR;zR=function(a,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},g1=function(){},UR=function(a,c,f,y){var w=a.memoizedProps;if(w!==y){a=c.stateNode,Uh(Aa.current);var x=null;switch(f){case"input":w=xe(a,w),y=xe(a,y),x=[];break;case"select":w=N({},w,{value:void 0}),y=N({},y,{value:void 0}),x=[];break;case"textarea":w=ps(a,w),y=ps(a,y),x=[];break;default:typeof w.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=PA)}qn(f,y);var R;f=null;for(K in w)if(!y.hasOwnProperty(K)&&w.hasOwnProperty(K)&&w[K]!=null)if(K==="style"){var O=w[K];for(R in O)O.hasOwnProperty(R)&&(f||(f={}),f[R]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(i.hasOwnProperty(K)?x||(x=[]):(x=x||[]).push(K,null));for(K in y){var $=y[K];if(O=w!=null?w[K]:void 0,y.hasOwnProperty(K)&&$!==O&&($!=null||O!=null))if(K==="style")if(O){for(R in O)!O.hasOwnProperty(R)||$&&$.hasOwnProperty(R)||(f||(f={}),f[R]="");for(R in $)$.hasOwnProperty(R)&&O[R]!==$[R]&&(f||(f={}),f[R]=$[R])}else f||(x||(x=[]),x.push(K,f)),f=$;else K==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,O=O?O.__html:void 0,$!=null&&O!==$&&(x=x||[]).push(K,$)):K==="children"?typeof $!="string"&&typeof $!="number"||(x=x||[]).push(K,""+$):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(i.hasOwnProperty(K)?($!=null&&K==="onScroll"&&ke("scroll",a),x||O===$||(x=[])):(x=x||[]).push(K,$))}f&&(x=x||[]).push("style",f);var K=x;(c.updateQueue=K)&&(c.flags|=4)}},GR=function(a,c,f,y){f!==y&&(c.flags|=4)};function iy(a,c){if(!De)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var y=null;f!==null;)f.alternate!==null&&(y=f),f=f.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function pi(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,y=0;if(c)for(var w=a.child;w!==null;)f|=w.lanes|w.childLanes,y|=w.subtreeFlags&14680064,y|=w.flags&14680064,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)f|=w.lanes|w.childLanes,y|=w.subtreeFlags,y|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=y,a.childLanes=f,c}function rj(a,c,f){var y=c.pendingProps;switch(NS(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pi(c),null;case 1:return Yi(c.type)&&LA(),pi(c),null;case 3:return y=c.stateNode,Bf(),Pe(Xi),Pe(di),KS(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(OA(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Mr!==null&&(C1(Mr),Mr=null))),g1(a,c),pi(c),null;case 5:XS(c);var w=Uh(Jm.current);if(f=c.type,a!==null&&c.stateNode!=null)UR(a,c,f,y,w),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(e(166));return pi(c),null}if(a=Uh(Aa.current),OA(c)){y=c.stateNode,f=c.type;var x=c.memoizedProps;switch(y[ba]=c,y[qm]=x,a=(c.mode&1)!==0,f){case"dialog":ke("cancel",y),ke("close",y);break;case"iframe":case"object":case"embed":ke("load",y);break;case"video":case"audio":for(w=0;w<Gm.length;w++)ke(Gm[w],y);break;case"source":ke("error",y);break;case"img":case"image":case"link":ke("error",y),ke("load",y);break;case"details":ke("toggle",y);break;case"input":on(y,x),ke("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!x.multiple},ke("invalid",y);break;case"textarea":ma(y,x),ke("invalid",y)}qn(f,x),w=null;for(var R in x)if(x.hasOwnProperty(R)){var O=x[R];R==="children"?typeof O=="string"?y.textContent!==O&&(x.suppressHydrationWarning!==!0&&kA(y.textContent,O,a),w=["children",O]):typeof O=="number"&&y.textContent!==""+O&&(x.suppressHydrationWarning!==!0&&kA(y.textContent,O,a),w=["children",""+O]):i.hasOwnProperty(R)&&O!=null&&R==="onScroll"&&ke("scroll",y)}switch(f){case"input":Qt(y),Cr(y,x,!0);break;case"textarea":Qt(y),po(y);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(y.onclick=PA)}y=w,c.updateQueue=y,y!==null&&(c.flags|=4)}else{R=w.nodeType===9?w:w.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=go(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=R.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=R.createElement(f,{is:y.is}):(a=R.createElement(f),f==="select"&&(R=a,y.multiple?R.multiple=!0:y.size&&(R.size=y.size))):a=R.createElementNS(a,f),a[ba]=c,a[qm]=y,zR(a,c,!1,!1),c.stateNode=a;t:{switch(R=Fh(f,y),f){case"dialog":ke("cancel",a),ke("close",a),w=y;break;case"iframe":case"object":case"embed":ke("load",a),w=y;break;case"video":case"audio":for(w=0;w<Gm.length;w++)ke(Gm[w],a);w=y;break;case"source":ke("error",a),w=y;break;case"img":case"image":case"link":ke("error",a),ke("load",a),w=y;break;case"details":ke("toggle",a),w=y;break;case"input":on(a,y),w=xe(a,y),ke("invalid",a);break;case"option":w=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},w=N({},y,{value:void 0}),ke("invalid",a);break;case"textarea":ma(a,y),w=ps(a,y),ke("invalid",a);break;default:w=y}qn(f,w),O=w;for(x in O)if(O.hasOwnProperty(x)){var $=O[x];x==="style"?gs(a,$):x==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&kr(a,$)):x==="children"?typeof $=="string"?(f!=="textarea"||$!=="")&&ye(a,$):typeof $=="number"&&ye(a,""+$):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(i.hasOwnProperty(x)?$!=null&&x==="onScroll"&&ke("scroll",a):$!=null&&P(a,x,$,R))}switch(f){case"input":Qt(a),Cr(a,y,!1);break;case"textarea":Qt(a),po(a);break;case"option":y.value!=null&&a.setAttribute("value",""+vt(y.value));break;case"select":a.multiple=!!y.multiple,x=y.value,x!=null?Li(a,!!y.multiple,x,!1):y.defaultValue!=null&&Li(a,!!y.multiple,y.defaultValue,!0);break;default:typeof w.onClick=="function"&&(a.onclick=PA)}switch(f){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break t;case"img":y=!0;break t;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return pi(c),null;case 6:if(a&&c.stateNode!=null)GR(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(e(166));if(f=Uh(Jm.current),Uh(Aa.current),OA(c)){if(y=c.stateNode,f=c.memoizedProps,y[ba]=c,(x=y.nodeValue!==f)&&(a=vs,a!==null))switch(a.tag){case 3:kA(y.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&kA(y.nodeValue,f,(a.mode&1)!==0)}x&&(c.flags|=4)}else y=(f.nodeType===9?f:f.ownerDocument).createTextNode(y),y[ba]=c,c.stateNode=y}return pi(c),null;case 13:if(Pe($e),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(De&&bs!==null&&c.mode&1&&!(c.flags&128))qP(),Nf(),c.flags|=98560,x=!1;else if(x=OA(c),y!==null&&y.dehydrated!==null){if(a===null){if(!x)throw Error(e(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(e(317));x[ba]=c}else Nf(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;pi(c),x=!1}else Mr!==null&&(C1(Mr),Mr=null),x=!0;if(!x)return c.flags&65536?c:null}return c.flags&128?(c.lanes=f,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,c.mode&1&&(a===null||$e.current&1?yn===0&&(yn=3):P1())),c.updateQueue!==null&&(c.flags|=4),pi(c),null);case 4:return Bf(),g1(a,c),a===null&&Vm(c.stateNode.containerInfo),pi(c),null;case 10:return US(c.type._context),pi(c),null;case 17:return Yi(c.type)&&LA(),pi(c),null;case 19:if(Pe($e),x=c.memoizedState,x===null)return pi(c),null;if(y=(c.flags&128)!==0,R=x.rendering,R===null)if(y)iy(x,!1);else{if(yn!==0||a!==null&&a.flags&128)for(a=c.child;a!==null;){if(R=zA(a),R!==null){for(c.flags|=128,iy(x,!1),y=R.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=f,f=c.child;f!==null;)x=f,a=y,x.flags&=14680066,R=x.alternate,R===null?(x.childLanes=0,x.lanes=a,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=R.childLanes,x.lanes=R.lanes,x.child=R.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=R.memoizedProps,x.memoizedState=R.memoizedState,x.updateQueue=R.updateQueue,x.type=R.type,a=R.dependencies,x.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return Ce($e,$e.current&1|2),c.child}a=a.sibling}x.tail!==null&&Ze()>Vf&&(c.flags|=128,y=!0,iy(x,!1),c.lanes=4194304)}else{if(!y)if(a=zA(R),a!==null){if(c.flags|=128,y=!0,f=a.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),iy(x,!0),x.tail===null&&x.tailMode==="hidden"&&!R.alternate&&!De)return pi(c),null}else 2*Ze()-x.renderingStartTime>Vf&&f!==1073741824&&(c.flags|=128,y=!0,iy(x,!1),c.lanes=4194304);x.isBackwards?(R.sibling=c.child,c.child=R):(f=x.last,f!==null?f.sibling=R:c.child=R,x.last=R)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Ze(),c.sibling=null,f=$e.current,Ce($e,y?f&1|2:f&1),c):(pi(c),null);case 22:case 23:return k1(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&c.mode&1?As&1073741824&&(pi(c),c.subtreeFlags&6&&(c.flags|=8192)):pi(c),null;case 24:return null;case 25:return null}throw Error(e(156,c.tag))}function aj(a,c){switch(NS(c),c.tag){case 1:return Yi(c.type)&&LA(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Bf(),Pe(Xi),Pe(di),KS(),a=c.flags,a&65536&&!(a&128)?(c.flags=a&-65537|128,c):null;case 5:return XS(c),null;case 13:if(Pe($e),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(e(340));Nf()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Pe($e),null;case 4:return Bf(),null;case 10:return US(c.type._context),null;case 22:case 23:return k1(),null;case 24:return null;default:return null}}var QA=!1,gi=!1,oj=typeof WeakSet=="function"?WeakSet:Set,_t=null;function Uf(a,c){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(y){We(a,c,y)}else f.current=null}function m1(a,c,f){try{f()}catch(y){We(a,c,y)}}var VR=!1;function lj(a,c){if(kS=yA,a=EP(),AS(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else t:{f=(f=a.ownerDocument)&&f.defaultView||window;var y=f.getSelection&&f.getSelection();if(y&&y.rangeCount!==0){f=y.anchorNode;var w=y.anchorOffset,x=y.focusNode;y=y.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break t}var R=0,O=-1,$=-1,K=0,rt=0,ot=a,st=null;e:for(;;){for(var yt;ot!==f||w!==0&&ot.nodeType!==3||(O=R+w),ot!==x||y!==0&&ot.nodeType!==3||($=R+y),ot.nodeType===3&&(R+=ot.nodeValue.length),(yt=ot.firstChild)!==null;)st=ot,ot=yt;for(;;){if(ot===a)break e;if(st===f&&++K===w&&(O=R),st===x&&++rt===y&&($=R),(yt=ot.nextSibling)!==null)break;ot=st,st=ot.parentNode}ot=yt}f=O===-1||$===-1?null:{start:O,end:$}}else f=null}f=f||{start:0,end:0}}else f=null;for(PS={focusedElem:a,selectionRange:f},yA=!1,_t=c;_t!==null;)if(c=_t,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_t=a;else for(;_t!==null;){c=_t;try{var St=c.alternate;if(c.flags&1024)switch(c.tag){case 0:case 11:case 15:break;case 1:if(St!==null){var Ct=St.memoizedProps,tn=St.memoizedState,W=c.stateNode,z=W.getSnapshotBeforeUpdate(c.elementType===c.type?Ct:Ir(c.type,Ct),tn);W.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var X=c.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(ct){We(c,c.return,ct)}if(a=c.sibling,a!==null){a.return=c.return,_t=a;break}_t=c.return}return St=VR,VR=!1,St}function sy(a,c,f){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var w=y=y.next;do{if((w.tag&a)===a){var x=w.destroy;w.destroy=void 0,x!==void 0&&m1(c,f,x)}w=w.next}while(w!==y)}}function JA(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&a)===a){var y=f.create;f.destroy=y()}f=f.next}while(f!==c)}}function y1(a){var c=a.ref;if(c!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof c=="function"?c(a):c.current=a}}function WR(a){var c=a.alternate;c!==null&&(a.alternate=null,WR(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[ba],delete c[qm],delete c[IS],delete c[G$],delete c[V$])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function qR(a){return a.tag===5||a.tag===3||a.tag===4}function XR(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||qR(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function v1(a,c,f){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(a,c):f.insertBefore(a,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(a,f)):(c=f,c.appendChild(a)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=PA));else if(y!==4&&(a=a.child,a!==null))for(v1(a,c,f),a=a.sibling;a!==null;)v1(a,c,f),a=a.sibling}function b1(a,c,f){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(b1(a,c,f),a=a.sibling;a!==null;)b1(a,c,f),a=a.sibling}var Yn=null,Dr=!1;function ac(a,c,f){for(f=f.child;f!==null;)YR(a,c,f),f=f.sibling}function YR(a,c,f){if(va&&typeof va.onCommitFiberUnmount=="function")try{va.onCommitFiberUnmount(uA,f)}catch{}switch(f.tag){case 5:gi||Uf(f,c);case 6:var y=Yn,w=Dr;Yn=null,ac(a,c,f),Yn=y,Dr=w,Yn!==null&&(Dr?(a=Yn,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):Yn.removeChild(f.stateNode));break;case 18:Yn!==null&&(Dr?(a=Yn,f=f.stateNode,a.nodeType===8?MS(a.parentNode,f):a.nodeType===1&&MS(a,f),Om(a)):MS(Yn,f.stateNode));break;case 4:y=Yn,w=Dr,Yn=f.stateNode.containerInfo,Dr=!0,ac(a,c,f),Yn=y,Dr=w;break;case 0:case 11:case 14:case 15:if(!gi&&(y=f.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){w=y=y.next;do{var x=w,R=x.destroy;x=x.tag,R!==void 0&&(x&2||x&4)&&m1(f,c,R),w=w.next}while(w!==y)}ac(a,c,f);break;case 1:if(!gi&&(Uf(f,c),y=f.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=f.memoizedProps,y.state=f.memoizedState,y.componentWillUnmount()}catch(O){We(f,c,O)}ac(a,c,f);break;case 21:ac(a,c,f);break;case 22:f.mode&1?(gi=(y=gi)||f.memoizedState!==null,ac(a,c,f),gi=y):ac(a,c,f);break;default:ac(a,c,f)}}function KR(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new oj),c.forEach(function(y){var w=yj.bind(null,a,y);f.has(y)||(f.add(y),y.then(w,w))})}}function Fr(a,c){var f=c.deletions;if(f!==null)for(var y=0;y<f.length;y++){var w=f[y];try{var x=a,R=c,O=R;t:for(;O!==null;){switch(O.tag){case 5:Yn=O.stateNode,Dr=!1;break t;case 3:Yn=O.stateNode.containerInfo,Dr=!0;break t;case 4:Yn=O.stateNode.containerInfo,Dr=!0;break t}O=O.return}if(Yn===null)throw Error(e(160));YR(x,R,w),Yn=null,Dr=!1;var $=w.alternate;$!==null&&($.return=null),w.return=null}catch(K){We(w,c,K)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)QR(c,a),c=c.sibling}function QR(a,c){var f=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Fr(c,a),wa(a),y&4){try{sy(3,a,a.return),JA(3,a)}catch(Ct){We(a,a.return,Ct)}try{sy(5,a,a.return)}catch(Ct){We(a,a.return,Ct)}}break;case 1:Fr(c,a),wa(a),y&512&&f!==null&&Uf(f,f.return);break;case 5:if(Fr(c,a),wa(a),y&512&&f!==null&&Uf(f,f.return),a.flags&32){var w=a.stateNode;try{ye(w,"")}catch(Ct){We(a,a.return,Ct)}}if(y&4&&(w=a.stateNode,w!=null)){var x=a.memoizedProps,R=f!==null?f.memoizedProps:x,O=a.type,$=a.updateQueue;if(a.updateQueue=null,$!==null)try{O==="input"&&x.type==="radio"&&x.name!=null&&ci(w,x),Fh(O,R);var K=Fh(O,x);for(R=0;R<$.length;R+=2){var rt=$[R],ot=$[R+1];rt==="style"?gs(w,ot):rt==="dangerouslySetInnerHTML"?kr(w,ot):rt==="children"?ye(w,ot):P(w,rt,ot,K)}switch(O){case"input":hi(w,x);break;case"textarea":Tr(w,x);break;case"select":var st=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!x.multiple;var yt=x.value;yt!=null?Li(w,!!x.multiple,yt,!1):st!==!!x.multiple&&(x.defaultValue!=null?Li(w,!!x.multiple,x.defaultValue,!0):Li(w,!!x.multiple,x.multiple?[]:"",!1))}w[qm]=x}catch(Ct){We(a,a.return,Ct)}}break;case 6:if(Fr(c,a),wa(a),y&4){if(a.stateNode===null)throw Error(e(162));w=a.stateNode,x=a.memoizedProps;try{w.nodeValue=x}catch(Ct){We(a,a.return,Ct)}}break;case 3:if(Fr(c,a),wa(a),y&4&&f!==null&&f.memoizedState.isDehydrated)try{Om(c.containerInfo)}catch(Ct){We(a,a.return,Ct)}break;case 4:Fr(c,a),wa(a);break;case 13:Fr(c,a),wa(a),w=a.child,w.flags&8192&&(x=w.memoizedState!==null,w.stateNode.isHidden=x,!x||w.alternate!==null&&w.alternate.memoizedState!==null||(w1=Ze())),y&4&&KR(a);break;case 22:if(rt=f!==null&&f.memoizedState!==null,a.mode&1?(gi=(K=gi)||rt,Fr(c,a),gi=K):Fr(c,a),wa(a),y&8192){if(K=a.memoizedState!==null,(a.stateNode.isHidden=K)&&!rt&&a.mode&1)for(_t=a,rt=a.child;rt!==null;){for(ot=_t=rt;_t!==null;){switch(st=_t,yt=st.child,st.tag){case 0:case 11:case 14:case 15:sy(4,st,st.return);break;case 1:Uf(st,st.return);var St=st.stateNode;if(typeof St.componentWillUnmount=="function"){y=st,f=st.return;try{c=y,St.props=c.memoizedProps,St.state=c.memoizedState,St.componentWillUnmount()}catch(Ct){We(y,f,Ct)}}break;case 5:Uf(st,st.return);break;case 22:if(st.memoizedState!==null){tL(ot);continue}}yt!==null?(yt.return=st,_t=yt):tL(ot)}rt=rt.sibling}t:for(rt=null,ot=a;;){if(ot.tag===5){if(rt===null){rt=ot;try{w=ot.stateNode,K?(x=w.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(O=ot.stateNode,$=ot.memoizedProps.style,R=$!=null&&$.hasOwnProperty("display")?$.display:null,O.style.display=ui("display",R))}catch(Ct){We(a,a.return,Ct)}}}else if(ot.tag===6){if(rt===null)try{ot.stateNode.nodeValue=K?"":ot.memoizedProps}catch(Ct){We(a,a.return,Ct)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===a)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===a)break t;for(;ot.sibling===null;){if(ot.return===null||ot.return===a)break t;rt===ot&&(rt=null),ot=ot.return}rt===ot&&(rt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:Fr(c,a),wa(a),y&4&&KR(a);break;case 21:break;default:Fr(c,a),wa(a)}}function wa(a){var c=a.flags;if(c&2){try{t:{for(var f=a.return;f!==null;){if(qR(f)){var y=f;break t}f=f.return}throw Error(e(160))}switch(y.tag){case 5:var w=y.stateNode;y.flags&32&&(ye(w,""),y.flags&=-33);var x=XR(a);b1(a,x,w);break;case 3:case 4:var R=y.stateNode.containerInfo,O=XR(a);v1(a,O,R);break;default:throw Error(e(161))}}catch($){We(a,a.return,$)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function cj(a,c,f){_t=a,JR(a)}function JR(a,c,f){for(var y=(a.mode&1)!==0;_t!==null;){var w=_t,x=w.child;if(w.tag===22&&y){var R=w.memoizedState!==null||QA;if(!R){var O=w.alternate,$=O!==null&&O.memoizedState!==null||gi;O=QA;var K=gi;if(QA=R,(gi=$)&&!K)for(_t=w;_t!==null;)R=_t,$=R.child,R.tag===22&&R.memoizedState!==null?eL(w):$!==null?($.return=R,_t=$):eL(w);for(;x!==null;)_t=x,JR(x),x=x.sibling;_t=w,QA=O,gi=K}ZR(a)}else w.subtreeFlags&8772&&x!==null?(x.return=w,_t=x):ZR(a)}}function ZR(a){for(;_t!==null;){var c=_t;if(c.flags&8772){var f=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:gi||JA(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!gi)if(f===null)y.componentDidMount();else{var w=c.elementType===c.type?f.memoizedProps:Ir(c.type,f.memoizedProps);y.componentDidUpdate(w,f.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&tR(c,x,y);break;case 3:var R=c.updateQueue;if(R!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}tR(c,R,f)}break;case 5:var O=c.stateNode;if(f===null&&c.flags&4){f=O;var $=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&f.focus();break;case"img":$.src&&(f.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var K=c.alternate;if(K!==null){var rt=K.memoizedState;if(rt!==null){var ot=rt.dehydrated;ot!==null&&Om(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}gi||c.flags&512&&y1(c)}catch(st){We(c,c.return,st)}}if(c===a){_t=null;break}if(f=c.sibling,f!==null){f.return=c.return,_t=f;break}_t=c.return}}function tL(a){for(;_t!==null;){var c=_t;if(c===a){_t=null;break}var f=c.sibling;if(f!==null){f.return=c.return,_t=f;break}_t=c.return}}function eL(a){for(;_t!==null;){var c=_t;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{JA(4,c)}catch($){We(c,f,$)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var w=c.return;try{y.componentDidMount()}catch($){We(c,w,$)}}var x=c.return;try{y1(c)}catch($){We(c,x,$)}break;case 5:var R=c.return;try{y1(c)}catch($){We(c,R,$)}}}catch($){We(c,c.return,$)}if(c===a){_t=null;break}var O=c.sibling;if(O!==null){O.return=c.return,_t=O;break}_t=c.return}}var hj=Math.ceil,ZA=L.ReactCurrentDispatcher,A1=L.ReactCurrentOwner,tr=L.ReactCurrentBatchConfig,ie=0,In=null,cn=null,Kn=0,As=0,Gf=ec(0),yn=0,ry=null,Vh=0,t_=0,_1=0,ay=null,Qi=null,w1=0,Vf=1/0,xo=null,e_=!1,E1=null,oc=null,n_=!1,lc=null,i_=0,oy=0,S1=null,s_=-1,r_=0;function Di(){return ie&6?Ze():s_!==-1?s_:s_=Ze()}function cc(a){return a.mode&1?ie&2&&Kn!==0?Kn&-Kn:q$.transition!==null?(r_===0&&(r_=Xk()),r_):(a=ce,a!==0||(a=window.event,a=a===void 0?16:iP(a.type)),a):1}function Or(a,c,f,y){if(50<oy)throw oy=0,S1=null,Error(e(185));Lm(a,f,y),(!(ie&2)||a!==In)&&(a===In&&(!(ie&2)&&(t_|=f),yn===4&&hc(a,Kn)),Ji(a,y),f===1&&ie===0&&!(c.mode&1)&&(Vf=Ze()+500,IA&&ic()))}function Ji(a,c){var f=a.callbackNode;q2(a,c);var y=pA(a,a===In?Kn:0);if(y===0)f!==null&&Vk(f),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(f!=null&&Vk(f),c===1)a.tag===0?W$(iL.bind(null,a)):zP(iL.bind(null,a)),z$(function(){!(ie&6)&&ic()}),f=null;else{switch(Yk(y)){case 1:f=iS;break;case 4:f=Wk;break;case 16:f=hA;break;case 536870912:f=qk;break;default:f=hA}f=uL(f,nL.bind(null,a))}a.callbackPriority=c,a.callbackNode=f}}function nL(a,c){if(s_=-1,r_=0,ie&6)throw Error(e(327));var f=a.callbackNode;if(Wf()&&a.callbackNode!==f)return null;var y=pA(a,a===In?Kn:0);if(y===0)return null;if(y&30||y&a.expiredLanes||c)c=a_(a,y);else{c=y;var w=ie;ie|=2;var x=rL();(In!==a||Kn!==c)&&(xo=null,Vf=Ze()+500,qh(a,c));do try{fj();break}catch(O){sL(a,O)}while(!0);zS(),ZA.current=x,ie=w,cn!==null?c=0:(In=null,Kn=0,c=yn)}if(c!==0){if(c===2&&(w=sS(a),w!==0&&(y=w,c=x1(a,w))),c===1)throw f=ry,qh(a,0),hc(a,y),Ji(a,Ze()),f;if(c===6)hc(a,y);else{if(w=a.current.alternate,!(y&30)&&!uj(w)&&(c=a_(a,y),c===2&&(x=sS(a),x!==0&&(y=x,c=x1(a,x))),c===1))throw f=ry,qh(a,0),hc(a,y),Ji(a,Ze()),f;switch(a.finishedWork=w,a.finishedLanes=y,c){case 0:case 1:throw Error(e(345));case 2:Xh(a,Qi,xo);break;case 3:if(hc(a,y),(y&130023424)===y&&(c=w1+500-Ze(),10<c)){if(pA(a,0)!==0)break;if(w=a.suspendedLanes,(w&y)!==y){Di(),a.pingedLanes|=a.suspendedLanes&w;break}a.timeoutHandle=LS(Xh.bind(null,a,Qi,xo),c);break}Xh(a,Qi,xo);break;case 4:if(hc(a,y),(y&4194240)===y)break;for(c=a.eventTimes,w=-1;0<y;){var R=31-Rr(y);x=1<<R,R=c[R],R>w&&(w=R),y&=~x}if(y=w,y=Ze()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*hj(y/1960))-y,10<y){a.timeoutHandle=LS(Xh.bind(null,a,Qi,xo),y);break}Xh(a,Qi,xo);break;case 5:Xh(a,Qi,xo);break;default:throw Error(e(329))}}}return Ji(a,Ze()),a.callbackNode===f?nL.bind(null,a):null}function x1(a,c){var f=ay;return a.current.memoizedState.isDehydrated&&(qh(a,c).flags|=256),a=a_(a,c),a!==2&&(c=Qi,Qi=f,c!==null&&C1(c)),a}function C1(a){Qi===null?Qi=a:Qi.push.apply(Qi,a)}function uj(a){for(var c=a;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var y=0;y<f.length;y++){var w=f[y],x=w.getSnapshot;w=w.value;try{if(!Lr(x(),w))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function hc(a,c){for(c&=~_1,c&=~t_,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var f=31-Rr(c),y=1<<f;a[f]=-1,c&=~y}}function iL(a){if(ie&6)throw Error(e(327));Wf();var c=pA(a,0);if(!(c&1))return Ji(a,Ze()),null;var f=a_(a,c);if(a.tag!==0&&f===2){var y=sS(a);y!==0&&(c=y,f=x1(a,y))}if(f===1)throw f=ry,qh(a,0),hc(a,c),Ji(a,Ze()),f;if(f===6)throw Error(e(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Xh(a,Qi,xo),Ji(a,Ze()),null}function T1(a,c){var f=ie;ie|=1;try{return a(c)}finally{ie=f,ie===0&&(Vf=Ze()+500,IA&&ic())}}function Wh(a){lc!==null&&lc.tag===0&&!(ie&6)&&Wf();var c=ie;ie|=1;var f=tr.transition,y=ce;try{if(tr.transition=null,ce=1,a)return a()}finally{ce=y,tr.transition=f,ie=c,!(ie&6)&&ic()}}function k1(){As=Gf.current,Pe(Gf)}function qh(a,c){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,B$(f)),cn!==null)for(f=cn.return;f!==null;){var y=f;switch(NS(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&LA();break;case 3:Bf(),Pe(Xi),Pe(di),KS();break;case 5:XS(y);break;case 4:Bf();break;case 13:Pe($e);break;case 19:Pe($e);break;case 10:US(y.type._context);break;case 22:case 23:k1()}f=f.return}if(In=a,cn=a=uc(a.current,null),Kn=As=c,yn=0,ry=null,_1=t_=Vh=0,Qi=ay=null,zh!==null){for(c=0;c<zh.length;c++)if(f=zh[c],y=f.interleaved,y!==null){f.interleaved=null;var w=y.next,x=f.pending;if(x!==null){var R=x.next;x.next=w,y.next=R}f.pending=y}zh=null}return a}function sL(a,c){do{var f=cn;try{if(zS(),UA.current=qA,GA){for(var y=je.memoizedState;y!==null;){var w=y.queue;w!==null&&(w.pending=null),y=y.next}GA=!1}if(Gh=0,Mn=mn=je=null,Zm=!1,ty=0,A1.current=null,f===null||f.return===null){yn=1,ry=c,cn=null;break}t:{var x=a,R=f.return,O=f,$=c;if(c=Kn,O.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var K=$,rt=O,ot=rt.tag;if(!(rt.mode&1)&&(ot===0||ot===11||ot===15)){var st=rt.alternate;st?(rt.updateQueue=st.updateQueue,rt.memoizedState=st.memoizedState,rt.lanes=st.lanes):(rt.updateQueue=null,rt.memoizedState=null)}var yt=PR(R);if(yt!==null){yt.flags&=-257,RR(yt,R,O,x,c),yt.mode&1&&kR(x,K,c),c=yt,$=K;var St=c.updateQueue;if(St===null){var Ct=new Set;Ct.add($),c.updateQueue=Ct}else St.add($);break t}else{if(!(c&1)){kR(x,K,c),P1();break t}$=Error(e(426))}}else if(De&&O.mode&1){var tn=PR(R);if(tn!==null){!(tn.flags&65536)&&(tn.flags|=256),RR(tn,R,O,x,c),HS(zf($,O));break t}}x=$=zf($,O),yn!==4&&(yn=2),ay===null?ay=[x]:ay.push(x),x=R;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var W=CR(x,$,c);ZP(x,W);break t;case 1:O=$;var z=x.type,X=x.stateNode;if(!(x.flags&128)&&(typeof z.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(oc===null||!oc.has(X)))){x.flags|=65536,c&=-c,x.lanes|=c;var ct=TR(x,O,c);ZP(x,ct);break t}}x=x.return}while(x!==null)}oL(f)}catch(Tt){c=Tt,cn===f&&f!==null&&(cn=f=f.return);continue}break}while(!0)}function rL(){var a=ZA.current;return ZA.current=qA,a===null?qA:a}function P1(){(yn===0||yn===3||yn===2)&&(yn=4),In===null||!(Vh&268435455)&&!(t_&268435455)||hc(In,Kn)}function a_(a,c){var f=ie;ie|=2;var y=rL();(In!==a||Kn!==c)&&(xo=null,qh(a,c));do try{dj();break}catch(w){sL(a,w)}while(!0);if(zS(),ie=f,ZA.current=y,cn!==null)throw Error(e(261));return In=null,Kn=0,yn}function dj(){for(;cn!==null;)aL(cn)}function fj(){for(;cn!==null&&!$2();)aL(cn)}function aL(a){var c=hL(a.alternate,a,As);a.memoizedProps=a.pendingProps,c===null?oL(a):cn=c,A1.current=null}function oL(a){var c=a;do{var f=c.alternate;if(a=c.return,c.flags&32768){if(f=aj(f,c),f!==null){f.flags&=32767,cn=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{yn=6,cn=null;return}}else if(f=rj(f,c,As),f!==null){cn=f;return}if(c=c.sibling,c!==null){cn=c;return}cn=c=a}while(c!==null);yn===0&&(yn=5)}function Xh(a,c,f){var y=ce,w=tr.transition;try{tr.transition=null,ce=1,pj(a,c,f,y)}finally{tr.transition=w,ce=y}return null}function pj(a,c,f,y){do Wf();while(lc!==null);if(ie&6)throw Error(e(327));f=a.finishedWork;var w=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(e(177));a.callbackNode=null,a.callbackPriority=0;var x=f.lanes|f.childLanes;if(X2(a,x),a===In&&(cn=In=null,Kn=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||n_||(n_=!0,uL(hA,function(){return Wf(),null})),x=(f.flags&15990)!==0,f.subtreeFlags&15990||x){x=tr.transition,tr.transition=null;var R=ce;ce=1;var O=ie;ie|=4,A1.current=null,lj(a,f),QR(f,a),D$(PS),yA=!!kS,PS=kS=null,a.current=f,cj(f),j2(),ie=O,ce=R,tr.transition=x}else a.current=f;if(n_&&(n_=!1,lc=a,i_=w),x=a.pendingLanes,x===0&&(oc=null),z2(f.stateNode),Ji(a,Ze()),c!==null)for(y=a.onRecoverableError,f=0;f<c.length;f++)w=c[f],y(w.value,{componentStack:w.stack,digest:w.digest});if(e_)throw e_=!1,a=E1,E1=null,a;return i_&1&&a.tag!==0&&Wf(),x=a.pendingLanes,x&1?a===S1?oy++:(oy=0,S1=a):oy=0,ic(),null}function Wf(){if(lc!==null){var a=Yk(i_),c=tr.transition,f=ce;try{if(tr.transition=null,ce=16>a?16:a,lc===null)var y=!1;else{if(a=lc,lc=null,i_=0,ie&6)throw Error(e(331));var w=ie;for(ie|=4,_t=a.current;_t!==null;){var x=_t,R=x.child;if(_t.flags&16){var O=x.deletions;if(O!==null){for(var $=0;$<O.length;$++){var K=O[$];for(_t=K;_t!==null;){var rt=_t;switch(rt.tag){case 0:case 11:case 15:sy(8,rt,x)}var ot=rt.child;if(ot!==null)ot.return=rt,_t=ot;else for(;_t!==null;){rt=_t;var st=rt.sibling,yt=rt.return;if(WR(rt),rt===K){_t=null;break}if(st!==null){st.return=yt,_t=st;break}_t=yt}}}var St=x.alternate;if(St!==null){var Ct=St.child;if(Ct!==null){St.child=null;do{var tn=Ct.sibling;Ct.sibling=null,Ct=tn}while(Ct!==null)}}_t=x}}if(x.subtreeFlags&2064&&R!==null)R.return=x,_t=R;else t:for(;_t!==null;){if(x=_t,x.flags&2048)switch(x.tag){case 0:case 11:case 15:sy(9,x,x.return)}var W=x.sibling;if(W!==null){W.return=x.return,_t=W;break t}_t=x.return}}var z=a.current;for(_t=z;_t!==null;){R=_t;var X=R.child;if(R.subtreeFlags&2064&&X!==null)X.return=R,_t=X;else t:for(R=z;_t!==null;){if(O=_t,O.flags&2048)try{switch(O.tag){case 0:case 11:case 15:JA(9,O)}}catch(Tt){We(O,O.return,Tt)}if(O===R){_t=null;break t}var ct=O.sibling;if(ct!==null){ct.return=O.return,_t=ct;break t}_t=O.return}}if(ie=w,ic(),va&&typeof va.onPostCommitFiberRoot=="function")try{va.onPostCommitFiberRoot(uA,a)}catch{}y=!0}return y}finally{ce=f,tr.transition=c}}return!1}function lL(a,c,f){c=zf(f,c),c=CR(a,c,1),a=rc(a,c,1),c=Di(),a!==null&&(Lm(a,1,c),Ji(a,c))}function We(a,c,f){if(a.tag===3)lL(a,a,f);else for(;c!==null;){if(c.tag===3){lL(c,a,f);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(oc===null||!oc.has(y))){a=zf(f,a),a=TR(c,a,1),c=rc(c,a,1),a=Di(),c!==null&&(Lm(c,1,a),Ji(c,a));break}}c=c.return}}function gj(a,c,f){var y=a.pingCache;y!==null&&y.delete(c),c=Di(),a.pingedLanes|=a.suspendedLanes&f,In===a&&(Kn&f)===f&&(yn===4||yn===3&&(Kn&130023424)===Kn&&500>Ze()-w1?qh(a,0):_1|=f),Ji(a,c)}function cL(a,c){c===0&&(a.mode&1?(c=fA,fA<<=1,!(fA&130023424)&&(fA=4194304)):c=1);var f=Di();a=wo(a,c),a!==null&&(Lm(a,c,f),Ji(a,f))}function mj(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),cL(a,f)}function yj(a,c){var f=0;switch(a.tag){case 13:var y=a.stateNode,w=a.memoizedState;w!==null&&(f=w.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(e(314))}y!==null&&y.delete(c),cL(a,f)}var hL;hL=function(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps||Xi.current)Ki=!0;else{if(!(a.lanes&f)&&!(c.flags&128))return Ki=!1,sj(a,c,f);Ki=!!(a.flags&131072)}else Ki=!1,De&&c.flags&1048576&&UP(c,FA,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;KA(a,c),a=c.pendingProps;var w=Df(c,di.current);Hf(c,f),w=ZS(null,c,y,a,w,f);var x=t1();return c.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Yi(y)?(x=!0,MA(c)):x=!1,c.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,WS(c),w.updater=XA,c.stateNode=w,w._reactInternals=c,a1(c,y,a,f),c=h1(null,c,y,!0,x,f)):(c.tag=0,De&&x&&OS(c),Ii(null,c,w,f),c=c.child),c;case 16:y=c.elementType;t:{switch(KA(a,c),a=c.pendingProps,w=y._init,y=w(y._payload),c.type=y,w=c.tag=bj(y),a=Ir(y,a),w){case 0:c=c1(null,c,y,a,f);break t;case 1:c=OR(null,c,y,a,f);break t;case 11:c=LR(null,c,y,a,f);break t;case 14:c=MR(null,c,y,Ir(y.type,a),f);break t}throw Error(e(306,y,""))}return c;case 0:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ir(y,w),c1(a,c,y,w,f);case 1:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ir(y,w),OR(a,c,y,w,f);case 3:t:{if(NR(c),a===null)throw Error(e(387));y=c.pendingProps,x=c.memoizedState,w=x.element,JP(a,c),BA(c,y,null,f);var R=c.memoizedState;if(y=R.element,x.isDehydrated)if(x={element:y,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){w=zf(Error(e(423)),c),c=$R(a,c,y,f,w);break t}else if(y!==w){w=zf(Error(e(424)),c),c=$R(a,c,y,f,w);break t}else for(bs=tc(c.stateNode.containerInfo.firstChild),vs=c,De=!0,Mr=null,f=KP(c,null,y,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Nf(),y===w){c=So(a,c,f);break t}Ii(a,c,y,f)}c=c.child}return c;case 5:return eR(c),a===null&&jS(c),y=c.type,w=c.pendingProps,x=a!==null?a.memoizedProps:null,R=w.children,RS(y,w)?R=null:x!==null&&RS(y,x)&&(c.flags|=32),FR(a,c),Ii(a,c,R,f),c.child;case 6:return a===null&&jS(c),null;case 13:return jR(a,c,f);case 4:return qS(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=$f(c,null,y,f):Ii(a,c,y,f),c.child;case 11:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ir(y,w),LR(a,c,y,w,f);case 7:return Ii(a,c,c.pendingProps,f),c.child;case 8:return Ii(a,c,c.pendingProps.children,f),c.child;case 12:return Ii(a,c,c.pendingProps.children,f),c.child;case 10:t:{if(y=c.type._context,w=c.pendingProps,x=c.memoizedProps,R=w.value,Ce($A,y._currentValue),y._currentValue=R,x!==null)if(Lr(x.value,R)){if(x.children===w.children&&!Xi.current){c=So(a,c,f);break t}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var O=x.dependencies;if(O!==null){R=x.child;for(var $=O.firstContext;$!==null;){if($.context===y){if(x.tag===1){$=Eo(-1,f&-f),$.tag=2;var K=x.updateQueue;if(K!==null){K=K.shared;var rt=K.pending;rt===null?$.next=$:($.next=rt.next,rt.next=$),K.pending=$}}x.lanes|=f,$=x.alternate,$!==null&&($.lanes|=f),GS(x.return,f,c),O.lanes|=f;break}$=$.next}}else if(x.tag===10)R=x.type===c.type?null:x.child;else if(x.tag===18){if(R=x.return,R===null)throw Error(e(341));R.lanes|=f,O=R.alternate,O!==null&&(O.lanes|=f),GS(R,f,c),R=x.sibling}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===c){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}Ii(a,c,w.children,f),c=c.child}return c;case 9:return w=c.type,y=c.pendingProps.children,Hf(c,f),w=Js(w),y=y(w),c.flags|=1,Ii(a,c,y,f),c.child;case 14:return y=c.type,w=Ir(y,c.pendingProps),w=Ir(y.type,w),MR(a,c,y,w,f);case 15:return IR(a,c,c.type,c.pendingProps,f);case 17:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ir(y,w),KA(a,c),c.tag=1,Yi(y)?(a=!0,MA(c)):a=!1,Hf(c,f),SR(c,y,w),a1(c,y,w,f),h1(null,c,y,!0,a,f);case 19:return BR(a,c,f);case 22:return DR(a,c,f)}throw Error(e(156,c.tag))};function uL(a,c){return Gk(a,c)}function vj(a,c,f,y){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(a,c,f,y){return new vj(a,c,f,y)}function R1(a){return a=a.prototype,!(!a||!a.isReactComponent)}function bj(a){if(typeof a=="function")return R1(a)?1:0;if(a!=null){if(a=a.$$typeof,a===tt)return 11;if(a===ht)return 14}return 2}function uc(a,c){var f=a.alternate;return f===null?(f=er(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function o_(a,c,f,y,w,x){var R=2;if(y=a,typeof a=="function")R1(a)&&(R=1);else if(typeof a=="string")R=5;else t:switch(a){case F:return Yh(f.children,w,x,c);case H:R=8,w|=8;break;case j:return a=er(12,f,c,w|2),a.elementType=j,a.lanes=x,a;case Z:return a=er(13,f,c,w),a.elementType=Z,a.lanes=x,a;case et:return a=er(19,f,c,w),a.elementType=et,a.lanes=x,a;case G:return l_(f,w,x,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Q:R=10;break t;case V:R=9;break t;case tt:R=11;break t;case ht:R=14;break t;case J:R=16,y=null;break t}throw Error(e(130,a==null?a:typeof a,""))}return c=er(R,f,c,w),c.elementType=a,c.type=y,c.lanes=x,c}function Yh(a,c,f,y){return a=er(7,a,y,c),a.lanes=f,a}function l_(a,c,f,y){return a=er(22,a,y,c),a.elementType=G,a.lanes=f,a.stateNode={isHidden:!1},a}function L1(a,c,f){return a=er(6,a,null,c),a.lanes=f,a}function M1(a,c,f){return c=er(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function Aj(a,c,f,y,w){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rS(0),this.expirationTimes=rS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rS(0),this.identifierPrefix=y,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function I1(a,c,f,y,w,x,R,O,$){return a=new Aj(a,c,f,O,$),c===1?(c=1,x===!0&&(c|=8)):c=0,x=er(3,null,null,c),a.current=x,x.stateNode=a,x.memoizedState={element:y,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},WS(x),a}function _j(a,c,f){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:y==null?null:""+y,children:a,containerInfo:c,implementation:f}}function dL(a){if(!a)return nc;a=a._reactInternals;t:{if(Nh(a)!==a||a.tag!==1)throw Error(e(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(Yi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(e(171))}if(a.tag===1){var f=a.type;if(Yi(f))return HP(a,f,c)}return c}function fL(a,c,f,y,w,x,R,O,$){return a=I1(f,y,!0,a,w,x,R,O,$),a.context=dL(null),f=a.current,y=Di(),w=cc(f),x=Eo(y,w),x.callback=c??null,rc(f,x,w),a.current.lanes=w,Lm(a,w,y),Ji(a,y),a}function c_(a,c,f,y){var w=c.current,x=Di(),R=cc(w);return f=dL(f),c.context===null?c.context=f:c.pendingContext=f,c=Eo(x,R),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=rc(w,c,R),a!==null&&(Or(a,w,R,x),HA(a,w,R)),R}function h_(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function pL(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function D1(a,c){pL(a,c),(a=a.alternate)&&pL(a,c)}var gL=typeof reportError=="function"?reportError:function(a){console.error(a)};function F1(a){this._internalRoot=a}u_.prototype.render=F1.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(e(409));c_(a,c,null,null)},u_.prototype.unmount=F1.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Wh(function(){c_(null,a,null,null)}),c[vo]=null}};function u_(a){this._internalRoot=a}u_.prototype.unstable_scheduleHydration=function(a){if(a){var c=Jk();a={blockedOn:null,target:a,priority:c};for(var f=0;f<Ql.length&&c!==0&&c<Ql[f].priority;f++);Ql.splice(f,0,a),f===0&&eP(a)}};function O1(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function d_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function mL(){}function wj(a,c,f,y,w){if(w){if(typeof y=="function"){var x=y;y=function(){var K=h_(R);x.call(K)}}var R=fL(c,y,a,0,null,!1,!1,"",mL);return a._reactRootContainer=R,a[vo]=R.current,Vm(a.nodeType===8?a.parentNode:a),Wh(),R}for(;w=a.lastChild;)a.removeChild(w);if(typeof y=="function"){var O=y;y=function(){var K=h_($);O.call(K)}}var $=I1(a,0,!1,null,null,!1,!1,"",mL);return a._reactRootContainer=$,a[vo]=$.current,Vm(a.nodeType===8?a.parentNode:a),Wh(function(){c_(c,$,f,y)}),$}function f_(a,c,f,y,w){var x=f._reactRootContainer;if(x){var R=x;if(typeof w=="function"){var O=w;w=function(){var $=h_(R);O.call($)}}c_(c,R,a,w)}else R=wj(f,c,a,w,y);return h_(R)}Kk=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var f=Rm(c.pendingLanes);f!==0&&(aS(c,f|1),Ji(c,Ze()),!(ie&6)&&(Vf=Ze()+500,ic()))}break;case 13:Wh(function(){var y=wo(a,1);if(y!==null){var w=Di();Or(y,a,1,w)}}),D1(a,1)}},oS=function(a){if(a.tag===13){var c=wo(a,134217728);if(c!==null){var f=Di();Or(c,a,134217728,f)}D1(a,134217728)}},Qk=function(a){if(a.tag===13){var c=cc(a),f=wo(a,c);if(f!==null){var y=Di();Or(f,a,c,y)}D1(a,c)}},Jk=function(){return ce},Zk=function(a,c){var f=ce;try{return ce=a,c()}finally{ce=f}},Mi=function(a,c,f){switch(c){case"input":if(hi(a,f),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var y=f[c];if(y!==a&&y.form===a.form){var w=RA(y);if(!w)throw Error(e(90));Se(y),hi(y,w)}}}break;case"textarea":Tr(a,f);break;case"select":c=f.value,c!=null&&Li(a,!!f.multiple,c,!1)}},oA=T1,mo=Wh;var Ej={usingClientEntryPoint:!1,Events:[Xm,Mf,RA,rA,aA,T1]},ly={findFiberByHostInstance:$h,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sj={bundleType:ly.bundleType,version:ly.version,rendererPackageName:ly.rendererPackageName,rendererConfig:ly.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=zk(a),a===null?null:a.stateNode},findFiberByHostInstance:ly.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var p_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!p_.isDisabled&&p_.supportsFiber)try{uA=p_.inject(Sj),va=p_}catch{}}return Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ej,Zi.createPortal=function(a,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O1(c))throw Error(e(200));return _j(a,c,null,f)},Zi.createRoot=function(a,c){if(!O1(a))throw Error(e(299));var f=!1,y="",w=gL;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(w=c.onRecoverableError)),c=I1(a,1,!1,null,null,f,!1,y,w),a[vo]=c.current,Vm(a.nodeType===8?a.parentNode:a),new F1(c)},Zi.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(e(188)):(a=Object.keys(a).join(","),Error(e(268,a)));return a=zk(c),a=a===null?null:a.stateNode,a},Zi.flushSync=function(a){return Wh(a)},Zi.hydrate=function(a,c,f){if(!d_(c))throw Error(e(200));return f_(null,a,c,!0,f)},Zi.hydrateRoot=function(a,c,f){if(!O1(a))throw Error(e(405));var y=f!=null&&f.hydratedSources||null,w=!1,x="",R=gL;if(f!=null&&(f.unstable_strictMode===!0&&(w=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(R=f.onRecoverableError)),c=fL(c,null,a,1,f??null,w,!1,x,R),a[vo]=c.current,Vm(a),y)for(a=0;a<y.length;a++)f=y[a],w=f._getVersion,w=w(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,w]:c.mutableSourceEagerHydrationData.push(f,w);return new u_(c)},Zi.render=function(a,c,f){if(!d_(c))throw Error(e(200));return f_(null,a,c,!1,f)},Zi.unmountComponentAtNode=function(a){if(!d_(a))throw Error(e(40));return a._reactRootContainer?(Wh(function(){f_(null,null,a,!1,function(){a._reactRootContainer=null,a[vo]=null})}),!0):!1},Zi.unstable_batchedUpdates=T1,Zi.unstable_renderSubtreeIntoContainer=function(a,c,f,y){if(!d_(f))throw Error(e(200));if(a==null||a._reactInternals===void 0)throw Error(e(38));return f_(a,c,f,!1,y)},Zi.version="18.3.1-next-f1338f8080-20240426",Zi}var xL;function Dj(){if(xL)return H1.exports;xL=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(t){console.error(t)}}return u(),H1.exports=Ij(),H1.exports}var CL;function Fj(){if(CL)return g_;CL=1;var u=Dj();return g_.createRoot=u.createRoot,g_.hydrateRoot=u.hydrateRoot,g_}var Oj=Fj();function df(u){return Object.keys(u)}function U1(u){return u&&typeof u=="object"&&!Array.isArray(u)}function ik(u,t){const e={...u},n=t;return U1(u)&&U1(t)&&Object.keys(t).forEach(i=>{U1(n[i])&&i in u?e[i]=ik(e[i],n[i]):e[i]=n[i]}),e}function Nj(u){var t;return typeof u!="string"||!u.includes("var(--mantine-scale)")?u:(t=u.match(/^calc\((.*?)\)$/))==null?void 0:t[1].split("*")[0].trim()}function $j(u){const t=Nj(u);return typeof t=="number"?t:typeof t=="string"?t.includes("calc")||t.includes("var")?t:t.includes("px")?Number(t.replace("px","")):t.includes("rem")?Number(t.replace("rem",""))*16:t.includes("em")?Number(t.replace("em",""))*16:Number(t):NaN}function G1(u){return u==="0rem"?"0rem":`calc(${u} * var(--mantine-scale))`}function sD(u,{shouldScale:t=!1}={}){function e(n){if(n===0||n==="0")return`0${u}`;if(typeof n=="number"){const i=`${n/16}${u}`;return t?G1(i):i}if(typeof n=="string"){if(n===""||n.startsWith("calc(")||n.startsWith("clamp(")||n.includes("rgba("))return n;if(n.includes(","))return n.split(",").map(s=>e(s)).join(",");if(n.includes(" "))return n.split(" ").map(s=>e(s)).join(" ");if(n.includes(u))return t?G1(n):n;const i=n.replace("px","");if(!Number.isNaN(Number(i))){const s=`${Number(i)/16}${u}`;return t?G1(s):s}}return n}return e}const pt=sD("rem",{shouldScale:!0}),TL=sD("em"),rD=typeof document<"u"?Qe.useLayoutEffect:Qe.useEffect,aD=Qe.createContext(null);function oD(){const u=Qe.useContext(aD);if(!u)throw new Error("[@mantine/core] MantineProvider was not found in tree");return u}function jj(){return oD().cssVariablesResolver}function lD(){return oD().getStyleNonce}function Hj(u){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(u)}function Bj(u){let t=u.replace("#","");if(t.length===3){const o=t.split("");t=[o[0],o[0],o[1],o[1],o[2],o[2]].join("")}if(t.length===8){const o=parseInt(t.slice(6,8),16)/255;return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:o}}const e=parseInt(t,16),n=e>>16&255,i=e>>8&255,s=e&255;return{r:n,g:i,b:s,a:1}}function zj(u){const[t,e,n,i]=u.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:t,g:e,b:n,a:i||1}}function Uj(u){const t=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,e=u.match(t);if(!e)return{r:0,g:0,b:0,a:1};const n=parseInt(e[1],10),i=parseInt(e[2],10)/100,s=parseInt(e[3],10)/100,o=e[5]?parseFloat(e[5]):void 0,l=(1-Math.abs(2*s-1))*i,h=n/60,d=l*(1-Math.abs(h%2-1)),p=s-l/2;let g,m,b;return h>=0&&h<1?(g=l,m=d,b=0):h>=1&&h<2?(g=d,m=l,b=0):h>=2&&h<3?(g=0,m=l,b=d):h>=3&&h<4?(g=0,m=d,b=l):h>=4&&h<5?(g=d,m=0,b=l):(g=l,m=0,b=d),{r:Math.round((g+p)*255),g:Math.round((m+p)*255),b:Math.round((b+p)*255),a:o||1}}function sk(u){return Hj(u)?Bj(u):u.startsWith("rgb")?zj(u):u.startsWith("hsl")?Uj(u):{r:0,g:0,b:0,a:1}}function m_(u,t){if(u.startsWith("var("))return`color-mix(in srgb, ${u}, black ${t*100}%)`;const{r:e,g:n,b:i,a:s}=sk(u),o=1-t,l=h=>Math.round(h*o);return`rgba(${l(e)}, ${l(n)}, ${l(i)}, ${s})`}function lv(u,t){return typeof u.primaryShade=="number"?u.primaryShade:t==="dark"?u.primaryShade.dark:u.primaryShade.light}function V1(u){return u<=.03928?u/12.92:((u+.055)/1.055)**2.4}function Gj(u){const t=u.match(/oklch\((.*?)%\s/);return t?parseFloat(t[1]):null}function Vj(u){if(u.startsWith("oklch("))return(Gj(u)||0)/100;const{r:t,g:e,b:n}=sk(u),i=t/255,s=e/255,o=n/255,l=V1(i),h=V1(s),d=V1(o);return .2126*l+.7152*h+.0722*d}function hy(u,t=.179){return u.startsWith("var(")?!1:Vj(u)>t}function rk({color:u,theme:t,colorScheme:e}){if(typeof u!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof u}`);if(u==="bright")return{color:u,value:e==="dark"?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:hy(e==="dark"?t.white:t.black,t.luminanceThreshold),variable:"--mantine-color-bright"};if(u==="dimmed")return{color:u,value:e==="dark"?t.colors.dark[2]:t.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:hy(e==="dark"?t.colors.dark[2]:t.colors.gray[6],t.luminanceThreshold),variable:"--mantine-color-dimmed"};if(u==="white"||u==="black")return{color:u,value:u==="white"?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:hy(u==="white"?t.white:t.black,t.luminanceThreshold),variable:`--mantine-color-${u}`};const[n,i]=u.split("."),s=i?Number(i):void 0,o=n in t.colors;if(o){const l=s!==void 0?t.colors[n][s]:t.colors[n][lv(t,e||"light")];return{color:n,value:l,shade:s,isThemeColor:o,isLight:hy(l,t.luminanceThreshold),variable:i?`--mantine-color-${n}-${s}`:`--mantine-color-${n}-filled`}}return{color:u,value:u,isThemeColor:o,isLight:hy(u,t.luminanceThreshold),shade:s,variable:void 0}}function kL(u,t){const e=rk({color:u||t.primaryColor,theme:t});return e.variable?`var(${e.variable})`:u}function PL(u,t){const e={from:(u==null?void 0:u.from)||t.defaultGradient.from,to:(u==null?void 0:u.to)||t.defaultGradient.to,deg:(u==null?void 0:u.deg)||t.defaultGradient.deg||0},n=kL(e.from,t),i=kL(e.to,t);return`linear-gradient(${e.deg}deg, ${n} 0%, ${i} 100%)`}function Po(u,t){if(typeof u!="string"||t>1||t<0)return"rgba(0, 0, 0, 1)";if(u.startsWith("var(")){const s=(1-t)*100;return`color-mix(in srgb, ${u}, transparent ${s}%)`}if(u.startsWith("oklch"))return u.includes("/")?u.replace(/\/\s*[\d.]+\s*\)/,`/ ${t})`):u.replace(")",` / ${t})`);const{r:e,g:n,b:i}=sk(u);return`rgba(${e}, ${n}, ${i}, ${t})`}const qf=Po,Wj=({color:u,theme:t,variant:e,gradient:n,autoContrast:i})=>{const s=rk({color:u,theme:t}),o=typeof i=="boolean"?i:t.autoContrast;if(e==="filled"){const l=o&&s.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return s.isThemeColor?s.shade===void 0?{background:`var(--mantine-color-${u}-filled)`,hover:`var(--mantine-color-${u}-filled-hover)`,color:l,border:`${pt(1)} solid transparent`}:{background:`var(--mantine-color-${s.color}-${s.shade})`,hover:`var(--mantine-color-${s.color}-${s.shade===9?8:s.shade+1})`,color:l,border:`${pt(1)} solid transparent`}:{background:u,hover:m_(u,.1),color:l,border:`${pt(1)} solid transparent`}}if(e==="light"){if(s.isThemeColor){if(s.shade===void 0)return{background:`var(--mantine-color-${u}-light)`,hover:`var(--mantine-color-${u}-light-hover)`,color:`var(--mantine-color-${u}-light-color)`,border:`${pt(1)} solid transparent`};const l=t.colors[s.color][s.shade];return{background:Po(l,.1),hover:Po(l,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${pt(1)} solid transparent`}}return{background:Po(u,.1),hover:Po(u,.12),color:u,border:`${pt(1)} solid transparent`}}if(e==="outline")return s.isThemeColor?s.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${u}-outline-hover)`,color:`var(--mantine-color-${u}-outline)`,border:`${pt(1)} solid var(--mantine-color-${u}-outline)`}:{background:"transparent",hover:Po(t.colors[s.color][s.shade],.05),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${pt(1)} solid var(--mantine-color-${s.color}-${s.shade})`}:{background:"transparent",hover:Po(u,.05),color:u,border:`${pt(1)} solid ${u}`};if(e==="subtle"){if(s.isThemeColor){if(s.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${u}-light-hover)`,color:`var(--mantine-color-${u}-light-color)`,border:`${pt(1)} solid transparent`};const l=t.colors[s.color][s.shade];return{background:"transparent",hover:Po(l,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${pt(1)} solid transparent`}}return{background:"transparent",hover:Po(u,.12),color:u,border:`${pt(1)} solid transparent`}}return e==="transparent"?s.isThemeColor?s.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${u}-light-color)`,border:`${pt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${pt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:u,border:`${pt(1)} solid transparent`}:e==="white"?s.isThemeColor?s.shade===void 0?{background:"var(--mantine-color-white)",hover:m_(t.white,.01),color:`var(--mantine-color-${u}-filled)`,border:`${pt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:m_(t.white,.01),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${pt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:m_(t.white,.01),color:u,border:`${pt(1)} solid transparent`}:e==="gradient"?{background:PL(n,t),hover:PL(n,t),color:"var(--mantine-color-white)",border:"none"}:e==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${pt(1)} solid var(--mantine-color-default-border)`}:{}},qj={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},RL="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",ak={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:qj,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:Wj,autoContrast:!1,luminanceThreshold:.3,fontFamily:RL,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:RL,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:pt(34),lineHeight:"1.3"},h2:{fontSize:pt(26),lineHeight:"1.35"},h3:{fontSize:pt(22),lineHeight:"1.4"},h4:{fontSize:pt(18),lineHeight:"1.45"},h5:{fontSize:pt(16),lineHeight:"1.5"},h6:{fontSize:pt(14),lineHeight:"1.5"}}},fontSizes:{xs:pt(12),sm:pt(14),md:pt(16),lg:pt(18),xl:pt(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:pt(2),sm:pt(4),md:pt(8),lg:pt(16),xl:pt(32)},spacing:{xs:pt(10),sm:pt(12),md:pt(16),lg:pt(20),xl:pt(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${pt(1)} ${pt(3)} rgba(0, 0, 0, 0.05), 0 ${pt(1)} ${pt(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${pt(1)} ${pt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${pt(10)} ${pt(15)} ${pt(-5)}, rgba(0, 0, 0, 0.04) 0 ${pt(7)} ${pt(7)} ${pt(-5)}`,md:`0 ${pt(1)} ${pt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${pt(20)} ${pt(25)} ${pt(-5)}, rgba(0, 0, 0, 0.04) 0 ${pt(10)} ${pt(10)} ${pt(-5)}`,lg:`0 ${pt(1)} ${pt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${pt(28)} ${pt(23)} ${pt(-7)}, rgba(0, 0, 0, 0.04) 0 ${pt(12)} ${pt(12)} ${pt(-7)}`,xl:`0 ${pt(1)} ${pt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${pt(36)} ${pt(28)} ${pt(-7)}, rgba(0, 0, 0, 0.04) 0 ${pt(17)} ${pt(17)} ${pt(-7)}`},other:{},components:{}};function LL(u){return u==="auto"||u==="dark"||u==="light"}function Xj({key:u="mantine-color-scheme-value"}={}){let t;return{get:e=>{if(typeof window>"u")return e;try{const n=window.localStorage.getItem(u);return LL(n)?n:e}catch{return e}},set:e=>{try{window.localStorage.setItem(u,e)}catch(n){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",n)}},subscribe:e=>{t=n=>{n.storageArea===window.localStorage&&n.key===u&&LL(n.newValue)&&e(n.newValue)},window.addEventListener("storage",t)},unsubscribe:()=>{window.removeEventListener("storage",t)},clear:()=>{window.localStorage.removeItem(u)}}}const Yj="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more – https://mantine.dev/theming/colors/#primary-color",ML="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function W1(u){return u<0||u>9?!1:parseInt(u.toString(),10)===u}function IL(u){if(!(u.primaryColor in u.colors))throw new Error(Yj);if(typeof u.primaryShade=="object"&&(!W1(u.primaryShade.dark)||!W1(u.primaryShade.light)))throw new Error(ML);if(typeof u.primaryShade=="number"&&!W1(u.primaryShade))throw new Error(ML)}function Kj(u,t){var n;if(!t)return IL(u),u;const e=ik(u,t);return t.fontFamily&&!((n=t.headings)!=null&&n.fontFamily)&&(e.headings.fontFamily=t.fontFamily),IL(e),e}const ok=Qe.createContext(null),Qj=()=>Qe.useContext(ok)||ak;function cD(){const u=Qe.useContext(ok);if(!u)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return u}function hD({theme:u,children:t,inherit:e=!0}){const n=Qj(),i=Qe.useMemo(()=>Kj(e?n:ak,u),[u,n,e]);return Jt.jsx(ok.Provider,{value:i,children:t})}hD.displayName="@mantine/core/MantineThemeProvider";function Jj(){const u=cD(),t=lD(),e=df(u.breakpoints).reduce((n,i)=>{const s=u.breakpoints[i].includes("px"),o=$j(u.breakpoints[i]),l=s?`${o-.1}px`:TL(o-.1),h=s?`${o}px`:TL(o);return`${n}@media (max-width: ${l}) {.mantine-visible-from-${i} {display: none !important;}}@media (min-width: ${h}) {.mantine-hidden-from-${i} {display: none !important;}}`},"");return Jt.jsx("style",{"data-mantine-styles":"classes",nonce:t==null?void 0:t(),dangerouslySetInnerHTML:{__html:e}})}function q1(u){return Object.entries(u).map(([t,e])=>`${t}: ${e};`).join("")}function uy(u,t){return(Array.isArray(u)?u:[u]).reduce((n,i)=>`${i}{${n}}`,t)}function Zj(u,t){const e=q1(u.variables),n=e?uy(t,e):"",i=q1(u.dark),s=q1(u.light),o=i?uy(t===":host"?`${t}([data-mantine-color-scheme="dark"])`:`${t}[data-mantine-color-scheme="dark"]`,i):"",l=s?uy(t===":host"?`${t}([data-mantine-color-scheme="light"])`:`${t}[data-mantine-color-scheme="light"]`,s):"";return`${n}${o}${l}`}function tH({color:u,theme:t,autoContrast:e}){return(typeof e=="boolean"?e:t.autoContrast)&&rk({color:u||t.primaryColor,theme:t}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function DL(u,t){return tH({color:u.colors[u.primaryColor][lv(u,t)],theme:u,autoContrast:null})}function y_({theme:u,color:t,colorScheme:e,name:n=t,withColorValues:i=!0}){if(!u.colors[t])return{};if(e==="light"){const l=lv(u,"light"),h={[`--mantine-color-${n}-text`]:`var(--mantine-color-${n}-filled)`,[`--mantine-color-${n}-filled`]:`var(--mantine-color-${n}-${l})`,[`--mantine-color-${n}-filled-hover`]:`var(--mantine-color-${n}-${l===9?8:l+1})`,[`--mantine-color-${n}-light`]:qf(u.colors[t][l],.1),[`--mantine-color-${n}-light-hover`]:qf(u.colors[t][l],.12),[`--mantine-color-${n}-light-color`]:`var(--mantine-color-${n}-${l})`,[`--mantine-color-${n}-outline`]:`var(--mantine-color-${n}-${l})`,[`--mantine-color-${n}-outline-hover`]:qf(u.colors[t][l],.05)};return i?{[`--mantine-color-${n}-0`]:u.colors[t][0],[`--mantine-color-${n}-1`]:u.colors[t][1],[`--mantine-color-${n}-2`]:u.colors[t][2],[`--mantine-color-${n}-3`]:u.colors[t][3],[`--mantine-color-${n}-4`]:u.colors[t][4],[`--mantine-color-${n}-5`]:u.colors[t][5],[`--mantine-color-${n}-6`]:u.colors[t][6],[`--mantine-color-${n}-7`]:u.colors[t][7],[`--mantine-color-${n}-8`]:u.colors[t][8],[`--mantine-color-${n}-9`]:u.colors[t][9],...h}:h}const s=lv(u,"dark"),o={[`--mantine-color-${n}-text`]:`var(--mantine-color-${n}-4)`,[`--mantine-color-${n}-filled`]:`var(--mantine-color-${n}-${s})`,[`--mantine-color-${n}-filled-hover`]:`var(--mantine-color-${n}-${s===9?8:s+1})`,[`--mantine-color-${n}-light`]:qf(u.colors[t][Math.max(0,s-2)],.15),[`--mantine-color-${n}-light-hover`]:qf(u.colors[t][Math.max(0,s-2)],.2),[`--mantine-color-${n}-light-color`]:`var(--mantine-color-${n}-${Math.max(s-5,0)})`,[`--mantine-color-${n}-outline`]:`var(--mantine-color-${n}-${Math.max(s-4,0)})`,[`--mantine-color-${n}-outline-hover`]:qf(u.colors[t][Math.max(s-4,0)],.05)};return i?{[`--mantine-color-${n}-0`]:u.colors[t][0],[`--mantine-color-${n}-1`]:u.colors[t][1],[`--mantine-color-${n}-2`]:u.colors[t][2],[`--mantine-color-${n}-3`]:u.colors[t][3],[`--mantine-color-${n}-4`]:u.colors[t][4],[`--mantine-color-${n}-5`]:u.colors[t][5],[`--mantine-color-${n}-6`]:u.colors[t][6],[`--mantine-color-${n}-7`]:u.colors[t][7],[`--mantine-color-${n}-8`]:u.colors[t][8],[`--mantine-color-${n}-9`]:u.colors[t][9],...o}:o}function eH(u){return!!u&&typeof u=="object"&&"mantine-virtual-color"in u}function Xf(u,t,e){df(t).forEach(n=>Object.assign(u,{[`--mantine-${e}-${n}`]:t[n]}))}const uD=u=>{const t=lv(u,"light"),e=u.defaultRadius in u.radius?u.radius[u.defaultRadius]:pt(u.defaultRadius),n={variables:{"--mantine-scale":u.scale.toString(),"--mantine-cursor-type":u.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":u.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":u.fontSmoothing?"grayscale":"unset","--mantine-color-white":u.white,"--mantine-color-black":u.black,"--mantine-line-height":u.lineHeights.md,"--mantine-font-family":u.fontFamily,"--mantine-font-family-monospace":u.fontFamilyMonospace,"--mantine-font-family-headings":u.headings.fontFamily,"--mantine-heading-font-weight":u.headings.fontWeight,"--mantine-heading-text-wrap":u.headings.textWrap,"--mantine-radius-default":e,"--mantine-primary-color-filled":`var(--mantine-color-${u.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${u.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${u.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${u.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${u.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":DL(u,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":u.black,"--mantine-color-body":u.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${u.primaryColor}-${t})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":DL(u,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${u.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};Xf(n.variables,u.breakpoints,"breakpoint"),Xf(n.variables,u.spacing,"spacing"),Xf(n.variables,u.fontSizes,"font-size"),Xf(n.variables,u.lineHeights,"line-height"),Xf(n.variables,u.shadows,"shadow"),Xf(n.variables,u.radius,"radius"),u.colors[u.primaryColor].forEach((s,o)=>{n.variables[`--mantine-primary-color-${o}`]=`var(--mantine-color-${u.primaryColor}-${o})`}),df(u.colors).forEach(s=>{const o=u.colors[s];if(eH(o)){Object.assign(n.light,y_({theme:u,name:o.name,color:o.light,colorScheme:"light",withColorValues:!0})),Object.assign(n.dark,y_({theme:u,name:o.name,color:o.dark,colorScheme:"dark",withColorValues:!0}));return}o.forEach((l,h)=>{n.variables[`--mantine-color-${s}-${h}`]=l}),Object.assign(n.light,y_({theme:u,color:s,colorScheme:"light",withColorValues:!1})),Object.assign(n.dark,y_({theme:u,color:s,colorScheme:"dark",withColorValues:!1}))});const i=u.headings.sizes;return df(i).forEach(s=>{n.variables[`--mantine-${s}-font-size`]=i[s].fontSize,n.variables[`--mantine-${s}-line-height`]=i[s].lineHeight,n.variables[`--mantine-${s}-font-weight`]=i[s].fontWeight||u.headings.fontWeight}),n};function nH({theme:u,generator:t}){const e=uD(u),n=t==null?void 0:t(u);return n?ik(e,n):e}const X1=uD(ak);function iH(u){const t={variables:{},light:{},dark:{}};return df(u.variables).forEach(e=>{X1.variables[e]!==u.variables[e]&&(t.variables[e]=u.variables[e])}),df(u.light).forEach(e=>{X1.light[e]!==u.light[e]&&(t.light[e]=u.light[e])}),df(u.dark).forEach(e=>{X1.dark[e]!==u.dark[e]&&(t.dark[e]=u.dark[e])}),t}function sH(u){return`
  ${u}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${u}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function dD({cssVariablesSelector:u,deduplicateCssVariables:t}){const e=cD(),n=lD(),i=jj(),s=nH({theme:e,generator:i}),o=u===":root"&&t,l=o?iH(s):s,h=Zj(l,u);return h?Jt.jsx("style",{"data-mantine-styles":!0,nonce:n==null?void 0:n(),dangerouslySetInnerHTML:{__html:`${h}${o?"":sH(u)}`}}):null}dD.displayName="@mantine/CssVariables";function rH(){const u=console.error;console.error=(...t)=>{t.length>1&&typeof t[0]=="string"&&t[0].toLowerCase().includes("extra attributes from the server")&&typeof t[1]=="string"&&t[1].toLowerCase().includes("data-mantine-color-scheme")||u(...t)}}function Yf(u,t){var i;const e=typeof window<"u"&&"matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=u!=="auto"?u:e?"dark":"light";(i=t())==null||i.setAttribute("data-mantine-color-scheme",n)}function aH({manager:u,defaultColorScheme:t,getRootElement:e,forceColorScheme:n}){const i=Qe.useRef(null),[s,o]=Qe.useState(()=>u.get(t)),l=n||s,h=Qe.useCallback(p=>{n||(Yf(p,e),o(p),u.set(p))},[u.set,l,n]),d=Qe.useCallback(()=>{o(t),Yf(t,e),u.clear()},[u.clear,t]);return Qe.useEffect(()=>(u.subscribe(h),u.unsubscribe),[u.subscribe,u.unsubscribe]),rD(()=>{Yf(u.get(t),e)},[]),Qe.useEffect(()=>{var g;if(n)return Yf(n,e),()=>{};n===void 0&&Yf(s,e),typeof window<"u"&&"matchMedia"in window&&(i.current=window.matchMedia("(prefers-color-scheme: dark)"));const p=m=>{s==="auto"&&Yf(m.matches?"dark":"light",e)};return(g=i.current)==null||g.addEventListener("change",p),()=>{var m;return(m=i.current)==null?void 0:m.removeEventListener("change",p)}},[s,n]),{colorScheme:l,setColorScheme:h,clearColorScheme:d}}function oH({respectReducedMotion:u,getRootElement:t}){rD(()=>{var e;u&&((e=t())==null||e.setAttribute("data-respect-reduced-motion","true"))},[u])}rH();function fD({theme:u,children:t,getStyleNonce:e,withStaticClasses:n=!0,withGlobalClasses:i=!0,deduplicateCssVariables:s=!0,withCssVariables:o=!0,cssVariablesSelector:l=":root",classNamesPrefix:h="mantine",colorSchemeManager:d=Xj(),defaultColorScheme:p="light",getRootElement:g=()=>document.documentElement,cssVariablesResolver:m,forceColorScheme:b,stylesTransform:_}){const{colorScheme:S,setColorScheme:C,clearColorScheme:T}=aH({defaultColorScheme:p,forceColorScheme:b,manager:d,getRootElement:g});return oH({respectReducedMotion:(u==null?void 0:u.respectReducedMotion)||!1,getRootElement:g}),Jt.jsx(aD.Provider,{value:{colorScheme:S,setColorScheme:C,clearColorScheme:T,getRootElement:g,classNamesPrefix:h,getStyleNonce:e,cssVariablesResolver:m,cssVariablesSelector:l,withStaticClasses:n,stylesTransform:_},children:Jt.jsxs(hD,{theme:u,children:[o&&Jt.jsx(dD,{cssVariablesSelector:l,deduplicateCssVariables:s}),i&&Jt.jsx(Jj,{}),t]})})}fD.displayName="@mantine/core/MantineProvider";var sv={};sv.d=(u,t)=>{for(var e in t)sv.o(t,e)&&!sv.o(u,e)&&Object.defineProperty(u,e,{enumerable:!0,get:t[e]})};sv.o=(u,t)=>Object.prototype.hasOwnProperty.call(u,t);var Ot=globalThis.pdfjsLib={};sv.d(Ot,{AbortException:()=>Ch,AnnotationEditorLayer:()=>m3,AnnotationEditorParamsType:()=>te,AnnotationEditorType:()=>zt,AnnotationEditorUIManager:()=>hv,AnnotationLayer:()=>l3,AnnotationMode:()=>bc,ColorPicker:()=>QF,DOMSVGFactory:()=>mk,DrawLayer:()=>y3,FeatureTest:()=>zi,GlobalWorkerOptions:()=>ru,ImageKind:()=>U_,InvalidPDFException:()=>Fx,MissingPDFException:()=>cv,OPS:()=>$r,OutputScale:()=>Nx,PDFDataRangeTransport:()=>vF,PDFDateString:()=>yD,PDFWorker:()=>iw,PasswordResponses:()=>uH,PermissionFlag:()=>hH,PixelsPerInch:()=>Em,RenderingCancelledException:()=>uk,TextLayer:()=>oC,TouchManager:()=>Zw,UnexpectedResponseException:()=>Qw,Util:()=>Rt,VerbosityLevel:()=>jE,XfaLayer:()=>AF,build:()=>zB,createValidAbsoluteUrl:()=>gH,fetchData:()=>UE,getDocument:()=>LB,getFilenameFromUrl:()=>SH,getPdfFilenameFromUrl:()=>xH,getXfaPageViewport:()=>CH,isDataScheme:()=>GE,isPdfFile:()=>dk,noContextMenu:()=>fa,normalizeUnicode:()=>_H,setLayerDimensions:()=>ff,shadow:()=>Kt,stopEvent:()=>Ws,version:()=>BB});const Pi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),pD=[1,0,0,1,0,0],Dx=[.001,0,0,.001,0,0],lH=1e7,Y1=1.35,zs={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},bc={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},cH="pdfjs_internal_editor_",zt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},hH={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},mi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},U_={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},vn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},dy={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},jE={ERRORS:0,WARNINGS:1,INFOS:5},$r={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},uH={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let HE=jE.WARNINGS;function dH(u){Number.isInteger(u)&&(HE=u)}function fH(){return HE}function BE(u){HE>=jE.INFOS&&console.log(`Info: ${u}`)}function Gt(u){HE>=jE.WARNINGS&&console.log(`Warning: ${u}`)}function Ee(u){throw new Error(u)}function fn(u,t){u||Ee(t)}function pH(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function gH(u,t=null,e=null){if(!u)return null;try{if(e&&typeof u=="string"){if(e.addDefaultProtocol&&u.startsWith("www.")){const i=u.match(/\./g);(i==null?void 0:i.length)>=2&&(u=`http://${u}`)}if(e.tryConvertEncoding)try{u=AH(u)}catch{}}const n=t?new URL(u,t):new URL(u);if(pH(n))return n}catch{}return null}function Kt(u,t,e,n=!1){return Object.defineProperty(u,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Mh=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();let FL=class extends Mh{constructor(t,e){super(t,"PasswordException"),this.code=e}},K1=class extends Mh{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}},Fx=class extends Mh{constructor(t){super(t,"InvalidPDFException")}},cv=class extends Mh{constructor(t){super(t,"MissingPDFException")}},Qw=class extends Mh{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}},mH=class extends Mh{constructor(t){super(t,"FormatError")}},Ch=class extends Mh{constructor(t){super(t,"AbortException")}};function gD(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Ee("Invalid argument for bytesToString");const t=u.length,e=8192;if(t<e)return String.fromCharCode.apply(null,u);const n=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),o=u.subarray(i,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function zE(u){typeof u!="string"&&Ee("Invalid argument for stringToBytes");const t=u.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=u.charCodeAt(n)&255;return e}function yH(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function lk(u){const t=Object.create(null);for(const[e,n]of u)t[e]=n;return t}function vH(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function bH(){try{return new Function(""),!0}catch{return!1}}let zi=class{static get isLittleEndian(){return Kt(this,"isLittleEndian",vH())}static get isEvalSupported(){return Kt(this,"isEvalSupported",bH())}static get isOffscreenCanvasSupported(){return Kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Kt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Kt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Kt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return Kt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}};const Q1=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));var Fl,Lx,G_,Ox;let Rt=(Lx=class{static makeHexColor(t,e,n){return`#${Q1[t]}${Q1[e]}${Q1[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const n=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[n,i]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n;return[i,s]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],s[0],o[0]),Math.min(n[1],i[1],s[1],o[1]),Math.max(n[0],i[0],s[0],o[0]),Math.max(n[1],i[1],s[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],l=(n+o)/2,h=Math.sqrt((n+o)**2-4*(n*o-s*i))/2,d=l+h||1,p=l-h||1;return[Math.sqrt(d),Math.sqrt(p)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>o?null:[n,s,i,o]}static bezierBoundingBox(t,e,n,i,s,o,l,h,d){return d?(d[0]=Math.min(d[0],t,l),d[1]=Math.min(d[1],e,h),d[2]=Math.max(d[2],t,l),d[3]=Math.max(d[3],e,h)):d=[Math.min(t,l),Math.min(e,h),Math.max(t,l),Math.max(e,h)],A(this,Fl,Ox).call(this,t,n,s,l,e,i,o,h,3*(-t+3*(n-s)+l),6*(t-2*n+s),3*(n-t),d),A(this,Fl,Ox).call(this,t,n,s,l,e,i,o,h,3*(-e+3*(i-o)+h),6*(e-2*i+o),3*(i-e),d),d}},Fl=new WeakSet,G_=function(t,e,n,i,s,o,l,h,d,p){if(d<=0||d>=1)return;const g=1-d,m=d*d,b=m*d,_=g*(g*(g*t+3*d*e)+3*m*n)+b*i,S=g*(g*(g*s+3*d*o)+3*m*l)+b*h;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)},Ox=function(t,e,n,i,s,o,l,h,d,p,g,m){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&A(this,Fl,G_).call(this,t,e,n,i,s,o,l,h,-g/p,m);return}const b=p**2-4*g*d;if(b<0)return;const _=Math.sqrt(b),S=2*d;A(this,Fl,G_).call(this,t,e,n,i,s,o,l,h,(-p+_)/S,m),A(this,Fl,G_).call(this,t,e,n,i,s,o,l,h,(-p-_)/S,m)},E(Lx,Fl),Lx);function AH(u){return decodeURIComponent(escape(u))}let J1=null,OL=null;function _H(u){return J1||(J1=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,OL=new Map([["ﬅ","ſt"]])),u.replaceAll(J1,(t,e,n)=>e?e.normalize("NFKC"):OL.get(n))}function wH(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const u=new Uint8Array(32);return crypto.getRandomValues(u),gD(u)}const ck="pdfjs_internal_id_";function EH(u){return Uint8Array.prototype.toBase64?u.toBase64():btoa(gD(u))}typeof Promise.try!="function"&&(Promise.try=function(u,...t){return new Promise(e=>{e(u(...t))})});const Ro="http://www.w3.org/2000/svg";var co;let Em=(co=class{},lt(co,"CSS",96),lt(co,"PDF",72),lt(co,"PDF_TO_CSS_UNITS",co.CSS/co.PDF),co);async function UE(u,t="text"){if(Cy(u,document.baseURI)){const e=await fetch(u);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",u,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}let hk=class mD{constructor({viewBox:t,userUnit:e,scale:n,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=i,this.offsetX=s,this.offsetY=o,n*=e;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,g,m,b;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,g=0,m=0,b=1;break;case 90:p=0,g=1,m=1,b=0;break;case 270:p=0,g=-1,m=-1,b=0;break;case 0:p=1,g=0,m=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,b=-b);let _,S,C,T;p===0?(_=Math.abs(d-t[1])*n+s,S=Math.abs(h-t[0])*n+o,C=(t[3]-t[1])*n,T=(t[2]-t[0])*n):(_=Math.abs(h-t[0])*n+s,S=Math.abs(d-t[1])*n+o,C=(t[2]-t[0])*n,T=(t[3]-t[1])*n),this.transform=[p*n,g*n,m*n,b*n,_-p*n*h-m*n*d,S-g*n*h-b*n*d],this.width=C,this.height=T}get rawDims(){const{userUnit:t,viewBox:e}=this,n=e.map(i=>i*t);return Kt(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new mD({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){return Rt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Rt.applyTransform([t[0],t[1]],this.transform),n=Rt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return Rt.applyInverseTransform([t,e],this.transform)}},uk=class extends Mh{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}};function GE(u){const t=u.length;let e=0;for(;e<t&&u[e].trim()==="";)e++;return u.substring(e,e+5).toLowerCase()==="data:"}function dk(u){return typeof u=="string"&&/\.pdf$/i.test(u)}function SH(u){return[u]=u.split(/[#?]/,1),u.substring(u.lastIndexOf("/")+1)}function xH(u,t="document.pdf"){if(typeof u!="string")return t;if(GE(u))return Gt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(u);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||t}let NL=class{constructor(){lt(this,"started",Object.create(null));lt(this,"times",[])}time(t){t in this.started&&Gt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Gt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:s}of this.times)t.push(`${n.padEnd(e)} ${s-i}ms
`);return t.join("")}};function Cy(u,t){try{const{protocol:e}=t?new URL(u,t):new URL(u);return e==="http:"||e==="https:"}catch{return!1}}function fa(u){u.preventDefault()}function Ws(u){u.preventDefault(),u.stopPropagation()}var Mx,dv;let yD=(Mx=class{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,dv)||v(this,dv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,dv).exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const d=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,d==="-"?(o+=p,l+=g):d==="+"&&(o-=p,l-=g),new Date(Date.UTC(n,i,s,o,l,h))}},dv=new WeakMap,E(Mx,dv),Mx);function CH(u,{scale:t=1,rotation:e=0}){const{width:n,height:i}=u.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new hk({viewBox:s,userUnit:1,scale:t,rotation:e})}function fk(u){if(u.startsWith("#")){const t=parseInt(u.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return u.startsWith("rgb(")?u.slice(4,-1).split(",").map(t=>parseInt(t)):u.startsWith("rgba(")?u.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Gt(`Not a valid color format: "${u}"`),[0,0,0])}function TH(u){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of u.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;u.set(e,fk(n))}t.remove()}function Oe(u){const{a:t,b:e,c:n,d:i,e:s,f:o}=u.getTransform();return[t,e,n,i,s,o]}function Ea(u){const{a:t,b:e,c:n,d:i,e:s,f:o}=u.getTransform().invertSelf();return[t,e,n,i,s,o]}function ff(u,t,e=!1,n=!0){if(t instanceof hk){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=u,l=zi.isCSSRoundSupported,h=`var(--scale-factor) * ${i}px`,d=`var(--scale-factor) * ${s}px`,p=l?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,g=l?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!e||t.rotation%180===0?(o.width=p,o.height=g):(o.width=g,o.height=p)}n&&u.setAttribute("data-main-rotation",t.rotation)}let Nx=class{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}};var _c,lu,Hr,cu,fv,yr,pv,aE,vD,Gi,bD,AD,V_,_D,$x;let kH=(yr=class{constructor(t){E(this,Gi);E(this,_c,null);E(this,lu,null);E(this,Hr);E(this,cu,null);E(this,fv,null);v(this,Hr,t),r(yr,pv)||v(yr,pv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=v(this,_c,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,Hr)._uiManager._signal;t.addEventListener("contextmenu",fa,{signal:e}),t.addEventListener("pointerdown",A(yr,aE,vD),{signal:e});const n=v(this,cu,document.createElement("div"));n.className="buttons",t.append(n);const i=r(this,Hr).toolbarPosition;if(i){const{style:s}=t,o=r(this,Hr)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,Gi,_D).call(this),t}get div(){return r(this,_c)}hide(){var t;r(this,_c).classList.add("hidden"),(t=r(this,lu))==null||t.hideDropdown()}show(){var t;r(this,_c).classList.remove("hidden"),(t=r(this,fv))==null||t.shown()}async addAltText(t){const e=await t.render();A(this,Gi,V_).call(this,e),r(this,cu).prepend(e,r(this,Gi,$x)),v(this,fv,t)}addColorPicker(t){v(this,lu,t);const e=t.renderButton();A(this,Gi,V_).call(this,e),r(this,cu).prepend(e,r(this,Gi,$x))}remove(){var t;r(this,_c).remove(),(t=r(this,lu))==null||t.destroy(),v(this,lu,null)}},_c=new WeakMap,lu=new WeakMap,Hr=new WeakMap,cu=new WeakMap,fv=new WeakMap,pv=new WeakMap,aE=new WeakSet,vD=function(t){t.stopPropagation()},Gi=new WeakSet,bD=function(t){r(this,Hr)._focusEventsAllowed=!1,Ws(t)},AD=function(t){r(this,Hr)._focusEventsAllowed=!0,Ws(t)},V_=function(t){const e=r(this,Hr)._uiManager._signal;t.addEventListener("focusin",A(this,Gi,bD).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",A(this,Gi,AD).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",fa,{signal:e})},_D=function(){const{editorType:t,_uiManager:e}=r(this,Hr),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",r(yr,pv)[t]),A(this,Gi,V_).call(this,n),n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),r(this,cu).append(n)},$x=function(){const t=document.createElement("div");return t.className="divider",t},E(yr,aE),E(yr,pv,null),yr);var gv,hu,uu,Ph,wD,ED,SD,SI;let PH=(SI=class{constructor(t){E(this,Ph);E(this,gv,null);E(this,hu,null);E(this,uu);v(this,uu,t)}show(t,e,n){const[i,s]=A(this,Ph,ED).call(this,e,n),{style:o}=r(this,hu)||v(this,hu,A(this,Ph,wD).call(this));t.append(r(this,hu)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,hu).remove()}},gv=new WeakMap,hu=new WeakMap,uu=new WeakMap,Ph=new WeakSet,wD=function(){const t=v(this,hu,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",fa,{signal:r(this,uu)._signal});const e=v(this,gv,document.createElement("div"));return e.className="buttons",t.append(e),A(this,Ph,SD).call(this),t},ED=function(t,e){let n=0,i=0;for(const s of t){const o=s.y+s.height;if(o<n)continue;const l=s.x+(e?s.width:0);if(o>n){i=l,n=o;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,n]},SD=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=r(this,uu)._signal;t.addEventListener("contextmenu",fa,{signal:n}),t.addEventListener("click",()=>{r(this,uu).highlightSelection("floating_button")},{signal:n}),r(this,gv).append(t)},SI);function Jw(u,t,e){for(const n of e)t.addEventListener(n,u[n].bind(u))}var oE,xI;let RH=(xI=class{constructor(){E(this,oE,0)}get id(){return`${cH}${he(this,oE)._++}`}},oE=new WeakMap,xI);var yp,mv,Ai,vp,W_,bp;let LH=(bp=class{constructor(){E(this,vp);E(this,yp,wH());E(this,mv,0);E(this,Ai,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Kt(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return A(this,vp,W_).call(this,`${e}_${n}_${i}_${s}`,t)}async getFromUrl(t){return A(this,vp,W_).call(this,t,t)}async getFromBlob(t,e){const n=await e;return A(this,vp,W_).call(this,t,n)}async getFromId(t){r(this,Ai)||v(this,Ai,new Map);const e=r(this,Ai).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,Ai)||v(this,Ai,new Map);let n=r(this,Ai).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${r(this,yp)}_${he(this,mv)._++}`,refCounter:1,isSvg:!1},r(this,Ai).set(t,n),r(this,Ai).set(n.id,n),n}getSvgUrl(t){const e=r(this,Ai).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;r(this,Ai)||v(this,Ai,new Map);const e=r(this,Ai).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}(i=n.close)==null||i.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,yp)}_`)}},yp=new WeakMap,mv=new WeakMap,Ai=new WeakMap,vp=new WeakSet,W_=async function(t,e){r(this,Ai)||v(this,Ai,new Map);let n=r(this,Ai).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${r(this,yp)}_${he(this,mv)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(n.url=e,i=await UE(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=bp._isSVGFittingCanvas,o=new FileReader,l=new Image,h=new Promise((d,p)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,d()},o.onload=async()=>{const g=n.svgUrl=o.result;l.src=await s?`${g}#svgView(preserveAspectRatio(none))`:g},l.onerror=o.onerror=p});o.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Gt(i),n=null}return r(this,Ai).set(t,n),n&&r(this,Ai).set(n.id,n),n},bp);var en,wc,yv,Be,CI;let MH=(CI=class{constructor(t=128){E(this,en,[]);E(this,wc,!1);E(this,yv);E(this,Be,-1);v(this,yv,t)}add({cmd:t,undo:e,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&t(),r(this,wc))return;const h={cmd:t,undo:e,post:n,type:s};if(r(this,Be)===-1){r(this,en).length>0&&(r(this,en).length=0),v(this,Be,0),r(this,en).push(h);return}if(o&&r(this,en)[r(this,Be)].type===s){l&&(h.undo=r(this,en)[r(this,Be)].undo),r(this,en)[r(this,Be)]=h;return}const d=r(this,Be)+1;d===r(this,yv)?r(this,en).splice(0,1):(v(this,Be,d),d<r(this,en).length&&r(this,en).splice(d)),r(this,en).push(h)}undo(){if(r(this,Be)===-1)return;v(this,wc,!0);const{undo:t,post:e}=r(this,en)[r(this,Be)];t(),e==null||e(),v(this,wc,!1),v(this,Be,r(this,Be)-1)}redo(){if(r(this,Be)<r(this,en).length-1){v(this,Be,r(this,Be)+1),v(this,wc,!0);const{cmd:t,post:e}=r(this,en)[r(this,Be)];t(),e==null||e(),v(this,wc,!1)}}hasSomethingToUndo(){return r(this,Be)!==-1}hasSomethingToRedo(){return r(this,Be)<r(this,en).length-1}cleanType(t){if(r(this,Be)!==-1){for(let e=r(this,Be);e>=0;e--)if(r(this,en)[e].type!==t){r(this,en).splice(e+1,r(this,Be)-e),v(this,Be,e);return}r(this,en).length=0,v(this,Be,-1)}}destroy(){v(this,en,null)}},en=new WeakMap,wc=new WeakMap,yv=new WeakMap,Be=new WeakMap,CI);var lE,xD,TI;let J0=(TI=class{constructor(t){E(this,lE);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=zi.platform;for(const[n,i,s={}]of t)for(const o of n){const l=o.startsWith("mac+");e&&l?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!e&&!l&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(A(this,lE,xD).call(this,e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:l=null}}=n;l&&!l(t,e)||(i.bind(t,...o,e)(),s||Ws(e))}},lE=new WeakSet,xD=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e},TI);var du;let IH=(du=class{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return TH(t),Kt(this,"_colors",t)}convert(t){const e=fk(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((s,o)=>s===e[o]))return du._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Rt.makeHexColor(...e):t}},lt(du,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),du);var Ap,ws,An,Jn,_p,Oo,wp,sr,Ec,fu,Ep,pu,ka,Br,gu,vv,bv,Sp,Av,Pa,Sc,xp,xc,Ra,cE,Cc,_v,Tc,mu,wv,Ev,Fn,ue,No,yu,Sv,xv,kc,La,$o,Cv,rr,Il,gt,q_,jx,CD,TD,X_,kD,PD,RD,Hx,LD,Bx,zx,MD,Fi,Lo,ID,DD,Ux,FD,Ty,Gx;let hv=(Il=class{constructor(t,e,n,i,s,o,l,h,d,p,g,m,b){E(this,gt);E(this,Ap,new AbortController);E(this,ws,null);E(this,An,new Map);E(this,Jn,new Map);E(this,_p,null);E(this,Oo,null);E(this,wp,null);E(this,sr,new MH);E(this,Ec,null);E(this,fu,null);E(this,Ep,0);E(this,pu,new Set);E(this,ka,null);E(this,Br,null);E(this,gu,new Set);lt(this,"_editorUndoBar",null);E(this,vv,!1);E(this,bv,!1);E(this,Sp,!1);E(this,Av,null);E(this,Pa,null);E(this,Sc,null);E(this,xp,null);E(this,xc,!1);E(this,Ra,null);E(this,cE,new RH);E(this,Cc,!1);E(this,_v,!1);E(this,Tc,null);E(this,mu,null);E(this,wv,null);E(this,Ev,null);E(this,Fn,zt.NONE);E(this,ue,new Set);E(this,No,null);E(this,yu,null);E(this,Sv,null);E(this,xv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,kc,[0,0]);E(this,La,null);E(this,$o,null);E(this,Cv,null);E(this,rr,null);const _=this._signal=r(this,Ap).signal;v(this,$o,t),v(this,Cv,e),v(this,_p,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:_}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),i._on("setpreference",this.onSetPreference.bind(this),{signal:_}),i._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:_}),A(this,gt,kD).call(this),A(this,gt,MD).call(this),A(this,gt,Hx).call(this),v(this,Oo,s.annotationStorage),v(this,Av,s.filterFactory),v(this,yu,o),v(this,xp,l||null),v(this,vv,h),v(this,bv,d),v(this,Sp,p),v(this,Ev,g||null),this.viewParameters={realScale:Em.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=b!==!1}static get _keyboardManager(){const t=Il.prototype,e=o=>r(o,$o).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new J0([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,$o).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,$o).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,n,i,s;(t=r(this,rr))==null||t.resolve(),v(this,rr,null),(e=r(this,Ap))==null||e.abort(),v(this,Ap,null),this._signal=null;for(const o of r(this,Jn).values())o.destroy();r(this,Jn).clear(),r(this,An).clear(),r(this,gu).clear(),v(this,ws,null),r(this,ue).clear(),r(this,sr).destroy(),(n=r(this,_p))==null||n.destroy(),(i=r(this,Ra))==null||i.hide(),v(this,Ra,null),r(this,Pa)&&(clearTimeout(r(this,Pa)),v(this,Pa,null)),r(this,La)&&(clearTimeout(r(this,La)),v(this,La,null)),(s=this._editorUndoBar)==null||s.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,Ev)}get useNewAltTextFlow(){return r(this,bv)}get useNewAltTextWhenAddingImage(){return r(this,Sp)}get hcmFilter(){return Kt(this,"hcmFilter",r(this,yu)?r(this,Av).addHCMFilter(r(this,yu).foreground,r(this,yu).background):"none")}get direction(){return Kt(this,"direction",getComputedStyle(r(this,$o)).direction)}get highlightColors(){return Kt(this,"highlightColors",r(this,xp)?new Map(r(this,xp).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Kt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),v(this,fu,t)}setMainHighlightColorPicker(t){v(this,wv,t)}editAltText(t,e=!1){var n;(n=r(this,_p))==null||n.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":v(this,Sp,e);break}}onPageChanging({pageNumber:t}){v(this,Ep,t-1)}focusMainContainer(){r(this,$o).focus()}findParent(t,e){for(const n of r(this,Jn).values()){const{x:i,y:s,width:o,height:l}=n.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=s&&e<=s+l)return n}return null}disableUserSelect(t=!1){r(this,Cv).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,gu).add(t)}removeShouldRescale(t){r(this,gu).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*Em.PDF_TO_CSS_UNITS;for(const n of r(this,gu))n.onScaleChanging();(e=r(this,fu))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}=e,l=e.toString(),d=A(this,gt,q_).call(this,e).closest(".textLayer"),p=this.getSelectionBoxes(d);if(!p)return;e.empty();const g=A(this,gt,jx).call(this,d),m=r(this,Fn)===zt.NONE,b=()=>{g==null||g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(zt.HIGHLIGHT,b);return}b()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,Oo)&&!r(this,Oo).has(t.id)&&r(this,Oo).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,xc)&&(v(this,xc,!1),A(this,gt,X_).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,ue))if(e.div.contains(t)){v(this,mu,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,mu))return;const[t,e]=r(this,mu);v(this,mu,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){A(this,gt,Hx).call(this),A(this,gt,Bx).call(this)}removeEditListeners(){A(this,gt,LD).call(this),A(this,gt,zx).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of r(this,Br))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of r(this,Br))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=r(this,ws))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of r(this,ue)){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const o of r(this,Br))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Gt(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;s.push(d)}const o=()=>{for(const h of s)A(this,gt,Ux).call(this,h);A(this,gt,Gx).call(this,s)},l=()=>{for(const h of s)h.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(s){Gt(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,Fn)!==zt.NONE&&!this.isEditorHandlingKeyboard&&Il._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,xc)&&(v(this,xc,!1),A(this,gt,X_).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(A(this,gt,PD).call(this),A(this,gt,Bx).call(this),A(this,gt,Fi).call(this,{isEditing:r(this,Fn)!==zt.NONE,isEmpty:A(this,gt,Ty).call(this),hasSomethingToUndo:r(this,sr).hasSomethingToUndo(),hasSomethingToRedo:r(this,sr).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,gt,RD).call(this),A(this,gt,zx).call(this),A(this,gt,Fi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,Br)){v(this,Br,t);for(const e of r(this,Br))A(this,gt,Lo).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,cE).id}get currentLayer(){return r(this,Jn).get(r(this,Ep))}getLayer(t){return r(this,Jn).get(t)}get currentPageIndex(){return r(this,Ep)}addLayer(t){r(this,Jn).set(t.pageIndex,t),r(this,Cc)?t.enable():t.disable()}removeLayer(t){r(this,Jn).delete(t.pageIndex)}async updateMode(t,e=null,n=!1){var i;if(r(this,Fn)!==t&&!(r(this,rr)&&(await r(this,rr).promise,!r(this,rr)))){if(v(this,rr,Promise.withResolvers()),v(this,Fn,t),t===zt.NONE){this.setEditingState(!1),A(this,gt,DD).call(this),(i=this._editorUndoBar)==null||i.hide(),r(this,rr).resolve();return}this.setEditingState(!0),await A(this,gt,ID).call(this),this.unselectAll();for(const s of r(this,Jn).values())s.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),r(this,rr).resolve();return}for(const s of r(this,An).values())s.annotationElementId===e?(this.setSelected(s),s.enterInEditMode()):s.unselect();r(this,rr).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,Fn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var n;if(r(this,Br)){switch(t){case te.CREATE:this.currentLayer.addNewEditor();return;case te.HIGHLIGHT_DEFAULT_COLOR:(n=r(this,wv))==null||n.updateColor(e);break;case te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,Sv)||v(this,Sv,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of r(this,ue))i.updateParams(t,e);for(const i of r(this,Br))i.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var s;for(const o of r(this,An).values())o.editorType===t&&o.show(e);(((s=r(this,Sv))==null?void 0:s.get(te.HIGHLIGHT_SHOW_ALL))??!0)!==e&&A(this,gt,Lo).call(this,[[te.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,_v)!==t){v(this,_v,t);for(const e of r(this,Jn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of r(this,An).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return r(this,An).get(t)}addEditor(t){r(this,An).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Pa)&&clearTimeout(r(this,Pa)),v(this,Pa,setTimeout(()=>{this.focusMainContainer(),v(this,Pa,null)},0))),r(this,An).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,pu).has(t.annotationElementId))&&((e=r(this,Oo))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,pu).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,pu).has(t)}removeDeletedAnnotationElement(t){r(this,pu).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,ws)!==t&&(v(this,ws,t),t&&A(this,gt,Lo).call(this,t.propertiesToUpdate))}updateUI(t){r(this,gt,FD)===t&&A(this,gt,Lo).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){A(this,gt,Lo).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(r(this,ue).has(t)){r(this,ue).delete(t),t.unselect(),A(this,gt,Fi).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,ue).add(t),t.select(),A(this,gt,Lo).call(this,t.propertiesToUpdate),A(this,gt,Fi).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=r(this,fu))==null||e.commitOrRemove();for(const n of r(this,ue))n!==t&&n.unselect();r(this,ue).clear(),r(this,ue).add(t),t.select(),A(this,gt,Lo).call(this,t.propertiesToUpdate),A(this,gt,Fi).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,ue).has(t)}get firstSelectedEditor(){return r(this,ue).values().next().value}unselect(t){t.unselect(),r(this,ue).delete(t),A(this,gt,Fi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,ue).size!==0}get isEnterHandled(){return r(this,ue).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;r(this,sr).undo(),A(this,gt,Fi).call(this,{hasSomethingToUndo:r(this,sr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,gt,Ty).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){r(this,sr).redo(),A(this,gt,Fi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,sr).hasSomethingToRedo(),isEmpty:A(this,gt,Ty).call(this)})}addCommands(t){r(this,sr).add(t),A(this,gt,Fi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,gt,Ty).call(this)})}cleanUndoStack(t){r(this,sr).cleanType(t)}delete(){var s;this.commitOrRemove();const t=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...r(this,ue)],n=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},i=()=>{for(const o of e)A(this,gt,Ux).call(this,o)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=r(this,ws))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,ws)||this.hasSelection}selectAll(){for(const t of r(this,ue))t.commit();A(this,gt,Gx).call(this,r(this,An).values())}unselectAll(){var t;if(!(r(this,ws)&&(r(this,ws).commitOrRemove(),r(this,Fn)!==zt.NONE))&&!((t=r(this,fu))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of r(this,ue))e.unselect();r(this,ue).clear(),A(this,gt,Fi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;r(this,kc)[0]+=t,r(this,kc)[1]+=e;const[i,s]=r(this,kc),o=[...r(this,ue)],l=1e3;r(this,La)&&clearTimeout(r(this,La)),v(this,La,setTimeout(()=>{v(this,La,null),r(this,kc)[0]=r(this,kc)[1]=0,this.addCommands({cmd:()=>{for(const h of o)r(this,An).has(h.id)&&h.translateInPage(i,s)},undo:()=>{for(const h of o)r(this,An).has(h.id)&&h.translateInPage(-i,-s)},mustExec:!1})},l));for(const h of o)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,ka,new Map);for(const t of r(this,ue))r(this,ka).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,ka))return!1;this.disableUserSelect(!1);const t=r(this,ka);v(this,ka,null);let e=!1;for(const[{x:i,y:s,pageIndex:o},l]of t)l.newX=i,l.newY=s,l.newPageIndex=o,e||(e=i!==l.savedX||s!==l.savedY||o!==l.savedPageIndex);if(!e)return!1;const n=(i,s,o,l)=>{if(r(this,An).has(i.id)){const h=r(this,Jn).get(l);h?i._setParentAndPosition(h,s,o):(i.pageIndex=l,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:l}]of t)n(i,s,o,l)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:l}]of t)n(i,s,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,ka))for(const n of r(this,ka).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,ue).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,ws)===t}getActive(){return r(this,ws)}getMode(){return r(this,Fn)}get imageManager(){return Kt(this,"imageManager",new LH)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,p=e.rangeCount;d<p;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:o}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(d,p,g,m)=>({x:(p-i)/o,y:1-(d+g-n)/s,width:m/o,height:g/s});break;case"180":l=(d,p,g,m)=>({x:1-(d+g-n)/s,y:1-(p+m-i)/o,width:g/s,height:m/o});break;case"270":l=(d,p,g,m)=>({x:1-(p+m-i)/o,y:(d-n)/s,width:m/o,height:g/s});break;default:l=(d,p,g,m)=>({x:(d-n)/s,y:(p-i)/o,width:g/s,height:m/o});break}const h=[];for(let d=0,p=e.rangeCount;d<p;d++){const g=e.getRangeAt(d);if(!g.collapsed)for(const{x:m,y:b,width:_,height:S}of g.getClientRects())_===0||S===0||h.push(l(m,b,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,wp)||v(this,wp,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,wp))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=r(this,wp))==null?void 0:i.get(t.data.id);if(!e)return;const n=r(this,Oo).getRawValue(e);n&&(r(this,Fn)===zt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}},Ap=new WeakMap,ws=new WeakMap,An=new WeakMap,Jn=new WeakMap,_p=new WeakMap,Oo=new WeakMap,wp=new WeakMap,sr=new WeakMap,Ec=new WeakMap,fu=new WeakMap,Ep=new WeakMap,pu=new WeakMap,ka=new WeakMap,Br=new WeakMap,gu=new WeakMap,vv=new WeakMap,bv=new WeakMap,Sp=new WeakMap,Av=new WeakMap,Pa=new WeakMap,Sc=new WeakMap,xp=new WeakMap,xc=new WeakMap,Ra=new WeakMap,cE=new WeakMap,Cc=new WeakMap,_v=new WeakMap,Tc=new WeakMap,mu=new WeakMap,wv=new WeakMap,Ev=new WeakMap,Fn=new WeakMap,ue=new WeakMap,No=new WeakMap,yu=new WeakMap,Sv=new WeakMap,xv=new WeakMap,kc=new WeakMap,La=new WeakMap,$o=new WeakMap,Cv=new WeakMap,rr=new WeakMap,gt=new WeakSet,q_=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},jx=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of r(this,Jn).values())if(n.hasTextLayer(t))return n;return null},CD=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=A(this,gt,q_).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(r(this,Ra)||v(this,Ra,new PH(this)),r(this,Ra).show(n,i,this.direction==="ltr"))},TD=function(){var s,o,l;const t=document.getSelection();if(!t||t.isCollapsed){r(this,No)&&((s=r(this,Ra))==null||s.hide(),v(this,No,null),A(this,gt,Fi).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,No))return;const i=A(this,gt,q_).call(this,t).closest(".textLayer");if(!i){r(this,No)&&((o=r(this,Ra))==null||o.hide(),v(this,No,null),A(this,gt,Fi).call(this,{hasSelectedText:!1}));return}if((l=r(this,Ra))==null||l.hide(),v(this,No,e),A(this,gt,Fi).call(this,{hasSelectedText:!0}),!(r(this,Fn)!==zt.HIGHLIGHT&&r(this,Fn)!==zt.NONE)&&(r(this,Fn)===zt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,xc,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=r(this,Fn)===zt.HIGHLIGHT?A(this,gt,jx).call(this,i):null;h==null||h.toggleDrawing();const d=new AbortController,p=this.combinedSignal(d),g=m=>{m.type==="pointerup"&&m.button!==0||(d.abort(),h==null||h.toggleDrawing(!0),m.type==="pointerup"&&A(this,gt,X_).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("blur",g,{signal:p})}},X_=function(t=""){r(this,Fn)===zt.HIGHLIGHT?this.highlightSelection(t):r(this,vv)&&A(this,gt,CD).call(this)},kD=function(){document.addEventListener("selectionchange",A(this,gt,TD).bind(this),{signal:this._signal})},PD=function(){if(r(this,Sc))return;v(this,Sc,new AbortController);const t=this.combinedSignal(r(this,Sc));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},RD=function(){var t;(t=r(this,Sc))==null||t.abort(),v(this,Sc,null)},Hx=function(){if(r(this,Tc))return;v(this,Tc,new AbortController);const t=this.combinedSignal(r(this,Tc));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},LD=function(){var t;(t=r(this,Tc))==null||t.abort(),v(this,Tc,null)},Bx=function(){if(r(this,Ec))return;v(this,Ec,new AbortController);const t=this.combinedSignal(r(this,Ec));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},zx=function(){var t;(t=r(this,Ec))==null||t.abort(),v(this,Ec,null)},MD=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Fi=function(t){Object.entries(t).some(([n,i])=>r(this,xv)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,xv),t)}),r(this,Fn)===zt.HIGHLIGHT&&t.hasSelectedEditor===!1&&A(this,gt,Lo).call(this,[[te.HIGHLIGHT_FREE,!0]]))},Lo=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},ID=async function(){if(!r(this,Cc)){v(this,Cc,!0);const t=[];for(const e of r(this,Jn).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,An).values())e.enable()}},DD=function(){if(this.unselectAll(),r(this,Cc)){v(this,Cc,!1);for(const t of r(this,Jn).values())t.disable();for(const t of r(this,An).values())t.disable()}},Ux=function(t){const e=r(this,Jn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},FD=function(){let t=null;for(t of r(this,ue));return t},Ty=function(){if(r(this,An).size===0)return!0;if(r(this,An).size===1)for(const t of r(this,An).values())return t.isEmpty();return!1},Gx=function(t){for(const e of r(this,ue))e.unselect();r(this,ue).clear();for(const e of t)e.isEmpty()||(r(this,ue).add(e),e.select());A(this,gt,Fi).call(this,{hasSelectedEditor:this.hasSelection})},lt(Il,"TRANSLATE_SMALL",1),lt(Il,"TRANSLATE_BIG",10),Il);var On,Ma,zr,Cp,Ia,Es,Tp,Da,ss,jo,vu,Fa,Wn,Pc,ua,ky,Y_;let $L=(Wn=class{constructor(t){E(this,ua);E(this,On,null);E(this,Ma,!1);E(this,zr,null);E(this,Cp,null);E(this,Ia,null);E(this,Es,null);E(this,Tp,!1);E(this,Da,null);E(this,ss,null);E(this,jo,null);E(this,vu,null);E(this,Fa,!1);v(this,ss,t),v(this,Fa,t._uiManager.useNewAltTextFlow),r(Wn,Pc)||v(Wn,Pc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Wn._l10n??(Wn._l10n=t)}async render(){const t=v(this,zr,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=v(this,Cp,document.createElement("span"));t.append(e),r(this,Fa)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Wn,Pc).missing),e.setAttribute("data-l10n-id",r(Wn,Pc)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=r(this,ss)._uiManager._signal;t.addEventListener("contextmenu",fa,{signal:n}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),r(this,ss)._uiManager.editAltText(r(this,ss)),r(this,Fa)&&r(this,ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,ua,ky)}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(v(this,Tp,!0),i(s))},{signal:n}),await A(this,ua,Y_).call(this),t}finish(){r(this,zr)&&(r(this,zr).focus({focusVisible:r(this,Tp)}),v(this,Tp,!1))}isEmpty(){return r(this,Fa)?r(this,On)===null:!r(this,On)&&!r(this,Ma)}hasData(){return r(this,Fa)?r(this,On)!==null||!!r(this,jo):this.isEmpty()}get guessedText(){return r(this,jo)}async setGuessedText(t){r(this,On)===null&&(v(this,jo,t),v(this,vu,await Wn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),A(this,ua,Y_).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,Fa)||r(this,On)){(e=r(this,Da))==null||e.remove(),v(this,Da,null);return}if(!r(this,Da)){const n=v(this,Da,document.createElement("div"));n.className="noAltTextBadge",r(this,ss).div.append(n)}r(this,Da).classList.toggle("hidden",!t)}serialize(t){let e=r(this,On);return!t&&r(this,jo)===e&&(e=r(this,vu)),{altText:e,decorative:r(this,Ma),guessedText:r(this,jo),textWithDisclaimer:r(this,vu)}}get data(){return{altText:r(this,On),decorative:r(this,Ma)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(v(this,jo,n),v(this,vu,i)),!(r(this,On)===t&&r(this,Ma)===e)&&(s||(v(this,On,t),v(this,Ma,e)),A(this,ua,Y_).call(this))}toggle(t=!1){r(this,zr)&&(!t&&r(this,Es)&&(clearTimeout(r(this,Es)),v(this,Es,null)),r(this,zr).disabled=!t)}shown(){r(this,ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,ua,ky)}})}destroy(){var t,e;(t=r(this,zr))==null||t.remove(),v(this,zr,null),v(this,Cp,null),v(this,Ia,null),(e=r(this,Da))==null||e.remove(),v(this,Da,null)}},On=new WeakMap,Ma=new WeakMap,zr=new WeakMap,Cp=new WeakMap,Ia=new WeakMap,Es=new WeakMap,Tp=new WeakMap,Da=new WeakMap,ss=new WeakMap,jo=new WeakMap,vu=new WeakMap,Fa=new WeakMap,Pc=new WeakMap,ua=new WeakSet,ky=function(){return r(this,On)&&"added"||r(this,On)===null&&this.guessedText&&"review"||"missing"},Y_=async function(){var i,s,o;const t=r(this,zr);if(!t)return;if(r(this,Fa)){if(t.classList.toggle("done",!!r(this,On)),t.setAttribute("data-l10n-id",r(Wn,Pc)[r(this,ua,ky)]),(i=r(this,Cp))==null||i.setAttribute("data-l10n-id",r(Wn,Pc)[`${r(this,ua,ky)}-label`]),!r(this,On)){(s=r(this,Ia))==null||s.remove();return}}else{if(!r(this,On)&&!r(this,Ma)){t.classList.remove("done"),(o=r(this,Ia))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,Ia);if(!e){v(this,Ia,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,ss).id}`;const l=100,h=r(this,ss)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(r(this,Es)),v(this,Es,null)},{once:!0}),t.addEventListener("mouseenter",()=>{v(this,Es,setTimeout(()=>{v(this,Es,null),r(this,Ia).classList.add("show"),r(this,ss)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:h}),t.addEventListener("mouseleave",()=>{var d;r(this,Es)&&(clearTimeout(r(this,Es)),v(this,Es,null)),(d=r(this,Ia))==null||d.classList.remove("show")},{signal:h})}r(this,Ma)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,On)),e.parentNode||t.append(e);const n=r(this,ss).getImageForAltText();n==null||n.setAttribute("aria-describedby",e.id)},E(Wn,Pc,null),lt(Wn,"_l10n",null),Wn);var Tv,bu,kv,Pv,Rv,Lv,Mv,kp,Ho,Au,Rc,jl,OD,ND,Vx;const Dk=class Dk{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:l}){E(this,jl);E(this,Tv);E(this,bu,!1);E(this,kv,null);E(this,Pv);E(this,Rv);E(this,Lv);E(this,Mv);E(this,kp);E(this,Ho,null);E(this,Au);E(this,Rc,null);v(this,Tv,t),v(this,kv,n),v(this,Pv,e),v(this,Rv,i),v(this,Lv,s),v(this,Mv,o),v(this,Au,new AbortController),v(this,kp,AbortSignal.any([l,r(this,Au).signal])),t.addEventListener("touchstart",A(this,jl,OD).bind(this),{passive:!1,signal:r(this,kp)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Kt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=r(this,Au))==null||t.abort(),v(this,Au,null)}};Tv=new WeakMap,bu=new WeakMap,kv=new WeakMap,Pv=new WeakMap,Rv=new WeakMap,Lv=new WeakMap,Mv=new WeakMap,kp=new WeakMap,Ho=new WeakMap,Au=new WeakMap,Rc=new WeakMap,jl=new WeakSet,OD=function(t){var i,s,o;if((i=r(this,Pv))!=null&&i.call(this)||t.touches.length<2)return;if(!r(this,Rc)){v(this,Rc,new AbortController);const l=AbortSignal.any([r(this,kp),r(this,Rc).signal]),h=r(this,Tv),d={signal:l,passive:!1};h.addEventListener("touchmove",A(this,jl,ND).bind(this),d),h.addEventListener("touchend",A(this,jl,Vx).bind(this),d),h.addEventListener("touchcancel",A(this,jl,Vx).bind(this),d),(s=r(this,Rv))==null||s.call(this)}if(Ws(t),t.touches.length!==2||(o=r(this,kv))!=null&&o.call(this)){v(this,Ho,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),v(this,Ho,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},ND=function(t){var L;if(!r(this,Ho)||t.touches.length!==2)return;let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:i,screenY:s}=e,{screenX:o,screenY:l}=n,h=r(this,Ho),{touch0X:d,touch0Y:p,touch1X:g,touch1Y:m}=h,b=g-d,_=m-p,S=o-i,C=l-s,T=Math.hypot(S,C)||1,k=Math.hypot(b,_)||1;if(!r(this,bu)&&Math.abs(k-T)<=Dk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=s,h.touch1X=o,h.touch1Y=l,t.preventDefault(),!r(this,bu)){v(this,bu,!0);return}const P=[(i+o)/2,(s+l)/2];(L=r(this,Lv))==null||L.call(this,P,k,T)},Vx=function(t){var e;r(this,Rc).abort(),v(this,Rc,null),(e=r(this,Mv))==null||e.call(this),r(this,Ho)&&(t.preventDefault(),v(this,Ho,null),v(this,bu,!1))};let Zw=Dk;var _u,Ur,Le,Pp,Lc,Iv,wu,Zn,Eu,Bo,Mc,Dv,Su,Ss,Fv,xu,zo,Oa,Rp,Lp,ar,Cu,jt,Ov,hE,Dt,Wx,Nv,qx,K_,$D,jD,Xx,Q_,Yx,HD,BD,zD,Kx,UD,Qx,GD,VD,WD,Jx,Py;let rn=(jt=class{constructor(t){E(this,Dt);E(this,_u,null);E(this,Ur,null);E(this,Le,null);E(this,Pp,!1);E(this,Lc,null);E(this,Iv,"");E(this,wu,!1);E(this,Zn,null);E(this,Eu,null);E(this,Bo,null);E(this,Mc,null);E(this,Dv,"");E(this,Su,!1);E(this,Ss,null);E(this,Fv,!1);E(this,xu,!1);E(this,zo,!1);E(this,Oa,null);E(this,Rp,0);E(this,Lp,0);E(this,ar,null);E(this,Cu,null);lt(this,"_editToolbar",null);lt(this,"_initialOptions",Object.create(null));lt(this,"_initialData",null);lt(this,"_isVisible",!0);lt(this,"_uiManager",null);lt(this,"_focusEventsAllowed",!0);E(this,Ov,!1);E(this,hE,jt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[l,h]=this.parentDimensions;this.x=t.x/l,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=jt.prototype._resizeWithKeyboard,e=hv.TRANSLATE_SMALL,n=hv.TRANSLATE_BIG;return Kt(this,"_resizerKeyboardManager",new J0([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],jt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Kt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new DH({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(jt._l10n??(jt._l10n=t),jt._l10nResizer||(jt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),jt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);jt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ee("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Ov)}set _isDraggable(t){var e;v(this,Ov,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,hE)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):A(this,Dt,Py).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,Su)?v(this,Su,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/o,this.fixAndSetPosition()}translate(t,e){A(this,Dt,Wx).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,Ss)||v(this,Ss,[this.x,this.y,this.width,this.height]),A(this,Dt,Wx).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,Ss)||v(this,Ss,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[h,d]=this.getBaseTranslation();o+=h,l+=d;const{style:p}=n;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!r(this,Ss)&&(r(this,Ss)[0]!==this.x||r(this,Ss)[1]!==this.y)}get _hasBeenResized(){return!!r(this,Ss)&&(r(this,Ss)[2]!==this.width||r(this,Ss)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=jt,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,i]}=this;let{x:s,y:o,width:l,height:h}=this;if(l*=n,h*=i,s*=n,o*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(n-l,s)),o=Math.max(0,Math.min(i-h,o));break;case 90:s=Math.max(0,Math.min(n-h,s)),o=Math.min(i,Math.max(l,o));break;case 180:s=Math.min(n,Math.max(l,s)),o=Math.min(i,Math.max(h,o));break;case 270:s=Math.min(n,Math.max(h,s)),o=Math.max(0,Math.min(i-l,o));break}this.x=s/=n,this.y=o/=i;const[d,p]=this.getBaseTranslation();s+=d,o+=p,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return A(n=jt,Nv,qx).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return A(n=jt,Nv,qx).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/n).toFixed(2)}%`,r(this,wu)||(s.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!r(this,wu)&&e.endsWith("%");if(i&&s)return;const[o,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!r(this,wu)&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=r(this,Le))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,xu)?this._editToolbar:(this._editToolbar=new kH(this),this.div.append(this._editToolbar.render()),r(this,Le)&&await this._editToolbar.addAltText(r(this,Le)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,Le))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,Le)||($L.initialize(jt._l10n),v(this,Le,new $L(this)),r(this,_u)&&(r(this,Le).data=r(this,_u),v(this,_u,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,Le))==null?void 0:t.data}set altTextData(t){r(this,Le)&&(r(this,Le).data=t)}get guessedAltText(){var t;return(t=r(this,Le))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,Le))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,Le))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,Le)&&!r(this,Le).isEmpty()}hasAltTextData(){var t;return((t=r(this,Le))==null?void 0:t.hasData())??!1}render(){var s;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,Pp)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),A(this,Dt,Qx).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),Jw(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(r(this,Cu)||v(this,Cu,new Zw({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,Dt,HD).bind(this),onPinching:A(this,Dt,BD).bind(this),onPinchEnd:A(this,Dt,zD).bind(this),signal:this._uiManager._signal}))),(s=this._uiManager._editorUndoBar)==null||s.hide(),this.div}pointerdown(t){const{isMac:e}=zi.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(v(this,Su,!0),this._isDraggable){A(this,Dt,UD).call(this,t);return}A(this,Dt,Kx).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){r(this,Oa)&&clearTimeout(r(this,Oa)),v(this,Oa,setTimeout(()=>{var t;v(this,Oa,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[l,h]=this.pageTranslation,d=t/i,p=e/i,g=this.x*s,m=this.y*o,b=this.width*s,_=this.height*o;switch(n){case 0:return[g+d+l,o-m-p-_+h,g+d+b+l,o-m-p+h];case 90:return[g+p+l,o-m+d+h,g+p+_+l,o-m+d+b+h];case 180:return[g-d-b+l,o-m+p+h,g-d+l,o-m+p+_+h];case 270:return[g-p-_+l,o-m-d-b+h,g-p+l,o-m-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,o]=t,l=s-n,h=o-i;switch(this.rotation){case 0:return[n,e-o,l,h];case 90:return[n,e-i,h,l];case 180:return[s,e-i,l,h];case 270:return[s,e-o,h,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){v(this,xu,!0)}disableEditMode(){v(this,xu,!1)}isInEditMode(){return r(this,xu)}shouldGetKeyboardEvents(){return r(this,zo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return e<o&&i>0&&t<s&&n>0}rebuild(){A(this,Dt,Qx).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Ee("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,v(i,_u,t.accessibilityData);const[s,o]=i.pageDimensions,[l,h,d,p]=i.getRectInCurrentCoords(t.rect,o);return i.x=l/s,i.y=h/o,i.width=d/s,i.height=p/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=r(this,Mc))==null||t.abort(),v(this,Mc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,Oa)&&(clearTimeout(r(this,Oa)),v(this,Oa,null)),A(this,Dt,Py).call(this),this.removeEditToolbar(),r(this,ar)){for(const n of r(this,ar).values())clearTimeout(n);v(this,ar,null)}this.parent=null,(e=r(this,Cu))==null||e.destroy(),v(this,Cu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Dt,$D).call(this),r(this,Zn).classList.remove("hidden"),Jw(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),v(this,Bo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,Zn).children;if(!r(this,Ur)){v(this,Ur,Array.from(e));const o=A(this,Dt,GD).bind(this),l=A(this,Dt,VD).bind(this),h=this._uiManager._signal;for(const d of r(this,Ur)){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:h}),d.addEventListener("blur",l,{signal:h}),d.addEventListener("focus",A(this,Dt,WD).bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",jt._l10nResizer[p])}}const n=r(this,Ur)[0];let i=0;for(const o of e){if(o===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(r(this,Ur).length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)r(this,Zn).append(r(this,Zn).firstChild);else if(s>i)for(let l=0;l<s-i;l++)r(this,Zn).firstChild.before(r(this,Zn).lastChild);let o=0;for(const l of e){const d=r(this,Ur)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",jt._l10nResizer[d])}}A(this,Dt,Jx).call(this,0),v(this,zo,!0),r(this,Zn).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,zo)&&A(this,Dt,Yx).call(this,r(this,Dv),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,Dt,Py).call(this),this.div.focus()}select(){var t,e,n;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(n=r(this,Le))==null||n.toggleAltTextBadge(!1)}unselect(){var t,e,n,i,s;(t=r(this,Zn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=r(this,Le))==null||s.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,Fv)}set isEditing(t){v(this,Fv,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){v(this,wu,!0);const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,ar)||v(this,ar,new Map);const{action:n}=t;let i=r(this,ar).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),r(this,ar).delete(n),r(this,ar).size===0&&v(this,ar,null)},jt._telemetryTimeout),r(this,ar).set(n,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),v(this,Pp,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,Pp,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}},_u=new WeakMap,Ur=new WeakMap,Le=new WeakMap,Pp=new WeakMap,Lc=new WeakMap,Iv=new WeakMap,wu=new WeakMap,Zn=new WeakMap,Eu=new WeakMap,Bo=new WeakMap,Mc=new WeakMap,Dv=new WeakMap,Su=new WeakMap,Ss=new WeakMap,Fv=new WeakMap,xu=new WeakMap,zo=new WeakMap,Oa=new WeakMap,Rp=new WeakMap,Lp=new WeakMap,ar=new WeakMap,Cu=new WeakMap,Ov=new WeakMap,hE=new WeakMap,Dt=new WeakSet,Wx=function([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Nv=new WeakSet,qx=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},K_=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},$D=function(){if(r(this,Zn))return;v(this,Zn,document.createElement("div")),r(this,Zn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");r(this,Zn).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",A(this,Dt,jD).bind(this,n),{signal:e}),i.addEventListener("contextmenu",fa,{signal:e}),i.tabIndex=-1}this.div.prepend(r(this,Zn))},jD=function(t,e){var p;e.preventDefault();const{isMac:n}=zi.platform;if(e.button!==0||e.ctrlKey&&n)return;(p=r(this,Le))==null||p.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,v(this,Eu,[e.screenX,e.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,Dt,Yx).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Ws,{passive:!1,signal:o}),window.addEventListener("contextmenu",fa,{signal:o}),v(this,Bo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{var g;s.abort(),this.parent.togglePointerEvents(!0),(g=r(this,Le))==null||g.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=h,A(this,Dt,Q_).call(this)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})},Xx=function(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[s,o]=this.parentDimensions;this.setDims(s*n,o*i),this.fixAndSetPosition(),this._onResized()},Q_=function(){if(!r(this,Bo))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=r(this,Bo);v(this,Bo,null);const s=this.x,o=this.y,l=this.width,h=this.height;s===t&&o===e&&l===n&&h===i||this.addCommands({cmd:A(this,Dt,Xx).bind(this,s,o,l,h),undo:A(this,Dt,Xx).bind(this,t,e,n,i),mustExec:!0})},Yx=function(t,e){const[n,i]=this.parentDimensions,s=this.x,o=this.y,l=this.width,h=this.height,d=jt.MIN_SIZE/n,p=jt.MIN_SIZE/i,g=A(this,Dt,K_).call(this,this.rotation),m=(J,G)=>[g[0]*J+g[2]*G,g[1]*J+g[3]*G],b=A(this,Dt,K_).call(this,360-this.rotation),_=(J,G)=>[b[0]*J+b[2]*G,b[1]*J+b[3]*G];let S,C,T=!1,k=!1;switch(t){case"topLeft":T=!0,S=(J,G)=>[0,0],C=(J,G)=>[J,G];break;case"topMiddle":S=(J,G)=>[J/2,0],C=(J,G)=>[J/2,G];break;case"topRight":T=!0,S=(J,G)=>[J,0],C=(J,G)=>[0,G];break;case"middleRight":k=!0,S=(J,G)=>[J,G/2],C=(J,G)=>[0,G/2];break;case"bottomRight":T=!0,S=(J,G)=>[J,G],C=(J,G)=>[0,0];break;case"bottomMiddle":S=(J,G)=>[J/2,G],C=(J,G)=>[J/2,0];break;case"bottomLeft":T=!0,S=(J,G)=>[0,G],C=(J,G)=>[J,0];break;case"middleLeft":k=!0,S=(J,G)=>[0,G/2],C=(J,G)=>[J,G/2];break}const P=S(l,h),L=C(l,h);let I=m(...L);const D=jt._round(s+I[0]),F=jt._round(o+I[1]);let H=1,j=1,Q,V;if(e.fromKeyboard)({deltaX:Q,deltaY:V}=e);else{const{screenX:J,screenY:G}=e,[q,U]=r(this,Eu);[Q,V]=this.screenToPageTranslation(J-q,G-U),r(this,Eu)[0]=J,r(this,Eu)[1]=G}if([Q,V]=_(Q/n,V/i),T){const J=Math.hypot(l,h);H=j=Math.max(Math.min(Math.hypot(L[0]-P[0]-Q,L[1]-P[1]-V)/J,1/l,1/h),d/l,p/h)}else k?H=Math.max(d,Math.min(1,Math.abs(L[0]-P[0]-Q)))/l:j=Math.max(p,Math.min(1,Math.abs(L[1]-P[1]-V)))/h;const tt=jt._round(l*H),Z=jt._round(h*j);I=m(...C(tt,Z));const et=D-I[0],ht=F-I[1];r(this,Ss)||v(this,Ss,[this.x,this.y,this.width,this.height]),this.width=tt,this.height=Z,this.x=et,this.y=ht,this.setDims(n*tt,i*Z),this.fixAndSetPosition(),this._onResizing()},HD=function(){var t;v(this,Bo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=r(this,Le))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},BD=function(t,e,n){let s=.7*(n/e)+1-.7;if(s===1)return;const o=A(this,Dt,K_).call(this,this.rotation),l=(D,F)=>[o[0]*D+o[2]*F,o[1]*D+o[3]*F],[h,d]=this.parentDimensions,p=this.x,g=this.y,m=this.width,b=this.height,_=jt.MIN_SIZE/h,S=jt.MIN_SIZE/d;s=Math.max(Math.min(s,1/m,1/b),_/m,S/b);const C=jt._round(m*s),T=jt._round(b*s);if(C===m&&T===b)return;r(this,Ss)||v(this,Ss,[p,g,m,b]);const k=l(m/2,b/2),P=jt._round(p+k[0]),L=jt._round(g+k[1]),I=l(C/2,T/2);this.x=P-I[0],this.y=L-I[1],this.width=C,this.height=T,this.setDims(h*C,d*T),this.fixAndSetPosition(),this._onResizing()},zD=function(){var t;(t=r(this,Le))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),A(this,Dt,Q_).call(this)},Kx=function(t){const{isMac:e}=zi.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},UD=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},l=d=>{i.abort(),v(this,Lc,null),v(this,Su,!1),this._uiManager.endDragSession()||A(this,Dt,Kx).call(this,d),n&&this._onStopDragging()};e&&(v(this,Rp,t.clientX),v(this,Lp,t.clientY),v(this,Lc,t.pointerId),v(this,Iv,t.pointerType),window.addEventListener("pointermove",d=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:g,pointerId:m}=d;if(m!==r(this,Lc)){Ws(d);return}const[b,_]=this.screenToPageTranslation(p-r(this,Rp),g-r(this,Lp));v(this,Rp,p),v(this,Lp,g),this._uiManager.dragSelectedEditors(b,_)},o),window.addEventListener("touchmove",Ws,o),window.addEventListener("pointerdown",d=>{d.pointerType===r(this,Iv)&&(r(this,Cu)||d.isPrimary)&&l(d),Ws(d)},o));const h=d=>{if(!r(this,Lc)||r(this,Lc)===d.pointerId){l(d);return}Ws(d)};window.addEventListener("pointerup",h,{signal:s}),window.addEventListener("blur",h,{signal:s})},Qx=function(){if(r(this,Mc)||!this.div)return;v(this,Mc,new AbortController);const t=this._uiManager.combinedSignal(r(this,Mc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},GD=function(t){jt._resizerKeyboardManager.exec(this,t)},VD=function(t){var e;r(this,zo)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,Zn)&&A(this,Dt,Py).call(this)},WD=function(t){v(this,Dv,r(this,zo)?t:"")},Jx=function(t){if(r(this,Ur))for(const e of r(this,Ur))e.tabIndex=t},Py=function(){v(this,zo,!1),A(this,Dt,Jx).call(this,-1),A(this,Dt,Q_).call(this)},E(jt,Nv),lt(jt,"_l10n",null),lt(jt,"_l10nResizer",null),lt(jt,"_borderLineWidth",-1),lt(jt,"_colorManager",new IH),lt(jt,"_zIndex",1),lt(jt,"_telemetryTimeout",1e3),jt),DH=class extends rn{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}};const jL=3285377520,nr=4294901760,Sa=65535;let qD=class{constructor(t){this.h1=t?t&4294967295:jL,this.h2=t?t&4294967295:jL}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,C=t.length;S<C;S++){const T=t.charCodeAt(S);T<=255?e[n++]=T:(e[n++]=T>>>8,e[n++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,o=new Uint32Array(e.buffer,0,i);let l=0,h=0,d=this.h1,p=this.h2;const g=3432918353,m=461845907,b=g&Sa,_=m&Sa;for(let S=0;S<i;S++)S&1?(l=o[S],l=l*g&nr|l*b&Sa,l=l<<15|l>>>17,l=l*m&nr|l*_&Sa,d^=l,d=d<<13|d>>>19,d=d*5+3864292196):(h=o[S],h=h*g&nr|h*b&Sa,h=h<<15|h>>>17,h=h*m&nr|h*_&Sa,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*g&nr|l*b&Sa,l=l<<15|l>>>17,l=l*m&nr|l*_&Sa,i&1?d^=l:p^=l}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&nr|t*36045&Sa,e=e*4283543511&nr|((e<<16|t>>>16)*2950163797&nr)>>>16,t^=e>>>1,t=t*444984403&nr|t*60499&Sa,e=e*3301882366&nr|((e<<16|t>>>16)*3120437893&nr)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}};const Zx=Object.freeze({map:null,hash:"",transfer:void 0});var Tu,ku,Nn,uE,XD,kI;let pk=(kI=class{constructor(){E(this,uE);E(this,Tu,!1);E(this,ku,null);E(this,Nn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=r(this,Nn).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return r(this,Nn).get(t)}remove(t){if(r(this,Nn).delete(t),r(this,Nn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,Nn).values())if(e instanceof rn)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=r(this,Nn).get(t);let i=!1;if(n!==void 0)for(const[s,o]of Object.entries(e))n[s]!==o&&(i=!0,n[s]=o);else i=!0,r(this,Nn).set(t,e);i&&A(this,uE,XD).call(this),e instanceof rn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Nn).has(t)}getAll(){return r(this,Nn).size>0?lk(r(this,Nn)):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return r(this,Nn).size}resetModified(){r(this,Tu)&&(v(this,Tu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new YD(this)}get serializable(){if(r(this,Nn).size===0)return Zx;const t=new Map,e=new qD,n=[],i=Object.create(null);let s=!1;for(const[o,l]of r(this,Nn)){const h=l instanceof rn?l.serialize(!1,i):l;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const o of t.values())o.bitmap&&n.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Zx}get editorStats(){let t=null;const e=new Map;for(const n of r(this,Nn).values()){if(!(n instanceof rn))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const o=t[s]||(t[s]=new Map);for(const[l,h]of Object.entries(i)){if(l==="type")continue;let d=o.get(l);d||(d=new Map,o.set(l,d));const p=d.get(h)??0;d.set(h,p+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){v(this,ku,null)}get modifiedIds(){if(r(this,ku))return r(this,ku);const t=[];for(const e of r(this,Nn).values())!(e instanceof rn)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return v(this,ku,{ids:new Set(t),hash:t.join(",")})}},Tu=new WeakMap,ku=new WeakMap,Nn=new WeakMap,uE=new WeakSet,XD=function(){r(this,Tu)||(v(this,Tu,!0),typeof this.onSetModified=="function"&&this.onSetModified())},kI);var $v,PI;let YD=(PI=class extends pk{constructor(e){super();E(this,$v);const{map:n,hash:i,transfer:s}=e.serializable,o=structuredClone(n,s?{transfer:s}:null);v(this,$v,{map:o,hash:i,transfer:s})}get print(){Ee("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,$v)}get modifiedIds(){return Kt(this,"modifiedIds",{ids:new Set,hash:""})}},$v=new WeakMap,PI);var Mp,RI;let FH=(RI=class{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){E(this,Mp,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,Mp).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,Mp).has(t.loadedName))){if(fn(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=t,o=new FontFace(n,i,s);this.addNativeFontFace(o);try{await o.load(),r(this,Mp).add(n),e==null||e(t)}catch{Gt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ee("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Gt(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Kt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Pi||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Kt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(fn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Kt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(L,I){return L.charCodeAt(I)<<24|L.charCodeAt(I+1)<<16|L.charCodeAt(I+2)<<8|L.charCodeAt(I+3)&255}function i(L,I,D,F){const H=L.substring(0,I),j=L.substring(I+D);return H+F+j}let s,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let d=0;function p(L,I){if(++d>30){Gt("Load test font never loaded."),I();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(p.bind(null,L,I))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,g.length,g);const _=16,S=1482184792;let C=n(m,_);for(s=0,o=g.length-3;s<o;s+=4)C=C-S+n(g,s)|0;s<g.length&&(C=C-S+n(g+"XXX",s)|0),m=i(m,_,4,yH(C));const T=`url(data:font/opentype;base64,${btoa(m)});`,k=`@font-face {font-family:"${g}";src:${T}}`;this.insertRule(k);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[t.loadedName,g]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=L,P.append(I)}this._document.body.append(P),p(g,()=>{P.remove(),e.complete()})}},Mp=new WeakMap,RI),OH=class{constructor(t,{disableFontFace:e=!1,fontExtraProperties:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this.fontExtraProperties=n===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${EH(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(o){Gt(`getPathGenerator - ignoring character: "${o}".`)}const s=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=s}};const v_={DATA:1,ERROR:2},hn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function HL(){}function ns(u){if(u instanceof Ch||u instanceof Fx||u instanceof cv||u instanceof FL||u instanceof Qw||u instanceof K1)return u;switch(u instanceof Error||typeof u=="object"&&u!==null||Ee('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new Ch(u.message);case"InvalidPDFException":return new Fx(u.message);case"MissingPDFException":return new cv(u.message);case"PasswordException":return new FL(u.message,u.code);case"UnexpectedResponseException":return new Qw(u.message,u.status);case"UnknownErrorException":return new K1(u.message,u.details)}return new K1(u.message,u.toString())}var Ip,wr,KD,QD,JD,J_,LI;let Ry=(LI=class{constructor(t,e,n){E(this,wr);E(this,Ip,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",A(this,wr,KD).bind(this),{signal:r(this,Ip).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[s]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:l,action:t,streamId:s,data:e,desiredSize:d.desiredSize},i),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[s].pullCall=p,h.postMessage({sourceName:o,targetName:l,stream:hn.PULL,streamId:s,desiredSize:d.desiredSize}),p.promise},cancel:d=>{fn(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[s].cancelCall=p,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:o,targetName:l,stream:hn.CANCEL,streamId:s,reason:ns(d)}),p.promise}},n)}destroy(){var t;(t=r(this,Ip))==null||t.abort(),v(this,Ip,null)}},Ip=new WeakMap,wr=new WeakSet,KD=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){A(this,wr,JD).call(this,t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===v_.DATA)i.resolve(t.data);else if(t.callback===v_.ERROR)i.reject(ns(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(o){s.postMessage({sourceName:n,targetName:i,callback:v_.DATA,callbackId:t.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:i,callback:v_.ERROR,callbackId:t.callbackId,reason:ns(o)})});return}if(t.streamId){A(this,wr,QD).call(this,t);return}e(t.data)},QD=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this,l=this.actionHandler[t.action],h={enqueue(d,p=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=p,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:hn.ENQUEUE,streamId:e,chunk:d},g)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:hn.CLOSE,streamId:e}),delete o.streamSinks[e])},error(d){fn(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:hn.ERROR,streamId:e,reason:ns(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(l,t.data,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:hn.START_COMPLETE,streamId:e,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:hn.START_COMPLETE,streamId:e,reason:ns(d)})})},JD=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case hn.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(ns(t.reason));break;case hn.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(ns(t.reason));break;case hn.PULL:if(!l){s.postMessage({sourceName:n,targetName:i,stream:hn.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||HL).then(function(){s.postMessage({sourceName:n,targetName:i,stream:hn.PULL_COMPLETE,streamId:e,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:hn.PULL_COMPLETE,streamId:e,reason:ns(d)})});break;case hn.ENQUEUE:if(fn(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case hn.CLOSE:if(fn(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),A(this,wr,J_).call(this,o,e);break;case hn.ERROR:fn(o,"error should have stream controller"),o.controller.error(ns(t.reason)),A(this,wr,J_).call(this,o,e);break;case hn.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(ns(t.reason)),A(this,wr,J_).call(this,o,e);break;case hn.CANCEL:if(!l)break;const h=ns(t.reason);Promise.try(l.onCancel||HL,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:hn.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:hn.CANCEL_COMPLETE,streamId:e,reason:ns(d)})}),l.sinkCapability.reject(h),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},J_=async function(t,e){var n,i,s;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(i=t.pullCall)==null?void 0:i.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]},LI);var jv,MI;let ZD=(MI=class{constructor({enableHWA:t=!1}){E(this,jv,!1);v(this,jv,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!r(this,jv)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ee("Abstract method `_createCanvas` called.")}},jv=new WeakMap,MI),NH=class extends ZD{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}},tF=class{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}},eF=class extends tF{async _fetch(t){const e=await UE(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):zE(e)}},nF=class{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(t=!1){}};var Pu,Dp,Uo,Go,_i,Ru,Lu,At,yi,Ly,Zf,Z_,tp,iF,tC,ep,My,Iy,eC,Dy,II;let $H=(II=class extends nF{constructor({docId:e,ownerDocument:n=globalThis.document}){super();E(this,At);E(this,Pu);E(this,Dp);E(this,Uo);E(this,Go);E(this,_i);E(this,Ru);E(this,Lu,0);v(this,Go,e),v(this,_i,n)}addFilter(e){if(!e)return"none";let n=r(this,At,yi).get(e);if(n)return n;const[i,s,o]=A(this,At,Z_).call(this,e),l=e.length===1?i:`${i}${s}${o}`;if(n=r(this,At,yi).get(l),n)return r(this,At,yi).set(e,n),n;const h=`g_${r(this,Go)}_transfer_map_${he(this,Lu)._++}`,d=A(this,At,tp).call(this,h);r(this,At,yi).set(e,d),r(this,At,yi).set(l,d);const p=A(this,At,ep).call(this,h);return A(this,At,Iy).call(this,i,s,o,p),d}addHCMFilter(e,n){var _;const i=`${e}-${n}`,s="base";let o=r(this,At,Ly).get(s);if((o==null?void 0:o.key)===i||(o?((_=o.filter)==null||_.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},r(this,At,Ly).set(s,o)),!e||!n))return o.url;const l=A(this,At,Dy).call(this,e);e=Rt.makeHexColor(...l);const h=A(this,At,Dy).call(this,n);if(n=Rt.makeHexColor(...h),r(this,At,Zf).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return o.url;const d=new Array(256);for(let S=0;S<=255;S++){const C=S/255;d[S]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const p=d.join(","),g=`g_${r(this,Go)}_hcm_filter`,m=o.filter=A(this,At,ep).call(this,g);A(this,At,Iy).call(this,p,p,p,m),A(this,At,tC).call(this,m);const b=(S,C)=>{const T=l[S]/255,k=h[S]/255,P=new Array(C+1);for(let L=0;L<=C;L++)P[L]=T+L/C*(k-T);return P.join(",")};return A(this,At,Iy).call(this,b(0,5),b(1,5),b(2,5),m),o.url=A(this,At,tp).call(this,g),o.url}addAlphaFilter(e){let n=r(this,At,yi).get(e);if(n)return n;const[i]=A(this,At,Z_).call(this,[e]),s=`alpha_${i}`;if(n=r(this,At,yi).get(s),n)return r(this,At,yi).set(e,n),n;const o=`g_${r(this,Go)}_alpha_map_${he(this,Lu)._++}`,l=A(this,At,tp).call(this,o);r(this,At,yi).set(e,l),r(this,At,yi).set(s,l);const h=A(this,At,ep).call(this,o);return A(this,At,eC).call(this,i,h),l}addLuminosityFilter(e){let n=r(this,At,yi).get(e||"luminosity");if(n)return n;let i,s;if(e?([i]=A(this,At,Z_).call(this,[e]),s=`luminosity_${i}`):s="luminosity",n=r(this,At,yi).get(s),n)return r(this,At,yi).set(e,n),n;const o=`g_${r(this,Go)}_luminosity_map_${he(this,Lu)._++}`,l=A(this,At,tp).call(this,o);r(this,At,yi).set(e,l),r(this,At,yi).set(s,l);const h=A(this,At,ep).call(this,o);return A(this,At,iF).call(this,h),e&&A(this,At,eC).call(this,i,h),l}addHighlightHCMFilter(e,n,i,s,o){var k;const l=`${n}-${i}-${s}-${o}`;let h=r(this,At,Ly).get(e);if((h==null?void 0:h.key)===l||(h?((k=h.filter)==null||k.remove(),h.key=l,h.url="none",h.filter=null):(h={key:l,url:"none",filter:null},r(this,At,Ly).set(e,h)),!n||!i))return h.url;const[d,p]=[n,i].map(A(this,At,Dy).bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[b,_]=[s,o].map(A(this,At,Dy).bind(this));m<g&&([g,m,b,_]=[m,g,_,b]),r(this,At,Zf).style.color="";const S=(P,L,I)=>{const D=new Array(256),F=(m-g)/I,H=P/255,j=(L-P)/(255*I);let Q=0;for(let V=0;V<=I;V++){const tt=Math.round(g+V*F),Z=H+V*j;for(let et=Q;et<=tt;et++)D[et]=Z;Q=tt+1}for(let V=Q;V<256;V++)D[V]=D[Q-1];return D.join(",")},C=`g_${r(this,Go)}_hcm_${e}_filter`,T=h.filter=A(this,At,ep).call(this,C);return A(this,At,tC).call(this,T),A(this,At,Iy).call(this,S(b[0],_[0],5),S(b[1],_[1],5),S(b[2],_[2],5),T),h.url=A(this,At,tp).call(this,C),h.url}destroy(e=!1){var n,i,s,o;e&&((n=r(this,Ru))!=null&&n.size)||((i=r(this,Uo))==null||i.parentNode.parentNode.remove(),v(this,Uo,null),(s=r(this,Dp))==null||s.clear(),v(this,Dp,null),(o=r(this,Ru))==null||o.clear(),v(this,Ru,null),v(this,Lu,0))}},Pu=new WeakMap,Dp=new WeakMap,Uo=new WeakMap,Go=new WeakMap,_i=new WeakMap,Ru=new WeakMap,Lu=new WeakMap,At=new WeakSet,yi=function(){return r(this,Dp)||v(this,Dp,new Map)},Ly=function(){return r(this,Ru)||v(this,Ru,new Map)},Zf=function(){if(!r(this,Uo)){const e=r(this,_i).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=r(this,_i).createElementNS(Ro,"svg");i.setAttribute("width",0),i.setAttribute("height",0),v(this,Uo,r(this,_i).createElementNS(Ro,"defs")),e.append(i),i.append(r(this,Uo)),r(this,_i).body.append(e)}return r(this,Uo)},Z_=function(e){if(e.length===1){const d=e[0],p=new Array(256);for(let m=0;m<256;m++)p[m]=d[m]/255;const g=p.join(",");return[g,g,g]}const[n,i,s]=e,o=new Array(256),l=new Array(256),h=new Array(256);for(let d=0;d<256;d++)o[d]=n[d]/255,l[d]=i[d]/255,h[d]=s[d]/255;return[o.join(","),l.join(","),h.join(",")]},tp=function(e){if(r(this,Pu)===void 0){v(this,Pu,"");const n=r(this,_i).URL;n!==r(this,_i).baseURI&&(GE(n)?Gt('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,Pu,n.split("#",1)[0]))}return`url(${r(this,Pu)}#${e})`},iF=function(e){const n=r(this,_i).createElementNS(Ro,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},tC=function(e){const n=r(this,_i).createElementNS(Ro,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},ep=function(e){const n=r(this,_i).createElementNS(Ro,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),r(this,At,Zf).append(n),n},My=function(e,n,i){const s=r(this,_i).createElementNS(Ro,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)},Iy=function(e,n,i,s){const o=r(this,_i).createElementNS(Ro,"feComponentTransfer");s.append(o),A(this,At,My).call(this,o,"feFuncR",e),A(this,At,My).call(this,o,"feFuncG",n),A(this,At,My).call(this,o,"feFuncB",i)},eC=function(e,n){const i=r(this,_i).createElementNS(Ro,"feComponentTransfer");n.append(i),A(this,At,My).call(this,i,"feFuncA",e)},Dy=function(e){return r(this,At,Zf).style.color=e,fk(getComputedStyle(r(this,At,Zf)).getPropertyValue("color"))},II),sF=class{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}},rF=class extends sF{async _fetch(t){const e=await UE(t,"arraybuffer");return new Uint8Array(e)}};Pi&&Gt("Please use the `legacy` build in Node.js environments.");async function aF(u){const e=await process.getBuiltinModule("fs").promises.readFile(u);return new Uint8Array(e)}let jH=class extends nF{},HH=class extends ZD{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}},BH=class extends tF{async _fetch(t){return aF(t)}},zH=class extends sF{async _fetch(t){return aF(t)}};const ki={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function nC(u,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),u.clip(i)}let gk=class{getPattern(){Ee("Abstract method `getPattern` called.")}},UH=class extends gk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let s;if(i===ki.STROKE||i===ki.FILL){const o=e.current.getClippedPathBoundingBox(i,Oe(t))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,d=e.cachedCanvases.getCanvas("pattern",l,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),n=Rt.transform(n,[1,0,0,1,o[0],o[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),nC(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),s=t.createPattern(d.canvas,"no-repeat");const g=new DOMMatrix(n);s.setTransform(g)}else nC(t,this._bbox),s=this._createGradient(t);return s}};function Z1(u,t,e,n,i,s,o,l){const h=t.coords,d=t.colors,p=u.data,g=u.width*4;let m;h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m),h[n+1]>h[i+1]&&(m=n,n=i,i=m,m=o,o=l,l=m),h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m);const b=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,C=(h[n+1]+t.offsetY)*t.scaleY,T=(h[i]+t.offsetX)*t.scaleX,k=(h[i+1]+t.offsetY)*t.scaleY;if(_>=k)return;const P=d[s],L=d[s+1],I=d[s+2],D=d[o],F=d[o+1],H=d[o+2],j=d[l],Q=d[l+1],V=d[l+2],tt=Math.round(_),Z=Math.round(k);let et,ht,J,G,q,U,N,M;for(let B=tt;B<=Z;B++){if(B<C){const nt=B<_?0:(_-B)/(_-C);et=b-(b-S)*nt,ht=P-(P-D)*nt,J=L-(L-F)*nt,G=I-(I-H)*nt}else{let nt;B>k?nt=1:C===k?nt=0:nt=(C-B)/(C-k),et=S-(S-T)*nt,ht=D-(D-j)*nt,J=F-(F-Q)*nt,G=H-(H-V)*nt}let Y;B<_?Y=0:B>k?Y=1:Y=(_-B)/(_-k),q=b-(b-T)*Y,U=P-(P-j)*Y,N=L-(L-Q)*Y,M=I-(I-V)*Y;const it=Math.round(Math.min(et,q)),dt=Math.round(Math.max(et,q));let at=g*B+it*4;for(let nt=it;nt<=dt;nt++)Y=(et-nt)/(et-q),Y<0?Y=0:Y>1&&(Y=1),p[at++]=ht-(ht-U)*Y|0,p[at++]=J-(J-N)*Y|0,p[at++]=G-(G-M)*Y|0,p[at++]=255}}function GH(u,t,e){const n=t.coords,i=t.colors;let s,o;switch(t.type){case"lattice":const l=t.verticesPerRow,h=Math.floor(n.length/l)-1,d=l-1;for(s=0;s<h;s++){let p=s*l;for(let g=0;g<d;g++,p++)Z1(u,e,n[p],n[p+1],n[p+l],i[p],i[p+1],i[p+l]),Z1(u,e,n[p+l+1],n[p+1],n[p+l],i[p+l+1],i[p+1],i[p+l])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)Z1(u,e,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}let VH=class extends gk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-l,p=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=d/g,_=p/m,S={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/b,scaleY:1/_},C=g+2*2,T=m+2*2,k=n.getCanvas("mesh",C,T),P=k.context,L=P.createImageData(g,m);if(e){const D=L.data;for(let F=0,H=D.length;F<H;F+=4)D[F]=e[0],D[F+1]=e[1],D[F+2]=e[2],D[F+3]=255}for(const D of this._figures)GH(L,D,S);return P.putImageData(L,2,2),{canvas:k.canvas,offsetX:l-2*b,offsetY:h-2*_,scaleX:b,scaleY:_}}getPattern(t,e,n,i){nC(t,this._bbox);let s;if(i===ki.SHADING)s=Rt.singularValueDecompose2dScale(Oe(t));else if(s=Rt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const l=Rt.singularValueDecompose2dScale(this.matrix);s=[s[0]*l[0],s[1]*l[1]]}const o=this._createMeshCanvas(s,i===ki.SHADING?null:this._background,e.cachedCanvases);return i!==ki.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}},WH=class extends gk{getPattern(){return"hotpink"}};function qH(u){switch(u[0]){case"RadialAxial":return new UH(u);case"Mesh":return new VH(u);case"Dummy":return new WH}throw new Error(`Unknown IR type: ${u[0]}`)}const BL={COLORED:1,UNCOLORED:2};var Mu;let XH=(Mu=class{constructor(t,e,n,i,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:o,canvasGraphicsFactory:l}=this;let{xstep:h,ystep:d}=this;h=Math.abs(h),d=Math.abs(d),BE("TilingType: "+s);const p=e[0],g=e[1],m=e[2],b=e[3],_=m-p,S=b-g,C=Rt.singularValueDecompose2dScale(this.matrix),T=Rt.singularValueDecompose2dScale(this.baseTransform),k=C[0]*T[0],P=C[1]*T[1];let L=_,I=S,D=!1,F=!1;const H=Math.ceil(h*k),j=Math.ceil(d*P),Q=Math.ceil(_*k),V=Math.ceil(S*P);H>=Q?L=h:D=!0,j>=V?I=d:F=!0;const tt=this.getSizeAndScale(L,this.ctx.canvas.width,k),Z=this.getSizeAndScale(I,this.ctx.canvas.height,P),et=t.cachedCanvases.getCanvas("pattern",tt.size,Z.size),ht=et.context,J=l.createCanvasGraphics(ht);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,i,o),ht.translate(-tt.scale*p,-Z.scale*g),J.transform(tt.scale,0,0,Z.scale,0,0),ht.save(),this.clipBbox(J,p,g,m,b),J.baseTransform=Oe(J.ctx),J.executeOperatorList(n),J.endDrawing(),ht.restore(),D||F){const G=et.canvas;D&&(L=h),F&&(I=d);const q=this.getSizeAndScale(L,this.ctx.canvas.width,k),U=this.getSizeAndScale(I,this.ctx.canvas.height,P),N=q.size,M=U.size,B=t.cachedCanvases.getCanvas("pattern-workaround",N,M),Y=B.context,it=D?Math.floor(_/h):0,dt=F?Math.floor(S/d):0;for(let at=0;at<=it;at++)for(let nt=0;nt<=dt;nt++)Y.drawImage(G,N*at,M*nt,N,M,0,0,N,M);return{canvas:B.canvas,scaleX:q.scale,scaleY:U.scale,offsetX:p,offsetY:g}}return{canvas:et.canvas,scaleX:tt.scale,scaleY:Z.scale,offsetX:p,offsetY:g}}getSizeAndScale(t,e,n){const i=Math.max(Mu.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const o=i-e,l=s-n;t.ctx.rect(e,n,o,l),t.current.updateRectMinMax(Oe(t.ctx),[e,n,i,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case BL.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,s.fillColor=o.fillStyle,s.strokeColor=o.strokeStyle;break;case BL.UNCOLORED:const l=Rt.makeHexColor(n[0],n[1],n[2]);i.fillStyle=l,i.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new mH(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let s=n;i!==ki.SHADING&&(s=Rt.transform(s,e.baseTransform),this.matrix&&(s=Rt.transform(s,this.matrix)));const o=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const h=t.createPattern(o.canvas,"repeat");return h.setTransform(l),h}},lt(Mu,"MAX_PATTERN_SIZE",3e3),Mu);function YH({src:u,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=zi.isLittleEndian?4278190080:255,[h,d]=o?[s,l]:[l,s],p=n>>3,g=n&7,m=u.length;e=new Uint32Array(e.buffer);let b=0;for(let _=0;_<i;_++){for(const C=t+p;t<C;t++){const T=t<m?u[t]:255;e[b++]=T&128?d:h,e[b++]=T&64?d:h,e[b++]=T&32?d:h,e[b++]=T&16?d:h,e[b++]=T&8?d:h,e[b++]=T&4?d:h,e[b++]=T&2?d:h,e[b++]=T&1?d:h}if(g===0)continue;const S=t<m?u[t++]:255;for(let C=0;C<g;C++)e[b++]=S&1<<7-C?d:h}return{srcPos:t,destPos:b}}const zL=16,UL=100,KH=15,GL=10,VL=1e3,hs=16;function QH(u,t){if(u._removeMirroring)throw new Error("Context is already forwarding operations.");u.__originalSave=u.save,u.__originalRestore=u.restore,u.__originalRotate=u.rotate,u.__originalScale=u.scale,u.__originalTranslate=u.translate,u.__originalTransform=u.transform,u.__originalSetTransform=u.setTransform,u.__originalResetTransform=u.resetTransform,u.__originalClip=u.clip,u.__originalMoveTo=u.moveTo,u.__originalLineTo=u.lineTo,u.__originalBezierCurveTo=u.bezierCurveTo,u.__originalRect=u.rect,u.__originalClosePath=u.closePath,u.__originalBeginPath=u.beginPath,u._removeMirroring=()=>{u.save=u.__originalSave,u.restore=u.__originalRestore,u.rotate=u.__originalRotate,u.scale=u.__originalScale,u.translate=u.__originalTranslate,u.transform=u.__originalTransform,u.setTransform=u.__originalSetTransform,u.resetTransform=u.__originalResetTransform,u.clip=u.__originalClip,u.moveTo=u.__originalMoveTo,u.lineTo=u.__originalLineTo,u.bezierCurveTo=u.__originalBezierCurveTo,u.rect=u.__originalRect,u.closePath=u.__originalClosePath,u.beginPath=u.__originalBeginPath,delete u._removeMirroring},u.save=function(){t.save(),this.__originalSave()},u.restore=function(){t.restore(),this.__originalRestore()},u.translate=function(n,i){t.translate(n,i),this.__originalTranslate(n,i)},u.scale=function(n,i){t.scale(n,i),this.__originalScale(n,i)},u.transform=function(n,i,s,o,l,h){t.transform(n,i,s,o,l,h),this.__originalTransform(n,i,s,o,l,h)},u.setTransform=function(n,i,s,o,l,h){t.setTransform(n,i,s,o,l,h),this.__originalSetTransform(n,i,s,o,l,h)},u.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},u.rotate=function(n){t.rotate(n),this.__originalRotate(n)},u.clip=function(n){t.clip(n),this.__originalClip(n)},u.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},u.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},u.bezierCurveTo=function(e,n,i,s,o,l){t.bezierCurveTo(e,n,i,s,o,l),this.__originalBezierCurveTo(e,n,i,s,o,l)},u.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},u.closePath=function(){t.closePath(),this.__originalClosePath()},u.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}let JH=class{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}};function b_(u,t,e,n,i,s,o,l,h,d){const[p,g,m,b,_,S]=Oe(u);if(g===0&&m===0){const k=o*p+_,P=Math.round(k),L=l*b+S,I=Math.round(L),D=(o+h)*p+_,F=Math.abs(Math.round(D)-P)||1,H=(l+d)*b+S,j=Math.abs(Math.round(H)-I)||1;return u.setTransform(Math.sign(p),0,0,Math.sign(b),P,I),u.drawImage(t,e,n,i,s,0,0,F,j),u.setTransform(p,g,m,b,_,S),[F,j]}if(p===0&&b===0){const k=l*m+_,P=Math.round(k),L=o*g+S,I=Math.round(L),D=(l+d)*m+_,F=Math.abs(Math.round(D)-P)||1,H=(o+h)*g+S,j=Math.abs(Math.round(H)-I)||1;return u.setTransform(0,Math.sign(g),Math.sign(m),0,P,I),u.drawImage(t,e,n,i,s,0,0,j,F),u.setTransform(p,g,m,b,_,S),[j,F]}u.drawImage(t,e,n,i,s,o,l,h,d);const C=Math.hypot(p,g),T=Math.hypot(m,b);return[C*h,T*d]}function ZH(u){const{width:t,height:e}=u;if(t>VL||e>VL)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let o=new Uint8Array(s*(e+1)),l,h,d;const p=t+7&-8;let g=new Uint8Array(p*e),m=0;for(const T of u.data){let k=128;for(;k>0;)g[m++]=T&k?0:255,k>>=1}let b=0;for(m=0,g[m]!==0&&(o[0]=1,++b),h=1;h<t;h++)g[m]!==g[m+1]&&(o[h]=g[m]?2:1,++b),m++;for(g[m]!==0&&(o[h]=2,++b),l=1;l<e;l++){m=l*p,d=l*s,g[m-p]!==g[m]&&(o[d]=g[m]?1:8,++b);let T=(g[m]?4:0)+(g[m-p]?8:0);for(h=1;h<t;h++)T=(T>>2)+(g[m+1]?4:0)+(g[m-p+1]?8:0),i[T]&&(o[d+h]=i[T],++b),m++;if(g[m-p]!==g[m]&&(o[d+h]=g[m]?2:4,++b),b>n)return null}for(m=p*(e-1),d=l*s,g[m]!==0&&(o[d]=8,++b),h=1;h<t;h++)g[m]!==g[m+1]&&(o[d+h]=g[m]?4:8,++b),m++;if(g[m]!==0&&(o[d+h]=4,++b),b>n)return null;const _=new Int32Array([0,s,-1,0,-s,0,0,0,1]),S=new Path2D;for(l=0;b&&l<=e;l++){let T=l*s;const k=T+t;for(;T<k&&!o[T];)T++;if(T===k)continue;S.moveTo(T%s,l);const P=T;let L=o[T];do{const I=_[L];do T+=I;while(!o[T]);const D=o[T];D!==5&&D!==10?(L=D,o[T]=0):(L=D&51*L>>4,o[T]&=L>>2|L<<2),S.lineTo(T%s,T/s|0),o[T]||--b}while(P!==T);--l}return g=null,o=null,function(T){T.save(),T.scale(1/t,-1/e),T.translate(0,-e),T.fill(S),T.beginPath(),T.restore()}}let WL=class{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=pD,this.textMatrixScale=1,this.fontMatrix=Dx,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=mi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=Rt.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=Rt.applyTransform(e,t),i=Rt.applyTransform(e.slice(2),t),s=Rt.applyTransform([e[0],e[3]],t),o=Rt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],i[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],i[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],i[1],s[1],o[1])}updateScalingPathMinMax(t,e){Rt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,s,o,l,h,d,p){const g=Rt.bezierBoundingBox(e,n,i,s,o,l,h,d,p);p||this.updateRectMinMax(t,g)}getPathBoundingBox(t=ki.FILL,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===ki.STROKE){e||Ee("Stroke bounding box must include transform.");const i=Rt.singularValueDecompose2dScale(e),s=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=Rt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=ki.FILL,e=null){return Rt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}};function qL(u,t){if(t instanceof ImageData){u.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%hs,s=(e-i)/hs,o=i===0?s:s+1,l=u.createImageData(n,hs);let h=0,d;const p=t.data,g=l.data;let m,b,_,S;if(t.kind===U_.GRAYSCALE_1BPP){const C=p.byteLength,T=new Uint32Array(g.buffer,0,g.byteLength>>2),k=T.length,P=n+7>>3,L=4294967295,I=zi.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(_=m<s?hs:i,d=0,b=0;b<_;b++){const D=C-h;let F=0;const H=D>P?n:D*8-7,j=H&-8;let Q=0,V=0;for(;F<j;F+=8)V=p[h++],T[d++]=V&128?L:I,T[d++]=V&64?L:I,T[d++]=V&32?L:I,T[d++]=V&16?L:I,T[d++]=V&8?L:I,T[d++]=V&4?L:I,T[d++]=V&2?L:I,T[d++]=V&1?L:I;for(;F<H;F++)Q===0&&(V=p[h++],Q=128),T[d++]=V&Q?L:I,Q>>=1}for(;d<k;)T[d++]=0;u.putImageData(l,0,m*hs)}}else if(t.kind===U_.RGBA_32BPP){for(b=0,S=n*hs*4,m=0;m<s;m++)g.set(p.subarray(h,h+S)),h+=S,u.putImageData(l,0,b),b+=hs;m<o&&(S=n*i*4,g.set(p.subarray(h,h+S)),u.putImageData(l,0,b))}else if(t.kind===U_.RGB_24BPP)for(_=hs,S=n*_,m=0;m<o;m++){for(m>=s&&(_=i,S=n*_),d=0,b=S;b--;)g[d++]=p[h++],g[d++]=p[h++],g[d++]=p[h++],g[d++]=255;u.putImageData(l,0,m*hs)}else throw new Error(`bad image kind: ${t.kind}`)}function XL(u,t){if(t.bitmap){u.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%hs,s=(e-i)/hs,o=i===0?s:s+1,l=u.createImageData(n,hs);let h=0;const d=t.data,p=l.data;for(let g=0;g<o;g++){const m=g<s?hs:i;({srcPos:h}=YH({src:d,srcPos:h,dest:p,width:n,height:m,nonBlackColor:0})),u.putImageData(l,0,g*hs)}}function fy(u,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)u[n]!==void 0&&(t[n]=u[n]);u.setLineDash!==void 0&&(t.setLineDash(u.getLineDash()),t.lineDashOffset=u.lineDashOffset)}function A_(u){if(u.strokeStyle=u.fillStyle="#000000",u.fillRule="nonzero",u.globalAlpha=1,u.lineWidth=1,u.lineCap="butt",u.lineJoin="miter",u.miterLimit=10,u.globalCompositeOperation="source-over",u.font="10px sans-serif",u.setLineDash!==void 0&&(u.setLineDash([]),u.lineDashOffset=0),!Pi){const{filter:t}=u;t!=="none"&&t!==""&&(u.filter="none")}}function YL(u,t){if(t)return!0;const e=Rt.singularValueDecompose2dScale(u);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*Em.PDF_TO_CSS_UNITS);return e[0]<=n&&e[1]<=n}const tB=["butt","round","square"],eB=["miter","round","bevel"],nB={},KL={};var pa,iC,sC,rC,Fp;let tw=(Fp=class{constructor(t,e,n,i,s,{optionalContentConfig:o,markedContentStack:l=null},h,d){E(this,pa);this.ctx=t,this.current=new WL(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new JH(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,n){const h=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Oe(this.compositeCtx))}this.ctx.save(),A_(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Oe(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,o=t.fnArray;let l=e||0;const h=s.length;if(h===l)return l;const d=h-l>GL&&typeof n=="function",p=d?Date.now()+KH:0;let g=0;const m=this.commonObjs,b=this.objs;let _;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,n),l;if(_=o[l],_!==$r.dependency)this[_].apply(this,s[l]);else for(const S of s[l]){const C=S.startsWith("g_")?m:b;if(!C.has(S))return C.get(S,n),l}if(l++,l===h)return l;if(d&&++g>GL){if(Date.now()>p)return n(),l;g=0}}}endDrawing(){A(this,pa,iC).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),A(this,pa,sC).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,h=i,d="prescale1",p,g;for(;s>2&&l>1||o>2&&h>1;){let m=l,b=h;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),o>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/b),p=this.cachedCanvases.getCanvas(d,m,b),g=p.context,g.clearRect(0,0,m,b),g.drawImage(t,0,0,l,h,0,0,m,b),t=p.canvas,l=m,h=b,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,o=this.current.patternFill,l=Oe(e);let h,d,p,g;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),s]),h=this._cachedBitmapsMap.get(H),h||(h=new Map,this._cachedBitmapsMap.set(H,h));const j=h.get(d);if(j&&!o){const Q=Math.round(Math.min(l[0],l[2])+l[4]),V=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:j,offsetX:Q,offsetY:V}}p=j}p||(g=this.cachedCanvases.getCanvas("maskCanvas",n,i),XL(g.context,t));let m=Rt.transform(l,[1/n,0,0,-1/i,0,0]);m=Rt.transform(m,[1,0,0,1,0,-i]);const[b,_,S,C]=Rt.getAxialAlignedBoundingBox([0,0,n,i],m),T=Math.round(S-b)||1,k=Math.round(C-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",T,k),L=P.context,I=b,D=_;L.translate(-I,-D),L.transform(...m),p||(p=this._scaleImage(g.canvas,Ea(L)),p=p.img,h&&o&&h.set(d,p)),L.imageSmoothingEnabled=YL(Oe(L),t.interpolate),b_(L,p,0,0,p.width,p.height,0,0,n,i),L.globalCompositeOperation="source-in";const F=Rt.transform(Ea(L),[1,0,0,1,-I,-D]);return L.fillStyle=o?s.getPattern(e,this,F,ki.FILL):s,L.fillRect(0,0,n,i),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(d,P.canvas)),{canvas:P.canvas,offsetX:Math.round(I),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=tB[t]}setLineJoin(t){this.ctx.lineJoin=eB[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...Oe(this.suspendedCtx)),fy(this.suspendedCtx,s),QH(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),fy(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],o=i[1],l=i[2]-s,h=i[3]-o;l===0||h===0||(this.genericComposeSMask(e.context,n,l,h,e.subtype,e.backdrop,e.transferMap,s,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,o,l,h,d,p,g){let m=t.canvas,b=h-p,_=d-g;if(o){const C=Rt.makeHexColor(...o);if(b<0||_<0||b+n>m.width||_+i>m.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,i),k=T.context;k.drawImage(m,-b,-_),k.globalCompositeOperation="destination-atop",k.fillStyle=C,k.fillRect(0,0,n,i),k.globalCompositeOperation="source-over",m=T.canvas,b=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(b,_,n,i),t.clip(T),t.globalCompositeOperation="destination-atop",t.fillStyle=C,t.fillRect(b,_,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const S=new Path2D;S.rect(h,d,n,i),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(m,b,_,n,i,h,d,n,i),e.restore()}save(){this.inSMaskMode?(fy(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),fy(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,s,o){this.ctx.transform(t,e,n,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,s=this.current;let o=s.x,l=s.y,h,d;const p=Oe(i),g=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,m=g?n.slice(0):null;for(let b=0,_=0,S=t.length;b<S;b++)switch(t[b]|0){case $r.rectangle:o=e[_++],l=e[_++];const C=e[_++],T=e[_++],k=o+C,P=l+T;i.moveTo(o,l),C===0||T===0?i.lineTo(k,P):(i.lineTo(k,l),i.lineTo(k,P),i.lineTo(o,P)),g||s.updateRectMinMax(p,[o,l,k,P]),i.closePath();break;case $r.moveTo:o=e[_++],l=e[_++],i.moveTo(o,l),g||s.updatePathMinMax(p,o,l);break;case $r.lineTo:o=e[_++],l=e[_++],i.lineTo(o,l),g||s.updatePathMinMax(p,o,l);break;case $r.curveTo:h=o,d=l,o=e[_+4],l=e[_+5],i.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],o,l),s.updateCurvePathMinMax(p,h,d,e[_],e[_+1],e[_+2],e[_+3],o,l,m),_+=6;break;case $r.curveTo2:h=o,d=l,i.bezierCurveTo(o,l,e[_],e[_+1],e[_+2],e[_+3]),s.updateCurvePathMinMax(p,h,d,o,l,e[_],e[_+1],e[_+2],e[_+3],m),o=e[_+2],l=e[_+3],_+=4;break;case $r.curveTo3:h=o,d=l,o=e[_+2],l=e[_+3],i.bezierCurveTo(e[_],e[_+1],o,l,o,l),s.updateCurvePathMinMax(p,h,d,e[_],e[_+1],o,l,o,l,m),_+=4;break;case $r.closePath:i.closePath();break}g&&s.updateScalingPathMinMax(p,m),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(e.save(),e.strokeStyle=n.getPattern(e,this,Ea(e),ki.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let s=!1;i&&(e.save(),e.fillStyle=n.getPattern(e,this,Ea(e),ki.FILL),s=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nB}eoClip(){this.pendingClip=KL}beginText(){this.current.textMatrix=pD,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const n=new Path2D,i=e.getTransform().invertSelf();for(const{transform:s,x:o,y:l,fontSize:h,path:d}of t)n.addPath(d,new DOMMatrix(s).preMultiplySelf(i).translate(o,l).scale(h,-h));e.clip(n),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var p;const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||Dx,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Gt("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const s=n.loadedName||"sans-serif",o=((p=n.systemFontInfo)==null?void 0:p.css)||`"${s}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const h=n.italic?"italic":"normal";let d=e;e<zL?d=zL:e>UL&&(d=UL),this.current.fontSizeScale=e/d,this.ctx.font=`${h} ${l} ${d}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,s,o){this.current.textMatrix=[t,e,n,i,s,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i,s){const o=this.ctx,l=this.current,h=l.font,d=l.textRenderingMode,p=l.fontSize/l.fontSizeScale,g=d&mi.FILL_STROKE_MASK,m=!!(d&mi.ADD_TO_PATH_FLAG),b=l.patternFill&&!h.missingFile,_=l.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||m||b||_)&&(S=h.getPathGenerator(this.commonObjs,t)),h.disableFontFace||b||_){if(o.save(),o.translate(e,n),o.scale(p,-p),g===mi.FILL||g===mi.FILL_STROKE)if(i){const C=o.getTransform();o.setTransform(...i),o.fill(A(this,pa,rC).call(this,S,C,i))}else o.fill(S);if(g===mi.STROKE||g===mi.FILL_STROKE)if(s){const C=o.getTransform();o.setTransform(...s),o.stroke(A(this,pa,rC).call(this,S,C,s))}else o.lineWidth/=p,o.stroke(S);o.restore()}else(g===mi.FILL||g===mi.FILL_STROKE)&&o.fillText(t,e,n),(g===mi.STROKE||g===mi.FILL_STROKE)&&o.strokeText(t,e,n);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Oe(o),x:e,y:n,fontSize:p,path:S})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return Kt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,h=e.wordSpacing,d=e.fontDirection,p=e.textHScale*d,g=t.length,m=n.vertical,b=m?1:-1,_=n.defaultVMetrics,S=i*e.fontMatrix[0],C=e.textRenderingMode===mi.FILL&&!n.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),d>0?s.scale(p,-1):s.scale(p,1);let T,k;if(e.patternFill){s.save();const F=e.fillColor.getPattern(s,this,Ea(s),ki.FILL);T=Oe(s),s.restore(),s.fillStyle=F}if(e.patternStroke){s.save();const F=e.strokeColor.getPattern(s,this,Ea(s),ki.STROKE);k=Oe(s),s.restore(),s.strokeStyle=F}let P=e.lineWidth;const L=e.textMatrixScale;if(L===0||P===0){const F=e.textRenderingMode&mi.FILL_STROKE_MASK;(F===mi.STROKE||F===mi.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=L;if(o!==1&&(s.scale(o,o),P/=o),s.lineWidth=P,n.isInvalidPDFjsFont){const F=[];let H=0;for(const j of t)F.push(j.unicode),H+=j.width;s.fillText(F.join(""),0,0),e.x+=H*S*p,s.restore(),this.compose();return}let I=0,D;for(D=0;D<g;++D){const F=t[D];if(typeof F=="number"){I+=b*F*i/1e3;continue}let H=!1;const j=(F.isSpace?h:0)+l,Q=F.fontChar,V=F.accent;let tt,Z,et=F.width;if(m){const J=F.vmetric||_,G=-(F.vmetric?J[1]:et*.5)*S,q=J[2]*S;et=J?-J[0]:et,tt=G/o,Z=(I+q)/o}else tt=I/o,Z=0;if(n.remeasure&&et>0){const J=s.measureText(Q).width*1e3/i*o;if(et<J&&this.isFontSubpixelAAEnabled){const G=et/J;H=!0,s.save(),s.scale(G,1),tt/=G}else et!==J&&(tt+=(et-J)/2e3*i/o)}if(this.contentVisible&&(F.isInFont||n.missingFile)){if(C&&!V)s.fillText(Q,tt,Z);else if(this.paintChar(Q,tt,Z,T,k),V){const J=tt+i*V.offset.x/o,G=Z-i*V.offset.y/o;this.paintChar(V.fontChar,J,G,T,k)}}const ht=m?et*S-j*d:et*S+j*d;I+=ht,H&&s.restore()}m?e.y-=I:e.x+=I*p,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,o=n.fontDirection,l=i.vertical?1:-1,h=n.charSpacing,d=n.wordSpacing,p=n.textHScale*o,g=n.fontMatrix||Dx,m=t.length,b=n.textRenderingMode===mi.INVISIBLE;let _,S,C,T;if(!(b||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(p,o),_=0;_<m;++_){if(S=t[_],typeof S=="number"){T=l*S*s/1e3,this.ctx.translate(T,0),n.x+=T*p;continue}const k=(S.isSpace?d:0)+h,P=i.charProcOperatorList[S.operatorListId];if(!P){Gt(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(s,s),e.transform(...g),this.executeOperatorList(P),this.restore()),C=Rt.applyTransform([S.width,0],g)[0]*s+k,e.translate(C,0),n.x+=C*p}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,o){this.ctx.rect(n,i,s-n,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=t[1],i=this.baseTransform||Oe(this.ctx),s={createCanvasGraphics:o=>new Fp(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new XH(t,n,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=Rt.makeHexColor(t,e,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=Rt.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=qH(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,Ea(e),ki.SHADING);const i=Ea(e);{const{width:s,height:o}=e.canvas,[l,h,d,p]=Rt.getAxialAlignedBoundingBox([0,0,s,o],i);this.ctx.fillRect(l,h,d-l,p-h)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ee("Should not call beginInlineImage")}beginImageData(){Ee("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Oe(this.ctx),e)){const n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.current.updateRectMinMax(Oe(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||BE("TODO: Support non-isolated groups."),t.knockout&&Gt("Knockout groups not supported.");const n=Oe(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Rt.getAxialAlignedBoundingBox(t.bbox,Oe(e));const s=[0,0,e.canvas.width,e.canvas.height];i=Rt.intersect(i,s)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-o,1),d=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,h,d]);let p="groupAt"+this.groupLevel;t.smask&&(p+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(p,h,d),m=g.context;m.translate(-o,-l),m.transform(...n),t.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.save()),fy(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Oe(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=Rt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,n,i,s){if(A(this,pa,iC).call(this),A_(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=l;const[h,d]=Rt.singularValueDecompose2dScale(Oe(this.ctx)),{viewportScale:p}=this,g=Math.ceil(o*this.outputScaleX*p),m=Math.ceil(l*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:b,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-d,0,l*d),A_(this.ctx)}else A_(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new WL(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,pa,sC).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=ZH(t)),i.compiled)){i.compiled(n);return}const s=this._createMaskCanvas(t),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,s,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const h=Oe(l);l.transform(e,n,i,s,0,0);const d=this._createMaskCanvas(t);l.setTransform(1,0,0,1,d.offsetX-h[4],d.offsetY-h[5]);for(let p=0,g=o.length;p<g;p+=2){const m=Rt.transform(h,[e,n,i,s,o[p],o[p+1]]),[b,_]=Rt.applyTransform([0,0],m);l.drawImage(d.canvas,b,_)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:o,width:l,height:h,transform:d}=s,p=this.cachedCanvases.getCanvas("maskCanvas",l,h),g=p.context;g.save();const m=this.getObject(o,s);XL(g,m),g.globalCompositeOperation="source-in",g.fillStyle=i?n.getPattern(g,this,Ea(e),ki.FILL):n,g.fillRect(0,0,l,h),g.restore(),e.save(),e.transform(...d),e.scale(1,-1),b_(e,p.canvas,0,0,l,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Gt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Gt("Dependent image isn't ready yet");return}const o=s.width,l=s.height,h=[];for(let d=0,p=i.length;d<p;d+=2)h.push({transform:[e,0,0,n,i[d],i[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(s,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!Pi){const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none")}i.scale(1/e,-1/n);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;qL(h,t),s=this.applyTransferMapsToCanvas(h)}const o=this._scaleImage(s,Ea(i));i.imageSmoothingEnabled=YL(Oe(i),t.interpolate),b_(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,o=t.height,h=this.cachedCanvases.getCanvas("inlineImage",s,o).context;qL(h,t),i=this.applyTransferMapsToCanvas(h)}for(const s of e)n.save(),n.transform(...s.transform),n.scale(1,-1),b_(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===KL?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Oe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let o,l;if(n===0&&i===0){const h=Math.abs(e),d=Math.abs(s);if(h===d)if(t===0)o=l=1/h;else{const p=h*t;o=l=p<1?1/p:1}else if(t===0)o=1/h,l=1/d;else{const p=h*t,g=d*t;o=p<1?1/p:1,l=g<1?1/g:1}}else{const h=Math.abs(e*s-n*i),d=Math.hypot(e,n),p=Math.hypot(i,s);if(t===0)o=p/h,l=d/h;else{const g=t*h;o=p>g?p/g:1,l=d>g?d/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,s]=this.getScaleForStroking();if(e.lineWidth=n||1,i===1&&s===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,s),o.length>0){const l=Math.max(i,s);e.setLineDash(o.map(h=>h/l)),e.lineDashOffset/=l}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}},pa=new WeakSet,iC=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},sC=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},rC=function(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i},Fp);for(const u in $r)tw.prototype[u]!==void 0&&(tw.prototype[$r[u]]=tw.prototype[u]);var z_,Hv,Bv;let ru=(z_=class{static get workerPort(){return r(this,Hv)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");v(this,Hv,t)}static get workerSrc(){return r(this,Bv)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");v(this,Bv,t)}},Hv=new WeakMap,Bv=new WeakMap,E(z_,Hv,null),E(z_,Bv,""),z_);var Iu,zv,DI;let iB=(DI=class{constructor({parsedData:t,rawData:e}){E(this,Iu);E(this,zv);v(this,Iu,t),v(this,zv,e)}getRaw(){return r(this,zv)}get(t){return r(this,Iu).get(t)??null}getAll(){return lk(r(this,Iu))}has(t){return r(this,Iu).has(t)}},Iu=new WeakMap,zv=new WeakMap,DI);const np=Symbol("INTERNAL");var Uv,Gv,Vv,Op,FI;let sB=(FI=class{constructor(t,{name:e,intent:n,usage:i,rbGroups:s}){E(this,Uv,!1);E(this,Gv,!1);E(this,Vv,!1);E(this,Op,!0);v(this,Uv,!!(t&zs.DISPLAY)),v(this,Gv,!!(t&zs.PRINT)),this.name=e,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(r(this,Vv))return r(this,Op);if(!r(this,Op))return!1;const{print:t,view:e}=this.usage;return r(this,Uv)?(e==null?void 0:e.viewState)!=="OFF":r(this,Gv)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==np&&Ee("Internal method `_setVisible` called."),v(this,Vv,n),v(this,Op,e)}},Uv=new WeakMap,Gv=new WeakMap,Vv=new WeakMap,Op=new WeakMap,FI);var Ic,de,Np,$p,Wv,aC,OI;let rB=(OI=class{constructor(t,e=zs.DISPLAY){E(this,Wv);E(this,Ic,null);E(this,de,new Map);E(this,Np,null);E(this,$p,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,v(this,$p,t.order);for(const n of t.groups)r(this,de).set(n.id,new sB(e,n));if(t.baseState==="OFF")for(const n of r(this,de).values())n._setVisible(np,!1);for(const n of t.on)r(this,de).get(n)._setVisible(np,!0);for(const n of t.off)r(this,de).get(n)._setVisible(np,!1);v(this,Np,this.getHash())}}isVisible(t){if(r(this,de).size===0)return!0;if(!t)return BE("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,de).has(t.id)?r(this,de).get(t.id).visible:(Gt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return A(this,Wv,aC).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,de).has(e))return Gt(`Optional content group not found: ${e}`),!0;if(r(this,de).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,de).has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!r(this,de).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,de).has(e))return Gt(`Optional content group not found: ${e}`),!0;if(!r(this,de).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,de).has(e))return Gt(`Optional content group not found: ${e}`),!0;if(r(this,de).get(e).visible)return!1}return!0}return Gt(`Unknown optional content policy ${t.policy}.`),!0}return Gt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var s;const i=r(this,de).get(t);if(!i){Gt(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const l of o)l!==t&&((s=r(this,de).get(l))==null||s._setVisible(np,!1,!0));i._setVisible(np,!!e,!0),v(this,Ic,null)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=r(this,de).get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}v(this,Ic,null)}get hasInitialVisibility(){return r(this,Np)===null||this.getHash()===r(this,Np)}getOrder(){return r(this,de).size?r(this,$p)?r(this,$p).slice():[...r(this,de).keys()]:null}getGroups(){return r(this,de).size>0?lk(r(this,de)):null}getGroup(t){return r(this,de).get(t)||null}getHash(){if(r(this,Ic)!==null)return r(this,Ic);const t=new qD;for(const[e,n]of r(this,de))t.update(`${e}:${n.visible}`);return v(this,Ic,t.hexdigest())}},Ic=new WeakMap,de=new WeakMap,Np=new WeakMap,$p=new WeakMap,Wv=new WeakSet,aC=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const s=t[i];let o;if(Array.isArray(s))o=A(this,Wv,aC).call(this,s);else if(r(this,de).has(s))o=r(this,de).get(s).visible;else return Gt(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"},OI),aB=class{constructor(t,{disableRange:e=!1,disableStream:n=!1}){fn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(n),!0)});fn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,i,s;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){fn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new oB(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new lB(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}},oB=class{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=dk(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},lB=class{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function cB(u){let t=!0,e=n("filename\\*","i").exec(u);if(e){e=e[1];let p=l(e);return p=unescape(p),p=h(p),p=d(p),s(p)}if(e=o(u),e){const p=d(e);return s(p)}if(e=n("filename","i").exec(u),e){e=e[1];let p=l(e);return p=d(p),s(p)}function n(p,g){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(p,g){if(p){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(p,{fatal:!0}),b=zE(g);g=m.decode(b),t=!1}catch{}}return g}function s(p){return t&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),t&&(p=i("iso-8859-1",p))),p}function o(p){const g=[];let m;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=b.exec(p))!==null;){let[,S,C,T]=m;if(S=parseInt(S,10),S in g){if(S===0)break;continue}g[S]=[C,T]}const _=[];for(let S=0;S<g.length&&S in g;++S){let[C,T]=g[S];T=l(T),C&&(T=unescape(T),S===0&&(T=h(T))),_.push(T)}return _.join("")}function l(p){if(p.startsWith('"')){const g=p.slice(1).split('\\"');for(let m=0;m<g.length;++m){const b=g[m].indexOf('"');b!==-1&&(g[m]=g[m].slice(0,b),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}p=g.join('"')}return p}function h(p){const g=p.indexOf("'");if(g===-1)return p;const m=p.slice(0,g),_=p.slice(g+1).replace(/^[^']*'/,"");return i(m,_)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,b,_){if(b==="q"||b==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),i(m,_);try{_=atob(_)}catch{}return i(m,_)})}return""}function oF(u,t){const e=new Headers;if(!u||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function VE(u){try{return new URL(u).origin}catch{}return null}function lF({responseHeaders:u,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(u.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||n||!t||u.get("Accept-Ranges")!=="bytes"||(u.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function cF(u){const t=u.get("Content-Disposition");if(t){let e=cB(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(dk(e))return e}return null}function WE(u,t){return u===404||u===0&&t.startsWith("file:")?new cv('Missing PDF "'+t+'".'):new Qw(`Unexpected server response (${u}) while retrieving PDF "${t}".`,u)}function hF(u){return u===200||u===206}function uF(u,t,e){return{method:"GET",headers:u,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function dF(u){return u instanceof Uint8Array?u.buffer:u instanceof ArrayBuffer?u:(Gt(`getArrayBuffer - unexpected data format: ${u}`),new Uint8Array(u).buffer)}let QL=class{constructor(t){lt(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=oF(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return fn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new hB(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new uB(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},hB=class{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,uF(n,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=VE(s.url),!hF(s.status))throw WE(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:l,suggestedLength:h}=lF({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=cF(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ch("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dF(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}},uB=class{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${n-1}`);const o=i.url;fetch(o,uF(s,this._withCredentials,this._abortController)).then(l=>{const h=VE(l.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!hF(l.status))throw WE(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:dF(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}};const tx=200,ex=206;function dB(u){const t=u.response;return typeof t!="string"?t:zE(t).buffer}let fB=class{constructor({url:t,httpHeaders:e,withCredentials:n}){lt(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=oF(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,o]of this.headers)e.setRequestHeader(s,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=ex):i.expectedStatus=tx,e.responseType="arraybuffer",fn(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var i;const n=this.pendingRequests[t];n&&((i=n.onProgress)==null||i.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){n.onError(i.status);return}const s=i.status||tx;if(!(s===tx&&n.expectedStatus===ex)&&s!==n.expectedStatus){n.onError(i.status);return}const l=dB(i);if(s===ex){const h=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?n.onDone({begin:parseInt(d[1],10),chunk:l}):(Gt('Missing or invalid "Content-Range" header.'),n.onError(0))}else l?n.onDone({begin:0,chunk:l}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}},pB=class{constructor(t){this._source=t,this._manager=new fB(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return fn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new gB(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new mB(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},gB=class{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=VE(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[h,...d]=l.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=lF({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=cF(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=WE(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},mB=class{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=VE((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=WE(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}};const yB=/^[a-z][a-z0-9\-+.]+:/i;function vB(u){if(yB.test(u))return new URL(u);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(u))}let bB=class{constructor(t){this.source=t,this.url=vB(t.url),fn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return fn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new AB(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new _B(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}},AB=class{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new cv(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ch("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},_B=class{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}};const wB=1e5,ts=30,EB=.8;var NI,Dc,rs,qv,Xv,Du,Vo,Yv,Kv,Fu,jp,Hp,Fc,Bp,Qv,zp,Ou,Jv,Zv,Ye,Nu,$u,tb,Oc,Up,Hl,fF,pF,lC,qs,ew,cC,gF,mF;let oC=(Ye=class{constructor({textContentSource:t,container:e,viewport:n}){E(this,Hl);E(this,Dc,Promise.withResolvers());E(this,rs,null);E(this,qv,!1);E(this,Xv,!!((NI=globalThis.FontInspector)!=null&&NI.enabled));E(this,Du,null);E(this,Vo,null);E(this,Yv,0);E(this,Kv,0);E(this,Fu,null);E(this,jp,null);E(this,Hp,0);E(this,Fc,0);E(this,Bp,Object.create(null));E(this,Qv,[]);E(this,zp,null);E(this,Ou,[]);E(this,Jv,new WeakMap);E(this,Zv,null);var h;if(t instanceof ReadableStream)v(this,zp,t);else if(typeof t=="object")v(this,zp,new ReadableStream({start(d){d.enqueue(t),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,rs,v(this,jp,e)),v(this,Fc,n.scale*(globalThis.devicePixelRatio||1)),v(this,Hp,n.rotation),v(this,Vo,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:l}=n.rawDims;v(this,Zv,[1,0,0,-1,-o,l+s]),v(this,Kv,i),v(this,Yv,s),A(h=Ye,qs,gF).call(h),ff(e,n),r(this,Dc).promise.finally(()=>{r(Ye,Up).delete(this),v(this,Vo,null),v(this,Bp,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=zi.platform;return Kt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Fu).read().then(({value:e,done:n})=>{if(n){r(this,Dc).resolve();return}r(this,Du)??v(this,Du,e.lang),Object.assign(r(this,Bp),e.styles),A(this,Hl,fF).call(this,e.items),t()},r(this,Dc).reject)};return v(this,Fu,r(this,zp).getReader()),r(Ye,Up).add(this),t(),r(this,Dc).promise}update({viewport:t,onBefore:e=null}){var s;const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==r(this,Hp)&&(e==null||e(),v(this,Hp,i),ff(r(this,jp),{rotation:i})),n!==r(this,Fc)){e==null||e(),v(this,Fc,n);const o={div:null,properties:null,ctx:A(s=Ye,qs,ew).call(s,r(this,Du))};for(const l of r(this,Ou))o.properties=r(this,Jv).get(l),o.div=l,A(this,Hl,lC).call(this,o)}}cancel(){var e;const t=new Ch("TextLayer task cancelled.");(e=r(this,Fu))==null||e.cancel(t).catch(()=>{}),v(this,Fu,null),r(this,Dc).reject(t)}get textDivs(){return r(this,Ou)}get textContentItemsStr(){return r(this,Qv)}static cleanup(){if(!(r(this,Up).size>0)){r(this,Nu).clear();for(const{canvas:t}of r(this,$u).values())t.remove();r(this,$u).clear()}}},Dc=new WeakMap,rs=new WeakMap,qv=new WeakMap,Xv=new WeakMap,Du=new WeakMap,Vo=new WeakMap,Yv=new WeakMap,Kv=new WeakMap,Fu=new WeakMap,jp=new WeakMap,Hp=new WeakMap,Fc=new WeakMap,Bp=new WeakMap,Qv=new WeakMap,zp=new WeakMap,Ou=new WeakMap,Jv=new WeakMap,Zv=new WeakMap,Nu=new WeakMap,$u=new WeakMap,tb=new WeakMap,Oc=new WeakMap,Up=new WeakMap,Hl=new WeakSet,fF=function(t){var i,s;if(r(this,qv))return;(s=r(this,Vo)).ctx??(s.ctx=A(i=Ye,qs,ew).call(i,r(this,Du)));const e=r(this,Ou),n=r(this,Qv);for(const o of t){if(e.length>wB){Gt("Ignoring additional textDivs for performance reasons."),v(this,qv,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=r(this,rs);v(this,rs,document.createElement("span")),r(this,rs).classList.add("markedContent"),o.id!==null&&r(this,rs).setAttribute("id",`${o.id}`),l.append(r(this,rs))}else o.type==="endMarkedContent"&&v(this,rs,r(this,rs).parentNode);continue}n.push(o.str),A(this,Hl,pF).call(this,o)}},pF=function(t){var S;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Ou).push(e);const i=Rt.transform(r(this,Zv),t.transform);let s=Math.atan2(i[1],i[0]);const o=r(this,Bp)[t.fontName];o.vertical&&(s+=Math.PI/2);let l=r(this,Xv)&&o.fontSubstitution||o.fontFamily;l=Ye.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),d=h*A(S=Ye,qs,mF).call(S,l,r(this,Du));let p,g;s===0?(p=i[4],g=i[5]-d):(p=i[4]+d*Math.sin(s),g=i[5]-d*Math.cos(s));const m="calc(var(--scale-factor)*",b=e.style;r(this,rs)===r(this,jp)?(b.left=`${(100*p/r(this,Kv)).toFixed(2)}%`,b.top=`${(100*g/r(this,Yv)).toFixed(2)}%`):(b.left=`${m}${p.toFixed(2)}px)`,b.top=`${m}${g.toFixed(2)}px)`),b.fontSize=`${m}${(r(Ye,Oc)*h).toFixed(2)}px)`,b.fontFamily=l,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,Xv)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),s!==0&&(n.angle=s*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),T=Math.abs(t.transform[3]);C!==T&&Math.max(C,T)/Math.min(C,T)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?t.height:t.width),r(this,Jv).set(e,n),r(this,Vo).div=e,r(this,Vo).properties=n,A(this,Hl,lC).call(this,r(this,Vo)),n.hasText&&r(this,rs).append(e),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),r(this,rs).append(C)}},lC=function(t){var l;const{div:e,properties:n,ctx:i}=t,{style:s}=e;let o="";if(r(Ye,Oc)>1&&(o=`scale(${1/r(Ye,Oc)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=s,{canvasWidth:d,fontSize:p}=n;A(l=Ye,qs,cC).call(l,i,p*r(this,Fc),h);const{width:g}=i.measureText(e.textContent);g>0&&(o=`scaleX(${d*r(this,Fc)/g}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)},qs=new WeakSet,ew=function(t=null){let e=r(this,$u).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,$u).set(t,e),r(this,tb).set(e,{size:0,family:""})}return e},cC=function(t,e,n){const i=r(this,tb).get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)},gF=function(){if(r(this,Oc)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),v(this,Oc,t.getBoundingClientRect().height),t.remove()},mF=function(t,e){const n=r(this,Nu).get(t);if(n)return n;const i=A(this,qs,ew).call(this,e);i.canvas.width=i.canvas.height=ts,A(this,qs,cC).call(this,i,ts,t);const s=i.measureText("");let o=s.fontBoundingBoxAscent,l=Math.abs(s.fontBoundingBoxDescent);if(o){const p=o/(o+l);return r(this,Nu).set(t,p),i.canvas.width=i.canvas.height=0,p}i.strokeStyle="red",i.clearRect(0,0,ts,ts),i.strokeText("g",0,0);let h=i.getImageData(0,0,ts,ts).data;l=0;for(let p=h.length-1-3;p>=0;p-=4)if(h[p]>0){l=Math.ceil(p/4/ts);break}i.clearRect(0,0,ts,ts),i.strokeText("A",0,ts),h=i.getImageData(0,0,ts,ts).data,o=0;for(let p=0,g=h.length;p<g;p+=4)if(h[p]>0){o=ts-Math.floor(p/4/ts);break}i.canvas.width=i.canvas.height=0;const d=o?o/(o+l):EB;return r(this,Nu).set(t,d),d},E(Ye,qs),E(Ye,Nu,new Map),E(Ye,$u,new Map),E(Ye,tb,new WeakMap),E(Ye,Oc,null),E(Ye,Up,new Set),Ye),hC=class yF{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(s){var h;if(!s)return;let o=null;const l=s.name;if(l==="#text")o=s.value;else if(yF.shouldBuildText(l))(h=s==null?void 0:s.attributes)!=null&&h.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&e.push({str:o}),!!s.children)for(const d of s.children)i(d)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}};const SB=65536,xB=100,CB=5e3,TB=Pi?HH:NH,kB=Pi?BH:eF,PB=Pi?jH:$H,RB=Pi?zH:rF;function LB(u={}){typeof u=="string"||u instanceof URL?u={url:u}:(u instanceof ArrayBuffer||ArrayBuffer.isView(u))&&(u={data:u});const t=new DB,{docId:e}=t,n=u.url?MB(u.url):null,i=u.data?IB(u.data):null,s=u.httpHeaders||null,o=u.withCredentials===!0,l=u.password??null,h=u.range instanceof vF?u.range:null,d=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:SB;let p=u.worker instanceof iw?u.worker:null;const g=u.verbosity,m=typeof u.docBaseUrl=="string"&&!GE(u.docBaseUrl)?u.docBaseUrl:null,b=typeof u.cMapUrl=="string"?u.cMapUrl:null,_=u.cMapPacked!==!1,S=u.CMapReaderFactory||kB,C=typeof u.standardFontDataUrl=="string"?u.standardFontDataUrl:null,T=u.StandardFontDataFactory||RB,k=u.stopAtErrors!==!0,P=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,L=u.isEvalSupported!==!1,I=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!Pi,D=typeof u.isImageDecoderSupported=="boolean"?u.isImageDecoderSupported:!Pi&&(zi.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(u.canvasMaxAreaInBytes)?u.canvasMaxAreaInBytes:-1,H=typeof u.disableFontFace=="boolean"?u.disableFontFace:Pi,j=u.fontExtraProperties===!0,Q=u.enableXfa===!0,V=u.ownerDocument||globalThis.document,tt=u.disableRange===!0,Z=u.disableStream===!0,et=u.disableAutoFetch===!0,ht=u.pdfBug===!0,J=u.CanvasFactory||TB,G=u.FilterFactory||PB,q=u.enableHWA===!0,U=h?h.length:u.length??NaN,N=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!Pi&&!H,M=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:S===eF&&T===rF&&b&&C&&Cy(b,document.baseURI)&&Cy(C,document.baseURI),B=null;dH(g);const Y={canvasFactory:new J({ownerDocument:V,enableHWA:q}),filterFactory:new G({docId:e,ownerDocument:V}),cMapReaderFactory:M?null:new S({baseUrl:b,isCompressed:_}),standardFontDataFactory:M?null:new T({baseUrl:C})};if(!p){const at={verbosity:g,port:ru.workerPort};p=at.port?iw.fromPort(at):new iw(at),t._worker=p}const it={docId:e,apiVersion:"4.10.38",data:i,password:l,disableAutoFetch:et,rangeChunkSize:d,length:U,docBaseUrl:m,enableXfa:Q,evaluatorOptions:{maxImageSize:P,disableFontFace:H,ignoreErrors:k,isEvalSupported:L,isOffscreenCanvasSupported:I,isImageDecoderSupported:D,canvasMaxAreaInBytes:F,fontExtraProperties:j,useSystemFonts:N,cMapUrl:M?b:null,standardFontDataUrl:M?C:null}},dt={disableFontFace:H,fontExtraProperties:j,ownerDocument:V,pdfBug:ht,styleElement:B,loadingParams:{disableAutoFetch:et,enableXfa:Q}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const at=p.messageHandler.sendWithPromise("GetDocRequest",it,i?[i.buffer]:null);let nt;if(h)nt=new aB(h,{disableRange:tt,disableStream:Z});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let vt;if(Pi)if(Cy(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");vt=QL}else vt=bB;else vt=Cy(n)?QL:pB;nt=new vt({url:n,length:U,httpHeaders:s,withCredentials:o,rangeChunkSize:d,disableRange:tt,disableStream:Z})}return at.then(vt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ut=new Ry(e,vt,p.port),xt=new $B(ut,t,nt,dt,Y);t._transport=xt,ut.send("Ready",null)})}).catch(t._capability.reject),t}function MB(u){if(u instanceof URL)return u.href;try{return new URL(u,window.location).href}catch{if(Pi&&typeof u=="string")return u}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function IB(u){if(Pi&&typeof Buffer<"u"&&u instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return zE(u);if(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="object"&&!isNaN(u==null?void 0:u.length))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function JL(u){return typeof u=="object"&&Number.isInteger(u==null?void 0:u.num)&&u.num>=0&&Number.isInteger(u==null?void 0:u.gen)&&u.gen>=0}var ju,dE;let DB=(ju=class{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${he(ju,dE)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,n,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}},dE=new WeakMap,E(ju,dE,0),ju),vF=class{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Ee("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},FB=class{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}};var Nc,Wo,vr,ip,nw,$I;let OB=($I=class{constructor(t,e,n,i=!1){E(this,vr);E(this,Nc,null);E(this,Wo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new NL:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new bF,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new hk({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=bc.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:d=null,printAnnotationStorage:p=null,isEditing:g=!1}){var L,I;(L=this._stats)==null||L.time("Overall");const m=this._transport.getRenderingIntent(n,i,p,g),{renderingIntent:b,cacheKey:_}=m;v(this,Wo,!1),A(this,vr,nw).call(this),l||(l=this._transport.getOptionalContentConfig(b));let S=this._intentStates.get(_);S||(S=Object.create(null),this._intentStates.set(_,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const C=!!(b&zs.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(m));const T=D=>{var F;S.renderTasks.delete(k),(this._maybeCleanupAfterRender||C)&&v(this,Wo,!0),A(this,vr,ip).call(this,!C),D?(k.capability.reject(D),this._abortOperatorList({intentState:S,reason:D instanceof Error?D:new Error(D)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new HB({callback:T,params:{canvasContext:t,viewport:e,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:d});(S.renderTasks||(S.renderTasks=new Set)).add(k);const P=k.task;return Promise.all([S.displayReadyCapability.promise,l]).then(([D,F])=>{var H;if(this.destroyed){T();return}if((H=this._stats)==null||H.time("Rendering"),!(F.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:D,optionalContentConfig:F}),k.operatorListChanged()}).catch(T),P}getOperatorList({intent:t="display",annotationMode:e=bc.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var d;function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,n,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>hC.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function s(){o.read().then(function({value:h,done:d}){if(d){n(l);return}l.lang??(l.lang=h.lang),Object.assign(l.styles,h.styles),l.items.push(...h.items),s()},i)}const o=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),v(this,Wo,!1),A(this,vr,nw).call(this),Promise.all(t)}cleanup(t=!1){v(this,Wo,!0);const e=A(this,vr,ip).call(this,!1);return t&&e&&this._stats&&(this._stats=new NL),e}_startRenderPage(t,e){var i,s;const n=this._intentStates.get(e);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&A(this,vr,ip).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:o}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},o).getReader(),d=this._intentStates.get(e);d.streamReader=h;const p=()=>{h.read().then(({value:g,done:m})=>{if(m){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,d),p())},g=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const m of d.renderTasks)m.operatorListChanged();A(this,vr,ip).call(this,!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(g);else if(d.opListReadCapability)d.opListReadCapability.reject(g);else throw g}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof uk){let i=xB;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Ch(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}},Nc=new WeakMap,Wo=new WeakMap,vr=new WeakSet,ip=function(t=!1){if(A(this,vr,nw).call(this),!r(this,Wo)||this.destroyed)return!1;if(t)return v(this,Nc,setTimeout(()=>{v(this,Nc,null),A(this,vr,ip).call(this,!1)},CB)),!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,Wo,!1),!0},nw=function(){r(this,Nc)&&(clearTimeout(r(this,Nc)),v(this,Nc,null))},$I);var qo,fE,jI;let NB=(jI=class{constructor(){E(this,qo,new Map);E(this,fE,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};r(this,fE).then(()=>{for(const[i]of r(this,qo))i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Gt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}r(this,qo).set(e,i)}removeEventListener(t,e){const n=r(this,qo).get(e);n==null||n(),r(this,qo).delete(e)}terminate(){for(const[,t]of r(this,qo))t==null||t();r(this,qo).clear()}},qo=new WeakMap,fE=new WeakMap,jI);var we,pE,Hu,Bu,Gp,sw,Vp,rw;let iw=(we=class{constructor({name:t=null,port:e=null,verbosity:n=fH()}={}){E(this,Gp);var i;if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=r(we,Bu))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(we,Bu)||v(we,Bu,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Ry("main","worker",t),this._messageHandler.on("ready",function(){}),A(this,Gp,sw).call(this)}_initialize(){if(r(we,Hu)||r(we,Vp,rw)){this._setupFakeWorker();return}let{workerSrc:t}=we;try{we._isSameOrigin(window.location.href,t)||(t=we._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Ry("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),n.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}this._messageHandler=n,this._port=e,this._webWorker=e,A(this,Gp,sw).call(this)}),n.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};o();return}catch{BE("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(we,Hu)||(Gt("Setting up fake worker."),v(we,Hu,!0)),we._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new NB;this._port=e;const n=`fake${he(we,pE)._++}`,i=new Ry(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new Ry(n,n+"_worker",e),A(this,Gp,sw).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,n;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=r(we,Bu))==null||e.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(t){var n;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(n=r(this,Bu))==null?void 0:n.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new we(t)}static get workerSrc(){if(ru.workerSrc)return ru.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Kt(this,"_setupFakeWorkerGlobal",(async()=>r(this,Vp,rw)?r(this,Vp,rw):(await import(this.workerSrc)).WorkerMessageHandler)())}},pE=new WeakMap,Hu=new WeakMap,Bu=new WeakMap,Gp=new WeakSet,sw=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Vp=new WeakSet,rw=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},E(we,Vp),E(we,pE,0),E(we,Hu,!1),E(we,Bu),Pi&&(v(we,Hu,!0),ru.workerSrc||(ru.workerSrc="./pdf.worker.mjs")),we._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},we._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},we);var Xo,Na,Wp,qp,Yo,zu,Fy,HI;let $B=(HI=class{constructor(t,e,n,i,s){E(this,zu);E(this,Xo,new Map);E(this,Na,new Map);E(this,Wp,new Map);E(this,qp,new Map);E(this,Yo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new bF,this.fontLoader=new FH({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Kt(this,"annotationStorage",new pk)}getRenderingIntent(t,e=bc.ENABLE,n=null,i=!1,s=!1){let o=zs.DISPLAY,l=Zx;switch(t){case"any":o=zs.ANY;break;case"display":break;case"print":o=zs.PRINT;break;default:Gt(`getRenderingIntent - invalid intent: ${t}`)}const h=o&zs.PRINT&&n instanceof YD?n:this.annotationStorage;switch(e){case bc.DISABLE:o+=zs.ANNOTATIONS_DISABLE;break;case bc.ENABLE:break;case bc.ENABLE_FORMS:o+=zs.ANNOTATIONS_FORMS;break;case bc.ENABLE_STORAGE:o+=zs.ANNOTATIONS_STORAGE,l=h.serializable;break;default:Gt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=zs.IS_EDITING),s&&(o+=zs.OPLIST);const{ids:d,hash:p}=h.modifiedIds,g=[o,l.hash,p];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:l,modifiedIds:d}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=r(this,Yo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of r(this,Na).values())t.push(i._destroy());r(this,Na).clear(),r(this,Wp).clear(),r(this,qp).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),r(this,Xo).clear(),this.filterFactory.destroy(),oC.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Ch("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{fn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}fn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async n=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((l=e.onProgress)==null||l.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var d;(d=e.onProgress)==null||d.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),t.on("GetRangeReader",(n,i)=>{fn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:l}){if(l){i.close();return}fn(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new FB(n,this))}),t.on("DocException",n=>{e._capability.reject(ns(n))}),t.on("PasswordRequest",n=>{v(this,Yo,Promise.withResolvers());try{if(!e.onPassword)throw ns(n);const i=s=>{s instanceof Error?r(this,Yo).reject(s):r(this,Yo).resolve({password:s})};e.onPassword(i,n.code)}catch(i){r(this,Yo).reject(i)}return r(this,Yo).promise}),t.on("DataLoaded",n=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;r(this,Na).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:l,fontExtraProperties:h,pdfBug:d}=this._params;if("error"in s){const b=s.error;Gt(`Error during font loading: ${b}`),this.commonObjs.resolve(n,b);break}const p=d&&((o=globalThis.FontInspector)!=null&&o.enabled)?(b,_)=>globalThis.FontInspector.fontAdded(b,_):null,g=new OH(s,{disableFontFace:l,fontExtraProperties:h,inspectFont:p});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h&&g.data&&(g.data=null),this.commonObjs.resolve(n,g)});break;case"CopyLocalImage":const{imageRef:m}=s;fn(m,"The imageRef must be defined.");for(const b of r(this,Na).values())for(const[,_]of b.objs)if((_==null?void 0:_.ref)===m)return _.dataLen?(this.commonObjs.resolve(n,structuredClone(_)),_.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,s,o])=>{var h;if(this.destroyed)return;const l=r(this,Na).get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){(h=o==null?void 0:o.bitmap)==null||h.close();return}switch(s){case"Image":l.objs.resolve(n,o),(o==null?void 0:o.dataLen)>lH&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",n=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),t.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Gt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=r(this,Wp).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&r(this,qp).set(s.refStr,t);const o=new OB(e,s,this,this._params.pdfBug);return r(this,Na).set(e,o),o});return r(this,Wp).set(e,i),i}getPageIndex(t){return JL(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return A(this,zu,Fy).call(this,"GetFieldObjects")}hasJSActions(){return A(this,zu,Fy).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,zu,Fy).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return A(this,zu,Fy).call(this,"GetOptionalContentConfig").then(e=>new rB(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,Xo).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new iB(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return r(this,Xo).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,Na).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,Xo).clear(),this.filterFactory.destroy(!0),oC.cleanup()}}cachedPageNumber(t){if(!JL(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,qp).get(e)??null}},Xo=new WeakMap,Na=new WeakMap,Wp=new WeakMap,qp=new WeakMap,Yo=new WeakMap,zu=new WeakSet,Fy=function(t,e=null){const n=r(this,Xo).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return r(this,Xo).set(t,i),i},HI);const py=Symbol("INITIAL_DATA");var xs,eb,uC,BI;let bF=(BI=class{constructor(){E(this,eb);E(this,xs,Object.create(null))}get(t,e=null){if(e){const i=A(this,eb,uC).call(this,t);return i.promise.then(()=>e(i.data)),null}const n=r(this,xs)[t];if(!n||n.data===py)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=r(this,xs)[t];return!!e&&e.data!==py}delete(t){const e=r(this,xs)[t];return!e||e.data===py?!1:(delete r(this,xs)[t],!0)}resolve(t,e=null){const n=A(this,eb,uC).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in r(this,xs)){const{data:n}=r(this,xs)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}v(this,xs,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,xs)){const{data:e}=r(this,xs)[t];e!==py&&(yield[t,e])}}},xs=new WeakMap,eb=new WeakSet,uC=function(t){var e;return(e=r(this,xs))[t]||(e[t]={...Promise.withResolvers(),data:py})},BI);var $c,zI;let jB=(zI=class{constructor(t){E(this,$c,null);v(this,$c,t),this.onContinue=null}get promise(){return r(this,$c).capability.promise}cancel(t=0){r(this,$c).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,$c).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,$c);return t.form||t.canvas&&(e==null?void 0:e.size)>0}},$c=new WeakMap,zI);var jc,ho,Uu;let HB=(ho=class{constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:l,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:g=!1,pageColors:m=null}){E(this,jc,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new jB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var l,h;if(this.cancelled)return;if(this._canvas){if(r(ho,Uu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(ho,Uu).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:s,background:o}=this.params;this.gfx=new tw(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(t=null,e=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),r(this,jc)&&(window.cancelAnimationFrame(r(this,jc)),v(this,jc,null)),r(ho,Uu).delete(this._canvas),this.callback(t||new uk(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,jc,window.requestAnimationFrame(()=>{v(this,jc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(ho,Uu).delete(this._canvas),this.callback())))}},jc=new WeakMap,Uu=new WeakMap,E(ho,Uu,new WeakSet),ho);const BB="4.10.38",zB="f9bea397f";function ZL(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function gy(u){return Math.max(0,Math.min(255,255*u))}let tM=class{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=gy(t),[t,t,t]}static G_HTML([t]){const e=ZL(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(gy)}static RGB_HTML(t){return`#${t.map(ZL).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[gy(1-Math.min(1,t+i)),gy(1-Math.min(1,n+i)),gy(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,s=1-e,o=1-n,l=Math.min(i,s,o);return["CMYK",i,s,o,l]}},UB=class{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ee("Abstract method `_createSVG` called.")}},mk=class extends UB{_createSVG(t){return document.createElementNS(Ro,t)}},AF=class{static setupStorage(t,e,n,i,s){const o=i.getValue(e,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?t.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const l of n.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const h=l.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:s}){const{attributes:o}=e,l=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[h,d]of Object.entries(o))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!l||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}l&&s.addLinkAttributes(t,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(t,o.dataId,e,n)}static render(t){var g,m;const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:n});const l=s!=="richText",h=t.div;if(h.append(o),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=b}l&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const b=document.createTextNode(i.value);o.append(b),l&&hC.shouldBuildText(i.name)&&d.push(b)}return{textDivs:d}}const p=[[i,-1,o]];for(;p.length>0;){const[b,_,S]=p.at(-1);if(_+1===b.children.length){p.pop();continue}const C=b.children[++p.at(-1)[1]];if(C===null)continue;const{name:T}=C;if(T==="#text"){const P=document.createTextNode(C.value);d.push(P),S.append(P);continue}const k=(g=C==null?void 0:C.attributes)!=null&&g.xmlns?document.createElementNS(C.attributes.xmlns,T):document.createElement(T);if(S.append(k),C.attributes&&this.setAttributes({html:k,element:C,storage:e,intent:s,linkService:n}),((m=C.children)==null?void 0:m.length)>0)p.push([C,-1,k]);else if(C.value){const P=document.createTextNode(C.value);l&&hC.shouldBuildText(T)&&d.push(P),k.append(P)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}};const Z0=1e3,GB=9,pf=new WeakSet;function xh(u){return{width:u[2]-u[0],height:u[3]-u[1]}}let VB=class{static create(t){switch(t.data.annotationType){case vn.LINK:return new _F(t);case vn.TEXT:return new WB(t);case vn.WIDGET:switch(t.data.fieldType){case"Tx":return new qB(t);case"Btn":return t.data.radioButton?new SF(t):t.data.checkBox?new YB(t):new KB(t);case"Ch":return new QB(t);case"Sig":return new XB(t)}return new _f(t);case vn.POPUP:return new fC(t);case vn.FREETEXT:return new PF(t);case vn.LINE:return new ZB(t);case vn.SQUARE:return new t3(t);case vn.CIRCLE:return new e3(t);case vn.POLYLINE:return new RF(t);case vn.CARET:return new i3(t);case vn.INK:return new yk(t);case vn.POLYGON:return new n3(t);case vn.HIGHLIGHT:return new LF(t);case vn.UNDERLINE:return new s3(t);case vn.SQUIGGLY:return new r3(t);case vn.STRIKEOUT:return new a3(t);case vn.STAMP:return new MF(t);case vn.FILEATTACHMENT:return new o3(t);default:return new Pn(t)}}};var Gu,Xp,Yp,nb,dC,Kp;let Pn=(Kp=class{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){E(this,nb);E(this,Gu,null);E(this,Xp,!1);E(this,Yp,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t!=null&&t.str||e!=null&&e.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Kp._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;r(this,Gu)||v(this,Gu,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&A(this,nb,dC).call(this,e),(n=r(this,Yp))==null||n.popup.updateEdited(t)}resetEdited(){var t;r(this,Gu)&&(A(this,nb,dC).call(this,r(this,Gu).rect),(t=r(this,Yp))==null||t.popup.resetEdited(),v(this,Gu,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof _f||(s.tabIndex=Z0);const{style:o}=s;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof fC){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:l,height:h}=xh(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;o.borderRadius=k}else if(this instanceof SF){const k=`calc(${l}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;o.borderRadius=k}switch(e.borderStyle.style){case dy.SOLID:o.borderStyle="solid";break;case dy.DASHED:o.borderStyle="dashed";break;case dy.BEVELED:Gt("Unimplemented border style: beveled");break;case dy.INSET:Gt("Unimplemented border style: inset");break;case dy.UNDERLINE:o.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(v(this,Xp,!0),o.borderColor=Rt.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const d=Rt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:g,pageX:m,pageY:b}=i.rawDims;o.left=`${100*(d[0]-m)/p}%`,o.top=`${100*(d[1]-b)/g}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(o.width=`${100*l/p}%`,o.height=`${100*h/g}%`):this.setRotation(_,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:o}=xh(this.data.rect);let l,h;t%180===0?(l=100*s/n,h=100*o/i):(l=100*o/n,h=100*s/i),e.style.width=`${l}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const s=i.detail[e],o=s[0],l=s.slice(1);i.target.style[n]=tM[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:tM[`${o}_rgb`](l)})};return Kt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const o=n[i];if(o){const l={detail:{[i]:s},target:t};o(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,T,k]=t.subarray(2,6);if(i===S&&s===C&&e===T&&n===k)return}const{style:o}=this.container;let l;if(r(this,Xp)){const{borderColor:S,borderWidth:C}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=i-e,d=s-n,{svgFactory:p}=this,g=p.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const m=p.createElement("defs");g.append(m);const b=p.createElement("clipPath"),_=`clippath_${this.data.id}`;b.setAttribute("id",_),b.setAttribute("clipPathUnits","objectBoundingBox"),m.append(b);for(let S=2,C=t.length;S<C;S+=8){const T=t[S],k=t[S+1],P=t[S+2],L=t[S+3],I=p.createElement("rect"),D=(P-e)/h,F=(s-k)/d,H=(T-P)/h,j=(k-L)/d;I.setAttribute("x",D),I.setAttribute("y",F),I.setAttribute("width",H),I.setAttribute("height",j),b.append(I),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${F}" width="${H}" height="${j}"/>`)}r(this,Xp)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(g),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,e=v(this,Yp,new fC({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Ee("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:o,exportValues:l}of i){if(s===-1||o===e)continue;const h=typeof l=="string"?l:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!pf.has(d)){Gt(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==e&&pf.has(i)&&n.push({id:o,exportValue:s,domElement:i})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}},Gu=new WeakMap,Xp=new WeakMap,Yp=new WeakMap,nb=new WeakSet,dC=function(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}}}=this;n==null||n.splice(0,4,...t);const{width:d,height:p}=xh(t);e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(o-t[3]+h)/o}%`,i===0?(e.width=`${100*d/s}%`,e.height=`${100*p/o}%`):this.setRotation(i)},Kp);var Gs,Jh,wF,EF,UI;let _F=(UI=class extends Pn{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});E(this,Gs);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(n.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(A(this,Gs,wF).call(this,i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(A(this,Gs,EF).call(this,i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&A(this,Gs,Jh).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),A(this,Gs,Jh).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=i.get(s);o&&(e[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),A(this,Gs,Jh).call(this)}_bindResetFormAction(e,n){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),A(this,Gs,Jh).call(this),!this._fieldObjects){Gt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var g;i==null||i();const{fields:s,refs:o,include:l}=n,h=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const b of s){const _=this._fieldObjects[b]||[];for(const{id:S}of _)m.add(S)}for(const b of Object.values(this._fieldObjects))for(const _ of b)m.has(_.id)===l&&h.push(_)}else for(const m of Object.values(this._fieldObjects))h.push(...m);const d=this.annotationStorage,p=[];for(const m of h){const{id:b}=m;switch(p.push(b),m.type){case"text":{const S=m.defaultValue||"";d.setValue(b,{value:S});break}case"checkbox":case"radiobutton":{const S=m.defaultValue===m.exportValues;d.setValue(b,{value:S});break}case"combobox":case"listbox":{const S=m.defaultValue||"";d.setValue(b,{value:S});break}default:continue}const _=document.querySelector(`[data-element-id="${b}"]`);if(_){if(!pf.has(_)){Gt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;_.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}},Gs=new WeakSet,Jh=function(){this.container.setAttribute("data-internal-link","")},wF=function(e,n,i=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},A(this,Gs,Jh).call(this)},EF=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),A(this,Gs,Jh).call(this)},UI),WB=class extends Pn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}},_f=class extends Pn{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return zi.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(n,o=>{var l;if(n==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}s&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(t,e,n,i){var s,o,l;for(const[h,d]of n)(d==="Action"||(s=this.data.actions)!=null&&s[d])&&((d==="Focus"||d==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,d,i),d==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):d==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Rt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||GB,s=t.style;let o;const l=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l),p=Math.round(d/(Y1*i))||1,g=d/p;o=Math.min(i,h(g/Y1))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,h(d/Y1))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=Rt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}},qB=class extends _f{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=n),s.setValue(o.id,{[i]:n})}render(){var i,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let l=o.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&l.length>h&&(l=l.slice(0,h));let d=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const p={userValue:l,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=d??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",d??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),pf.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Z0,this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",m=>{t.setValue(e,{value:m.target.value}),this.setPropertyOnSiblings(n,"value",m.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue??"";n.value=p.userValue=b,p.formattedValue=null});let g=m=>{const{formattedValue:b}=p;b!=null&&(m.target.value=b),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{var S;if(p.focused)return;const{target:_}=b;p.userValue&&(_.value=p.userValue),p.lastCommittedValue=_.value,p.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const _={value(S){p.userValue=S.detail.value??"",t.setValue(e,{value:p.userValue.toString()}),S.target.value=p.userValue},formattedValue(S){const{formattedValue:C}=S.detail;p.formattedValue=C,C!=null&&S.target!==document.activeElement&&(S.target.value=C),t.setValue(e,{formattedValue:C})},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:C}=S.detail,{target:T}=S;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let k=p.userValue;!k||k.length<=C||(k=k.slice(0,C),T.value=p.userValue=k,t.setValue(e,{value:k}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(_,b)}),n.addEventListener("keydown",b=>{var C;p.commitKey=1;let _=-1;if(b.key==="Escape"?_=0:b.key==="Enter"&&!this.data.multiLine?_=2:b.key==="Tab"&&(p.commitKey=3),_===-1)return;const{value:S}=b.target;p.lastCommittedValue!==S&&(p.lastCommittedValue=S,p.userValue=S,(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:_,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const m=g;g=null,n.addEventListener("blur",b=>{var S,C;if(!p.focused||!b.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(p.focused=!1);const{value:_}=b.target;p.userValue=_,p.lastCommittedValue!==_&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:p.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),m(b)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",b=>{var I;p.lastCommittedValue=null;const{data:_,target:S}=b,{value:C,selectionStart:T,selectionEnd:k}=S;let P=T,L=k;switch(b.inputType){case"deleteWordBackward":{const D=C.substring(0,T).match(/\w*[^\w]*$/);D&&(P-=D[0].length);break}case"deleteWordForward":{const D=C.substring(T).match(/^[^\w]*\w*/);D&&(L+=D[0].length);break}case"deleteContentBackward":T===k&&(P-=1);break;case"deleteContentForward":T===k&&(L+=1);break}b.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:_||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(g&&n.addEventListener("blur",g),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},XB=class extends _f{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}},YB=class extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return pf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=Z0,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const d of this._getElementsByName(l,n)){const p=h&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue||"Off";o.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const l={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},SF=class extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,n))t.setValue(o.id,{value:!1});const s=document.createElement("input");if(pf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=Z0,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const d of this._getElementsByName(l,n))t.setValue(d.id,{value:!1});t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue;o.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const h={value:d=>{const p=o===d.detail.value;for(const g of this._getElementsByName(d.target.name)){const m=p&&g.id===n;g.domElement&&(g.domElement.checked=m),t.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},KB=class extends _F{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}},QB=class extends _f{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");pf.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Z0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===g});for(const p of this.data.options){const g=document.createElement("option");g.textContent=p.displayValue,g.value=p.exportValue,n.value.includes(p.exportValue)&&(g.setAttribute("selected",!0),s=!1),i.append(g)}let o=null;if(s){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),o=()=>{p.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=p=>{const g=p?"value":"textContent",{options:m,multiple:b}=i;return b?Array.prototype.filter.call(m,_=>_.selected).map(_=>_[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let h=l(!1);const d=p=>{const g=p.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const g={value(m){o==null||o();const b=m.detail.value,_=new Set(Array.isArray(b)?b:[b]);for(const S of i.options)S.selected=_.has(S.value);t.setValue(e,{value:l(!0)}),h=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const b=i.options,_=m.detail.remove;b[_].selected=!1,i.remove(_),b.length>0&&Array.prototype.findIndex.call(b,C=>C.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=l(!1)},insert(m){const{index:b,displayValue:_,exportValue:S}=m.detail.insert,C=i.children[b],T=document.createElement("option");T.textContent=_,T.value=S,C?C.before(T):i.append(T),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},items(m){const{items:b}=m.detail;for(;i.length!==0;)i.remove(0);for(const _ of b){const{displayValue:S,exportValue:C}=_,T=document.createElement("option");T.textContent=S,T.value=C,i.append(T)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},indices(m){const b=new Set(m.detail.indices);for(const _ of m.target.options)_.selected=b.has(_.index);t.setValue(e,{value:l(!0)}),h=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,p)}),i.addEventListener("input",p=>{var b;const g=l(!0),m=l(!1);t.setValue(e,{value:g}),p.preventDefault(),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},fC=class extends Pn{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Pn._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new JB({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(n=>`${ck}${n}`).join(",")),this.container}};var Qp,gE,mE,Jp,Vu,qe,Ko,Zp,ib,sb,tg,Qo,Gr,Jo,rb,Zo,ab,Wu,qu,Ae,aw,pC,xF,CF,TF,kF,ow,lw,gC,GI;let JB=(GI=class{constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:h,rect:d,parentRect:p,open:g}){E(this,Ae);E(this,Qp,A(this,Ae,TF).bind(this));E(this,gE,A(this,Ae,gC).bind(this));E(this,mE,A(this,Ae,lw).bind(this));E(this,Jp,A(this,Ae,ow).bind(this));E(this,Vu,null);E(this,qe,null);E(this,Ko,null);E(this,Zp,null);E(this,ib,null);E(this,sb,null);E(this,tg,null);E(this,Qo,!1);E(this,Gr,null);E(this,Jo,null);E(this,rb,null);E(this,Zo,null);E(this,ab,null);E(this,Wu,null);E(this,qu,!1);var m;v(this,qe,t),v(this,ab,i),v(this,Ko,o),v(this,Zo,l),v(this,sb,h),v(this,Vu,e),v(this,rb,d),v(this,tg,p),v(this,ib,n),v(this,Zp,yD.toDateObject(s)),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup());for(const b of this.trigger)b.addEventListener("click",r(this,Jp)),b.addEventListener("mouseenter",r(this,mE)),b.addEventListener("mouseleave",r(this,gE)),b.classList.add("popupTriggerArea");for(const b of n)(m=b.container)==null||m.addEventListener("keydown",r(this,Qp));r(this,qe).hidden=!0,g&&A(this,Ae,ow).call(this)}render(){if(r(this,Gr))return;const t=v(this,Gr,document.createElement("div"));if(t.className="popup",r(this,Vu)){const s=t.style.outlineColor=Rt.makeHexColor(...r(this,Vu));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=Rt.makeHexColor(...r(this,Vu).map(l=>Math.floor(.7*(255-l)+l)))}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=r(this,ab),t.append(e),r(this,Zp)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,Zp).valueOf()})),e.append(s)}const i=r(this,Ae,aw);if(i)AF.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(r(this,Ko));t.append(s)}r(this,qe).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){const l=i[s];n.append(document.createTextNode(l)),s<o-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;r(this,Wu)||v(this,Wu,{contentsObj:r(this,Ko),richText:r(this,Zo)}),t&&v(this,Jo,null),e&&(v(this,Zo,A(this,Ae,CF).call(this,e)),v(this,Ko,null)),(n=r(this,Gr))==null||n.remove(),v(this,Gr,null)}resetEdited(){var t;r(this,Wu)&&({contentsObj:he(this,Ko)._,richText:he(this,Zo)._}=r(this,Wu),v(this,Wu,null),(t=r(this,Gr))==null||t.remove(),v(this,Gr,null),v(this,Jo,null))}forceHide(){v(this,qu,this.isVisible),r(this,qu)&&(r(this,qe).hidden=!0)}maybeShow(){r(this,qu)&&(r(this,Gr)||A(this,Ae,lw).call(this),v(this,qu,!1),r(this,qe).hidden=!1)}get isVisible(){return r(this,qe).hidden===!1}},Qp=new WeakMap,gE=new WeakMap,mE=new WeakMap,Jp=new WeakMap,Vu=new WeakMap,qe=new WeakMap,Ko=new WeakMap,Zp=new WeakMap,ib=new WeakMap,sb=new WeakMap,tg=new WeakMap,Qo=new WeakMap,Gr=new WeakMap,Jo=new WeakMap,rb=new WeakMap,Zo=new WeakMap,ab=new WeakMap,Wu=new WeakMap,qu=new WeakMap,Ae=new WeakSet,aw=function(){const t=r(this,Zo),e=r(this,Ko);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,Zo).html||null},pC=function(){var t,e,n;return((n=(e=(t=r(this,Ae,aw))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},xF=function(){var t,e,n;return((n=(e=(t=r(this,Ae,aw))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},CF=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:r(this,Ae,xF),fontSize:r(this,Ae,pC)?`calc(${r(this,Ae,pC)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return n},TF=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,Qo))&&A(this,Ae,ow).call(this)},kF=function(){if(r(this,Jo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=r(this,sb);let o=!!r(this,tg),l=o?r(this,tg):r(this,rb);for(const _ of r(this,ib))if(!l||Rt.intersect(_.data.rect,l)!==null){l=_.data.rect,o=!0;break}const h=Rt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),p=o?l[2]-l[0]+5:0,g=h[0]+p,m=h[1];v(this,Jo,[100*(g-i)/e,100*(m-s)/n]);const{style:b}=r(this,qe);b.left=`${r(this,Jo)[0]}%`,b.top=`${r(this,Jo)[1]}%`},ow=function(){v(this,Qo,!r(this,Qo)),r(this,Qo)?(A(this,Ae,lw).call(this),r(this,qe).addEventListener("click",r(this,Jp)),r(this,qe).addEventListener("keydown",r(this,Qp))):(A(this,Ae,gC).call(this),r(this,qe).removeEventListener("click",r(this,Jp)),r(this,qe).removeEventListener("keydown",r(this,Qp)))},lw=function(){r(this,Gr)||this.render(),this.isVisible?r(this,Qo)&&r(this,qe).classList.add("focused"):(A(this,Ae,kF).call(this),r(this,qe).hidden=!1,r(this,qe).style.zIndex=parseInt(r(this,qe).style.zIndex)+1e3)},gC=function(){r(this,qe).classList.remove("focused"),!(r(this,Qo)||!this.isVisible)&&(r(this,qe).hidden=!0,r(this,qe).style.zIndex=parseInt(r(this,qe).style.zIndex)-1e3)},GI),PF=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=zt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}};var ob,VI;let ZB=(VI=class extends Pn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,ob,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:i}=xh(e.rect),s=this.svgFactory.create(n,i,!0),o=v(this,ob,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ob)}addHighlightArea(){this.container.classList.add("highlightArea")}},ob=new WeakMap,VI);var lb,WI;let t3=(WI=class extends Pn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,lb,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:i}=xh(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,lb,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",n-o),l.setAttribute("height",i-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,lb)}addHighlightArea(){this.container.classList.add("highlightArea")}},lb=new WeakMap,WI);var cb,qI;let e3=(qI=class extends Pn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,cb,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:i}=xh(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,cb,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",n/2),l.setAttribute("cy",i/2),l.setAttribute("rx",n/2-o/2),l.setAttribute("ry",i/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,cb)}addHighlightArea(){this.container.classList.add("highlightArea")}},cb=new WeakMap,qI);var hb,XI;let RF=(XI=class extends Pn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,hb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:i,popupRef:s}}=this;if(!n)return this.container;const{width:o,height:l}=xh(e),h=this.svgFactory.create(o,l,!0);let d=[];for(let g=0,m=n.length;g<m;g+=2){const b=n[g]-e[0],_=e[3]-n[g+1];d.push(`${b},${_}`)}d=d.join(" ");const p=v(this,hb,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",d),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),h.append(p),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,hb)}addHighlightArea(){this.container.classList.add("highlightArea")}},hb=new WeakMap,XI),n3=class extends RF{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},i3=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}};var ub,Xu,db,mC,YI;let yk=(YI=class extends Pn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,db);E(this,ub,null);E(this,Xu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?zt.HIGHLIGHT:zt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:i,borderStyle:s,popupRef:o}}=this,{transform:l,width:h,height:d}=A(this,db,mC).call(this,n,e),p=this.svgFactory.create(h,d,!0),g=v(this,ub,this.svgFactory.createElement("svg:g"));p.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let m=0,b=i.length;m<b;m++){const _=this.svgFactory.createElement(this.svgElementName);r(this,Xu).push(_),_.setAttribute("points",i[m].join(",")),g.append(_)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:i,rect:s}=e,o=r(this,ub);if(n>=0&&o.setAttribute("stroke-width",n||1),i)for(let l=0,h=r(this,Xu).length;l<h;l++)r(this,Xu)[l].setAttribute("points",i[l].join(","));if(s){const{transform:l,width:h,height:d}=A(this,db,mC).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${h} ${d}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return r(this,Xu)}addHighlightArea(){this.container.classList.add("highlightArea")}},ub=new WeakMap,Xu=new WeakMap,db=new WeakSet,mC=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}},YI),LF=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=zt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},s3=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},r3=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},a3=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},MF=class extends Pn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=zt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}};var fb,pb,yC,KI;let o3=(KI=class extends Pn{constructor(e){var i;super(e,{isRenderable:!0});E(this,pb);E(this,fb,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,pb,yC).bind(this)),v(this,fb,i);const{isMac:s}=zi.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&A(this,pb,yC).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return r(this,fb)}addHighlightArea(){this.container.classList.add("highlightArea")}},fb=new WeakMap,pb=new WeakSet,yC=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)},KI);var gb,Yu,Ku,mb,vf,IF,vC,QI;let l3=(QI=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:l}){E(this,vf);E(this,gb,null);E(this,Yu,null);E(this,Ku,new Map);E(this,mb,null);this.div=t,v(this,gb,e),v(this,Yu,n),v(this,mb,l||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return r(this,Ku).size>0}async render(t){var o;const{annotations:e}=t,n=this.div;ff(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new mk,annotationStorage:t.annotationStorage||new pk,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const h=l.annotationType===vn.POPUP;if(h){const g=i.get(l.id);if(!g)continue;s.elements=g}else{const{width:g,height:m}=xh(l.rect);if(g<=0||m<=0)continue}s.data=l;const d=VB.create(s);if(!d.isRenderable)continue;if(!h&&l.popupRef){const g=i.get(l.popupRef);g?g.push(d):i.set(l.popupRef,[d])}const p=d.render();l.hidden&&(p.style.visibility="hidden"),await A(this,vf,IF).call(this,p,l.id),d._isEditable&&(r(this,Ku).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}A(this,vf,vC).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,ff(e,{rotation:t.rotation}),A(this,vf,vC).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,Ku).values())}getEditableAnnotation(t){return r(this,Ku).get(t)}},gb=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,mb=new WeakMap,vf=new WeakSet,IF=async function(t,e){var o,l;const n=t.firstChild||t,i=n.id=`${ck}${e}`,s=await((o=r(this,mb))==null?void 0:o.getAriaAttributes(i));if(s)for(const[h,d]of s)n.setAttribute(h,d);this.div.append(t),(l=r(this,gb))==null||l.moveElementInDOM(this.div,t,n,!1)},vC=function(){if(!r(this,Yu))return;const t=this.div;for(const[e,n]of r(this,Yu)){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n)}r(this,Yu).clear()},QI);const __=/\r\n?|\n/g;var Vr,Cs,yb,Qu,Ts,ge,pn,DF,FF,OF,cw,Ol,hw,uw,NF,bC,$F;let c3=(ge=class extends rn{constructor(e){super({...e,name:"freeTextEditor"});E(this,pn);E(this,Vr);E(this,Cs,"");E(this,yb,`${this.id}-editor`);E(this,Qu,null);E(this,Ts);v(this,Vr,e.color||ge._defaultColor||rn._defaultLineColor),v(this,Ts,e.fontSize||ge._defaultFontSize)}static get _keyboardManager(){const e=ge.prototype,n=o=>o.isEmpty(),i=hv.TRANSLATE_SMALL,s=hv.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new J0([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(e,n){rn.initialize(e,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case te.FREETEXT_SIZE:ge._defaultFontSize=n;break;case te.FREETEXT_COLOR:ge._defaultColor=n;break}}updateParams(e,n){switch(e){case te.FREETEXT_SIZE:A(this,pn,DF).call(this,n);break;case te.FREETEXT_COLOR:A(this,pn,FF).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[te.FREETEXT_SIZE,ge._defaultFontSize],[te.FREETEXT_COLOR,ge._defaultColor||rn._defaultLineColor]]}get propertiesToUpdate(){return[[te.FREETEXT_SIZE,r(this,Ts)],[te.FREETEXT_COLOR,r(this,Vr)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-ge._internalPadding*e,-(ge._internalPadding+r(this,Ts))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(zt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,Qu,new AbortController);const e=this._uiManager.combinedSignal(r(this,Qu));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,yb)),this._isDraggable=!0,(e=r(this,Qu))==null||e.abort(),v(this,Qu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Cs),n=v(this,Cs,A(this,pn,OF).call(this).trimEnd());if(e===n)return;const i=s=>{if(v(this,Cs,s),!s){this.remove();return}A(this,pn,uw).call(this),this._uiManager.rebuild(this),A(this,pn,cw).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(e)},mustExec:!1}),A(this,pn,cw).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ge._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,yb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${r(this,Ts)}px * var(--scale-factor))`,i.color=r(this,Vr),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Jw(this,this.div,["dblclick","keydown"]),this.width){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[h,d]=this.getInitialTranslation();[h,d]=this.pageTranslationToScreen(h,d);const[p,g]=this.pageDimensions,[m,b]=this.pageTranslation;let _,S;switch(this.rotation){case 0:_=e+(l[0]-m)/p,S=n+this.height-(l[1]-b)/g;break;case 90:_=e+(l[0]-m)/p,S=n-(l[1]-b)/g,[h,d]=[d,-h];break;case 180:_=e-this.width+(l[0]-m)/p,S=n-(l[1]-b)/g,[h,d]=[-h,-d];break;case 270:_=e+(l[0]-m-this.height*g)/p,S=n+(l[1]-b-this.width*p)/g,[h,d]=[-d,h];break}this.setAt(_*s,S*o,h,d)}else this.setAt(e*s,n*o,this.width*s,this.height*o);A(this,pn,uw).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var _,S,C;const n=e.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const s=A(_=ge,Ol,bC).call(_,n.getData("text")||"").replaceAll(__,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:h,startOffset:d}=l,p=[],g=[];if(h.nodeType===Node.TEXT_NODE){const T=h.parentElement;if(g.push(h.nodeValue.slice(d).replaceAll(__,"")),T!==this.editorDiv){let k=p;for(const P of this.editorDiv.childNodes){if(P===T){k=g;continue}k.push(A(S=ge,Ol,hw).call(S,P))}}p.push(h.nodeValue.slice(0,d).replaceAll(__,""))}else if(h===this.editorDiv){let T=p,k=0;for(const P of this.editorDiv.childNodes)k++===d&&(T=g),T.push(A(C=ge,Ol,hw).call(C,P))}v(this,Cs,`${p.join(`
`)}${s}${g.join(`
`)}`),A(this,pn,uw).call(this);const m=new Range;let b=p.reduce((T,k)=>T+k.length,0);for(const{firstChild:T}of this.editorDiv.childNodes)if(T.nodeType===Node.TEXT_NODE){const k=T.nodeValue.length;if(b<=k){m.setStart(T,b),m.setEnd(T,b);break}b-=k}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,i){var l;let s=null;if(e instanceof PF){const{data:{defaultAppearanceData:{fontSize:h,fontColor:d},rect:p,rotation:g,id:m,popupRef:b},textContent:_,textPosition:S,parent:{page:{pageNumber:C}}}=e;if(!_||_.length===0)return null;s=e={annotationType:zt.FREETEXT,color:Array.from(d),fontSize:h,value:_.join(`
`),position:S,pageIndex:C-1,rect:p.slice(0),rotation:g,id:m,deleted:!1,popupRef:b}}const o=await super.deserialize(e,n,i);return v(o,Ts,e.fontSize),v(o,Vr,Rt.makeHexColor(...e.color)),v(o,Cs,A(l=ge,Ol,bC).call(l,e.value)),o.annotationElementId=e.id||null,o._initialData=s,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=ge._internalPadding*this.parentScale,i=this.getRect(n,n),s=rn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Vr)),o={annotationType:zt.FREETEXT,color:s,fontSize:r(this,Ts),value:A(this,pn,NF).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!A(this,pn,$F).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${r(this,Ts)}px * var(--scale-factor))`,i.color=r(this,Vr),n.replaceChildren();for(const o of r(this,Cs).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}const s=ge._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:r(this,Cs)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},Vr=new WeakMap,Cs=new WeakMap,yb=new WeakMap,Qu=new WeakMap,Ts=new WeakMap,pn=new WeakSet,DF=function(e){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-r(this,Ts))*this.parentScale),v(this,Ts,s),A(this,pn,cw).call(this)},i=r(this,Ts);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},FF=function(e){const n=s=>{v(this,Vr,this.editorDiv.style.color=s)},i=r(this,Vr);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},OF=function(){var i;const e=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(A(i=ge,Ol,hw).call(i,s)),n=s);return e.join(`
`)},cw=function(){const[e,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,h=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/n):(this.width=i.height/e,this.height=i.width/n),this.fixAndSetPosition()},Ol=new WeakSet,hw=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(__,"")},uw=function(){if(this.editorDiv.replaceChildren(),!!r(this,Cs))for(const e of r(this,Cs).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},NF=function(){return r(this,Cs).replaceAll(" "," ")},bC=function(e){return e.replaceAll(" "," ")},$F=function(e){const{value:n,fontSize:i,color:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==i||e.color.some((l,h)=>l!==s[h])||e.pageIndex!==o},E(ge,Ol),lt(ge,"_freeTextDefaultContent",""),lt(ge,"_internalPadding",0),lt(ge,"_defaultColor",null),lt(ge,"_defaultFontSize",10),lt(ge,"_type","freetext"),lt(ge,"_editorType",zt.FREETEXT),ge);var Ix;let Et=(Ix=class{toSVGPath(){Ee("Abstract method `toSVGPath` must be implemented.")}get box(){Ee("Abstract getter `box` must be implemented.")}serialize(t,e){Ee("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,s,o){o||(o=new Float32Array(t.length));for(let l=0,h=t.length;l<h;l+=2)o[l]=e+t[l]*i,o[l+1]=n+t[l+1]*s;return o}static _rescaleAndSwap(t,e,n,i,s,o){o||(o=new Float32Array(t.length));for(let l=0,h=t.length;l<h;l+=2)o[l]=e+t[l+1]*i,o[l+1]=n+t[l]*s;return o}static _translate(t,e,n,i){i||(i=new Float32Array(t.length));for(let s=0,o=t.length;s<o;s+=2)i[s]=e+t[s],i[s+1]=n+t[s+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,i,s){switch(s){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,s,o){return[(t+5*n)/6,(e+5*i)/6,(5*n+s)/6,(5*i+o)/6,(n+s)/2,(i+o)/2]}},lt(Ix,"PRECISION",1e-4),Ix);var ks,Wr,eg,ng,$a,Xt,Ju,Zu,vb,bb,ig,sg,Hc,mr,Ab,yE,vE,Tn,Oy,HF,BF,zF,UF,GF,VF;let jF=(mr=class{constructor({x:t,y:e},n,i,s,o,l=0){E(this,Tn);E(this,ks);E(this,Wr,[]);E(this,eg);E(this,ng);E(this,$a,[]);E(this,Xt,new Float32Array(18));E(this,Ju);E(this,Zu);E(this,vb);E(this,bb);E(this,ig);E(this,sg);E(this,Hc,[]);v(this,ks,n),v(this,sg,s*i),v(this,ng,o),r(this,Xt).set([NaN,NaN,NaN,NaN,t,e],6),v(this,eg,l),v(this,bb,r(mr,Ab)*i),v(this,vb,r(mr,vE)*i),v(this,ig,i),r(this,Hc).push(t,e)}isEmpty(){return isNaN(r(this,Xt)[8])}add({x:t,y:e}){var j;v(this,Ju,t),v(this,Zu,e);const[n,i,s,o]=r(this,ks);let[l,h,d,p]=r(this,Xt).subarray(8,12);const g=t-d,m=e-p,b=Math.hypot(g,m);if(b<r(this,vb))return!1;const _=b-r(this,bb),S=_/b,C=S*g,T=S*m;let k=l,P=h;l=d,h=p,d+=C,p+=T,(j=r(this,Hc))==null||j.push(t,e);const L=-T/_,I=C/_,D=L*r(this,sg),F=I*r(this,sg);return r(this,Xt).set(r(this,Xt).subarray(2,8),0),r(this,Xt).set([d+D,p+F],4),r(this,Xt).set(r(this,Xt).subarray(14,18),12),r(this,Xt).set([d-D,p-F],16),isNaN(r(this,Xt)[6])?(r(this,$a).length===0&&(r(this,Xt).set([l+D,h+F],2),r(this,$a).push(NaN,NaN,NaN,NaN,(l+D-n)/s,(h+F-i)/o),r(this,Xt).set([l-D,h-F],14),r(this,Wr).push(NaN,NaN,NaN,NaN,(l-D-n)/s,(h-F-i)/o)),r(this,Xt).set([k,P,l,h,d,p],6),!this.isEmpty()):(r(this,Xt).set([k,P,l,h,d,p],6),Math.abs(Math.atan2(P-h,k-l)-Math.atan2(T,C))<Math.PI/2?([l,h,d,p]=r(this,Xt).subarray(2,6),r(this,$a).push(NaN,NaN,NaN,NaN,((l+d)/2-n)/s,((h+p)/2-i)/o),[l,h,k,P]=r(this,Xt).subarray(14,18),r(this,Wr).push(NaN,NaN,NaN,NaN,((k+l)/2-n)/s,((P+h)/2-i)/o),!0):([k,P,l,h,d,p]=r(this,Xt).subarray(0,6),r(this,$a).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+d)/6-n)/s,((5*h+p)/6-i)/o,((l+d)/2-n)/s,((h+p)/2-i)/o),[d,p,l,h,k,P]=r(this,Xt).subarray(12,18),r(this,Wr).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+d)/6-n)/s,((5*h+p)/6-i)/o,((l+d)/2-n)/s,((h+p)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,$a),e=r(this,Wr);if(isNaN(r(this,Xt)[6])&&!this.isEmpty())return A(this,Tn,HF).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);A(this,Tn,zF).call(this,n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return A(this,Tn,BF).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,i,s,o){return new WF(t,e,n,i,s,o)}getOutlines(){var g;const t=r(this,$a),e=r(this,Wr),n=r(this,Xt),[i,s,o,l]=r(this,ks),h=new Float32Array((((g=r(this,Hc))==null?void 0:g.length)??0)+2);for(let m=0,b=h.length-2;m<b;m+=2)h[m]=(r(this,Hc)[m]-i)/o,h[m+1]=(r(this,Hc)[m+1]-s)/l;if(h[h.length-2]=(r(this,Ju)-i)/o,h[h.length-1]=(r(this,Zu)-s)/l,isNaN(n[6])&&!this.isEmpty())return A(this,Tn,UF).call(this,h);const d=new Float32Array(r(this,$a).length+24+r(this,Wr).length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=A(this,Tn,VF).call(this,d,p);for(let m=e.length-6;m>=6;m-=6)for(let b=0;b<6;b+=2){if(isNaN(e[m+b])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=e[m+b],d[p+1]=e[m+b+1],p+=2}return A(this,Tn,GF).call(this,d,p),this.newFreeDrawOutline(d,h,r(this,ks),r(this,ig),r(this,eg),r(this,ng))}},ks=new WeakMap,Wr=new WeakMap,eg=new WeakMap,ng=new WeakMap,$a=new WeakMap,Xt=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,vb=new WeakMap,bb=new WeakMap,ig=new WeakMap,sg=new WeakMap,Hc=new WeakMap,Ab=new WeakMap,yE=new WeakMap,vE=new WeakMap,Tn=new WeakSet,Oy=function(){const t=r(this,Xt).subarray(4,6),e=r(this,Xt).subarray(16,18),[n,i,s,o]=r(this,ks);return[(r(this,Ju)+(t[0]-e[0])/2-n)/s,(r(this,Zu)+(t[1]-e[1])/2-i)/o,(r(this,Ju)+(e[0]-t[0])/2-n)/s,(r(this,Zu)+(e[1]-t[1])/2-i)/o]},HF=function(){const[t,e,n,i]=r(this,ks),[s,o,l,h]=A(this,Tn,Oy).call(this);return`M${(r(this,Xt)[2]-t)/n} ${(r(this,Xt)[3]-e)/i} L${(r(this,Xt)[4]-t)/n} ${(r(this,Xt)[5]-e)/i} L${s} ${o} L${l} ${h} L${(r(this,Xt)[16]-t)/n} ${(r(this,Xt)[17]-e)/i} L${(r(this,Xt)[14]-t)/n} ${(r(this,Xt)[15]-e)/i} Z`},BF=function(t){const e=r(this,Wr);t.push(`L${e[4]} ${e[5]} Z`)},zF=function(t){const[e,n,i,s]=r(this,ks),o=r(this,Xt).subarray(4,6),l=r(this,Xt).subarray(16,18),[h,d,p,g]=A(this,Tn,Oy).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-n)/s} L${h} ${d} L${p} ${g} L${(l[0]-e)/i} ${(l[1]-n)/s}`)},UF=function(t){const e=r(this,Xt),[n,i,s,o]=r(this,ks),[l,h,d,p]=A(this,Tn,Oy).call(this),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/o],0),this.newFreeDrawOutline(g,t,r(this,ks),r(this,ig),r(this,eg),r(this,ng))},GF=function(t,e){const n=r(this,Wr);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},VF=function(t,e){const n=r(this,Xt).subarray(4,6),i=r(this,Xt).subarray(16,18),[s,o,l,h]=r(this,ks),[d,p,g,m]=A(this,Tn,Oy).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/l,(n[1]-o)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/h],e),e+=24},E(mr,Ab,8),E(mr,yE,2),E(mr,vE,r(mr,Ab)+r(mr,yE)),mr);var rg,td,tl,_b,Ps,wb,nn,bE,qF,JI;let WF=(JI=class extends Et{constructor(e,n,i,s,o,l){super();E(this,bE);E(this,rg);E(this,td,new Float32Array(4));E(this,tl);E(this,_b);E(this,Ps);E(this,wb);E(this,nn);v(this,nn,e),v(this,Ps,n),v(this,rg,i),v(this,wb,s),v(this,tl,o),v(this,_b,l),this.lastPoint=[NaN,NaN],A(this,bE,qF).call(this,l);const[h,d,p,g]=r(this,td);for(let m=0,b=e.length;m<b;m+=2)e[m]=(e[m]-h)/p,e[m+1]=(e[m+1]-d)/g;for(let m=0,b=n.length;m<b;m+=2)n[m]=(n[m]-h)/p,n[m+1]=(n[m+1]-d)/g}toSVGPath(){const e=[`M${r(this,nn)[4]} ${r(this,nn)[5]}`];for(let n=6,i=r(this,nn).length;n<i;n+=6){if(isNaN(r(this,nn)[n])){e.push(`L${r(this,nn)[n+4]} ${r(this,nn)[n+5]}`);continue}e.push(`C${r(this,nn)[n]} ${r(this,nn)[n+1]} ${r(this,nn)[n+2]} ${r(this,nn)[n+3]} ${r(this,nn)[n+4]} ${r(this,nn)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,i,s],o){const l=i-e,h=s-n;let d,p;switch(o){case 0:d=Et._rescale(r(this,nn),e,s,l,-h),p=Et._rescale(r(this,Ps),e,s,l,-h);break;case 90:d=Et._rescaleAndSwap(r(this,nn),e,n,l,h),p=Et._rescaleAndSwap(r(this,Ps),e,n,l,h);break;case 180:d=Et._rescale(r(this,nn),i,n,-l,h),p=Et._rescale(r(this,Ps),i,n,-l,h);break;case 270:d=Et._rescaleAndSwap(r(this,nn),i,s,-l,-h),p=Et._rescaleAndSwap(r(this,Ps),i,s,-l,-h);break}return{outline:Array.from(d),points:[Array.from(p)]}}get box(){return r(this,td)}newOutliner(e,n,i,s,o,l=0){return new jF(e,n,i,s,o,l)}getNewOutline(e,n){const[i,s,o,l]=r(this,td),[h,d,p,g]=r(this,rg),m=o*p,b=l*g,_=i*p+h,S=s*g+d,C=this.newOutliner({x:r(this,Ps)[0]*m+_,y:r(this,Ps)[1]*b+S},r(this,rg),r(this,wb),e,r(this,_b),n??r(this,tl));for(let T=2;T<r(this,Ps).length;T+=2)C.add({x:r(this,Ps)[T]*m+_,y:r(this,Ps)[T+1]*b+S});return C.getOutlines()}},rg=new WeakMap,td=new WeakMap,tl=new WeakMap,_b=new WeakMap,Ps=new WeakMap,wb=new WeakMap,nn=new WeakMap,bE=new WeakSet,qF=function(e){const n=r(this,nn);let i=n[4],s=n[5],o=i,l=s,h=i,d=s,p=i,g=s;const m=e?Math.max:Math.min;for(let _=6,S=n.length;_<S;_+=6){if(isNaN(n[_]))o=Math.min(o,n[_+4]),l=Math.min(l,n[_+5]),h=Math.max(h,n[_+4]),d=Math.max(d,n[_+5]),g<n[_+5]?(p=n[_+4],g=n[_+5]):g===n[_+5]&&(p=m(p,n[_+4]));else{const C=Rt.bezierBoundingBox(i,s,...n.slice(_,_+6));o=Math.min(o,C[0]),l=Math.min(l,C[1]),h=Math.max(h,C[2]),d=Math.max(d,C[3]),g<C[3]?(p=C[2],g=C[3]):g===C[3]&&(p=m(p,C[2]))}i=n[_+4],s=n[_+5]}const b=r(this,td);b[0]=o-r(this,tl),b[1]=l-r(this,tl),b[2]=h-o+2*r(this,tl),b[3]=d-l+2*r(this,tl),this.lastPoint=[p,g]},JI);var Eb,Sb,Bc,qr,Vi,XF,dw,YF,KF,_C,ZI;let AC=(ZI=class{constructor(t,e=0,n=0,i=!0){E(this,Vi);E(this,Eb);E(this,Sb);E(this,Bc,[]);E(this,qr,[]);let s=1/0,o=-1/0,l=1/0,h=-1/0;const d=10**-4;for(const{x:C,y:T,width:k,height:P}of t){const L=Math.floor((C-e)/d)*d,I=Math.ceil((C+k+e)/d)*d,D=Math.floor((T-e)/d)*d,F=Math.ceil((T+P+e)/d)*d,H=[L,D,F,!0],j=[I,D,F,!1];r(this,Bc).push(H,j),s=Math.min(s,L),o=Math.max(o,I),l=Math.min(l,D),h=Math.max(h,F)}const p=o-s+2*n,g=h-l+2*n,m=s-n,b=l-n,_=r(this,Bc).at(i?-1:-2),S=[_[0],_[2]];for(const C of r(this,Bc)){const[T,k,P]=C;C[0]=(T-m)/p,C[1]=(k-b)/g,C[2]=(P-b)/g}v(this,Eb,new Float32Array([m,b,p,g])),v(this,Sb,S)}getOutlines(){r(this,Bc).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of r(this,Bc))e[3]?(t.push(...A(this,Vi,_C).call(this,e)),A(this,Vi,YF).call(this,e)):(A(this,Vi,KF).call(this,e),t.push(...A(this,Vi,_C).call(this,e)));return A(this,Vi,XF).call(this,t)}},Eb=new WeakMap,Sb=new WeakMap,Bc=new WeakMap,qr=new WeakMap,Vi=new WeakSet,XF=function(t){const e=[],n=new Set;for(const o of t){const[l,h,d]=o;e.push([l,h,o],[l,d,o])}e.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=e.length;o<l;o+=2){const h=e[o][2],d=e[o+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let s;for(;n.size>0;){const o=n.values().next().value;let[l,h,d,p,g]=o;n.delete(o);let m=l,b=h;for(s=[l,d],i.push(s);;){let _;if(n.has(p))_=p;else if(n.has(g))_=g;else break;n.delete(_),[l,h,d,p,g]=_,m!==l&&(s.push(m,b,l,b===h?h:d),m=l),b=b===h?d:h}s.push(m,b)}return new h3(i,r(this,Eb),r(this,Sb))},dw=function(t){const e=r(this,qr);let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,o=e[s][0];if(o===t)return s;o<t?n=s+1:i=s-1}return i+1},YF=function([,t,e]){const n=A(this,Vi,dw).call(this,t);r(this,qr).splice(n,0,[t,e])},KF=function([,t,e]){const n=A(this,Vi,dw).call(this,t);for(let i=n;i<r(this,qr).length;i++){const[s,o]=r(this,qr)[i];if(s!==t)break;if(s===t&&o===e){r(this,qr).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,o]=r(this,qr)[i];if(s!==t)break;if(s===t&&o===e){r(this,qr).splice(i,1);return}}},_C=function(t){const[e,n,i]=t,s=[[e,n,i]],o=A(this,Vi,dw).call(this,i);for(let l=0;l<o;l++){const[h,d]=r(this,qr)[l];for(let p=0,g=s.length;p<g;p++){const[,m,b]=s[p];if(!(d<=m||b<=h)){if(m>=h){if(b>d)s[p][1]=d;else{if(g===1)return[];s.splice(p,1),p--,g--}continue}s[p][2]=h,b>d&&s.push([e,d,b])}}}return s},ZI);var xb,ag,tD;let h3=(tD=class extends Et{constructor(e,n,i){super();E(this,xb);E(this,ag);v(this,ag,e),v(this,xb,n),this.lastPoint=i}toSVGPath(){const e=[];for(const n of r(this,ag)){let[i,s]=n;e.push(`M${i} ${s}`);for(let o=2;o<n.length;o+=2){const l=n[o],h=n[o+1];l===i?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${l}`),i=l)}e.push("Z")}return e.join(" ")}serialize([e,n,i,s],o){const l=[],h=i-e,d=s-n;for(const p of r(this,ag)){const g=new Array(p.length);for(let m=0;m<p.length;m+=2)g[m]=e+p[m]*h,g[m+1]=s-p[m+1]*d;l.push(g)}return l}get box(){return r(this,xb)}get classNamesForOutlining(){return["highlightOutline"]}},xb=new WeakMap,ag=new WeakMap,tD),wC=class extends jF{newFreeDrawOutline(t,e,n,i,s,o){return new u3(t,e,n,i,s,o)}},u3=class extends WF{newOutliner(t,e,n,i,s,o=0){return new wC(t,e,n,i,s,o)}};var Xr,ed,og,_n,Cb,lg,Tb,kb,zc,Yr,cg,ai,Pb,ve,EC,SC,xC,Zh,JF,mc;let QF=(ai=class{constructor({editor:t=null,uiManager:e=null}){E(this,ve);E(this,Xr,null);E(this,ed,null);E(this,og);E(this,_n,null);E(this,Cb,!1);E(this,lg,!1);E(this,Tb,null);E(this,kb);E(this,zc,null);E(this,Yr,null);E(this,cg);var n;t?(v(this,lg,!1),v(this,cg,te.HIGHLIGHT_COLOR),v(this,Tb,t)):(v(this,lg,!0),v(this,cg,te.HIGHLIGHT_DEFAULT_COLOR)),v(this,Yr,(t==null?void 0:t._uiManager)||e),v(this,kb,r(this,Yr)._eventBus),v(this,og,(t==null?void 0:t.color)||((n=r(this,Yr))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),r(ai,Pb)||v(ai,Pb,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Kt(this,"_keyboardManager",new J0([[["Escape","mac+Escape"],ai.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ai.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ai.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ai.prototype._moveToPrevious],[["Home","mac+Home"],ai.prototype._moveToBeginning],[["End","mac+End"],ai.prototype._moveToEnd]]))}renderButton(){const t=v(this,Xr,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,Yr)._signal;t.addEventListener("click",A(this,ve,Zh).bind(this),{signal:e}),t.addEventListener("keydown",A(this,ve,xC).bind(this),{signal:e});const n=v(this,ed,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=r(this,og),t.append(n),t}renderMainDropdown(){const t=v(this,_n,A(this,ve,EC).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,Xr)){A(this,ve,Zh).call(this,t);return}const e=t.target.getAttribute("data-color");e&&A(this,ve,SC).call(this,e,t)}_moveToNext(t){var e,n;if(!r(this,ve,mc)){A(this,ve,Zh).call(this,t);return}if(t.target===r(this,Xr)){(e=r(this,_n).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=r(this,_n))==null?void 0:e.firstChild)||t.target===r(this,Xr)){r(this,ve,mc)&&this._hideDropdownFromKeyboard();return}r(this,ve,mc)||A(this,ve,Zh).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!r(this,ve,mc)){A(this,ve,Zh).call(this,t);return}(e=r(this,_n).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,ve,mc)){A(this,ve,Zh).call(this,t);return}(e=r(this,_n).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,_n))==null||t.classList.add("hidden"),(e=r(this,zc))==null||e.abort(),v(this,zc,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,lg)){if(!r(this,ve,mc)){(t=r(this,Tb))==null||t.unselect();return}this.hideDropdown(),r(this,Xr).focus({preventScroll:!0,focusVisible:r(this,Cb)})}}updateColor(t){if(r(this,ed)&&(r(this,ed).style.backgroundColor=t),!r(this,_n))return;const e=r(this,Yr).highlightColors.values();for(const n of r(this,_n).children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,Xr))==null||t.remove(),v(this,Xr,null),v(this,ed,null),(e=r(this,_n))==null||e.remove(),v(this,_n,null)}},Xr=new WeakMap,ed=new WeakMap,og=new WeakMap,_n=new WeakMap,Cb=new WeakMap,lg=new WeakMap,Tb=new WeakMap,kb=new WeakMap,zc=new WeakMap,Yr=new WeakMap,cg=new WeakMap,Pb=new WeakMap,ve=new WeakSet,EC=function(){const t=document.createElement("div"),e=r(this,Yr)._signal;t.addEventListener("contextmenu",fa,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of r(this,Yr).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",r(ai,Pb)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===r(this,og)),s.addEventListener("click",A(this,ve,SC).bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",A(this,ve,xC).bind(this),{signal:e}),t},SC=function(t,e){e.stopPropagation(),r(this,kb).dispatch("switchannotationeditorparams",{source:this,type:r(this,cg),value:t})},xC=function(t){ai._keyboardManager.exec(this,t)},Zh=function(t){if(r(this,ve,mc)){this.hideDropdown();return}if(v(this,Cb,t.detail===0),r(this,zc)||(v(this,zc,new AbortController),window.addEventListener("pointerdown",A(this,ve,JF).bind(this),{signal:r(this,Yr).combinedSignal(r(this,zc))})),r(this,_n)){r(this,_n).classList.remove("hidden");return}const e=v(this,_n,A(this,ve,EC).call(this));r(this,Xr).append(e)},JF=function(t){var e;(e=r(this,_n))!=null&&e.contains(t.target)||this.hideDropdown()},mc=function(){return r(this,_n)&&!r(this,_n).classList.contains("hidden")},E(ai,Pb,null),ai);var hg,Rb,el,nd,ug,as,Lb,Mb,id,or,Rs,ti,dg,nl,wi,fg,lr,Ib,ne,Ht,CC,fw,ZF,tO,eO,TC,tu,br,sp,nO,pw,Ny,iO,sO,rO,aO,oO;let eM=(ne=class extends rn{constructor(e){super({...e,name:"highlightEditor"});E(this,Ht);E(this,hg,null);E(this,Rb,0);E(this,el);E(this,nd,null);E(this,ug,null);E(this,as,null);E(this,Lb,null);E(this,Mb,0);E(this,id,null);E(this,or,null);E(this,Rs,null);E(this,ti,!1);E(this,dg,null);E(this,nl);E(this,wi,null);E(this,fg,"");E(this,lr);E(this,Ib,"");this.color=e.color||ne._defaultColor,v(this,lr,e.thickness||ne._defaultThickness),v(this,nl,e.opacity||ne._defaultOpacity),v(this,el,e.boxes||null),v(this,Ib,e.methodOfCreation||""),v(this,fg,e.text||""),this._isDraggable=!1,e.highlightId>-1?(v(this,ti,!0),A(this,Ht,fw).call(this,e),A(this,Ht,tu).call(this)):r(this,el)&&(v(this,hg,e.anchorNode),v(this,Rb,e.anchorOffset),v(this,Lb,e.focusNode),v(this,Mb,e.focusOffset),A(this,Ht,CC).call(this),A(this,Ht,tu).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=ne.prototype;return Kt(this,"_keyboardManager",new J0([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,ti)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,lr),methodOfCreation:r(this,Ib)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var i;rn.initialize(e,n),ne._defaultColor||(ne._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case te.HIGHLIGHT_DEFAULT_COLOR:ne._defaultColor=n;break;case te.HIGHLIGHT_THICKNESS:ne._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return r(this,dg)}updateParams(e,n){switch(e){case te.HIGHLIGHT_COLOR:A(this,Ht,ZF).call(this,n);break;case te.HIGHLIGHT_THICKNESS:A(this,Ht,tO).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[te.HIGHLIGHT_DEFAULT_COLOR,ne._defaultColor],[te.HIGHLIGHT_THICKNESS,ne._defaultThickness]]}get propertiesToUpdate(){return[[te.HIGHLIGHT_COLOR,this.color||ne._defaultColor],[te.HIGHLIGHT_THICKNESS,r(this,lr)||ne._defaultThickness],[te.HIGHLIGHT_FREE,r(this,ti)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(v(this,ug,new QF({editor:this})),e.addColorPicker(r(this,ug))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,Ht,Ny).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,A(this,Ht,Ny).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){A(this,Ht,TC).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,Ht,tu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?A(this,Ht,TC).call(this):e&&(A(this,Ht,tu).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var s,o,l;const{drawLayer:n}=this.parent;let i;r(this,ti)?(e=(e-this.rotation+360)%360,i=A(s=ne,br,sp).call(s,r(this,or).box,e)):i=A(o=ne,br,sp).call(o,[this.x,this.y,this.width,this.height],e),n.updateProperties(r(this,Rs),{bbox:i,root:{"data-main-rotation":e}}),n.updateProperties(r(this,wi),{bbox:A(l=ne,br,sp).call(l,r(this,as).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();r(this,fg)&&(e.setAttribute("aria-label",r(this,fg)),e.setAttribute("role","mark")),r(this,ti)?e.classList.add("free"):this.div.addEventListener("keydown",A(this,Ht,nO).bind(this),{signal:this._uiManager._signal});const n=v(this,id,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=r(this,nd);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),Jw(this,r(this,id),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,wi),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,wi),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:A(this,Ht,pw).call(this,!0);break;case 1:case 3:A(this,Ht,pw).call(this,!1);break}}select(){var e;super.select(),r(this,wi)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,wi),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),r(this,wi)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,wi),{rootClass:{selected:!1}}),r(this,ti)||A(this,Ht,pw).call(this,!1))}get _mustFixPosition(){return!r(this,ti)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(r(this,Rs),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(r(this,wi),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:i,x:s,y:o}){const{x:l,y:h,width:d,height:p}=i.getBoundingClientRect(),g=new AbortController,m=e.combinedSignal(g),b=_=>{g.abort(),A(this,br,aO).call(this,e,_)};window.addEventListener("blur",b,{signal:m}),window.addEventListener("pointerup",b,{signal:m}),window.addEventListener("pointerdown",Ws,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",fa,{signal:m}),i.addEventListener("pointermove",A(this,br,rO).bind(this,e),{signal:m}),this._freeHighlight=new wC({x:s,y:o},[l,h,d,p],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,i){var S,C,T,k;let s=null;if(e instanceof LF){const{data:{quadPoints:P,rect:L,rotation:I,id:D,color:F,opacity:H,popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:zt.HIGHLIGHT,color:Array.from(F),opacity:H,quadPoints:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}else if(e instanceof yk){const{data:{inkLists:P,rect:L,rotation:I,id:D,color:F,borderStyle:{rawWidth:H},popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:zt.HIGHLIGHT,color:Array.from(F),thickness:H,inkLists:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}const{color:o,quadPoints:l,inkLists:h,opacity:d}=e,p=await super.deserialize(e,n,i);p.color=Rt.makeHexColor(...o),v(p,nl,d||1),h&&v(p,lr,e.thickness),p.annotationElementId=e.id||null,p._initialData=s;const[g,m]=p.pageDimensions,[b,_]=p.pageTranslation;if(l){const P=v(p,el,[]);for(let L=0;L<l.length;L+=8)P.push({x:(l[L]-b)/g,y:1-(l[L+1]-_)/m,width:(l[L+2]-l[L])/g,height:(l[L+1]-l[L+5])/m});A(S=p,Ht,CC).call(S),A(C=p,Ht,tu).call(C),p.rotate(p.rotation)}else if(h){v(p,ti,!0);const P=h[0],L={x:P[0]-b,y:m-(P[1]-_)},I=new wC(L,[0,0,g,m],1,r(p,lr)/2,!0,.001);for(let H=0,j=P.length;H<j;H+=2)L.x=P[H]-b,L.y=m-(P[H+1]-_),I.add(L);const{id:D,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:I.toSVGPath()}},!0,!0);A(T=p,Ht,fw).call(T,{highlightOutlines:I.getOutlines(),highlightId:D,clipPathId:F}),A(k=p,Ht,tu).call(k)}return p}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=rn._colorManager.convert(this.color),s={annotationType:zt.HIGHLIGHT,color:i,opacity:r(this,nl),thickness:r(this,lr),quadPoints:A(this,Ht,iO).call(this),outlines:A(this,Ht,sO).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:A(this,Ht,Ny).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!A(this,Ht,oO).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},hg=new WeakMap,Rb=new WeakMap,el=new WeakMap,nd=new WeakMap,ug=new WeakMap,as=new WeakMap,Lb=new WeakMap,Mb=new WeakMap,id=new WeakMap,or=new WeakMap,Rs=new WeakMap,ti=new WeakMap,dg=new WeakMap,nl=new WeakMap,wi=new WeakMap,fg=new WeakMap,lr=new WeakMap,Ib=new WeakMap,Ht=new WeakSet,CC=function(){const e=new AC(r(this,el),.001);v(this,or,e.getOutlines()),[this.x,this.y,this.width,this.height]=r(this,or).box;const n=new AC(r(this,el),.0025,.001,this._uiManager.direction==="ltr");v(this,as,n.getOutlines());const{lastPoint:i}=r(this,as);v(this,dg,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},fw=function({highlightOutlines:e,highlightId:n,clipPathId:i}){var g,m;if(v(this,or,e),v(this,as,e.getNewOutline(r(this,lr)/2+1.5,.0025)),n>=0)v(this,Rs,n),v(this,nd,i),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),v(this,wi,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:r(this,as).box,path:{d:r(this,as).toSVGPath()}},!0));else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(r(this,Rs),{bbox:A(g=ne,br,sp).call(g,r(this,or).box,(b-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(r(this,wi),{bbox:A(m=ne,br,sp).call(m,r(this,as).box,b),path:{d:r(this,as).toSVGPath()}})}const[o,l,h,d]=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=h,this.height=d;break;case 90:{const[b,_]=this.parentDimensions;this.x=l,this.y=1-o,this.width=h*_/b,this.height=d*b/_;break}case 180:this.x=1-o,this.y=1-l,this.width=h,this.height=d;break;case 270:{const[b,_]=this.parentDimensions;this.x=1-l,this.y=o,this.width=h*_/b,this.height=d*b/_;break}}const{lastPoint:p}=r(this,as);v(this,dg,[(p[0]-o)/h,(p[1]-l)/d])},ZF=function(e){const n=(o,l)=>{var h,d;this.color=o,v(this,nl,l),(h=this.parent)==null||h.drawLayer.updateProperties(r(this,Rs),{root:{fill:o,"fill-opacity":l}}),(d=r(this,ug))==null||d.updateColor(o)},i=this.color,s=r(this,nl);this.addCommands({cmd:n.bind(this,e,ne._defaultOpacity),undo:n.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},tO=function(e){const n=r(this,lr),i=s=>{v(this,lr,s),A(this,Ht,eO).call(this,s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},eO=function(e){if(!r(this,ti))return;A(this,Ht,fw).call(this,{highlightOutlines:r(this,or).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},TC=function(){r(this,Rs)===null||!this.parent||(this.parent.drawLayer.remove(r(this,Rs)),v(this,Rs,null),this.parent.drawLayer.remove(r(this,wi)),v(this,wi,null))},tu=function(e=this.parent){r(this,Rs)===null&&({id:he(this,Rs)._,clipPathId:he(this,nd)._}=e.drawLayer.draw({bbox:r(this,or).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":r(this,nl)},rootClass:{highlight:!0,free:r(this,ti)},path:{d:r(this,or).toSVGPath()}},!1,!0),v(this,wi,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:r(this,ti)},bbox:r(this,as).box,path:{d:r(this,as).toSVGPath()}},r(this,ti))),r(this,id)&&(r(this,id).style.clipPath=r(this,nd)))},br=new WeakSet,sp=function([e,n,i,s],o){switch(o){case 90:return[1-n-s,e,s,i];case 180:return[1-e-i,1-n-s,i,s];case 270:return[n,1-e-i,s,i]}return[e,n,i,s]},nO=function(e){ne._keyboardManager.exec(this,e)},pw=function(e){if(!r(this,hg))return;const n=window.getSelection();e?n.setPosition(r(this,hg),r(this,Rb)):n.setPosition(r(this,Lb),r(this,Mb))},Ny=function(){return r(this,ti)?this.rotation:0},iO=function(){if(r(this,ti))return null;const[e,n]=this.pageDimensions,[i,s]=this.pageTranslation,o=r(this,el),l=new Float32Array(o.length*8);let h=0;for(const{x:d,y:p,width:g,height:m}of o){const b=d*e+i,_=(1-p)*n+s;l[h]=l[h+4]=b,l[h+1]=l[h+3]=_,l[h+2]=l[h+6]=b+g*e,l[h+5]=l[h+7]=_-m*n,h+=8}return l},sO=function(e){return r(this,or).serialize(e,A(this,Ht,Ny).call(this))},rO=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},aO=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},oO=function(e){const{color:n}=this._initialData;return e.color.some((i,s)=>i!==n[s])},E(ne,br),lt(ne,"_defaultColor",null),lt(ne,"_defaultOpacity",1),lt(ne,"_defaultThickness",12),lt(ne,"_type","highlight"),lt(ne,"_editorType",zt.HIGHLIGHT),lt(ne,"_freeHighlightId",-1),lt(ne,"_freeHighlight",null),lt(ne,"_freeHighlightClipId",""),ne);var sd;class d3{constructor(){E(this,sd,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))this.updateProperty(e,n)}updateSVGProperty(t,e){r(this,sd)[t]=e}toSVGProperties(){const t=r(this,sd);return v(this,sd,Object.create(null)),{root:t}}reset(){v(this,sd,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Ee("Not implemented")}}sd=new WeakMap;var Ls,pg,$n,rd,ad,Uc,Gc,Vc,od,se,PC,RC,LC,$y,lO,gw,jy,rp;const wt=class wt extends rn{constructor(e){super(e);E(this,se);E(this,Ls,null);E(this,pg);lt(this,"_drawId",null);v(this,pg,e.mustBeCommitted||!1),e.drawOutlines&&(A(this,se,PC).call(this,e),A(this,se,$y).call(this))}static _mergeSVGProperties(e,n){const i=new Set(Object.keys(e));for(const[s,o]of Object.entries(n))i.has(s)?Object.assign(e[s],o):e[s]=o;return e}static getDefaultDrawingOptions(e){Ee("Not implemented")}static get typesMap(){Ee("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(r(wt,$n).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)e.push([i,n[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[i,s]of this.constructor.typesMap)e.push([i,n[s]]);return e}_updateProperty(e,n,i){const s=this._drawingOptions,o=s[n],l=h=>{var p;s.updateProperty(n,h);const d=r(this,Ls).updateProperty(n,h);d&&A(this,se,jy).call(this,d),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(r(this,Ls).getPathResizingSVGProperties(A(this,se,gw).call(this)),{bbox:A(this,se,rp).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(r(this,Ls).getPathResizedSVGProperties(A(this,se,gw).call(this)),{bbox:A(this,se,rp).call(this)}))}_onTranslating(e,n){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,se,rp).call(this,e,n)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(r(this,Ls).getPathTranslatedSVGProperties(A(this,se,gw).call(this),this.parentDimensions),{bbox:A(this,se,rp).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,r(this,pg)&&(v(this,pg,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){A(this,se,LC).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,se,$y).call(this),A(this,se,jy).call(this,r(this,Ls).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),A(this,se,LC).call(this)):e&&(this._uiManager.addShouldRescale(this),A(this,se,$y).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties({bbox:A(this,se,rp).call(this)},r(this,Ls).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,se,jy).call(this,r(this,Ls).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const n=document.createElement("div");e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,n,i,s,o){Ee("Not implemented")}static startDrawing(e,n,i,s){var C;const{target:o,offsetX:l,offsetY:h,pointerId:d,pointerType:p}=s;if(r(wt,Gc)&&r(wt,Gc)!==p)return;const{viewport:{rotation:g}}=e,{width:m,height:b}=o.getBoundingClientRect(),_=v(wt,rd,new AbortController),S=e.combinedSignal(_);if(r(wt,Uc)||v(wt,Uc,d),r(wt,Gc)??v(wt,Gc,p),window.addEventListener("pointerup",T=>{var k;r(wt,Uc)===T.pointerId?this._endDraw(T):(k=r(wt,Vc))==null||k.delete(T.pointerId)},{signal:S}),window.addEventListener("pointercancel",T=>{var k;r(wt,Uc)===T.pointerId?this._currentParent.endDrawingSession():(k=r(wt,Vc))==null||k.delete(T.pointerId)},{signal:S}),window.addEventListener("pointerdown",T=>{r(wt,Gc)===T.pointerType&&((r(wt,Vc)||v(wt,Vc,new Set)).add(T.pointerId),r(wt,$n).isCancellable()&&(r(wt,$n).removeLastElement(),r(wt,$n).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",fa,{signal:S}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),o.addEventListener("touchmove",T=>{T.timeStamp===r(wt,od)&&Ws(T)},{signal:S}),e.toggleDrawing(),(C=n._editorUndoBar)==null||C.hide(),r(wt,$n)){e.drawLayer.updateProperties(this._currentDrawId,r(wt,$n).startNew(l,h,m,b,g));return}n.updateUIForDefaultProperties(this),v(wt,$n,this.createDrawerInstance(l,h,m,b,g)),v(wt,ad,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(r(wt,ad).toSVGProperties(),r(wt,$n).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(v(wt,od,-1),!r(wt,$n))return;const{offsetX:n,offsetY:i,pointerId:s}=e;if(r(wt,Uc)===s){if(((o=r(wt,Vc))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,r(wt,$n).add(n,i)),v(wt,od,e.timeStamp),Ws(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,v(wt,$n,null),v(wt,ad,null),v(wt,Gc,null),v(wt,od,NaN)),r(wt,rd)&&(r(wt,rd).abort(),v(wt,rd,null),v(wt,Uc,NaN),v(wt,Vc,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),e&&n.drawLayer.updateProperties(this._currentDrawId,r(wt,$n).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=r(wt,$n),s=this._currentDrawId,o=i.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(s,i.setLastElement(o))},undo:()=>{n.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(te.DRAW_STEP),!r(wt,$n).isEmpty()){const{pageDimensions:[i,s],scale:o}=n,l=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:r(wt,$n).getOutlines(i*o,s*o,o,this._INNER_MARGIN),drawingOptions:r(wt,ad),mustBeCommitted:!e});return this._cleanup(!0),l}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,i,s,o,l){Ee("Not implemented")}static async deserialize(e,n,i){var g,m;const{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}=n.viewport,d=this.deserializeDraw(l,h,s,o,this._INNER_MARGIN,e),p=await super.deserialize(e,n,i);return p.createDrawingOptions(e),A(g=p,se,PC).call(g,{drawOutlines:d}),A(m=p,se,$y).call(m),p.onScaleChanging(),p.rotate(),p}serializeDraw(e){const[n,i]=this.pageTranslation,[s,o]=this.pageDimensions;return r(this,Ls).serialize([n,i,s,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ls=new WeakMap,pg=new WeakMap,$n=new WeakMap,rd=new WeakMap,ad=new WeakMap,Uc=new WeakMap,Gc=new WeakMap,Vc=new WeakMap,od=new WeakMap,se=new WeakSet,PC=function({drawOutlines:e,drawId:n,drawingOptions:i}){v(this,Ls,e),this._drawingOptions||(this._drawingOptions=i),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=A(this,se,RC).call(this,e,this.parent),A(this,se,jy).call(this,e.box)},RC=function(e,n){const{id:i}=n.drawLayer.draw(wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i},LC=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},$y=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,se,RC).call(this,r(this,Ls),e)}},lO=function([e,n,i,s]){const{parentDimensions:[o,l],rotation:h}=this;switch(h){case 90:return[n,1-e,i*(l/o),s*(o/l)];case 180:return[1-e,1-n,i,s];case 270:return[1-n,e,i*(l/o),s*(o/l)];default:return[e,n,i,s]}},gw=function(){const{x:e,y:n,width:i,height:s,parentDimensions:[o,l],rotation:h}=this;switch(h){case 90:return[1-n,e,i*(o/l),s*(l/o)];case 180:return[1-e,1-n,i,s];case 270:return[n,1-e,i*(o/l),s*(l/o)];default:return[e,n,i,s]}},jy=function(e){if([this.x,this.y,this.width,this.height]=A(this,se,lO).call(this,e),this.div){this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)}this._onResized()},rp=function(){const{x:e,y:n,width:i,height:s,rotation:o,parentRotation:l,parentDimensions:[h,d]}=this;switch((o*4+l)/90){case 1:return[1-n-s,e,s,i];case 2:return[1-e-i,1-n-s,i,s];case 3:return[n,1-e-i,s,i];case 4:return[e,n-i*(h/d),s*(d/h),i*(h/d)];case 5:return[1-n,e,i*(h/d),s*(d/h)];case 6:return[1-e-s*(d/h),1-n,s*(d/h),i*(h/d)];case 7:return[n-i*(h/d),1-e-s*(d/h),i*(h/d),s*(d/h)];case 8:return[e-i,n-s,i,s];case 9:return[1-n,e-i,s,i];case 10:return[1-e,1-n,i,s];case 11:return[n-s,1-e,s,i];case 12:return[e-s*(d/h),n,s*(d/h),i*(h/d)];case 13:return[1-n-i*(h/d),e-s*(d/h),i*(h/d),s*(d/h)];case 14:return[1-e,1-n-i*(h/d),s*(d/h),i*(h/d)];case 15:return[n,1-e,i*(h/d),s*(d/h)];default:return[e,n,i,s]}},lt(wt,"_currentDrawId",-1),lt(wt,"_currentParent",null),E(wt,$n,null),E(wt,rd,null),E(wt,ad,null),E(wt,Uc,NaN),E(wt,Gc,null),E(wt,Vc,null),E(wt,od,NaN),lt(wt,"_INNER_MARGIN",3);let kC=wt;var ja,jn,Hn,ld,gg,$i,ei,cr,cd,hd,ud,mg,mw;class f3{constructor(t,e,n,i,s,o){E(this,mg);E(this,ja,new Float64Array(6));E(this,jn);E(this,Hn);E(this,ld);E(this,gg);E(this,$i);E(this,ei,"");E(this,cr,0);E(this,cd,new tE);E(this,hd);E(this,ud);v(this,hd,n),v(this,ud,i),v(this,ld,s),v(this,gg,o),[t,e]=A(this,mg,mw).call(this,t,e);const l=v(this,jn,[NaN,NaN,NaN,NaN,t,e]);v(this,$i,[t,e]),v(this,Hn,[{line:l,points:r(this,$i)}]),r(this,ja).set(l,0)}updateProperty(t,e){t==="stroke-width"&&v(this,gg,e)}isEmpty(){return!r(this,Hn)||r(this,Hn).length===0}isCancellable(){return r(this,$i).length<=10}add(t,e){[t,e]=A(this,mg,mw).call(this,t,e);const[n,i,s,o]=r(this,ja).subarray(2,6),l=t-s,h=e-o;return Math.hypot(r(this,hd)*l,r(this,ud)*h)<=2?null:(r(this,$i).push(t,e),isNaN(n)?(r(this,ja).set([s,o,t,e],2),r(this,jn).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(r(this,ja)[0])&&r(this,jn).splice(6,6),r(this,ja).set([n,i,s,o,t,e],0),r(this,jn).push(...Et.createBezierPoints(n,i,s,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(r(this,$i).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,s){v(this,hd,n),v(this,ud,i),v(this,ld,s),[t,e]=A(this,mg,mw).call(this,t,e);const o=v(this,jn,[NaN,NaN,NaN,NaN,t,e]);v(this,$i,[t,e]);const l=r(this,Hn).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),r(this,Hn).push({line:o,points:r(this,$i)}),r(this,ja).set(o,0),v(this,cr,0),this.toSVGPath(),null}getLastElement(){return r(this,Hn).at(-1)}setLastElement(t){return r(this,Hn)?(r(this,Hn).push(t),v(this,jn,t.line),v(this,$i,t.points),v(this,cr,0),{path:{d:this.toSVGPath()}}):r(this,cd).setLastElement(t)}removeLastElement(){if(!r(this,Hn))return r(this,cd).removeLastElement();r(this,Hn).pop(),v(this,ei,"");for(let t=0,e=r(this,Hn).length;t<e;t++){const{line:n,points:i}=r(this,Hn)[t];v(this,jn,n),v(this,$i,i),v(this,cr,0),this.toSVGPath()}return{path:{d:r(this,ei)}}}toSVGPath(){const t=Et.svgRound(r(this,jn)[4]),e=Et.svgRound(r(this,jn)[5]);if(r(this,$i).length===2)return v(this,ei,`${r(this,ei)} M ${t} ${e} Z`),r(this,ei);if(r(this,$i).length<=6){const i=r(this,ei).lastIndexOf("M");v(this,ei,`${r(this,ei).slice(0,i)} M ${t} ${e}`),v(this,cr,6)}if(r(this,$i).length===4){const i=Et.svgRound(r(this,jn)[10]),s=Et.svgRound(r(this,jn)[11]);return v(this,ei,`${r(this,ei)} L ${i} ${s}`),v(this,cr,12),r(this,ei)}const n=[];r(this,cr)===0&&(n.push(`M ${t} ${e}`),v(this,cr,6));for(let i=r(this,cr),s=r(this,jn).length;i<s;i+=6){const[o,l,h,d,p,g]=r(this,jn).slice(i,i+6).map(Et.svgRound);n.push(`C${o} ${l} ${h} ${d} ${p} ${g}`)}return v(this,ei,r(this,ei)+n.join(" ")),v(this,cr,r(this,jn).length),r(this,ei)}getOutlines(t,e,n,i){const s=r(this,Hn).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),r(this,cd).build(r(this,Hn),t,e,n,r(this,ld),r(this,gg),i),v(this,ja,null),v(this,jn,null),v(this,Hn,null),v(this,ei,null),r(this,cd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ja=new WeakMap,jn=new WeakMap,Hn=new WeakMap,ld=new WeakMap,gg=new WeakMap,$i=new WeakMap,ei=new WeakMap,cr=new WeakMap,cd=new WeakMap,hd=new WeakMap,ud=new WeakMap,mg=new WeakSet,mw=function(t,e){return Et._normalizePoint(t,e,r(this,hd),r(this,ud),r(this,ld))};var ji,Db,Fb,Ms,Ha,Ba,yg,vg,bg,oi,Mo,cO,hO,uO;const Fk=class Fk extends Et{constructor(){super(...arguments);E(this,oi);E(this,ji);E(this,Db,0);E(this,Fb);E(this,Ms);E(this,Ha);E(this,Ba);E(this,yg);E(this,vg);E(this,bg)}build(e,n,i,s,o,l,h){v(this,Ha,n),v(this,Ba,i),v(this,yg,s),v(this,vg,o),v(this,bg,l),v(this,Fb,h??0),v(this,Ms,e),A(this,oi,hO).call(this)}setLastElement(e){return r(this,Ms).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return r(this,Ms).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of r(this,Ms)){if(e.push(`M${Et.svgRound(n[4])} ${Et.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12){e.push(`L${Et.svgRound(n[10])} ${Et.svgRound(n[11])}`);continue}for(let i=6,s=n.length;i<s;i+=6){const[o,l,h,d,p,g]=n.subarray(i,i+6).map(Et.svgRound);e.push(`C${o} ${l} ${h} ${d} ${p} ${g}`)}}return e.join("")}serialize([e,n,i,s],o){const l=[],h=[],[d,p,g,m]=A(this,oi,cO).call(this);let b,_,S,C,T,k,P,L,I;switch(r(this,vg)){case 0:I=Et._rescale,b=e,_=n+s,S=i,C=-s,T=e+d*i,k=n+(1-p-m)*s,P=e+(d+g)*i,L=n+(1-p)*s;break;case 90:I=Et._rescaleAndSwap,b=e,_=n,S=i,C=s,T=e+p*i,k=n+d*s,P=e+(p+m)*i,L=n+(d+g)*s;break;case 180:I=Et._rescale,b=e+i,_=n,S=-i,C=s,T=e+(1-d-g)*i,k=n+p*s,P=e+(1-d)*i,L=n+(p+m)*s;break;case 270:I=Et._rescaleAndSwap,b=e+i,_=n+s,S=-i,C=-s,T=e+(1-p-m)*i,k=n+(1-d-g)*s,P=e+(1-p)*i,L=n+(1-d)*s;break}for(const{line:D,points:F}of r(this,Ms))l.push(I(D,b,_,S,C,o?new Array(D.length):null)),h.push(I(F,b,_,S,C,o?new Array(F.length):null));return{lines:l,points:h,rect:[T,k,P,L]}}static deserialize(e,n,i,s,o,{paths:{lines:l,points:h},rotation:d,thickness:p}){const g=[];let m,b,_,S,C;switch(d){case 0:C=Et._rescale,m=-e/i,b=n/s+1,_=1/i,S=-1/s;break;case 90:C=Et._rescaleAndSwap,m=-n/s,b=-e/i,_=1/s,S=1/i;break;case 180:C=Et._rescale,m=e/i+1,b=-n/s,_=-1/i,S=1/s;break;case 270:C=Et._rescaleAndSwap,m=n/s+1,b=e/i+1,_=-1/s,S=-1/i;break}if(!l){l=[];for(const k of h){const P=k.length;if(P===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(P===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const L=new Float32Array(3*(P-2));l.push(L);let[I,D,F,H]=k.subarray(0,4);L.set([NaN,NaN,NaN,NaN,I,D],0);for(let j=4;j<P;j+=2){const Q=k[j],V=k[j+1];L.set(Et.createBezierPoints(I,D,F,H,Q,V),(j-2)*3),[I,D,F,H]=[F,H,Q,V]}}}for(let k=0,P=l.length;k<P;k++)g.push({line:C(l[k].map(L=>L??NaN),m,b,_,S),points:C(h[k].map(L=>L??NaN),m,b,_,S)});const T=new Fk;return T.build(g,i,s,1,d,p,o),T}get box(){return r(this,ji)}updateProperty(e,n){return e==="stroke-width"?A(this,oi,uO).call(this,n):null}updateParentDimensions([e,n],i){const[s,o]=A(this,oi,Mo).call(this);v(this,Ha,e),v(this,Ba,n),v(this,yg,i);const[l,h]=A(this,oi,Mo).call(this),d=l-s,p=h-o,g=r(this,ji);return g[0]-=d,g[1]-=p,g[2]+=2*d,g[3]+=2*p,g}updateRotation(e){return v(this,Db,e),{path:{transform:this.rotationTransform}}}get viewBox(){return r(this,ji).map(Et.svgRound).join(" ")}get defaultProperties(){const[e,n]=r(this,ji);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Et.svgRound(e)} ${Et.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=r(this,ji);let i=0,s=0,o=0,l=0,h=0,d=0;switch(r(this,Db)){case 90:s=n/e,o=-e/n,h=e;break;case 180:i=-1,l=-1,h=e,d=n;break;case 270:s=-n/e,o=e/n,d=n;break;default:return""}return`matrix(${i} ${s} ${o} ${l} ${Et.svgRound(h)} ${Et.svgRound(d)})`}getPathResizingSVGProperties([e,n,i,s]){const[o,l]=A(this,oi,Mo).call(this),[h,d,p,g]=r(this,ji);if(Math.abs(p-o)<=Et.PRECISION||Math.abs(g-l)<=Et.PRECISION){const C=e+i/2-(h+p/2),T=n+s/2-(d+g/2);return{path:{"transform-origin":`${Et.svgRound(e)} ${Et.svgRound(n)}`,transform:`${this.rotationTransform} translate(${C} ${T})`}}}const m=(i-2*o)/(p-2*o),b=(s-2*l)/(g-2*l),_=p/i,S=g/s;return{path:{"transform-origin":`${Et.svgRound(h)} ${Et.svgRound(d)}`,transform:`${this.rotationTransform} scale(${_} ${S}) translate(${Et.svgRound(o)} ${Et.svgRound(l)}) scale(${m} ${b}) translate(${Et.svgRound(-o)} ${Et.svgRound(-l)})`}}}getPathResizedSVGProperties([e,n,i,s]){const[o,l]=A(this,oi,Mo).call(this),h=r(this,ji),[d,p,g,m]=h;if(h[0]=e,h[1]=n,h[2]=i,h[3]=s,Math.abs(g-o)<=Et.PRECISION||Math.abs(m-l)<=Et.PRECISION){const T=e+i/2-(d+g/2),k=n+s/2-(p+m/2);for(const{line:P,points:L}of r(this,Ms))Et._translate(P,T,k,P),Et._translate(L,T,k,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Et.svgRound(e)} ${Et.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(i-2*o)/(g-2*o),_=(s-2*l)/(m-2*l),S=-b*(d+o)+e+o,C=-_*(p+l)+n+l;if(b!==1||_!==1||S!==0||C!==0)for(const{line:T,points:k}of r(this,Ms))Et._rescale(T,S,C,b,_,T),Et._rescale(k,S,C,b,_,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Et.svgRound(e)} ${Et.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],i){const[s,o]=i,l=r(this,ji),h=e-l[0],d=n-l[1];if(r(this,Ha)===s&&r(this,Ba)===o)for(const{line:p,points:g}of r(this,Ms))Et._translate(p,h,d,p),Et._translate(g,h,d,g);else{const p=r(this,Ha)/s,g=r(this,Ba)/o;v(this,Ha,s),v(this,Ba,o);for(const{line:m,points:b}of r(this,Ms))Et._rescale(m,h,d,p,g,m),Et._rescale(b,h,d,p,g,b);l[2]*=p,l[3]*=g}return l[0]=e,l[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Et.svgRound(e)} ${Et.svgRound(n)}`}}}get defaultSVGProperties(){const e=r(this,ji);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Et.svgRound(e[0])} ${Et.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};ji=new WeakMap,Db=new WeakMap,Fb=new WeakMap,Ms=new WeakMap,Ha=new WeakMap,Ba=new WeakMap,yg=new WeakMap,vg=new WeakMap,bg=new WeakMap,oi=new WeakSet,Mo=function(e=r(this,bg)){const n=r(this,Fb)+e/2*r(this,yg);return r(this,vg)%180===0?[n/r(this,Ha),n/r(this,Ba)]:[n/r(this,Ba),n/r(this,Ha)]},cO=function(){const[e,n,i,s]=r(this,ji),[o,l]=A(this,oi,Mo).call(this,0);return[e+o,n+l,i-2*o,s-2*l]},hO=function(){const e=v(this,ji,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of r(this,Ms)){if(s.length<=12){for(let h=4,d=s.length;h<d;h+=6){const[p,g]=s.subarray(h,h+2);e[0]=Math.min(e[0],p),e[1]=Math.min(e[1],g),e[2]=Math.max(e[2],p),e[3]=Math.max(e[3],g)}continue}let o=s[4],l=s[5];for(let h=6,d=s.length;h<d;h+=6){const[p,g,m,b,_,S]=s.subarray(h,h+6);Rt.bezierBoundingBox(o,l,p,g,m,b,_,S,e),o=_,l=S}}const[n,i]=A(this,oi,Mo).call(this);e[0]=Math.min(1,Math.max(0,e[0]-n)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+n)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]},uO=function(e){const[n,i]=A(this,oi,Mo).call(this);v(this,bg,e);const[s,o]=A(this,oi,Mo).call(this),[l,h]=[s-n,o-i],d=r(this,ji);return d[0]-=l,d[1]-=h,d[2]+=2*l,d[3]+=2*h,d};let tE=Fk;var Ag;const Ok=class Ok extends d3{constructor(e){super();E(this,Ag);v(this,Ag,e),super.updateProperties({fill:"none",stroke:rn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,n){e==="stroke-width"&&(n??(n=this["stroke-width"]),n*=r(this,Ag).realScale),super.updateSVGProperty(e,n)}clone(){const e=new Ok(r(this,Ag));return e.updateAll(this),e}};Ag=new WeakMap;let MC=Ok;var il,AE,dO;let p3=(il=class extends kC{constructor(e){super({...e,name:"inkEditor"});E(this,AE);this._willKeepAspectRatio=!0}static initialize(e,n){rn.initialize(e,n),this._defaultDrawingOptions=new MC(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Kt(this,"typesMap",new Map([[te.INK_THICKNESS,"stroke-width"],[te.INK_COLOR,"stroke"],[te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,i,s,o){return new f3(e,n,i,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,i,s,o,l){return tE.deserialize(e,n,i,s,o,l)}static async deserialize(e,n,i){let s=null;if(e instanceof yk){const{data:{inkLists:l,rect:h,rotation:d,id:p,color:g,opacity:m,borderStyle:{rawWidth:b},popupRef:_},parent:{page:{pageNumber:S}}}=e;s=e={annotationType:zt.INK,color:Array.from(g),thickness:b,opacity:m,paths:{points:l},boxes:null,pageIndex:S-1,rect:h.slice(0),rotation:d,id:p,deleted:!1,popupRef:_}}const o=await super.deserialize(e,n,i);return o.annotationElementId=e.id||null,o._initialData=s,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:i}=this;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:i}){this._drawingOptions=il.getDefaultDrawingOptions({stroke:Rt.makeHexColor(...e),"stroke-width":n,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:i,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":h}}=this,d={annotationType:zt.INK,color:rn._colorManager.convert(o),opacity:l,thickness:h,paths:{lines:n,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?d:this.annotationElementId&&!A(this,AE,dO).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(e){const{points:n,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:n}),null}},AE=new WeakSet,dO=function(e){const{color:n,thickness:i,opacity:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((l,h)=>l!==n[h])||e.thickness!==i||e.opacity!==s||e.pageIndex!==o},lt(il,"_type","ink"),lt(il,"_editorType",zt.INK),lt(il,"_defaultDrawingOptions",null),il);var ze,ni,Wc,sl,qc,_g,za,Ua,Is,wg,Xc,ae,Hy,By,yw,IC,vw,DC,bw,fO;let g3=(Xc=class extends rn{constructor(e){super({...e,name:"stampEditor"});E(this,ae);E(this,ze,null);E(this,ni,null);E(this,Wc,null);E(this,sl,null);E(this,qc,null);E(this,_g,"");E(this,za,null);E(this,Ua,null);E(this,Is,!1);E(this,wg,!1);v(this,sl,e.bitmapUrl),v(this,qc,e.bitmapFile)}static initialize(e,n){rn.initialize(e,n)}static get supportedTypes(){return Kt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Kt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,n){n.pasteEditor(zt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=e||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const d=h.output;return await this.setGuessedAltText(d),n&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var e;r(this,ni)&&(v(this,ze,null),this._uiManager.imageManager.deleteId(r(this,ni)),(e=r(this,za))==null||e.remove(),v(this,za,null),r(this,Ua)&&(clearTimeout(r(this,Ua)),v(this,Ua,null))),super.remove()}rebuild(){if(!this.parent){r(this,ni)&&A(this,ae,yw).call(this);return}super.rebuild(),this.div!==null&&(r(this,ni)&&r(this,za)===null&&A(this,ae,yw).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(r(this,Wc)||r(this,ze)||r(this,sl)||r(this,qc)||r(this,ni))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;if(this.width&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,ze)?A(this,ae,IC).call(this):A(this,ae,yw).call(this),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(e*i,n*s,this.width*i,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;r(this,Ua)!==null&&clearTimeout(r(this,Ua)),v(this,Ua,setTimeout(()=>{v(this,Ua,null),A(this,ae,DC).call(this)},200))}copyCanvas(e,n,i=!1){var b;e||(e=224);const{width:s,height:o}=r(this,ze),l=new Nx;let h=r(this,ze),d=s,p=o,g=null;if(n){if(s>n||o>n){const H=Math.min(n/s,n/o);d=Math.floor(s*H),p=Math.floor(o*H)}g=document.createElement("canvas");const _=g.width=Math.ceil(d*l.sx),S=g.height=Math.ceil(p*l.sy);r(this,Is)||(h=A(this,ae,vw).call(this,_,S));const C=g.getContext("2d");C.filter=this._uiManager.hcmFilter;let T="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(b=window.matchMedia)!=null&&b.call(window,"(prefers-color-scheme: dark)").matches&&(T="#8f8f9d",k="#42414d");const P=15,L=P*l.sx,I=P*l.sy,D=new OffscreenCanvas(L*2,I*2),F=D.getContext("2d");F.fillStyle=T,F.fillRect(0,0,L*2,I*2),F.fillStyle=k,F.fillRect(0,0,L,I),F.fillRect(L,I,L,I),C.fillStyle=C.createPattern(D,"repeat"),C.fillRect(0,0,_,S),C.drawImage(h,0,0,h.width,h.height,0,0,_,S)}let m=null;if(i){let _,S;if(l.symmetric&&h.width<e&&h.height<e)_=h.width,S=h.height;else if(h=r(this,ze),s>e||o>e){const k=Math.min(e/s,e/o);_=Math.floor(s*k),S=Math.floor(o*k),r(this,Is)||(h=A(this,ae,vw).call(this,_,S))}const T=new OffscreenCanvas(_,S).getContext("2d",{willReadFrequently:!0});T.drawImage(h,0,0,h.width,h.height,0,0,_,S),m={width:_,height:S,data:T.getImageData(0,0,_,S).data}}return{canvas:g,width:d,height:p,imageData:m}}getImageForAltText(){return r(this,za)}static async deserialize(e,n,i){var S;let s=null;if(e instanceof MF){const{data:{rect:C,rotation:T,id:k,structParent:P,popupRef:L},container:I,parent:{page:{pageNumber:D}}}=e,F=I.querySelector("canvas"),H=i.imageManager.getFromCanvas(I.id,F);F.remove();const j=((S=await n._structTree.getAriaAttributes(`${ck}${k}`))==null?void 0:S.get("aria-label"))||"";s=e={annotationType:zt.STAMP,bitmapId:H.id,bitmap:H.bitmap,pageIndex:D-1,rect:C.slice(0),rotation:T,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:P,popupRef:L}}const o=await super.deserialize(e,n,i),{rect:l,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:g,accessibilityData:m}=e;p&&i.imageManager.isValidId(p)?(v(o,ni,p),h&&v(o,ze,h)):v(o,sl,d),v(o,Is,g);const[b,_]=o.pageDimensions;return o.width=(l[2]-l[0])/b,o.height=(l[3]-l[1])/_,o.annotationElementId=e.id||null,m&&(o.altTextData=m),o._initialData=s,v(o,wg,!!s),o}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:zt.STAMP,bitmapId:r(this,ni),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,Is),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=A(this,ae,bw).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const h=A(this,ae,fO).call(this,i);if(h.isSame)return null;h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const l=r(this,Is)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(r(this,ni)))n.stamps.set(r(this,ni),{area:l,serialized:i}),i.bitmap=A(this,ae,bw).call(this,!1);else if(r(this,Is)){const h=n.stamps.get(r(this,ni));l>h.area&&(h.area=l,h.serialized.bitmap.close(),h.serialized.bitmap=A(this,ae,bw).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},ze=new WeakMap,ni=new WeakMap,Wc=new WeakMap,sl=new WeakMap,qc=new WeakMap,_g=new WeakMap,za=new WeakMap,Ua=new WeakMap,Is=new WeakMap,wg=new WeakMap,ae=new WeakSet,Hy=function(e,n=!1){if(!e){this.remove();return}v(this,ze,e.bitmap),n||(v(this,ni,e.id),v(this,Is,e.isSvg)),e.file&&v(this,_g,e.file.name),A(this,ae,IC).call(this)},By=function(){if(v(this,Wc,null),this._uiManager.enableWaiting(!1),!!r(this,za)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,ze)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,ze)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},yw=function(){if(r(this,ni)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,ni)).then(i=>A(this,ae,Hy).call(this,i,!0)).finally(()=>A(this,ae,By).call(this));return}if(r(this,sl)){const i=r(this,sl);v(this,sl,null),this._uiManager.enableWaiting(!0),v(this,Wc,this._uiManager.imageManager.getFromUrl(i).then(s=>A(this,ae,Hy).call(this,s)).finally(()=>A(this,ae,By).call(this)));return}if(r(this,qc)){const i=r(this,qc);v(this,qc,null),this._uiManager.enableWaiting(!0),v(this,Wc,this._uiManager.imageManager.getFromFile(i).then(s=>A(this,ae,Hy).call(this,s)).finally(()=>A(this,ae,By).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Xc.supportedTypesStr;const n=this._uiManager._signal;v(this,Wc,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,ae,Hy).call(this,s)}i()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>A(this,ae,By).call(this))),e.click()},IC=function(){var g;const{div:e}=this;let{width:n,height:i}=r(this,ze);const[s,o]=this.pageDimensions,l=.75;if(this.width)n=this.width*s,i=this.height*o;else if(n>l*s||i>l*o){const m=Math.min(l*s/n,l*o/i);n*=m,i*=m}const[h,d]=this.parentDimensions;this.setDims(n*h/s,i*d/o),this._uiManager.enableWaiting(!1);const p=v(this,za,document.createElement("canvas"));p.setAttribute("role","img"),this.addContainer(p),this.width=n/s,this.height=i/o,(g=this._initialOptions)!=null&&g.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),A(this,ae,DC).call(this),r(this,wg)||(this.parent.addUndoableEditor(this),v(this,wg,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,_g)&&p.setAttribute("aria-label",r(this,_g))},vw=function(e,n){const{width:i,height:s}=r(this,ze);let o=i,l=s,h=r(this,ze);for(;o>2*e||l>2*n;){const d=o,p=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*n&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(h,0,0,d,p,0,0,o,l),h=g.transferToImageBitmap()}return h},DC=function(){const[e,n]=this.parentDimensions,{width:i,height:s}=this,o=new Nx,l=Math.ceil(i*e*o.sx),h=Math.ceil(s*n*o.sy),d=r(this,za);if(!d||d.width===l&&d.height===h)return;d.width=l,d.height=h;const p=r(this,Is)?r(this,ze):A(this,ae,vw).call(this,l,h),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(p,0,0,p.width,p.height,0,0,l,h)},bw=function(e){if(e){if(r(this,Is)){const s=this._uiManager.imageManager.getSvgUrl(r(this,ni));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=r(this,ze),n.getContext("2d").drawImage(r(this,ze),0,0),n.toDataURL()}if(r(this,Is)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*Em.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Em.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(r(this,ze),0,0,r(this,ze).width,r(this,ze).height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(r(this,ze))},fO=function(e){var l;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===n,o=(((l=e.accessibilityData)==null?void 0:l.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},lt(Xc,"_type","stamp"),lt(Xc,"_editorType",zt.STAMP),Xc);var dd,Eg,Ga,Yc,rl,hr,Kc,Sg,fd,Kr,al,Ei,ol,kt,ds,Qc,Ne,pO,Ta,FC,OC,Aw;let m3=(ds=class{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:h,viewport:d,l10n:p}){E(this,Ne);E(this,dd);E(this,Eg,!1);E(this,Ga,null);E(this,Yc,null);E(this,rl,null);E(this,hr,new Map);E(this,Kc,!1);E(this,Sg,!1);E(this,fd,!1);E(this,Kr,null);E(this,al,null);E(this,Ei,null);E(this,ol,null);E(this,kt);const g=[...r(ds,Qc).values()];if(!ds._initialized){ds._initialized=!0;for(const m of g)m.initialize(p,t)}t.registerEditorTypes(g),v(this,kt,t),this.pageIndex=e,this.div=n,v(this,dd,s),v(this,Ga,o),this.viewport=d,v(this,Ei,h),this.drawLayer=l,this._structTree=i,r(this,kt).addLayer(this)}get isEmpty(){return r(this,hr).size===0}get isInvisible(){return this.isEmpty&&r(this,kt).getMode()===zt.NONE}updateToolbar(t){r(this,kt).updateToolbar(t)}updateMode(t=r(this,kt).getMode()){switch(A(this,Ne,Aw).call(this),t){case zt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case zt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case zt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of r(ds,Qc).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,Ei))==null?void 0:e.div)}setEditingState(t){r(this,kt).setEditingState(t)}addCommands(t){r(this,kt).addCommands(t)}cleanUndoStack(t){r(this,kt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,Ga))==null||e.div.classList.toggle("disabled",!t)}async enable(){v(this,fd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of r(this,hr).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(r(this,kt).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!r(this,Ga)){v(this,fd,!1);return}const e=r(this,Ga).getEditableAnnotations();for(const n of e){if(n.hide(),r(this,kt).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}v(this,fd,!1)}disable(){var i;v(this,Sg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of r(this,hr).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(i=this.getEditableAnnotation(s.annotationElementId))==null||i.show(),s.remove()}if(r(this,Ga)){const s=r(this,Ga).getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(r(this,kt).isDeletedAnnotationElement(l))continue;let h=e.get(l);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=t.get(l),h&&(r(this,kt).addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}A(this,Ne,Aw).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of r(ds,Qc).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,Sg,!1)}getEditableAnnotation(t){var e;return((e=r(this,Ga))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,kt).getActive()!==t&&r(this,kt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,Ei))!=null&&t.div&&!r(this,ol)){v(this,ol,new AbortController);const e=r(this,kt).combinedSignal(r(this,ol));r(this,Ei).div.addEventListener("pointerdown",A(this,Ne,pO).bind(this),{signal:e}),r(this,Ei).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,Ei))!=null&&t.div&&r(this,ol)&&(r(this,ol).abort(),v(this,ol,null),r(this,Ei).div.classList.remove("highlighting"))}enableClick(){if(r(this,Yc))return;v(this,Yc,new AbortController);const t=r(this,kt).combinedSignal(r(this,Yc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=r(this,Yc))==null||t.abort(),v(this,Yc,null)}attach(t){r(this,hr).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,kt).isDeletedAnnotationElement(e)&&r(this,kt).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,hr).delete(t.id),(e=r(this,dd))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,Sg)&&t.annotationElementId&&r(this,kt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,kt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,kt).addDeletedAnnotationElement(t.annotationElementId),rn.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,kt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!r(this,fd)),r(this,kt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,rl)&&(t._focusEventsAllowed=!1,v(this,rl,setTimeout(()=>{v(this,rl,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,kt)._signal}),e.focus())},0))),t._structTreeParentId=(n=r(this,dd))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return r(this,kt).getId()}combinedSignal(t){return r(this,kt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,Ne,Ta))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,kt).updateToolbar(t),r(this,kt).updateMode(t);const{offsetX:n,offsetY:i}=A(this,Ne,OC).call(this),s=this.getNextId(),o=A(this,Ne,FC).call(this,{parent:this,id:s,x:n,y:i,uiManager:r(this,kt),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=r(ds,Qc).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,kt)))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),s=A(this,Ne,FC).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:r(this,kt),isCentered:e,...n});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(A(this,Ne,OC).call(this),!0)}setSelected(t){r(this,kt).setSelected(t)}toggleSelected(t){r(this,kt).toggleSelected(t)}unselect(t){r(this,kt).unselect(t)}pointerup(t){var n;const{isMac:e}=zi.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,Kc)&&(v(this,Kc,!1),!((n=r(this,Ne,Ta))!=null&&n.isDrawer&&r(this,Ne,Ta).supportMultipleDrawings))){if(!r(this,Eg)){v(this,Eg,!0);return}if(r(this,kt).getMode()===zt.STAMP){r(this,kt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var i;if(r(this,kt).getMode()===zt.HIGHLIGHT&&this.enableTextSelection(),r(this,Kc)){v(this,Kc,!1);return}const{isMac:e}=zi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(v(this,Kc,!0),(i=r(this,Ne,Ta))!=null&&i.isDrawer){this.startDrawingSession(t);return}const n=r(this,kt).getActive();v(this,Eg,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus(),r(this,Kr)){r(this,Ne,Ta).startDrawing(this,r(this,kt),!1,t);return}r(this,kt).setCurrentDrawingSession(this),v(this,Kr,new AbortController);const e=r(this,kt).combinedSignal(r(this,Kr));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(v(this,al,null),this.commitOrRemove())},{signal:e}),r(this,Ne,Ta).startDrawing(this,r(this,kt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&v(this,al,e);return}r(this,al)&&setTimeout(()=>{var e;(e=r(this,al))==null||e.focus(),v(this,al,null)},0)}endDrawingSession(t=!1){return r(this,Kr)?(r(this,kt).setCurrentDrawingSession(null),r(this,Kr).abort(),v(this,Kr,null),v(this,al,null),r(this,Ne,Ta).endDrawing(t)):null}findNewParent(t,e,n){const i=r(this,kt).findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return r(this,Kr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){r(this,Kr)&&r(this,Ne,Ta).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=r(this,kt).getActive())==null?void 0:t.parent)===this&&(r(this,kt).commitOrRemove(),r(this,kt).setActiveEditor(null)),r(this,rl)&&(clearTimeout(r(this,rl)),v(this,rl,null));for(const n of r(this,hr).values())(e=r(this,dd))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,r(this,hr).clear(),r(this,kt).removeLayer(this)}render({viewport:t}){this.viewport=t,ff(this.div,t);for(const e of r(this,kt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,kt).commitOrRemove(),A(this,Ne,Aw).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,ff(this.div,{rotation:n}),e!==n)for(const i of r(this,hr).values())i.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,kt).viewParameters.realScale}},dd=new WeakMap,Eg=new WeakMap,Ga=new WeakMap,Yc=new WeakMap,rl=new WeakMap,hr=new WeakMap,Kc=new WeakMap,Sg=new WeakMap,fd=new WeakMap,Kr=new WeakMap,al=new WeakMap,Ei=new WeakMap,ol=new WeakMap,kt=new WeakMap,Qc=new WeakMap,Ne=new WeakSet,pO=function(t){r(this,kt).unselectAll();const{target:e}=t;if(e===r(this,Ei).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,Ei).div.contains(e)){const{isMac:n}=zi.platform;if(t.button!==0||t.ctrlKey&&n)return;r(this,kt).showAllEditors("highlight",!0,!0),r(this,Ei).div.classList.add("free"),this.toggleDrawing(),eM.startHighlighting(this,r(this,kt).direction==="ltr",{target:r(this,Ei).div,x:t.x,y:t.y}),r(this,Ei).div.addEventListener("pointerup",()=>{r(this,Ei).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,kt)._signal}),t.preventDefault()}},Ta=function(){return r(ds,Qc).get(r(this,kt).getMode())},FC=function(t){const e=r(this,Ne,Ta);return e?new e.prototype.constructor(t):null},OC=function(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),o=Math.max(0,e),l=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),d=(s+l)/2-t,p=(o+h)/2-e,[g,m]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:g,offsetY:m}},Aw=function(){for(const t of r(this,hr).values())t.isEmpty()&&t.remove()},lt(ds,"_initialized",!1),E(ds,Qc,new Map([c3,p3,g3,eM].map(t=>[t._editorType,t]))),ds);var Qr,Ob,Hi,pd,_E,xn,gO,uo,NC,mO,$C;let y3=(xn=class{constructor({pageIndex:t}){E(this,uo);E(this,Qr,null);E(this,Ob,0);E(this,Hi,new Map);E(this,pd,new Map);this.pageIndex=t}setParent(t){if(!r(this,Qr)){v(this,Qr,t);return}if(r(this,Qr)!==t){if(r(this,Hi).size>0)for(const e of r(this,Hi).values())e.remove(),t.append(e);v(this,Qr,t)}}static get _svgFactory(){return Kt(this,"_svgFactory",new mk)}draw(t,e=!1,n=!1){const i=he(this,Ob)._++,s=A(this,uo,NC).call(this),o=xn._svgFactory.createElement("defs");s.append(o);const l=xn._svgFactory.createElement("path");o.append(l);const h=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",h),l.setAttribute("vector-effect","non-scaling-stroke"),e&&r(this,pd).set(i,l);const d=n?A(this,uo,mO).call(this,o,h):null,p=xn._svgFactory.createElement("use");return s.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(s,t),r(this,Hi).set(i,s),{id:i,clipPathId:`url(#${d})`}}drawOutline(t,e){const n=he(this,Ob)._++,i=A(this,uo,NC).call(this),s=xn._svgFactory.createElement("defs");i.append(s);const o=xn._svgFactory.createElement("path");s.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const g=xn._svgFactory.createElement("mask");s.append(g),h=`mask_p${this.pageIndex}_${n}`,g.setAttribute("id",h),g.setAttribute("maskUnits","objectBoundingBox");const m=xn._svgFactory.createElement("rect");g.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const b=xn._svgFactory.createElement("use");g.append(b),b.setAttribute("href",`#${l}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const d=xn._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${l}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return i.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,t),r(this,Hi).set(n,i),n}finalizeDraw(t,e){r(this,pd).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var h;if(!e)return;const{root:n,bbox:i,rootClass:s,path:o}=e,l=typeof t=="number"?r(this,Hi).get(t):t;if(l){if(n&&A(this,uo,$C).call(this,l,n),i&&A(h=xn,_E,gO).call(h,l,i),s){const{classList:d}=l;for(const[p,g]of Object.entries(s))d.toggle(p,g)}if(o){const p=l.firstChild.firstChild;A(this,uo,$C).call(this,p,o)}}}updateParent(t,e){if(e===this)return;const n=r(this,Hi).get(t);n&&(r(e,Qr).append(n),r(this,Hi).delete(t),r(e,Hi).set(t,n))}remove(t){r(this,pd).delete(t),r(this,Qr)!==null&&(r(this,Hi).get(t).remove(),r(this,Hi).delete(t))}destroy(){v(this,Qr,null);for(const t of r(this,Hi).values())t.remove();r(this,Hi).clear(),r(this,pd).clear()}},Qr=new WeakMap,Ob=new WeakMap,Hi=new WeakMap,pd=new WeakMap,_E=new WeakSet,gO=function(t,[e,n,i,s]){const{style:o}=t;o.top=`${100*n}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},uo=new WeakSet,NC=function(){const t=xn._svgFactory.create(1,1,!0);return r(this,Qr).append(t),t.setAttribute("aria-hidden",!0),t},mO=function(t,e){const n=xn._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=xn._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i},$C=function(t,e){for(const[n,i]of Object.entries(e))i===null?t.removeAttribute(n):t.setAttribute(n,i)},E(xn,_E),xn);globalThis.pdfjsTestingUtils={HighlightOutliner:AC};Ot.AbortException;Ot.AnnotationEditorLayer;Ot.AnnotationEditorParamsType;Ot.AnnotationEditorType;Ot.AnnotationEditorUIManager;Ot.AnnotationLayer;Ot.AnnotationMode;Ot.ColorPicker;Ot.DOMSVGFactory;Ot.DrawLayer;Ot.FeatureTest;var yO=Ot.GlobalWorkerOptions;Ot.ImageKind;Ot.InvalidPDFException;Ot.MissingPDFException;Ot.OPS;Ot.OutputScale;Ot.PDFDataRangeTransport;Ot.PDFDateString;Ot.PDFWorker;Ot.PasswordResponses;Ot.PermissionFlag;Ot.PixelsPerInch;Ot.RenderingCancelledException;Ot.TextLayer;Ot.TouchManager;Ot.UnexpectedResponseException;Ot.Util;Ot.VerbosityLevel;Ot.XfaLayer;Ot.build;Ot.createValidAbsoluteUrl;Ot.fetchData;var v3=Ot.getDocument;Ot.getFilenameFromUrl;Ot.getPdfFilenameFromUrl;Ot.getXfaPageViewport;Ot.isDataScheme;Ot.isPdfFile;Ot.noContextMenu;Ot.normalizeUnicode;Ot.setLayerDimensions;Ot.shadow;Ot.stopEvent;Ot.version;const b3=u=>{var n;let t="Unknown",e=null;if(u.target.files&&u.target.files[0]){if(e=u.target.files[0],e){const i=(n=e.name.split(".").pop())==null?void 0:n.toLowerCase();i==="pdf"?t="PDF":["jpg","jpeg","png","gif"].includes(i||"")?t="Image":t="Unknown"}return{fileType:t,file:e}}};var nx={exports:{}},nM;function A3(){return nM||(nM=1,function(u){var t=function(e){var n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(U,N,M){U[N]=M.value},o,l=typeof Symbol=="function"?Symbol:{},h=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",p=l.toStringTag||"@@toStringTag";function g(U,N,M){return Object.defineProperty(U,N,{value:M,enumerable:!0,configurable:!0,writable:!0}),U[N]}try{g({},"")}catch{g=function(N,M,B){return N[M]=B}}function m(U,N,M,B){var Y=N&&N.prototype instanceof P?N:P,it=Object.create(Y.prototype),dt=new J(B||[]);return s(it,"_invoke",{value:tt(U,M,dt)}),it}e.wrap=m;function b(U,N,M){try{return{type:"normal",arg:U.call(N,M)}}catch(B){return{type:"throw",arg:B}}}var _="suspendedStart",S="suspendedYield",C="executing",T="completed",k={};function P(){}function L(){}function I(){}var D={};g(D,h,function(){return this});var F=Object.getPrototypeOf,H=F&&F(F(G([])));H&&H!==n&&i.call(H,h)&&(D=H);var j=I.prototype=P.prototype=Object.create(D);L.prototype=I,s(j,"constructor",{value:I,configurable:!0}),s(I,"constructor",{value:L,configurable:!0}),L.displayName=g(I,p,"GeneratorFunction");function Q(U){["next","throw","return"].forEach(function(N){g(U,N,function(M){return this._invoke(N,M)})})}e.isGeneratorFunction=function(U){var N=typeof U=="function"&&U.constructor;return N?N===L||(N.displayName||N.name)==="GeneratorFunction":!1},e.mark=function(U){return Object.setPrototypeOf?Object.setPrototypeOf(U,I):(U.__proto__=I,g(U,p,"GeneratorFunction")),U.prototype=Object.create(j),U},e.awrap=function(U){return{__await:U}};function V(U,N){function M(it,dt,at,nt){var vt=b(U[it],U,dt);if(vt.type==="throw")nt(vt.arg);else{var ut=vt.arg,xt=ut.value;return xt&&typeof xt=="object"&&i.call(xt,"__await")?N.resolve(xt.__await).then(function(Qt){M("next",Qt,at,nt)},function(Qt){M("throw",Qt,at,nt)}):N.resolve(xt).then(function(Qt){ut.value=Qt,at(ut)},function(Qt){return M("throw",Qt,at,nt)})}}var B;function Y(it,dt){function at(){return new N(function(nt,vt){M(it,dt,nt,vt)})}return B=B?B.then(at,at):at()}s(this,"_invoke",{value:Y})}Q(V.prototype),g(V.prototype,d,function(){return this}),e.AsyncIterator=V,e.async=function(U,N,M,B,Y){Y===void 0&&(Y=Promise);var it=new V(m(U,N,M,B),Y);return e.isGeneratorFunction(N)?it:it.next().then(function(dt){return dt.done?dt.value:it.next()})};function tt(U,N,M){var B=_;return function(it,dt){if(B===C)throw new Error("Generator is already running");if(B===T){if(it==="throw")throw dt;return q()}for(M.method=it,M.arg=dt;;){var at=M.delegate;if(at){var nt=Z(at,M);if(nt){if(nt===k)continue;return nt}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(B===_)throw B=T,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);B=C;var vt=b(U,N,M);if(vt.type==="normal"){if(B=M.done?T:S,vt.arg===k)continue;return{value:vt.arg,done:M.done}}else vt.type==="throw"&&(B=T,M.method="throw",M.arg=vt.arg)}}}function Z(U,N){var M=N.method,B=U.iterator[M];if(B===o)return N.delegate=null,M==="throw"&&U.iterator.return&&(N.method="return",N.arg=o,Z(U,N),N.method==="throw")||M!=="return"&&(N.method="throw",N.arg=new TypeError("The iterator does not provide a '"+M+"' method")),k;var Y=b(B,U.iterator,N.arg);if(Y.type==="throw")return N.method="throw",N.arg=Y.arg,N.delegate=null,k;var it=Y.arg;if(!it)return N.method="throw",N.arg=new TypeError("iterator result is not an object"),N.delegate=null,k;if(it.done)N[U.resultName]=it.value,N.next=U.nextLoc,N.method!=="return"&&(N.method="next",N.arg=o);else return it;return N.delegate=null,k}Q(j),g(j,p,"Generator"),g(j,h,function(){return this}),g(j,"toString",function(){return"[object Generator]"});function et(U){var N={tryLoc:U[0]};1 in U&&(N.catchLoc=U[1]),2 in U&&(N.finallyLoc=U[2],N.afterLoc=U[3]),this.tryEntries.push(N)}function ht(U){var N=U.completion||{};N.type="normal",delete N.arg,U.completion=N}function J(U){this.tryEntries=[{tryLoc:"root"}],U.forEach(et,this),this.reset(!0)}e.keys=function(U){var N=Object(U),M=[];for(var B in N)M.push(B);return M.reverse(),function Y(){for(;M.length;){var it=M.pop();if(it in N)return Y.value=it,Y.done=!1,Y}return Y.done=!0,Y}};function G(U){if(U){var N=U[h];if(N)return N.call(U);if(typeof U.next=="function")return U;if(!isNaN(U.length)){var M=-1,B=function Y(){for(;++M<U.length;)if(i.call(U,M))return Y.value=U[M],Y.done=!1,Y;return Y.value=o,Y.done=!0,Y};return B.next=B}}return{next:q}}e.values=G;function q(){return{value:o,done:!0}}return J.prototype={constructor:J,reset:function(U){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ht),!U)for(var N in this)N.charAt(0)==="t"&&i.call(this,N)&&!isNaN(+N.slice(1))&&(this[N]=o)},stop:function(){this.done=!0;var U=this.tryEntries[0],N=U.completion;if(N.type==="throw")throw N.arg;return this.rval},dispatchException:function(U){if(this.done)throw U;var N=this;function M(nt,vt){return it.type="throw",it.arg=U,N.next=nt,vt&&(N.method="next",N.arg=o),!!vt}for(var B=this.tryEntries.length-1;B>=0;--B){var Y=this.tryEntries[B],it=Y.completion;if(Y.tryLoc==="root")return M("end");if(Y.tryLoc<=this.prev){var dt=i.call(Y,"catchLoc"),at=i.call(Y,"finallyLoc");if(dt&&at){if(this.prev<Y.catchLoc)return M(Y.catchLoc,!0);if(this.prev<Y.finallyLoc)return M(Y.finallyLoc)}else if(dt){if(this.prev<Y.catchLoc)return M(Y.catchLoc,!0)}else if(at){if(this.prev<Y.finallyLoc)return M(Y.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(U,N){for(var M=this.tryEntries.length-1;M>=0;--M){var B=this.tryEntries[M];if(B.tryLoc<=this.prev&&i.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var Y=B;break}}Y&&(U==="break"||U==="continue")&&Y.tryLoc<=N&&N<=Y.finallyLoc&&(Y=null);var it=Y?Y.completion:{};return it.type=U,it.arg=N,Y?(this.method="next",this.next=Y.finallyLoc,k):this.complete(it)},complete:function(U,N){if(U.type==="throw")throw U.arg;return U.type==="break"||U.type==="continue"?this.next=U.arg:U.type==="return"?(this.rval=this.arg=U.arg,this.method="return",this.next="end"):U.type==="normal"&&N&&(this.next=N),k},finish:function(U){for(var N=this.tryEntries.length-1;N>=0;--N){var M=this.tryEntries[N];if(M.finallyLoc===U)return this.complete(M.completion,M.afterLoc),ht(M),k}},catch:function(U){for(var N=this.tryEntries.length-1;N>=0;--N){var M=this.tryEntries[N];if(M.tryLoc===U){var B=M.completion;if(B.type==="throw"){var Y=B.arg;ht(M)}return Y}}throw new Error("illegal catch attempt")},delegateYield:function(U,N,M){return this.delegate={iterator:G(U),resultName:N,nextLoc:M},this.method==="next"&&(this.arg=o),k}},e}(u.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(nx)),nx.exports}var ix,iM;function vk(){return iM||(iM=1,ix=(u,t)=>`${u}-${t}-${Math.random().toString(16).slice(3,8)}`),ix}var sx,sM;function vO(){if(sM)return sx;sM=1;const u=vk();let t=0;return sx=({id:e,action:n,payload:i={}})=>{let s=e;return typeof s>"u"&&(s=u("Job",t),t+=1),{id:s,action:n,payload:i}},sx}var my={},rM;function bk(){if(rM)return my;rM=1;let u=!1;return my.logging=u,my.setLogging=t=>{u=t},my.log=(...t)=>u?console.log.apply(this,t):null,my}var rx,aM;function _3(){if(aM)return rx;aM=1;const u=vO(),{log:t}=bk(),e=vk();let n=0;return rx=()=>{const i=e("Scheduler",n),s={},o={};let l=[];n+=1;const h=()=>l.length,d=()=>Object.keys(s).length,p=()=>{if(l.length!==0){const S=Object.keys(s);for(let C=0;C<S.length;C+=1)if(typeof o[S[C]]>"u"){l[0](s[S[C]]);break}}},g=(S,C)=>new Promise((T,k)=>{const P=u({action:S,payload:C});l.push(async L=>{l.shift(),o[L.id]=P;try{T(await L[S].apply(this,[...C,P.id]))}catch(I){k(I)}finally{delete o[L.id],p()}}),t(`[${i}]: Add ${P.id} to JobQueue`),t(`[${i}]: JobQueue length=${l.length}`),p()});return{addWorker:S=>(s[S.id]=S,t(`[${i}]: Add ${S.id}`),t(`[${i}]: Number of workers=${d()}`),p(),S.id),addJob:async(S,...C)=>{if(d()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return g(S,C)},terminate:async()=>{Object.keys(s).forEach(async S=>{await s[S].terminate()}),l=[]},getQueueLen:h,getNumWorkers:d}},rx}function w3(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ax,oM;function E3(){return oM||(oM=1,ax=u=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof w3=="function"&&(t.type="node"),typeof u>"u"?t:t[u]}),ax}var ox,lM;function S3(){if(lM)return ox;lM=1;const t=E3()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return ox=e=>{const n={...e};return["corePath","workerPath","langPath"].forEach(i=>{e[i]&&(n[i]=t(n[i]))}),n},ox}var lx,cM;function bO(){return cM||(cM=1,lx={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),lx}const x3="tesseract.js",C3="6.0.0",T3="Pure Javascript Multilingual OCR",k3="src/index.js",P3="src/index.d.ts",R3="dist/tesseract.min.js",L3="dist/tesseract.min.js",M3={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},I3={"./src/worker/node/index.js":"./src/worker/browser/index.js"},D3="",F3=["jeromewu"],O3="Apache-2.0",N3={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},$3={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},j3={"@rollup/pluginutils":"^5.0.2"},H3={type:"git",url:"https://github.com/naptha/tesseract.js.git"},B3={url:"https://github.com/naptha/tesseract.js/issues"},z3="https://github.com/naptha/tesseract.js",U3={type:"opencollective",url:"https://opencollective.com/tesseractjs"},G3={name:x3,version:C3,description:T3,main:k3,types:P3,unpkg:R3,jsdelivr:L3,scripts:M3,browser:I3,author:D3,contributors:F3,license:O3,devDependencies:N3,dependencies:$3,overrides:j3,repository:H3,bugs:B3,homepage:z3,collective:U3};var cx,hM;function V3(){return hM||(hM=1,cx={workerBlobURL:!0,logger:()=>{}}),cx}var hx,uM;function W3(){if(uM)return hx;uM=1;const u=G3.version;return hx={...V3(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${u}/dist/worker.min.js`},hx}var ux,dM;function q3(){return dM||(dM=1,ux=({workerPath:u,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const n=new Blob([`importScripts("${u}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(n))}else e=new Worker(u);return e}),ux}var dx,fM;function X3(){return fM||(fM=1,dx=u=>{u.terminate()}),dx}var fx,pM;function Y3(){return pM||(pM=1,fx=(u,t)=>{u.onmessage=({data:e})=>{t(e)}}),fx}var px,gM;function K3(){return gM||(gM=1,px=async(u,t)=>{u.postMessage(t)}),px}var gx,mM;function Q3(){if(mM)return gx;mM=1;const u=e=>new Promise((n,i)=>{const s=new FileReader;s.onload=()=>{n(s.result)},s.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},s.readAsArrayBuffer(e)}),t=async e=>{let n=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?n=atob(e.split(",")[1]).split("").map(i=>i.charCodeAt(0)):n=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(n=await t(e.src)),e.tagName==="VIDEO"&&(n=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(i=>{e.toBlob(async s=>{n=await u(s),i()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const i=await e.convertToBlob();n=await u(i)}else(e instanceof File||e instanceof Blob)&&(n=await u(e));return new Uint8Array(n)};return gx=t,gx}var mx,yM;function J3(){if(yM)return mx;yM=1;const u=W3(),t=q3(),e=X3(),n=Y3(),i=K3(),s=Q3();return mx={defaultOptions:u,spawnWorker:t,terminateWorker:e,onMessage:n,send:i,loadImage:s},mx}var yx,vM;function AO(){if(vM)return yx;vM=1;const u=S3(),t=vO(),{log:e}=bk(),n=vk(),i=bO(),{defaultOptions:s,spawnWorker:o,terminateWorker:l,onMessage:h,loadImage:d,send:p}=J3();let g=0;return yx=async(m="eng",b=i.LSTM_ONLY,_={},S={})=>{const C=n("Worker",g),{logger:T,errorHandler:k,...P}=u({...s,..._}),L={},I=typeof m=="string"?m.split("+"):m;let D=b,F=S;const H=[i.DEFAULT,i.LSTM_ONLY].includes(b)&&!P.legacyCore;let j,Q;const V=new Promise((ut,xt)=>{Q=ut,j=xt}),tt=ut=>{j(ut.message)};let Z=o(P);Z.onerror=tt,g+=1;const et=({id:ut,action:xt,payload:Qt})=>new Promise((Se,Ie)=>{e(`[${C}]: Start ${ut}, action=${xt}`);const xe=`${xt}-${ut}`;L[xe]={resolve:Se,reject:Ie},p(Z,{workerId:C,jobId:ut,action:xt,payload:Qt})}),ht=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),J=ut=>et(t({id:ut,action:"load",payload:{options:{lstmOnly:H,corePath:P.corePath,logging:P.logging}}})),G=(ut,xt,Qt)=>et(t({id:Qt,action:"FS",payload:{method:"writeFile",args:[ut,xt]}})),q=(ut,xt)=>et(t({id:xt,action:"FS",payload:{method:"readFile",args:[ut,{encoding:"utf8"}]}})),U=(ut,xt)=>et(t({id:xt,action:"FS",payload:{method:"unlink",args:[ut]}})),N=(ut,xt,Qt)=>et(t({id:Qt,action:"FS",payload:{method:ut,args:xt}})),M=(ut,xt)=>et(t({id:xt,action:"loadLanguage",payload:{langs:ut,options:{langPath:P.langPath,dataPath:P.dataPath,cachePath:P.cachePath,cacheMethod:P.cacheMethod,gzip:P.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(D)&&!P.legacyLang}}})),B=(ut,xt,Qt,Se)=>et(t({id:Se,action:"initialize",payload:{langs:ut,oem:xt,config:Qt}})),Y=(ut="eng",xt,Qt,Se)=>{if(H&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(xt))throw Error("Legacy model requested but code missing.");const Ie=xt||D;D=Ie;const xe=Qt||F;F=xe;const ci=(typeof ut=="string"?ut.split("+"):ut).filter(hi=>!I.includes(hi));return I.push(...ci),ci.length>0?M(ci,Se).then(()=>B(ut,Ie,xe,Se)):B(ut,Ie,xe,Se)},it=(ut={},xt)=>et(t({id:xt,action:"setParameters",payload:{params:ut}})),dt=async(ut,xt={},Qt={text:!0},Se)=>et(t({id:Se,action:"recognize",payload:{image:await d(ut),options:xt,output:Qt}})),at=async(ut,xt)=>{if(H)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return et(t({id:xt,action:"detect",payload:{image:await d(ut)}}))},nt=async()=>(Z!==null&&(l(Z),Z=null),Promise.resolve());h(Z,({workerId:ut,jobId:xt,status:Qt,action:Se,data:Ie})=>{const xe=`${Se}-${xt}`;if(Qt==="resolve")e(`[${ut}]: Complete ${xt}`),L[xe].resolve({jobId:xt,data:Ie}),delete L[xe];else if(Qt==="reject")if(L[xe].reject(Ie),delete L[xe],Se==="load"&&j(Ie),k)k(Ie);else throw Error(Ie);else Qt==="progress"&&T({...Ie,userJobId:xt})});const vt={id:C,worker:Z,load:ht,writeText:G,readText:q,removeFile:U,FS:N,reinitialize:Y,setParameters:it,recognize:dt,detect:at,terminate:nt};return J().then(()=>M(m)).then(()=>B(m,b,S)).then(()=>Q(vt)).catch(()=>{}),V},yx}var vx,bM;function Z3(){if(bM)return vx;bM=1;const u=AO();return vx={recognize:async(n,i,s)=>{const o=await u(i,1,s);return o.recognize(n).finally(async()=>{await o.terminate()})},detect:async(n,i)=>{const s=await u("osd",0,i);return s.detect(n).finally(async()=>{await s.terminate()})}},vx}var bx,AM;function tz(){return AM||(AM=1,bx={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),bx}var Ax,_M;function ez(){return _M||(_M=1,Ax={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Ax}var _x,wM;function nz(){if(wM)return _x;wM=1,A3();const u=_3(),t=AO(),e=Z3(),n=tz(),i=bO(),s=ez(),{setLogging:o}=bk();return _x={languages:n,OEM:i,PSM:s,createScheduler:u,createWorker:t,setLogging:o,...e},_x}var iz=nz();const EM=iD(iz);var yy={},Re={};const sz="modulepreload",rz=function(u){return"/personal-accounting/"+u},SM={},w_=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(e.map(h=>{if(h=rz(h),h in SM)return;SM[h]=!0;const d=h.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":sz,d||(g.as="script"),g.crossOrigin="",g.href=h,l&&g.setAttribute("nonce",l),document.head.appendChild(g),d)return new Promise((m,b)=>{g.addEventListener("load",m),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};var rv={};rv.d=(u,t)=>{for(var e in t)rv.o(t,e)&&!rv.o(u,e)&&Object.defineProperty(u,e,{enumerable:!0,get:t[e]})};rv.o=(u,t)=>Object.prototype.hasOwnProperty.call(u,t);var $t=globalThis.pdfjsLib={};rv.d($t,{AbortException:()=>Ef,AnnotationEditorLayer:()=>KT,AnnotationEditorParamsType:()=>Nt,AnnotationEditorType:()=>Ut,AnnotationEditorUIManager:()=>mf,AnnotationLayer:()=>iG,AnnotationMode:()=>Ac,ColorPicker:()=>sE,DOMSVGFactory:()=>Lk,DrawLayer:()=>tk,FeatureTest:()=>Ui,GlobalWorkerOptions:()=>Ml,ImageKind:()=>_w,InvalidPDFException:()=>wO,MissingPDFException:()=>wf,OPS:()=>jr,OutputScale:()=>UC,PDFDataRangeTransport:()=>vN,PDFDateString:()=>Sk,PDFWorker:()=>mp,PasswordResponses:()=>cz,PermissionFlag:()=>lz,PixelsPerInch:()=>Th,RenderingCancelledException:()=>wk,TextLayer:()=>yT,UnexpectedResponseException:()=>KE,Util:()=>Pt,VerbosityLevel:()=>qE,XfaLayer:()=>AN,build:()=>NU,createValidAbsoluteUrl:()=>fz,fetchData:()=>JE,getDocument:()=>kU,getFilenameFromUrl:()=>wz,getPdfFilenameFromUrl:()=>Ez,getXfaPageViewport:()=>Sz,isDataScheme:()=>ZE,isPdfFile:()=>Ek,noContextMenu:()=>Sr,normalizeUnicode:()=>bz,setLayerDimensions:()=>gf,shadow:()=>ee,version:()=>OU});const Ri=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),_O=[1,0,0,1,0,0],jC=[.001,0,0,.001,0,0],az=1e7,wx=1.35,Us={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ac={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},oz="pdfjs_internal_editor_",Ut={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},lz={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},vi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},_w={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},bn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},vy={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},qE={ERRORS:0,WARNINGS:1,INFOS:5},jr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},cz={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let XE=qE.WARNINGS;function hz(u){Number.isInteger(u)&&(XE=u)}function uz(){return XE}function YE(u){XE>=qE.INFOS&&console.log(`Info: ${u}`)}function Wt(u){XE>=qE.WARNINGS&&console.log(`Warning: ${u}`)}function Me(u){throw new Error(u)}function Cn(u,t){u||Me(t)}function dz(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function fz(u,t=null,e=null){if(!u)return null;try{if(e&&typeof u=="string"){if(e.addDefaultProtocol&&u.startsWith("www.")){const i=u.match(/\./g);(i==null?void 0:i.length)>=2&&(u=`http://${u}`)}if(e.tryConvertEncoding)try{u=vz(u)}catch{}}const n=t?new URL(u,t):new URL(u);if(dz(n))return n}catch{}return null}function ee(u,t,e,n=!1){return Object.defineProperty(u,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Ih=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class HC extends Ih{constructor(t,e){super(t,"PasswordException"),this.code=e}}class BC extends Ih{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class wO extends Ih{constructor(t){super(t,"InvalidPDFException")}}class wf extends Ih{constructor(t){super(t,"MissingPDFException")}}class KE extends Ih{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class pz extends Ih{constructor(t){super(t,"FormatError")}}class Ef extends Ih{constructor(t){super(t,"AbortException")}}function EO(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Me("Invalid argument for bytesToString");const t=u.length,e=8192;if(t<e)return String.fromCharCode.apply(null,u);const n=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),o=u.subarray(i,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function QE(u){typeof u!="string"&&Me("Invalid argument for stringToBytes");const t=u.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=u.charCodeAt(n)&255;return e}function gz(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function Ak(u){const t=Object.create(null);for(const[e,n]of u)t[e]=n;return t}function mz(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function yz(){try{return new Function(""),!0}catch{return!1}}class Ui{static get isLittleEndian(){return ee(this,"isLittleEndian",mz())}static get isEvalSupported(){return ee(this,"isEvalSupported",yz())}static get isOffscreenCanvasSupported(){return ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ee(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ee(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return ee(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Ex=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));var Nl,ww,zC;class Pt{static makeHexColor(t,e,n){return`#${Ex[t]}${Ex[e]}${Ex[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const n=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[n,i]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n;return[i,s]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],s[0],o[0]),Math.min(n[1],i[1],s[1],o[1]),Math.max(n[0],i[0],s[0],o[0]),Math.max(n[1],i[1],s[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],l=(n+o)/2,h=Math.sqrt((n+o)**2-4*(n*o-s*i))/2,d=l+h||1,p=l-h||1;return[Math.sqrt(d),Math.sqrt(p)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>o?null:[n,s,i,o]}static bezierBoundingBox(t,e,n,i,s,o,l,h,d){return d?(d[0]=Math.min(d[0],t,l),d[1]=Math.min(d[1],e,h),d[2]=Math.max(d[2],t,l),d[3]=Math.max(d[3],e,h)):d=[Math.min(t,l),Math.min(e,h),Math.max(t,l),Math.max(e,h)],A(this,Nl,zC).call(this,t,n,s,l,e,i,o,h,3*(-t+3*(n-s)+l),6*(t-2*n+s),3*(n-t),d),A(this,Nl,zC).call(this,t,n,s,l,e,i,o,h,3*(-e+3*(i-o)+h),6*(e-2*i+o),3*(i-e),d),d}}Nl=new WeakSet,ww=function(t,e,n,i,s,o,l,h,d,p){if(d<=0||d>=1)return;const g=1-d,m=d*d,b=m*d,_=g*(g*(g*t+3*d*e)+3*m*n)+b*i,S=g*(g*(g*s+3*d*o)+3*m*l)+b*h;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)},zC=function(t,e,n,i,s,o,l,h,d,p,g,m){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&A(this,Nl,ww).call(this,t,e,n,i,s,o,l,h,-g/p,m);return}const b=p**2-4*g*d;if(b<0)return;const _=Math.sqrt(b),S=2*d;A(this,Nl,ww).call(this,t,e,n,i,s,o,l,h,(-p+_)/S,m),A(this,Nl,ww).call(this,t,e,n,i,s,o,l,h,(-p-_)/S,m)},E(Pt,Nl);function vz(u){return decodeURIComponent(escape(u))}let Sx=null,xM=null;function bz(u){return Sx||(Sx=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,xM=new Map([["ﬅ","ſt"]])),u.replaceAll(Sx,(t,e,n)=>e?e.normalize("NFKC"):xM.get(n))}function Az(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const u=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(u);else for(let t=0;t<32;t++)u[t]=Math.floor(Math.random()*255);return EO(u)}const _k="pdfjs_internal_id_",Co={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function _z(u){return Uint8Array.prototype.toBase64?u.toBase64():btoa(EO(u))}const Io="http://www.w3.org/2000/svg",au=class au{};lt(au,"CSS",96),lt(au,"PDF",72),lt(au,"PDF_TO_CSS_UNITS",au.CSS/au.PDF);let Th=au;async function JE(u,t="text"){if(zy(u,document.baseURI)){const e=await fetch(u);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const i=new XMLHttpRequest;i.open("GET",u,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class tA{constructor({viewBox:t,scale:e,rotation:n,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=t,this.scale=e,this.rotation=n,this.offsetX=i,this.offsetY=s;const l=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let d,p,g,m;switch(n%=360,n<0&&(n+=360),n){case 180:d=-1,p=0,g=0,m=1;break;case 90:d=0,p=1,g=1,m=0;break;case 270:d=0,p=-1,g=-1,m=0;break;case 0:d=1,p=0,g=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(g=-g,m=-m);let b,_,S,C;d===0?(b=Math.abs(h-t[1])*e+i,_=Math.abs(l-t[0])*e+s,S=(t[3]-t[1])*e,C=(t[2]-t[0])*e):(b=Math.abs(l-t[0])*e+i,_=Math.abs(h-t[1])*e+s,S=(t[2]-t[0])*e,C=(t[3]-t[1])*e),this.transform=[d*e,p*e,g*e,m*e,b-d*e*l-g*e*h,_-p*e*l-m*e*h],this.width=S,this.height=C}get rawDims(){const{viewBox:t}=this;return ee(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new tA({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){return Pt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Pt.applyTransform([t[0],t[1]],this.transform),n=Pt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return Pt.applyInverseTransform([t,e],this.transform)}}class wk extends Ih{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function ZE(u){const t=u.length;let e=0;for(;e<t&&u[e].trim()==="";)e++;return u.substring(e,e+5).toLowerCase()==="data:"}function Ek(u){return typeof u=="string"&&/\.pdf$/i.test(u)}function wz(u){return[u]=u.split(/[#?]/,1),u.substring(u.lastIndexOf("/")+1)}function Ez(u,t="document.pdf"){if(typeof u!="string")return t;if(ZE(u))return Wt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(u);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||t}class CM{constructor(){lt(this,"started",Object.create(null));lt(this,"times",[])}time(t){t in this.started&&Wt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Wt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:s}of this.times)t.push(`${n.padEnd(e)} ${s-i}ms
`);return t.join("")}}function zy(u,t){try{const{protocol:e}=t?new URL(u,t):new URL(u);return e==="http:"||e==="https:"}catch{return!1}}function Sr(u){u.preventDefault()}function TM(u){console.log("Deprecated API usage: "+u)}var Nb;class Sk{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,Nb)||v(this,Nb,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,Nb).exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const d=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,d==="-"?(o+=p,l+=g):d==="+"&&(o-=p,l-=g),new Date(Date.UTC(n,i,s,o,l,h))}}Nb=new WeakMap,E(Sk,Nb);function Sz(u,{scale:t=1,rotation:e=0}){const{width:n,height:i}=u.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new tA({viewBox:s,scale:t,rotation:e})}function xk(u){if(u.startsWith("#")){const t=parseInt(u.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return u.startsWith("rgb(")?u.slice(4,-1).split(",").map(t=>parseInt(t)):u.startsWith("rgba(")?u.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Wt(`Not a valid color format: "${u}"`),[0,0,0])}function xz(u){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of u.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;u.set(e,xk(n))}t.remove()}function Ve(u){const{a:t,b:e,c:n,d:i,e:s,f:o}=u.getTransform();return[t,e,n,i,s,o]}function To(u){const{a:t,b:e,c:n,d:i,e:s,f:o}=u.getTransform().invertSelf();return[t,e,n,i,s,o]}function gf(u,t,e=!1,n=!0){if(t instanceof tA){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=u,l=Ui.isCSSRoundSupported,h=`var(--scale-factor) * ${i}px`,d=`var(--scale-factor) * ${s}px`,p=l?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,g=l?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!e||t.rotation%180===0?(o.width=p,o.height=g):(o.width=g,o.height=p)}n&&u.setAttribute("data-main-rotation",t.rotation)}class UC{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Jc,gd,Jr,md,$b,jb,wE,SO,Wi,xO,CO,Ew,TO,VC;const Do=class Do{constructor(t){E(this,Wi);E(this,Jc,null);E(this,gd,null);E(this,Jr);E(this,md,null);E(this,$b,null);v(this,Jr,t),r(Do,jb)||v(Do,jb,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=v(this,Jc,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,Jr)._uiManager._signal;t.addEventListener("contextmenu",Sr,{signal:e}),t.addEventListener("pointerdown",A(Do,wE,SO),{signal:e});const n=v(this,md,document.createElement("div"));n.className="buttons",t.append(n);const i=r(this,Jr).toolbarPosition;if(i){const{style:s}=t,o=r(this,Jr)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,Wi,TO).call(this),t}get div(){return r(this,Jc)}hide(){var t;r(this,Jc).classList.add("hidden"),(t=r(this,gd))==null||t.hideDropdown()}show(){var t;r(this,Jc).classList.remove("hidden"),(t=r(this,$b))==null||t.shown()}async addAltText(t){const e=await t.render();A(this,Wi,Ew).call(this,e),r(this,md).prepend(e,r(this,Wi,VC)),v(this,$b,t)}addColorPicker(t){v(this,gd,t);const e=t.renderButton();A(this,Wi,Ew).call(this,e),r(this,md).prepend(e,r(this,Wi,VC))}remove(){var t;r(this,Jc).remove(),(t=r(this,gd))==null||t.destroy(),v(this,gd,null)}};Jc=new WeakMap,gd=new WeakMap,Jr=new WeakMap,md=new WeakMap,$b=new WeakMap,jb=new WeakMap,wE=new WeakSet,SO=function(t){t.stopPropagation()},Wi=new WeakSet,xO=function(t){r(this,Jr)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},CO=function(t){r(this,Jr)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},Ew=function(t){const e=r(this,Jr)._uiManager._signal;t.addEventListener("focusin",A(this,Wi,xO).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",A(this,Wi,CO).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Sr,{signal:e})},TO=function(){const{editorType:t,_uiManager:e}=r(this,Jr),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",r(Do,jb)[t]),A(this,Wi,Ew).call(this,n),n.addEventListener("click",i=>{e.delete()},{signal:e._signal}),r(this,md).append(n)},VC=function(){const t=document.createElement("div");return t.className="divider",t},E(Do,wE),E(Do,jb,null);let GC=Do;var Hb,yd,vd,Rh,kO,PO,RO;class Cz{constructor(t){E(this,Rh);E(this,Hb,null);E(this,yd,null);E(this,vd);v(this,vd,t)}show(t,e,n){const[i,s]=A(this,Rh,PO).call(this,e,n),{style:o}=r(this,yd)||v(this,yd,A(this,Rh,kO).call(this));t.append(r(this,yd)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,yd).remove()}}Hb=new WeakMap,yd=new WeakMap,vd=new WeakMap,Rh=new WeakSet,kO=function(){const t=v(this,yd,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Sr,{signal:r(this,vd)._signal});const e=v(this,Hb,document.createElement("div"));return e.className="buttons",t.append(e),A(this,Rh,RO).call(this),t},PO=function(t,e){let n=0,i=0;for(const s of t){const o=s.y+s.height;if(o<n)continue;const l=s.x+(e?s.width:0);if(o>n){i=l,n=o;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,n]},RO=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=r(this,vd)._signal;t.addEventListener("contextmenu",Sr,{signal:n}),t.addEventListener("click",()=>{r(this,vd).highlightSelection("floating_button")},{signal:n}),r(this,Hb).append(t)};function eE(u,t,e){for(const n of e)t.addEventListener(n,u[n].bind(u))}function Tz(u){return Math.round(Math.min(255,Math.max(1,255*u))).toString(16).padStart(2,"0")}var EE;class kz{constructor(){E(this,EE,0)}get id(){return`${oz}${he(this,EE)._++}`}}EE=new WeakMap;var xg,Bb,Si,Cg,Sw;const Nk=class Nk{constructor(){E(this,Cg);E(this,xg,Az());E(this,Bb,0);E(this,Si,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return ee(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return A(this,Cg,Sw).call(this,`${e}_${n}_${i}_${s}`,t)}async getFromUrl(t){return A(this,Cg,Sw).call(this,t,t)}async getFromBlob(t,e){const n=await e;return A(this,Cg,Sw).call(this,t,n)}async getFromId(t){r(this,Si)||v(this,Si,new Map);const e=r(this,Si).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,Si)||v(this,Si,new Map);let n=r(this,Si).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${r(this,xg)}_${he(this,Bb)._++}`,refCounter:1,isSvg:!1},r(this,Si).set(t,n),r(this,Si).set(n.id,n),n}getSvgUrl(t){const e=r(this,Si).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;r(this,Si)||v(this,Si,new Map);const e=r(this,Si).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}(i=n.close)==null||i.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,xg)}_`)}};xg=new WeakMap,Bb=new WeakMap,Si=new WeakMap,Cg=new WeakSet,Sw=async function(t,e){r(this,Si)||v(this,Si,new Map);let n=r(this,Si).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${r(this,xg)}_${he(this,Bb)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(n.url=e,i=await JE(e,"blob")):e instanceof File?i=n.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=Nk._isSVGFittingCanvas,o=new FileReader,l=new Image,h=new Promise((d,p)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,d()},o.onload=async()=>{const g=n.svgUrl=o.result;l.src=await s?`${g}#svgView(preserveAspectRatio(none))`:g},l.onerror=o.onerror=p});o.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){console.error(i),n=null}return r(this,Si).set(t,n),n&&r(this,Si).set(n.id,n),n};let WC=Nk;var Bn,Zc,zb,zn;class Pz{constructor(t=128){E(this,Bn,[]);E(this,Zc,!1);E(this,zb);E(this,zn,-1);v(this,zb,t)}add({cmd:t,undo:e,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&t(),r(this,Zc))return;const h={cmd:t,undo:e,post:n,type:s};if(r(this,zn)===-1){r(this,Bn).length>0&&(r(this,Bn).length=0),v(this,zn,0),r(this,Bn).push(h);return}if(o&&r(this,Bn)[r(this,zn)].type===s){l&&(h.undo=r(this,Bn)[r(this,zn)].undo),r(this,Bn)[r(this,zn)]=h;return}const d=r(this,zn)+1;d===r(this,zb)?r(this,Bn).splice(0,1):(v(this,zn,d),d<r(this,Bn).length&&r(this,Bn).splice(d)),r(this,Bn).push(h)}undo(){if(r(this,zn)===-1)return;v(this,Zc,!0);const{undo:t,post:e}=r(this,Bn)[r(this,zn)];t(),e==null||e(),v(this,Zc,!1),v(this,zn,r(this,zn)-1)}redo(){if(r(this,zn)<r(this,Bn).length-1){v(this,zn,r(this,zn)+1),v(this,Zc,!0);const{cmd:t,post:e}=r(this,Bn)[r(this,zn)];t(),e==null||e(),v(this,Zc,!1)}}hasSomethingToUndo(){return r(this,zn)!==-1}hasSomethingToRedo(){return r(this,zn)<r(this,Bn).length-1}destroy(){v(this,Bn,null)}}Bn=new WeakMap,Zc=new WeakMap,zb=new WeakMap,zn=new WeakMap;var SE,LO;class eA{constructor(t){E(this,SE);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ui.platform;for(const[n,i,s={}]of t)for(const o of n){const l=o.startsWith("mac+");e&&l?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!e&&!l&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(A(this,SE,LO).call(this,e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:l=null}}=n;l&&!l(t,e)||(i.bind(t,...o,e)(),s||(e.stopPropagation(),e.preventDefault()))}}SE=new WeakSet,LO=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const xE=class xE{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return xz(t),ee(this,"_colors",t)}convert(t){const e=xk(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every((s,o)=>s===e[o]))return xE._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Pt.makeHexColor(...e):t}};lt(xE,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let qC=xE;var Tg,Ds,wn,ii,kg,ll,Pg,Zr,th,Rg,bd,Va,ta,Ad,Ub,Gb,Lg,Vb,Wa,eh,Mg,nh,qa,CE,ih,Wb,sh,_d,qb,Xb,Un,fe,cl,wd,Yb,Kb,rh,Xa,hl,Qb,ur,mt,xw,XC,MO,IO,Cw,DO,FO,OO,YC,NO,KC,QC,$O,Oi,yc,jO,HO,JC,BO,Uy,ZC;const pp=class pp{constructor(t,e,n,i,s,o,l,h,d,p,g){E(this,mt);E(this,Tg,new AbortController);E(this,Ds,null);E(this,wn,new Map);E(this,ii,new Map);E(this,kg,null);E(this,ll,null);E(this,Pg,null);E(this,Zr,new Pz);E(this,th,null);E(this,Rg,0);E(this,bd,new Set);E(this,Va,null);E(this,ta,null);E(this,Ad,new Set);E(this,Ub,!1);E(this,Gb,!1);E(this,Lg,!1);E(this,Vb,null);E(this,Wa,null);E(this,eh,null);E(this,Mg,null);E(this,nh,!1);E(this,qa,null);E(this,CE,new kz);E(this,ih,!1);E(this,Wb,!1);E(this,sh,null);E(this,_d,null);E(this,qb,null);E(this,Xb,null);E(this,Un,Ut.NONE);E(this,fe,new Set);E(this,cl,null);E(this,wd,null);E(this,Yb,null);E(this,Kb,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,rh,[0,0]);E(this,Xa,null);E(this,hl,null);E(this,Qb,null);E(this,ur,null);const m=this._signal=r(this,Tg).signal;v(this,hl,t),v(this,Qb,e),v(this,kg,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:m}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),i._on("setpreference",this.onSetPreference.bind(this),{signal:m}),i._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:m}),A(this,mt,DO).call(this),A(this,mt,$O).call(this),A(this,mt,YC).call(this),v(this,ll,s.annotationStorage),v(this,Vb,s.filterFactory),v(this,wd,o),v(this,Mg,l||null),v(this,Ub,h),v(this,Gb,d),v(this,Lg,p),v(this,Xb,g||null),this.viewParameters={realScale:Th.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=pp.prototype,e=o=>r(o,hl).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return ee(this,"_keyboardManager",new eA([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,hl).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&r(o,hl).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,n,i;(t=r(this,ur))==null||t.resolve(),v(this,ur,null),(e=r(this,Tg))==null||e.abort(),v(this,Tg,null),this._signal=null;for(const s of r(this,ii).values())s.destroy();r(this,ii).clear(),r(this,wn).clear(),r(this,Ad).clear(),v(this,Ds,null),r(this,fe).clear(),r(this,Zr).destroy(),(n=r(this,kg))==null||n.destroy(),(i=r(this,qa))==null||i.hide(),v(this,qa,null),r(this,Wa)&&(clearTimeout(r(this,Wa)),v(this,Wa,null)),r(this,Xa)&&(clearTimeout(r(this,Xa)),v(this,Xa,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,Xb)}get useNewAltTextFlow(){return r(this,Gb)}get useNewAltTextWhenAddingImage(){return r(this,Lg)}get hcmFilter(){return ee(this,"hcmFilter",r(this,wd)?r(this,Vb).addHCMFilter(r(this,wd).foreground,r(this,wd).background):"none")}get direction(){return ee(this,"direction",getComputedStyle(r(this,hl)).direction)}get highlightColors(){return ee(this,"highlightColors",r(this,Mg)?new Map(r(this,Mg).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return ee(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){v(this,qb,t)}editAltText(t,e=!1){var n;(n=r(this,kg))==null||n.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":v(this,Lg,e);break}}onPageChanging({pageNumber:t}){v(this,Rg,t-1)}focusMainContainer(){r(this,hl).focus()}findParent(t,e){for(const n of r(this,ii).values()){const{x:i,y:s,width:o,height:l}=n.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=s&&e<=s+l)return n}return null}disableUserSelect(t=!1){r(this,Qb).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,Ad).add(t)}removeShouldRescale(t){r(this,Ad).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Th.PDF_TO_CSS_UNITS;for(const e of r(this,Ad))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}=e,l=e.toString(),d=A(this,mt,xw).call(this,e).closest(".textLayer"),p=this.getSelectionBoxes(d);if(!p)return;e.empty();const g=A(this,mt,XC).call(this,d),m=r(this,Un)===Ut.NONE,b=()=>{g==null||g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Ut.HIGHLIGHT,b);return}b()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,ll)&&!r(this,ll).has(t.id)&&r(this,ll).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,nh)&&(v(this,nh,!1),A(this,mt,Cw).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,fe))if(e.div.contains(t)){v(this,_d,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,_d))return;const[t,e]=r(this,_d);v(this,_d,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){A(this,mt,YC).call(this),A(this,mt,KC).call(this)}removeEditListeners(){A(this,mt,NO).call(this),A(this,mt,QC).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of r(this,ta))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of r(this,ta))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=r(this,Ds))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of r(this,fe)){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const o of r(this,ta))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Wt(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;s.push(d)}const o=()=>{for(const h of s)A(this,mt,JC).call(this,h);A(this,mt,ZC).call(this,s)},l=()=>{for(const h of s)h.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(s){Wt(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,Un)!==Ut.NONE&&!this.isEditorHandlingKeyboard&&pp._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,nh)&&(v(this,nh,!1),A(this,mt,Cw).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(A(this,mt,FO).call(this),A(this,mt,KC).call(this),A(this,mt,Oi).call(this,{isEditing:r(this,Un)!==Ut.NONE,isEmpty:A(this,mt,Uy).call(this),hasSomethingToUndo:r(this,Zr).hasSomethingToUndo(),hasSomethingToRedo:r(this,Zr).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,mt,OO).call(this),A(this,mt,QC).call(this),A(this,mt,Oi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,ta)){v(this,ta,t);for(const e of r(this,ta))A(this,mt,yc).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,CE).id}get currentLayer(){return r(this,ii).get(r(this,Rg))}getLayer(t){return r(this,ii).get(t)}get currentPageIndex(){return r(this,Rg)}addLayer(t){r(this,ii).set(t.pageIndex,t),r(this,ih)?t.enable():t.disable()}removeLayer(t){r(this,ii).delete(t.pageIndex)}async updateMode(t,e=null,n=!1){if(r(this,Un)!==t&&!(r(this,ur)&&(await r(this,ur).promise,!r(this,ur)))){if(v(this,ur,Promise.withResolvers()),v(this,Un,t),t===Ut.NONE){this.setEditingState(!1),A(this,mt,HO).call(this),r(this,ur).resolve();return}this.setEditingState(!0),await A(this,mt,jO).call(this),this.unselectAll();for(const i of r(this,ii).values())i.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),r(this,ur).resolve();return}for(const i of r(this,wn).values())i.annotationElementId===e?(this.setSelected(i),i.enterInEditMode()):i.unselect();r(this,ur).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,Un)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var n;if(r(this,ta)){switch(t){case Nt.CREATE:this.currentLayer.addNewEditor();return;case Nt.HIGHLIGHT_DEFAULT_COLOR:(n=r(this,qb))==null||n.updateColor(e);break;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,Yb)||v(this,Yb,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of r(this,fe))i.updateParams(t,e);for(const i of r(this,ta))i.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var s;for(const o of r(this,wn).values())o.editorType===t&&o.show(e);(((s=r(this,Yb))==null?void 0:s.get(Nt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&A(this,mt,yc).call(this,[[Nt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,Wb)!==t){v(this,Wb,t);for(const e of r(this,ii).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of r(this,wn).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return r(this,wn).get(t)}addEditor(t){r(this,wn).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Wa)&&clearTimeout(r(this,Wa)),v(this,Wa,setTimeout(()=>{this.focusMainContainer(),v(this,Wa,null)},0))),r(this,wn).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,bd).has(t.annotationElementId))&&((e=r(this,ll))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,bd).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,bd).has(t)}removeDeletedAnnotationElement(t){r(this,bd).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,Ds)!==t&&(v(this,Ds,t),t&&A(this,mt,yc).call(this,t.propertiesToUpdate))}updateUI(t){r(this,mt,BO)===t&&A(this,mt,yc).call(this,t.propertiesToUpdate)}toggleSelected(t){if(r(this,fe).has(t)){r(this,fe).delete(t),t.unselect(),A(this,mt,Oi).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,fe).add(t),t.select(),A(this,mt,yc).call(this,t.propertiesToUpdate),A(this,mt,Oi).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of r(this,fe))e!==t&&e.unselect();r(this,fe).clear(),r(this,fe).add(t),t.select(),A(this,mt,yc).call(this,t.propertiesToUpdate),A(this,mt,Oi).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,fe).has(t)}get firstSelectedEditor(){return r(this,fe).values().next().value}unselect(t){t.unselect(),r(this,fe).delete(t),A(this,mt,Oi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,fe).size!==0}get isEnterHandled(){return r(this,fe).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){r(this,Zr).undo(),A(this,mt,Oi).call(this,{hasSomethingToUndo:r(this,Zr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,mt,Uy).call(this)})}redo(){r(this,Zr).redo(),A(this,mt,Oi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Zr).hasSomethingToRedo(),isEmpty:A(this,mt,Uy).call(this)})}addCommands(t){r(this,Zr).add(t),A(this,mt,Oi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,mt,Uy).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...r(this,fe)],e=()=>{for(const i of t)i.remove()},n=()=>{for(const i of t)A(this,mt,JC).call(this,i)};this.addCommands({cmd:e,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=r(this,Ds))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,Ds)||this.hasSelection}selectAll(){for(const t of r(this,fe))t.commit();A(this,mt,ZC).call(this,r(this,wn).values())}unselectAll(){if(!(r(this,Ds)&&(r(this,Ds).commitOrRemove(),r(this,Un)!==Ut.NONE))&&this.hasSelection){for(const t of r(this,fe))t.unselect();r(this,fe).clear(),A(this,mt,Oi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;r(this,rh)[0]+=t,r(this,rh)[1]+=e;const[i,s]=r(this,rh),o=[...r(this,fe)],l=1e3;r(this,Xa)&&clearTimeout(r(this,Xa)),v(this,Xa,setTimeout(()=>{v(this,Xa,null),r(this,rh)[0]=r(this,rh)[1]=0,this.addCommands({cmd:()=>{for(const h of o)r(this,wn).has(h.id)&&h.translateInPage(i,s)},undo:()=>{for(const h of o)r(this,wn).has(h.id)&&h.translateInPage(-i,-s)},mustExec:!1})},l));for(const h of o)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,Va,new Map);for(const t of r(this,fe))r(this,Va).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,Va))return!1;this.disableUserSelect(!1);const t=r(this,Va);v(this,Va,null);let e=!1;for(const[{x:i,y:s,pageIndex:o},l]of t)l.newX=i,l.newY=s,l.newPageIndex=o,e||(e=i!==l.savedX||s!==l.savedY||o!==l.savedPageIndex);if(!e)return!1;const n=(i,s,o,l)=>{if(r(this,wn).has(i.id)){const h=r(this,ii).get(l);h?i._setParentAndPosition(h,s,o):(i.pageIndex=l,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:l}]of t)n(i,s,o,l)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:l}]of t)n(i,s,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,Va))for(const n of r(this,Va).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,fe).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,Ds)===t}getActive(){return r(this,Ds)}getMode(){return r(this,Un)}get imageManager(){return ee(this,"imageManager",new WC)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,p=e.rangeCount;d<p;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:o}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(d,p,g,m)=>({x:(p-i)/o,y:1-(d+g-n)/s,width:m/o,height:g/s});break;case"180":l=(d,p,g,m)=>({x:1-(d+g-n)/s,y:1-(p+m-i)/o,width:g/s,height:m/o});break;case"270":l=(d,p,g,m)=>({x:1-(p+m-i)/o,y:(d-n)/s,width:m/o,height:g/s});break;default:l=(d,p,g,m)=>({x:(d-n)/s,y:(p-i)/o,width:g/s,height:m/o});break}const h=[];for(let d=0,p=e.rangeCount;d<p;d++){const g=e.getRangeAt(d);if(!g.collapsed)for(const{x:m,y:b,width:_,height:S}of g.getClientRects())_===0||S===0||h.push(l(m,b,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,Pg)||v(this,Pg,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,Pg))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=r(this,Pg))==null?void 0:i.get(t.data.id);if(!e)return;const n=r(this,ll).getRawValue(e);n&&(r(this,Un)===Ut.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}};Tg=new WeakMap,Ds=new WeakMap,wn=new WeakMap,ii=new WeakMap,kg=new WeakMap,ll=new WeakMap,Pg=new WeakMap,Zr=new WeakMap,th=new WeakMap,Rg=new WeakMap,bd=new WeakMap,Va=new WeakMap,ta=new WeakMap,Ad=new WeakMap,Ub=new WeakMap,Gb=new WeakMap,Lg=new WeakMap,Vb=new WeakMap,Wa=new WeakMap,eh=new WeakMap,Mg=new WeakMap,nh=new WeakMap,qa=new WeakMap,CE=new WeakMap,ih=new WeakMap,Wb=new WeakMap,sh=new WeakMap,_d=new WeakMap,qb=new WeakMap,Xb=new WeakMap,Un=new WeakMap,fe=new WeakMap,cl=new WeakMap,wd=new WeakMap,Yb=new WeakMap,Kb=new WeakMap,rh=new WeakMap,Xa=new WeakMap,hl=new WeakMap,Qb=new WeakMap,ur=new WeakMap,mt=new WeakSet,xw=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},XC=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of r(this,ii).values())if(n.hasTextLayer(t))return n;return null},MO=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=A(this,mt,xw).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(r(this,qa)||v(this,qa,new Cz(this)),r(this,qa).show(n,i,this.direction==="ltr"))},IO=function(){var s,o,l;const t=document.getSelection();if(!t||t.isCollapsed){r(this,cl)&&((s=r(this,qa))==null||s.hide(),v(this,cl,null),A(this,mt,Oi).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,cl))return;const i=A(this,mt,xw).call(this,t).closest(".textLayer");if(!i){r(this,cl)&&((o=r(this,qa))==null||o.hide(),v(this,cl,null),A(this,mt,Oi).call(this,{hasSelectedText:!1}));return}if((l=r(this,qa))==null||l.hide(),v(this,cl,e),A(this,mt,Oi).call(this,{hasSelectedText:!0}),!(r(this,Un)!==Ut.HIGHLIGHT&&r(this,Un)!==Ut.NONE)&&(r(this,Un)===Ut.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,nh,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=r(this,Un)===Ut.HIGHLIGHT?A(this,mt,XC).call(this,i):null;h==null||h.toggleDrawing();const d=new AbortController,p=this.combinedSignal(d),g=m=>{m.type==="pointerup"&&m.button!==0||(d.abort(),h==null||h.toggleDrawing(!0),m.type==="pointerup"&&A(this,mt,Cw).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("blur",g,{signal:p})}},Cw=function(t=""){r(this,Un)===Ut.HIGHLIGHT?this.highlightSelection(t):r(this,Ub)&&A(this,mt,MO).call(this)},DO=function(){document.addEventListener("selectionchange",A(this,mt,IO).bind(this),{signal:this._signal})},FO=function(){if(r(this,eh))return;v(this,eh,new AbortController);const t=this.combinedSignal(r(this,eh));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},OO=function(){var t;(t=r(this,eh))==null||t.abort(),v(this,eh,null)},YC=function(){if(r(this,sh))return;v(this,sh,new AbortController);const t=this.combinedSignal(r(this,sh));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},NO=function(){var t;(t=r(this,sh))==null||t.abort(),v(this,sh,null)},KC=function(){if(r(this,th))return;v(this,th,new AbortController);const t=this.combinedSignal(r(this,th));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},QC=function(){var t;(t=r(this,th))==null||t.abort(),v(this,th,null)},$O=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Oi=function(t){Object.entries(t).some(([n,i])=>r(this,Kb)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Kb),t)}),r(this,Un)===Ut.HIGHLIGHT&&t.hasSelectedEditor===!1&&A(this,mt,yc).call(this,[[Nt.HIGHLIGHT_FREE,!0]]))},yc=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},jO=async function(){if(!r(this,ih)){v(this,ih,!0);const t=[];for(const e of r(this,ii).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,wn).values())e.enable()}},HO=function(){if(this.unselectAll(),r(this,ih)){v(this,ih,!1);for(const t of r(this,ii).values())t.disable();for(const t of r(this,wn).values())t.disable()}},JC=function(t){const e=r(this,ii).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},BO=function(){let t=null;for(t of r(this,fe));return t},Uy=function(){if(r(this,wn).size===0)return!0;if(r(this,wn).size===1)for(const t of r(this,wn).values())return t.isEmpty();return!1},ZC=function(t){for(const e of r(this,fe))e.unselect();r(this,fe).clear();for(const e of t)e.isEmpty()||(r(this,fe).add(e),e.select());A(this,mt,Oi).call(this,{hasSelectedEditor:this.hasSelection})},lt(pp,"TRANSLATE_SMALL",1),lt(pp,"TRANSLATE_BIG",10);let mf=pp;var Gn,Ya,ea,Ig,Ka,Fs,Dg,Qa,os,ul,Ed,Ja,ah,da,Gy,Tw;const Ni=class Ni{constructor(t){E(this,da);E(this,Gn,null);E(this,Ya,!1);E(this,ea,null);E(this,Ig,null);E(this,Ka,null);E(this,Fs,null);E(this,Dg,!1);E(this,Qa,null);E(this,os,null);E(this,ul,null);E(this,Ed,null);E(this,Ja,!1);v(this,os,t),v(this,Ja,t._uiManager.useNewAltTextFlow),r(Ni,ah)||v(Ni,ah,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Ni._l10n??(Ni._l10n=t)}async render(){const t=v(this,ea,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=v(this,Ig,document.createElement("span"));t.append(e),r(this,Ja)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Ni,ah).missing),e.setAttribute("data-l10n-id",r(Ni,ah)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=r(this,os)._uiManager._signal;t.addEventListener("contextmenu",Sr,{signal:n}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),r(this,os)._uiManager.editAltText(r(this,os)),r(this,Ja)&&r(this,os)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,da,Gy)}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(v(this,Dg,!0),i(s))},{signal:n}),await A(this,da,Tw).call(this),t}finish(){r(this,ea)&&(r(this,ea).focus({focusVisible:r(this,Dg)}),v(this,Dg,!1))}isEmpty(){return r(this,Ja)?r(this,Gn)===null:!r(this,Gn)&&!r(this,Ya)}hasData(){return r(this,Ja)?r(this,Gn)!==null||!!r(this,ul):this.isEmpty()}get guessedText(){return r(this,ul)}async setGuessedText(t){r(this,Gn)===null&&(v(this,ul,t),v(this,Ed,await Ni._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),A(this,da,Tw).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,Ja)||r(this,Gn)){(e=r(this,Qa))==null||e.remove(),v(this,Qa,null);return}if(!r(this,Qa)){const n=v(this,Qa,document.createElement("div"));n.className="noAltTextBadge",r(this,os).div.append(n)}r(this,Qa).classList.toggle("hidden",!t)}serialize(t){let e=r(this,Gn);return!t&&r(this,ul)===e&&(e=r(this,Ed)),{altText:e,decorative:r(this,Ya),guessedText:r(this,ul),textWithDisclaimer:r(this,Ed)}}get data(){return{altText:r(this,Gn),decorative:r(this,Ya)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(v(this,ul,n),v(this,Ed,i)),!(r(this,Gn)===t&&r(this,Ya)===e)&&(s||(v(this,Gn,t),v(this,Ya,e)),A(this,da,Tw).call(this))}toggle(t=!1){r(this,ea)&&(!t&&r(this,Fs)&&(clearTimeout(r(this,Fs)),v(this,Fs,null)),r(this,ea).disabled=!t)}shown(){r(this,os)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,da,Gy)}})}destroy(){var t,e;(t=r(this,ea))==null||t.remove(),v(this,ea,null),v(this,Ig,null),v(this,Ka,null),(e=r(this,Qa))==null||e.remove(),v(this,Qa,null)}};Gn=new WeakMap,Ya=new WeakMap,ea=new WeakMap,Ig=new WeakMap,Ka=new WeakMap,Fs=new WeakMap,Dg=new WeakMap,Qa=new WeakMap,os=new WeakMap,ul=new WeakMap,Ed=new WeakMap,Ja=new WeakMap,ah=new WeakMap,da=new WeakSet,Gy=function(){return r(this,Gn)&&"added"||r(this,Gn)===null&&this.guessedText&&"review"||"missing"},Tw=async function(){var i,s,o;const t=r(this,ea);if(!t)return;if(r(this,Ja)){if(t.classList.toggle("done",!!r(this,Gn)),t.setAttribute("data-l10n-id",r(Ni,ah)[r(this,da,Gy)]),(i=r(this,Ig))==null||i.setAttribute("data-l10n-id",r(Ni,ah)[`${r(this,da,Gy)}-label`]),!r(this,Gn)){(s=r(this,Ka))==null||s.remove();return}}else{if(!r(this,Gn)&&!r(this,Ya)){t.classList.remove("done"),(o=r(this,Ka))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,Ka);if(!e){v(this,Ka,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,os).id}`;const l=100,h=r(this,os)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(r(this,Fs)),v(this,Fs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{v(this,Fs,setTimeout(()=>{v(this,Fs,null),r(this,Ka).classList.add("show"),r(this,os)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:h}),t.addEventListener("mouseleave",()=>{var d;r(this,Fs)&&(clearTimeout(r(this,Fs)),v(this,Fs,null)),(d=r(this,Ka))==null||d.classList.remove("show")},{signal:h})}r(this,Ya)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,Gn)),e.parentNode||t.append(e);const n=r(this,os).getImageForAltText();n==null||n.setAttribute("aria-describedby",e.id)},E(Ni,ah,null),lt(Ni,"_l10n",null);let nE=Ni;var Sd,na,Ue,Fg,xd,si,Cd,oh,Jb,Td,lh,Zb,kd,dl,Za,Og,Ng,dr,t0,TE,Vt,tT,e0,eT,nT,zO,UO,iT,sT,rT,GO,aT,VO,WO,qO,oT,Vy;const le=class le{constructor(t){E(this,Vt);E(this,Sd,null);E(this,na,null);E(this,Ue,null);E(this,Fg,!1);E(this,xd,!1);E(this,si,null);E(this,Cd,null);E(this,oh,null);E(this,Jb,"");E(this,Td,!1);E(this,lh,null);E(this,Zb,!1);E(this,kd,!1);E(this,dl,!1);E(this,Za,null);E(this,Og,0);E(this,Ng,0);E(this,dr,null);lt(this,"_editToolbar",null);lt(this,"_initialOptions",Object.create(null));lt(this,"_initialData",null);lt(this,"_isVisible",!0);lt(this,"_uiManager",null);lt(this,"_focusEventsAllowed",!0);E(this,t0,!1);E(this,TE,le._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[l,h]=this.parentDimensions;this.x=t.x/l,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=le.prototype._resizeWithKeyboard,e=mf.TRANSLATE_SMALL,n=mf.TRANSLATE_BIG;return ee(this,"_resizerKeyboardManager",new eA([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],le.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return ee(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Rz({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(le._l10n??(le._l10n=t),le._l10nResizer||(le._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),le._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);le._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,t0)}set _isDraggable(t){var e;v(this,t0,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,TE)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):A(this,Vt,Vy).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,Td)?v(this,Td,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/o,this.fixAndSetPosition()}translate(t,e){A(this,Vt,tT).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,lh)||v(this,lh,[this.x,this.y]),A(this,Vt,tT).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,lh)||v(this,lh,[this.x,this.y]);const[n,i]=this.parentDimensions;if(this.x+=t/n,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[l,h]=this.getBaseTranslation();s+=l,o+=h,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!r(this,lh)&&(r(this,lh)[0]!==this.x||r(this,lh)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=le,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,n]=this.pageDimensions;let{x:i,y:s,width:o,height:l}=this;if(o*=e,l*=n,i*=e,s*=n,this._mustFixPosition)switch(t){case 0:i=Math.max(0,Math.min(e-o,i)),s=Math.max(0,Math.min(n-l,s));break;case 90:i=Math.max(0,Math.min(e-l,i)),s=Math.min(n,Math.max(o,s));break;case 180:i=Math.min(e,Math.max(o,i)),s=Math.min(n,Math.max(l,s));break;case 270:i=Math.min(e,Math.max(l,i)),s=Math.max(0,Math.min(n-o,s));break}this.x=i/=e,this.y=s/=n;const[h,d]=this.getBaseTranslation();i+=h,s+=d;const{style:p}=this.div;p.left=`${(100*i).toFixed(2)}%`,p.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return A(n=le,e0,eT).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return A(n=le,e0,eT).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions;this.div.style.width=`${(100*t/n).toFixed(2)}%`,r(this,xd)||(this.div.style.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!r(this,xd)&&e.endsWith("%");if(i&&s)return;const[o,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!r(this,xd)&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=r(this,Ue))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,kd)?this._editToolbar:(this._editToolbar=new GC(this),this.div.append(this._editToolbar.render()),r(this,Ue)&&await this._editToolbar.addAltText(r(this,Ue)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,Ue))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,Ue)||(nE.initialize(le._l10n),v(this,Ue,new nE(this)),r(this,Sd)&&(r(this,Ue).data=r(this,Sd),v(this,Sd,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,Ue))==null?void 0:t.data}set altTextData(t){r(this,Ue)&&(r(this,Ue).data=t)}get guessedAltText(){var t;return(t=r(this,Ue))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,Ue))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,Ue))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,Ue)&&!r(this,Ue).isEmpty()}hasAltTextData(){var t;return((t=r(this,Ue))==null?void 0:t.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,Fg)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),A(this,Vt,aT).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),eE(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Ui.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(v(this,Td,!0),this._isDraggable){A(this,Vt,GO).call(this,t);return}A(this,Vt,rT).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){r(this,Za)&&clearTimeout(r(this,Za)),v(this,Za,setTimeout(()=>{var t;v(this,Za,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition()}getRect(t,e,n=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[l,h]=this.pageTranslation,d=t/i,p=e/i,g=this.x*s,m=this.y*o,b=this.width*s,_=this.height*o;switch(n){case 0:return[g+d+l,o-m-p-_+h,g+d+b+l,o-m-p+h];case 90:return[g+p+l,o-m+d+h,g+p+_+l,o-m+d+b+h];case 180:return[g-d-b+l,o-m+p+h,g-d+l,o-m+p+_+h];case 270:return[g-p-_+l,o-m-d-b+h,g-p+l,o-m-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,o]=t,l=s-n,h=o-i;switch(this.rotation){case 0:return[n,e-o,l,h];case 90:return[n,e-i,h,l];case 180:return[s,e-i,l,h];case 270:return[s,e-o,h,l];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){v(this,kd,!0)}disableEditMode(){v(this,kd,!1)}isInEditMode(){return r(this,kd)}shouldGetKeyboardEvents(){return r(this,dl)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){A(this,Vt,aT).call(this)}rotate(t){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Me("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,v(i,Sd,t.accessibilityData);const[s,o]=i.pageDimensions,[l,h,d,p]=i.getRectInCurrentCoords(t.rect,o);return i.x=l/s,i.y=h/o,i.width=d/s,i.height=p/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t;if((t=r(this,oh))==null||t.abort(),v(this,oh,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,Za)&&(clearTimeout(r(this,Za)),v(this,Za,null)),A(this,Vt,Vy).call(this),this.removeEditToolbar(),r(this,dr)){for(const e of r(this,dr).values())clearTimeout(e);v(this,dr,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Vt,zO).call(this),r(this,si).classList.remove("hidden"),eE(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),v(this,Cd,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,si).children;if(!r(this,na)){v(this,na,Array.from(e));const o=A(this,Vt,VO).bind(this),l=A(this,Vt,WO).bind(this),h=this._uiManager._signal;for(const d of r(this,na)){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:h}),d.addEventListener("blur",l,{signal:h}),d.addEventListener("focus",A(this,Vt,qO).bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",le._l10nResizer[p])}}const n=r(this,na)[0];let i=0;for(const o of e){if(o===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(r(this,na).length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)r(this,si).append(r(this,si).firstChild);else if(s>i)for(let l=0;l<s-i;l++)r(this,si).firstChild.before(r(this,si).lastChild);let o=0;for(const l of e){const d=r(this,na)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",le._l10nResizer[d])}}A(this,Vt,oT).call(this,0),v(this,dl,!0),r(this,si).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,dl)&&A(this,Vt,sT).call(this,r(this,Jb),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){A(this,Vt,Vy).call(this),this.div.focus()}select(){var t,e,n;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(n=r(this,Ue))==null||n.toggleAltTextBadge(!1)}unselect(){var t,e,n,i,s;(t=r(this,si))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=r(this,Ue))==null||s.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,Zb)}set isEditing(t){v(this,Zb,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){v(this,xd,!0);const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,dr)||v(this,dr,new Map);const{action:n}=t;let i=r(this,dr).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),r(this,dr).delete(n),r(this,dr).size===0&&v(this,dr,null)},le._telemetryTimeout),r(this,dr).set(n,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),v(this,Fg,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,Fg,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Sd=new WeakMap,na=new WeakMap,Ue=new WeakMap,Fg=new WeakMap,xd=new WeakMap,si=new WeakMap,Cd=new WeakMap,oh=new WeakMap,Jb=new WeakMap,Td=new WeakMap,lh=new WeakMap,Zb=new WeakMap,kd=new WeakMap,dl=new WeakMap,Za=new WeakMap,Og=new WeakMap,Ng=new WeakMap,dr=new WeakMap,t0=new WeakMap,TE=new WeakMap,Vt=new WeakSet,tT=function([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this.fixAndSetPosition()},e0=new WeakSet,eT=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},nT=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},zO=function(){if(r(this,si))return;v(this,si,document.createElement("div")),r(this,si).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const i=document.createElement("div");r(this,si).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",A(this,Vt,UO).bind(this,n),{signal:e}),i.addEventListener("contextmenu",Sr,{signal:e}),i.tabIndex=-1}this.div.prepend(r(this,si))},UO=function(t,e){var _;e.preventDefault();const{isMac:n}=Ui.platform;if(e.button!==0||e.ctrlKey&&n)return;(_=r(this,Ue))==null||_.toggle(!1);const i=this._isDraggable;this._isDraggable=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,Vt,sT).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("contextmenu",Sr,{signal:o});const l=this.x,h=this.y,d=this.width,p=this.height,g=this.parent.div.style.cursor,m=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const b=()=>{var S;s.abort(),this.parent.togglePointerEvents(!0),(S=r(this,Ue))==null||S.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=g,this.div.style.cursor=m,A(this,Vt,iT).call(this,l,h,d,p)};window.addEventListener("pointerup",b,{signal:o}),window.addEventListener("blur",b,{signal:o})},iT=function(t,e,n,i){const s=this.x,o=this.y,l=this.width,h=this.height;s===t&&o===e&&l===n&&h===i||this.addCommands({cmd:()=>{this.width=l,this.height=h,this.x=s,this.y=o;const[d,p]=this.parentDimensions;this.setDims(d*l,p*h),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=i,this.x=t,this.y=e;const[d,p]=this.parentDimensions;this.setDims(d*n,p*i),this.fixAndSetPosition()},mustExec:!0})},sT=function(t,e){const[n,i]=this.parentDimensions,s=this.x,o=this.y,l=this.width,h=this.height,d=le.MIN_SIZE/n,p=le.MIN_SIZE/i,g=G=>Math.round(G*1e4)/1e4,m=A(this,Vt,nT).call(this,this.rotation),b=(G,q)=>[m[0]*G+m[2]*q,m[1]*G+m[3]*q],_=A(this,Vt,nT).call(this,360-this.rotation),S=(G,q)=>[_[0]*G+_[2]*q,_[1]*G+_[3]*q];let C,T,k=!1,P=!1;switch(t){case"topLeft":k=!0,C=(G,q)=>[0,0],T=(G,q)=>[G,q];break;case"topMiddle":C=(G,q)=>[G/2,0],T=(G,q)=>[G/2,q];break;case"topRight":k=!0,C=(G,q)=>[G,0],T=(G,q)=>[0,q];break;case"middleRight":P=!0,C=(G,q)=>[G,q/2],T=(G,q)=>[0,q/2];break;case"bottomRight":k=!0,C=(G,q)=>[G,q],T=(G,q)=>[0,0];break;case"bottomMiddle":C=(G,q)=>[G/2,q],T=(G,q)=>[G/2,0];break;case"bottomLeft":k=!0,C=(G,q)=>[0,q],T=(G,q)=>[G,0];break;case"middleLeft":P=!0,C=(G,q)=>[0,q/2],T=(G,q)=>[G,q/2];break}const L=C(l,h),I=T(l,h);let D=b(...I);const F=g(s+D[0]),H=g(o+D[1]);let j=1,Q=1,[V,tt]=this.screenToPageTranslation(e.movementX,e.movementY);if([V,tt]=S(V/n,tt/i),k){const G=Math.hypot(l,h);j=Q=Math.max(Math.min(Math.hypot(I[0]-L[0]-V,I[1]-L[1]-tt)/G,1/l,1/h),d/l,p/h)}else P?j=Math.max(d,Math.min(1,Math.abs(I[0]-L[0]-V)))/l:Q=Math.max(p,Math.min(1,Math.abs(I[1]-L[1]-tt)))/h;const Z=g(l*j),et=g(h*Q);D=b(...T(Z,et));const ht=F-D[0],J=H-D[1];this.width=Z,this.height=et,this.x=ht,this.y=J,this.setDims(n*Z,i*et),this.fixAndSetPosition()},rT=function(t){const{isMac:e}=Ui.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},GO=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const n=new AbortController,i=this._uiManager.combinedSignal(n);if(e){this.div.classList.add("moving"),v(this,Og,t.clientX),v(this,Ng,t.clientY);const o=l=>{const{clientX:h,clientY:d}=l,[p,g]=this.screenToPageTranslation(h-r(this,Og),d-r(this,Ng));v(this,Og,h),v(this,Ng,d),this._uiManager.dragSelectedEditors(p,g)};window.addEventListener("pointermove",o,{passive:!0,capture:!0,signal:i})}const s=()=>{n.abort(),e&&this.div.classList.remove("moving"),v(this,Td,!1),this._uiManager.endDragSession()||A(this,Vt,rT).call(this,t)};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})},aT=function(){if(r(this,oh)||!this.div)return;v(this,oh,new AbortController);const t=this._uiManager.combinedSignal(r(this,oh));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},VO=function(t){le._resizerKeyboardManager.exec(this,t)},WO=function(t){var e;r(this,dl)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,si)&&A(this,Vt,Vy).call(this)},qO=function(t){v(this,Jb,r(this,dl)?t:"")},oT=function(t){if(r(this,na))for(const e of r(this,na))e.tabIndex=t},Vy=function(){if(v(this,dl,!1),A(this,Vt,oT).call(this,-1),r(this,Cd)){const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=r(this,Cd);A(this,Vt,iT).call(this,t,e,n,i),v(this,Cd,null)}},E(le,e0),lt(le,"_l10n",null),lt(le,"_l10nResizer",null),lt(le,"_borderLineWidth",-1),lt(le,"_colorManager",new qC),lt(le,"_zIndex",1),lt(le,"_telemetryTimeout",1e3);let me=le;class Rz extends me{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const kM=3285377520,ir=4294901760,xa=65535;class XO{constructor(t){this.h1=t?t&4294967295:kM,this.h2=t?t&4294967295:kM}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,C=t.length;S<C;S++){const T=t.charCodeAt(S);T<=255?e[n++]=T:(e[n++]=T>>>8,e[n++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,o=new Uint32Array(e.buffer,0,i);let l=0,h=0,d=this.h1,p=this.h2;const g=3432918353,m=461845907,b=g&xa,_=m&xa;for(let S=0;S<i;S++)S&1?(l=o[S],l=l*g&ir|l*b&xa,l=l<<15|l>>>17,l=l*m&ir|l*_&xa,d^=l,d=d<<13|d>>>19,d=d*5+3864292196):(h=o[S],h=h*g&ir|h*b&xa,h=h<<15|h>>>17,h=h*m&ir|h*_&xa,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*g&ir|l*b&xa,l=l<<15|l>>>17,l=l*m&ir|l*_&xa,i&1?d^=l:p^=l}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&ir|t*36045&xa,e=e*4283543511&ir|((e<<16|t>>>16)*2950163797&ir)>>>16,t^=e>>>1,t=t*444984403&ir|t*60499&xa,e=e*3301882366&ir|((e<<16|t>>>16)*3120437893&ir)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const lT=Object.freeze({map:null,hash:"",transfer:void 0});var Pd,Rd,Vn,kE,YO;class Ck{constructor(){E(this,kE);E(this,Pd,!1);E(this,Rd,null);E(this,Vn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=r(this,Vn).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return r(this,Vn).get(t)}remove(t){if(r(this,Vn).delete(t),r(this,Vn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,Vn).values())if(e instanceof me)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=r(this,Vn).get(t);let i=!1;if(n!==void 0)for(const[s,o]of Object.entries(e))n[s]!==o&&(i=!0,n[s]=o);else i=!0,r(this,Vn).set(t,e);i&&A(this,kE,YO).call(this),e instanceof me&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Vn).has(t)}getAll(){return r(this,Vn).size>0?Ak(r(this,Vn)):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return r(this,Vn).size}resetModified(){r(this,Pd)&&(v(this,Pd,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new KO(this)}get serializable(){if(r(this,Vn).size===0)return lT;const t=new Map,e=new XO,n=[],i=Object.create(null);let s=!1;for(const[o,l]of r(this,Vn)){const h=l instanceof me?l.serialize(!1,i):l;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const o of t.values())o.bitmap&&n.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:lT}get editorStats(){let t=null;const e=new Map;for(const n of r(this,Vn).values()){if(!(n instanceof me))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const o=t[s]||(t[s]=new Map);for(const[l,h]of Object.entries(i)){if(l==="type")continue;let d=o.get(l);d||(d=new Map,o.set(l,d));const p=d.get(h)??0;d.set(h,p+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){v(this,Rd,null)}get modifiedIds(){if(r(this,Rd))return r(this,Rd);const t=[];for(const e of r(this,Vn).values())!(e instanceof me)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return v(this,Rd,{ids:new Set(t),hash:t.join(",")})}}Pd=new WeakMap,Rd=new WeakMap,Vn=new WeakMap,kE=new WeakSet,YO=function(){r(this,Pd)||(v(this,Pd,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var n0;class KO extends Ck{constructor(e){super();E(this,n0);const{map:n,hash:i,transfer:s}=e.serializable,o=structuredClone(n,s?{transfer:s}:null);v(this,n0,{map:o,hash:i,transfer:s})}get print(){Me("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,n0)}get modifiedIds(){return ee(this,"modifiedIds",{ids:new Set,hash:""})}}n0=new WeakMap;var $g;class Lz{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){E(this,$g,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,$g).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,$g).has(t.loadedName))){if(Cn(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=t,o=new FontFace(n,i,s);this.addNativeFontFace(o);try{await o.load(),r(this,$g).add(n),e==null||e(t)}catch{Wt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Wt(`Failed to load font '${n.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return ee(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ri||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),ee(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Cn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:e,callback:t};return n.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ee(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(L,I){return L.charCodeAt(I)<<24|L.charCodeAt(I+1)<<16|L.charCodeAt(I+2)<<8|L.charCodeAt(I+3)&255}function i(L,I,D,F){const H=L.substring(0,I),j=L.substring(I+D);return H+F+j}let s,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let d=0;function p(L,I){if(++d>30){Wt("Load test font never loaded."),I();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(p.bind(null,L,I))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,g.length,g);const _=16,S=1482184792;let C=n(m,_);for(s=0,o=g.length-3;s<o;s+=4)C=C-S+n(g,s)|0;s<g.length&&(C=C-S+n(g+"XXX",s)|0),m=i(m,_,4,gz(C));const T=`url(data:font/opentype;base64,${btoa(m)});`,k=`@font-face {font-family:"${g}";src:${T}}`;this.insertRule(k);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[t.loadedName,g]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=L,P.append(I)}this._document.body.append(P),p(g,()=>{P.remove(),e.complete()})}}$g=new WeakMap;class Mz{constructor(t,{disableFontFace:e=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this.disableFontFace=e===!0,this._inspectFont=n}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${_z(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let n;try{n=t.get(this.loadedName+"_path_"+e)}catch(s){Wt(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[e]=function(s,o){};const i=[];for(let s=0,o=n.length;s<o;)switch(n[s++]){case Co.BEZIER_CURVE_TO:{const[l,h,d,p,g,m]=n.slice(s,s+6);i.push(b=>b.bezierCurveTo(l,h,d,p,g,m)),s+=6}break;case Co.MOVE_TO:{const[l,h]=n.slice(s,s+2);i.push(d=>d.moveTo(l,h)),s+=2}break;case Co.LINE_TO:{const[l,h]=n.slice(s,s+2);i.push(d=>d.lineTo(l,h)),s+=2}break;case Co.QUADRATIC_CURVE_TO:{const[l,h,d,p]=n.slice(s,s+4);i.push(g=>g.quadraticCurveTo(l,h,d,p)),s+=4}break;case Co.RESTORE:i.push(l=>l.restore());break;case Co.SAVE:i.push(l=>l.save());break;case Co.SCALE:Cn(i.length===2,"Scale command is only valid at the third position.");break;case Co.TRANSFORM:{const[l,h,d,p,g,m]=n.slice(s,s+6);i.push(b=>b.transform(l,h,d,p,g,m)),s+=6}break;case Co.TRANSLATE:{const[l,h]=n.slice(s,s+2);i.push(d=>d.translate(l,h)),s+=2}break}return this.compiledGlyphs[e]=function(o,l){i[0](o),i[1](o),o.scale(l,-l);for(let h=2,d=i.length;h<d;h++)i[h](o)}}}var i0;class QO{constructor({enableHWA:t=!1}){E(this,i0,!1);v(this,i0,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!r(this,i0)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Me("Abstract method `_createCanvas` called.")}}i0=new WeakMap;class Iz extends QO{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class JO{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class ZO extends JO{async _fetch(t){const e=await JE(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):QE(e)}}class tN{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(t=!1){}}var Ld,Md,to,fl,xi,PE,Id,bt,bi,ap,op,kw,lp,eN,cT,cp,Wy,qy,hT,Xy;class Dz extends tN{constructor({docId:e,ownerDocument:n=globalThis.document}){super();E(this,bt);E(this,Ld);E(this,Md);E(this,to);E(this,fl);E(this,xi);E(this,PE);E(this,Id,0);v(this,fl,e),v(this,xi,n)}addFilter(e){if(!e)return"none";let n=r(this,bt,bi).get(e);if(n)return n;const[i,s,o]=A(this,bt,kw).call(this,e),l=e.length===1?i:`${i}${s}${o}`;if(n=r(this,bt,bi).get(l),n)return r(this,bt,bi).set(e,n),n;const h=`g_${r(this,fl)}_transfer_map_${he(this,Id)._++}`,d=A(this,bt,lp).call(this,h);r(this,bt,bi).set(e,d),r(this,bt,bi).set(l,d);const p=A(this,bt,cp).call(this,h);return A(this,bt,qy).call(this,i,s,o,p),d}addHCMFilter(e,n){var _;const i=`${e}-${n}`,s="base";let o=r(this,bt,ap).get(s);if((o==null?void 0:o.key)===i||(o?((_=o.filter)==null||_.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},r(this,bt,ap).set(s,o)),!e||!n))return o.url;const l=A(this,bt,Xy).call(this,e);e=Pt.makeHexColor(...l);const h=A(this,bt,Xy).call(this,n);if(n=Pt.makeHexColor(...h),r(this,bt,op).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return o.url;const d=new Array(256);for(let S=0;S<=255;S++){const C=S/255;d[S]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const p=d.join(","),g=`g_${r(this,fl)}_hcm_filter`,m=o.filter=A(this,bt,cp).call(this,g);A(this,bt,qy).call(this,p,p,p,m),A(this,bt,cT).call(this,m);const b=(S,C)=>{const T=l[S]/255,k=h[S]/255,P=new Array(C+1);for(let L=0;L<=C;L++)P[L]=T+L/C*(k-T);return P.join(",")};return A(this,bt,qy).call(this,b(0,5),b(1,5),b(2,5),m),o.url=A(this,bt,lp).call(this,g),o.url}addAlphaFilter(e){let n=r(this,bt,bi).get(e);if(n)return n;const[i]=A(this,bt,kw).call(this,[e]),s=`alpha_${i}`;if(n=r(this,bt,bi).get(s),n)return r(this,bt,bi).set(e,n),n;const o=`g_${r(this,fl)}_alpha_map_${he(this,Id)._++}`,l=A(this,bt,lp).call(this,o);r(this,bt,bi).set(e,l),r(this,bt,bi).set(s,l);const h=A(this,bt,cp).call(this,o);return A(this,bt,hT).call(this,i,h),l}addLuminosityFilter(e){let n=r(this,bt,bi).get(e||"luminosity");if(n)return n;let i,s;if(e?([i]=A(this,bt,kw).call(this,[e]),s=`luminosity_${i}`):s="luminosity",n=r(this,bt,bi).get(s),n)return r(this,bt,bi).set(e,n),n;const o=`g_${r(this,fl)}_luminosity_map_${he(this,Id)._++}`,l=A(this,bt,lp).call(this,o);r(this,bt,bi).set(e,l),r(this,bt,bi).set(s,l);const h=A(this,bt,cp).call(this,o);return A(this,bt,eN).call(this,h),e&&A(this,bt,hT).call(this,i,h),l}addHighlightHCMFilter(e,n,i,s,o){var k;const l=`${n}-${i}-${s}-${o}`;let h=r(this,bt,ap).get(e);if((h==null?void 0:h.key)===l||(h?((k=h.filter)==null||k.remove(),h.key=l,h.url="none",h.filter=null):(h={key:l,url:"none",filter:null},r(this,bt,ap).set(e,h)),!n||!i))return h.url;const[d,p]=[n,i].map(A(this,bt,Xy).bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[b,_]=[s,o].map(A(this,bt,Xy).bind(this));m<g&&([g,m,b,_]=[m,g,_,b]),r(this,bt,op).style.color="";const S=(P,L,I)=>{const D=new Array(256),F=(m-g)/I,H=P/255,j=(L-P)/(255*I);let Q=0;for(let V=0;V<=I;V++){const tt=Math.round(g+V*F),Z=H+V*j;for(let et=Q;et<=tt;et++)D[et]=Z;Q=tt+1}for(let V=Q;V<256;V++)D[V]=D[Q-1];return D.join(",")},C=`g_${r(this,fl)}_hcm_${e}_filter`,T=h.filter=A(this,bt,cp).call(this,C);return A(this,bt,cT).call(this,T),A(this,bt,qy).call(this,S(b[0],_[0],5),S(b[1],_[1],5),S(b[2],_[2],5),T),h.url=A(this,bt,lp).call(this,C),h.url}destroy(e=!1){e&&r(this,bt,ap).size!==0||(r(this,to)&&(r(this,to).parentNode.parentNode.remove(),v(this,to,null)),r(this,Md)&&(r(this,Md).clear(),v(this,Md,null)),v(this,Id,0))}}Ld=new WeakMap,Md=new WeakMap,to=new WeakMap,fl=new WeakMap,xi=new WeakMap,PE=new WeakMap,Id=new WeakMap,bt=new WeakSet,bi=function(){return r(this,Md)||v(this,Md,new Map)},ap=function(){return r(this,PE)||v(this,PE,new Map)},op=function(){if(!r(this,to)){const e=r(this,xi).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=r(this,xi).createElementNS(Io,"svg");i.setAttribute("width",0),i.setAttribute("height",0),v(this,to,r(this,xi).createElementNS(Io,"defs")),e.append(i),i.append(r(this,to)),r(this,xi).body.append(e)}return r(this,to)},kw=function(e){if(e.length===1){const d=e[0],p=new Array(256);for(let m=0;m<256;m++)p[m]=d[m]/255;const g=p.join(",");return[g,g,g]}const[n,i,s]=e,o=new Array(256),l=new Array(256),h=new Array(256);for(let d=0;d<256;d++)o[d]=n[d]/255,l[d]=i[d]/255,h[d]=s[d]/255;return[o.join(","),l.join(","),h.join(",")]},lp=function(e){if(r(this,Ld)===void 0){v(this,Ld,"");const n=r(this,xi).URL;n!==r(this,xi).baseURI&&(ZE(n)?Wt('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,Ld,n.split("#",1)[0]))}return`url(${r(this,Ld)}#${e})`},eN=function(e){const n=r(this,xi).createElementNS(Io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},cT=function(e){const n=r(this,xi).createElementNS(Io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},cp=function(e){const n=r(this,xi).createElementNS(Io,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),r(this,bt,op).append(n),n},Wy=function(e,n,i){const s=r(this,xi).createElementNS(Io,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)},qy=function(e,n,i,s){const o=r(this,xi).createElementNS(Io,"feComponentTransfer");s.append(o),A(this,bt,Wy).call(this,o,"feFuncR",e),A(this,bt,Wy).call(this,o,"feFuncG",n),A(this,bt,Wy).call(this,o,"feFuncB",i)},hT=function(e,n){const i=r(this,xi).createElementNS(Io,"feComponentTransfer");n.append(i),A(this,bt,Wy).call(this,i,"feFuncA",e)},Xy=function(e){return r(this,bt,op).style.color=e,xk(getComputedStyle(r(this,bt,op)).getPropertyValue("color"))};class nN{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class iN extends nN{async _fetch(t){const e=await JE(t,"arraybuffer");return new Uint8Array(e)}}if(Ri){var uT=Promise.withResolvers(),av=null;(async()=>{const t=await w_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),e=await w_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),n=await w_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await w_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let s,o;return new Map(Object.entries({fs:t,http:e,https:n,url:i,canvas:s,path2d:o}))})().then(t=>{av=t,uT.resolve()},t=>{Wt(`loadPackages: ${t}`),av=new Map,uT.resolve()})}class kh{static get promise(){return uT.promise}static get(t){return av==null?void 0:av.get(t)}}async function sN(u){const e=await kh.get("fs").promises.readFile(u);return new Uint8Array(e)}class Fz extends tN{}class Oz extends QO{_createCanvas(t,e){return kh.get("canvas").createCanvas(t,e)}}class Nz extends JO{async _fetch(t){return sN(t)}}class $z extends nN{async _fetch(t){return sN(t)}}const Bi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function dT(u,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,n),u.clip(i)}class Tk{getPattern(){Me("Abstract method `getPattern` called.")}}class jz extends Tk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let s;if(i===Bi.STROKE||i===Bi.FILL){const o=e.current.getClippedPathBoundingBox(i,Ve(t))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,d=e.cachedCanvases.getCanvas("pattern",l,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),n=Pt.transform(n,[1,0,0,1,o[0],o[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),dT(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),s=t.createPattern(d.canvas,"no-repeat");const g=new DOMMatrix(n);s.setTransform(g)}else dT(t,this._bbox),s=this._createGradient(t);return s}}function xx(u,t,e,n,i,s,o,l){const h=t.coords,d=t.colors,p=u.data,g=u.width*4;let m;h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m),h[n+1]>h[i+1]&&(m=n,n=i,i=m,m=o,o=l,l=m),h[e+1]>h[n+1]&&(m=e,e=n,n=m,m=s,s=o,o=m);const b=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,C=(h[n+1]+t.offsetY)*t.scaleY,T=(h[i]+t.offsetX)*t.scaleX,k=(h[i+1]+t.offsetY)*t.scaleY;if(_>=k)return;const P=d[s],L=d[s+1],I=d[s+2],D=d[o],F=d[o+1],H=d[o+2],j=d[l],Q=d[l+1],V=d[l+2],tt=Math.round(_),Z=Math.round(k);let et,ht,J,G,q,U,N,M;for(let B=tt;B<=Z;B++){if(B<C){const nt=B<_?0:(_-B)/(_-C);et=b-(b-S)*nt,ht=P-(P-D)*nt,J=L-(L-F)*nt,G=I-(I-H)*nt}else{let nt;B>k?nt=1:C===k?nt=0:nt=(C-B)/(C-k),et=S-(S-T)*nt,ht=D-(D-j)*nt,J=F-(F-Q)*nt,G=H-(H-V)*nt}let Y;B<_?Y=0:B>k?Y=1:Y=(_-B)/(_-k),q=b-(b-T)*Y,U=P-(P-j)*Y,N=L-(L-Q)*Y,M=I-(I-V)*Y;const it=Math.round(Math.min(et,q)),dt=Math.round(Math.max(et,q));let at=g*B+it*4;for(let nt=it;nt<=dt;nt++)Y=(et-nt)/(et-q),Y<0?Y=0:Y>1&&(Y=1),p[at++]=ht-(ht-U)*Y|0,p[at++]=J-(J-N)*Y|0,p[at++]=G-(G-M)*Y|0,p[at++]=255}}function Hz(u,t,e){const n=t.coords,i=t.colors;let s,o;switch(t.type){case"lattice":const l=t.verticesPerRow,h=Math.floor(n.length/l)-1,d=l-1;for(s=0;s<h;s++){let p=s*l;for(let g=0;g<d;g++,p++)xx(u,e,n[p],n[p+1],n[p+l],i[p],i[p+1],i[p+l]),xx(u,e,n[p+l+1],n[p+1],n[p+l],i[p+l+1],i[p+1],i[p+l])}break;case"triangles":for(s=0,o=n.length;s<o;s+=3)xx(u,e,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class Bz extends Tk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-l,p=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=d/g,_=p/m,S={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/b,scaleY:1/_},C=g+2*2,T=m+2*2,k=n.getCanvas("mesh",C,T),P=k.context,L=P.createImageData(g,m);if(e){const D=L.data;for(let F=0,H=D.length;F<H;F+=4)D[F]=e[0],D[F+1]=e[1],D[F+2]=e[2],D[F+3]=255}for(const D of this._figures)Hz(L,D,S);return P.putImageData(L,2,2),{canvas:k.canvas,offsetX:l-2*b,offsetY:h-2*_,scaleX:b,scaleY:_}}getPattern(t,e,n,i){dT(t,this._bbox);let s;if(i===Bi.SHADING)s=Pt.singularValueDecompose2dScale(Ve(t));else if(s=Pt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const l=Pt.singularValueDecompose2dScale(this.matrix);s=[s[0]*l[0],s[1]*l[1]]}const o=this._createMeshCanvas(s,i===Bi.SHADING?null:this._background,e.cachedCanvases);return i!==Bi.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class zz extends Tk{getPattern(){return"hotpink"}}function Uz(u){switch(u[0]){case"RadialAxial":return new jz(u);case"Mesh":return new Bz(u);case"Dummy":return new zz}throw new Error(`Unknown IR type: ${u[0]}`)}const PM={COLORED:1,UNCOLORED:2},RE=class RE{constructor(t,e,n,i,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:o,canvasGraphicsFactory:l}=this;let{xstep:h,ystep:d}=this;h=Math.abs(h),d=Math.abs(d),YE("TilingType: "+s);const p=e[0],g=e[1],m=e[2],b=e[3],_=m-p,S=b-g,C=Pt.singularValueDecompose2dScale(this.matrix),T=Pt.singularValueDecompose2dScale(this.baseTransform),k=C[0]*T[0],P=C[1]*T[1];let L=_,I=S,D=!1,F=!1;const H=Math.ceil(h*k),j=Math.ceil(d*P),Q=Math.ceil(_*k),V=Math.ceil(S*P);H>=Q?L=h:D=!0,j>=V?I=d:F=!0;const tt=this.getSizeAndScale(L,this.ctx.canvas.width,k),Z=this.getSizeAndScale(I,this.ctx.canvas.height,P),et=t.cachedCanvases.getCanvas("pattern",tt.size,Z.size),ht=et.context,J=l.createCanvasGraphics(ht);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,i,o),ht.translate(-tt.scale*p,-Z.scale*g),J.transform(tt.scale,0,0,Z.scale,0,0),ht.save(),this.clipBbox(J,p,g,m,b),J.baseTransform=Ve(J.ctx),J.executeOperatorList(n),J.endDrawing(),ht.restore(),D||F){const G=et.canvas;D&&(L=h),F&&(I=d);const q=this.getSizeAndScale(L,this.ctx.canvas.width,k),U=this.getSizeAndScale(I,this.ctx.canvas.height,P),N=q.size,M=U.size,B=t.cachedCanvases.getCanvas("pattern-workaround",N,M),Y=B.context,it=D?Math.floor(_/h):0,dt=F?Math.floor(S/d):0;for(let at=0;at<=it;at++)for(let nt=0;nt<=dt;nt++)Y.drawImage(G,N*at,M*nt,N,M,0,0,N,M);return{canvas:B.canvas,scaleX:q.scale,scaleY:U.scale,offsetX:p,offsetY:g}}return{canvas:et.canvas,scaleX:tt.scale,scaleY:Z.scale,offsetX:p,offsetY:g}}getSizeAndScale(t,e,n){const i=Math.max(RE.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const o=i-e,l=s-n;t.ctx.rect(e,n,o,l),t.current.updateRectMinMax(Ve(t.ctx),[e,n,i,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case PM.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,s.fillColor=o.fillStyle,s.strokeColor=o.strokeStyle;break;case PM.UNCOLORED:const l=Pt.makeHexColor(n[0],n[1],n[2]);i.fillStyle=l,i.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new pz(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let s=n;i!==Bi.SHADING&&(s=Pt.transform(s,e.baseTransform),this.matrix&&(s=Pt.transform(s,this.matrix)));const o=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const h=t.createPattern(o.canvas,"repeat");return h.setTransform(l),h}};lt(RE,"MAX_PATTERN_SIZE",3e3);let fT=RE;function Gz({src:u,srcPos:t=0,dest:e,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=Ui.isLittleEndian?4278190080:255,[h,d]=o?[s,l]:[l,s],p=n>>3,g=n&7,m=u.length;e=new Uint32Array(e.buffer);let b=0;for(let _=0;_<i;_++){for(const C=t+p;t<C;t++){const T=t<m?u[t]:255;e[b++]=T&128?d:h,e[b++]=T&64?d:h,e[b++]=T&32?d:h,e[b++]=T&16?d:h,e[b++]=T&8?d:h,e[b++]=T&4?d:h,e[b++]=T&2?d:h,e[b++]=T&1?d:h}if(g===0)continue;const S=t<m?u[t++]:255;for(let C=0;C<g;C++)e[b++]=S&1<<7-C?d:h}return{srcPos:t,destPos:b}}const RM=16,LM=100,Vz=15,MM=10,IM=1e3,us=16;function Wz(u,t){if(u._removeMirroring)throw new Error("Context is already forwarding operations.");u.__originalSave=u.save,u.__originalRestore=u.restore,u.__originalRotate=u.rotate,u.__originalScale=u.scale,u.__originalTranslate=u.translate,u.__originalTransform=u.transform,u.__originalSetTransform=u.setTransform,u.__originalResetTransform=u.resetTransform,u.__originalClip=u.clip,u.__originalMoveTo=u.moveTo,u.__originalLineTo=u.lineTo,u.__originalBezierCurveTo=u.bezierCurveTo,u.__originalRect=u.rect,u.__originalClosePath=u.closePath,u.__originalBeginPath=u.beginPath,u._removeMirroring=()=>{u.save=u.__originalSave,u.restore=u.__originalRestore,u.rotate=u.__originalRotate,u.scale=u.__originalScale,u.translate=u.__originalTranslate,u.transform=u.__originalTransform,u.setTransform=u.__originalSetTransform,u.resetTransform=u.__originalResetTransform,u.clip=u.__originalClip,u.moveTo=u.__originalMoveTo,u.lineTo=u.__originalLineTo,u.bezierCurveTo=u.__originalBezierCurveTo,u.rect=u.__originalRect,u.closePath=u.__originalClosePath,u.beginPath=u.__originalBeginPath,delete u._removeMirroring},u.save=function(){t.save(),this.__originalSave()},u.restore=function(){t.restore(),this.__originalRestore()},u.translate=function(n,i){t.translate(n,i),this.__originalTranslate(n,i)},u.scale=function(n,i){t.scale(n,i),this.__originalScale(n,i)},u.transform=function(n,i,s,o,l,h){t.transform(n,i,s,o,l,h),this.__originalTransform(n,i,s,o,l,h)},u.setTransform=function(n,i,s,o,l,h){t.setTransform(n,i,s,o,l,h),this.__originalSetTransform(n,i,s,o,l,h)},u.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},u.rotate=function(n){t.rotate(n),this.__originalRotate(n)},u.clip=function(n){t.clip(n),this.__originalClip(n)},u.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},u.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},u.bezierCurveTo=function(e,n,i,s,o,l){t.bezierCurveTo(e,n,i,s,o,l),this.__originalBezierCurveTo(e,n,i,s,o,l)},u.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},u.closePath=function(){t.closePath(),this.__originalClosePath()},u.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class qz{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function E_(u,t,e,n,i,s,o,l,h,d){const[p,g,m,b,_,S]=Ve(u);if(g===0&&m===0){const k=o*p+_,P=Math.round(k),L=l*b+S,I=Math.round(L),D=(o+h)*p+_,F=Math.abs(Math.round(D)-P)||1,H=(l+d)*b+S,j=Math.abs(Math.round(H)-I)||1;return u.setTransform(Math.sign(p),0,0,Math.sign(b),P,I),u.drawImage(t,e,n,i,s,0,0,F,j),u.setTransform(p,g,m,b,_,S),[F,j]}if(p===0&&b===0){const k=l*m+_,P=Math.round(k),L=o*g+S,I=Math.round(L),D=(l+d)*m+_,F=Math.abs(Math.round(D)-P)||1,H=(o+h)*g+S,j=Math.abs(Math.round(H)-I)||1;return u.setTransform(0,Math.sign(g),Math.sign(m),0,P,I),u.drawImage(t,e,n,i,s,0,0,j,F),u.setTransform(p,g,m,b,_,S),[j,F]}u.drawImage(t,e,n,i,s,o,l,h,d);const C=Math.hypot(p,g),T=Math.hypot(m,b);return[C*h,T*d]}function Xz(u){const{width:t,height:e}=u;if(t>IM||e>IM)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let o=new Uint8Array(s*(e+1)),l,h,d;const p=t+7&-8;let g=new Uint8Array(p*e),m=0;for(const T of u.data){let k=128;for(;k>0;)g[m++]=T&k?0:255,k>>=1}let b=0;for(m=0,g[m]!==0&&(o[0]=1,++b),h=1;h<t;h++)g[m]!==g[m+1]&&(o[h]=g[m]?2:1,++b),m++;for(g[m]!==0&&(o[h]=2,++b),l=1;l<e;l++){m=l*p,d=l*s,g[m-p]!==g[m]&&(o[d]=g[m]?1:8,++b);let T=(g[m]?4:0)+(g[m-p]?8:0);for(h=1;h<t;h++)T=(T>>2)+(g[m+1]?4:0)+(g[m-p+1]?8:0),i[T]&&(o[d+h]=i[T],++b),m++;if(g[m-p]!==g[m]&&(o[d+h]=g[m]?2:4,++b),b>n)return null}for(m=p*(e-1),d=l*s,g[m]!==0&&(o[d]=8,++b),h=1;h<t;h++)g[m]!==g[m+1]&&(o[d+h]=g[m]?4:8,++b),m++;if(g[m]!==0&&(o[d+h]=4,++b),b>n)return null;const _=new Int32Array([0,s,-1,0,-s,0,0,0,1]),S=new Path2D;for(l=0;b&&l<=e;l++){let T=l*s;const k=T+t;for(;T<k&&!o[T];)T++;if(T===k)continue;S.moveTo(T%s,l);const P=T;let L=o[T];do{const I=_[L];do T+=I;while(!o[T]);const D=o[T];D!==5&&D!==10?(L=D,o[T]=0):(L=D&51*L>>4,o[T]&=L>>2|L<<2),S.lineTo(T%s,T/s|0),o[T]||--b}while(P!==T);--l}return g=null,o=null,function(T){T.save(),T.scale(1/t,-1/e),T.translate(0,-e),T.fill(S),T.beginPath(),T.restore()}}class DM{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_O,this.textMatrixScale=1,this.fontMatrix=jC,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=vi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=Pt.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=Pt.applyTransform(e,t),i=Pt.applyTransform(e.slice(2),t),s=Pt.applyTransform([e[0],e[3]],t),o=Pt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],s[0],o[0]),this.minY=Math.min(this.minY,n[1],i[1],s[1],o[1]),this.maxX=Math.max(this.maxX,n[0],i[0],s[0],o[0]),this.maxY=Math.max(this.maxY,n[1],i[1],s[1],o[1])}updateScalingPathMinMax(t,e){Pt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,s,o,l,h,d,p){const g=Pt.bezierBoundingBox(e,n,i,s,o,l,h,d,p);p||this.updateRectMinMax(t,g)}getPathBoundingBox(t=Bi.FILL,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===Bi.STROKE){e||Me("Stroke bounding box must include transform.");const i=Pt.singularValueDecompose2dScale(e),s=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=Pt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Bi.FILL,e=null){return Pt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function FM(u,t){if(typeof ImageData<"u"&&t instanceof ImageData){u.putImageData(t,0,0);return}const e=t.height,n=t.width,i=e%us,s=(e-i)/us,o=i===0?s:s+1,l=u.createImageData(n,us);let h=0,d;const p=t.data,g=l.data;let m,b,_,S;if(t.kind===_w.GRAYSCALE_1BPP){const C=p.byteLength,T=new Uint32Array(g.buffer,0,g.byteLength>>2),k=T.length,P=n+7>>3,L=4294967295,I=Ui.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(_=m<s?us:i,d=0,b=0;b<_;b++){const D=C-h;let F=0;const H=D>P?n:D*8-7,j=H&-8;let Q=0,V=0;for(;F<j;F+=8)V=p[h++],T[d++]=V&128?L:I,T[d++]=V&64?L:I,T[d++]=V&32?L:I,T[d++]=V&16?L:I,T[d++]=V&8?L:I,T[d++]=V&4?L:I,T[d++]=V&2?L:I,T[d++]=V&1?L:I;for(;F<H;F++)Q===0&&(V=p[h++],Q=128),T[d++]=V&Q?L:I,Q>>=1}for(;d<k;)T[d++]=0;u.putImageData(l,0,m*us)}}else if(t.kind===_w.RGBA_32BPP){for(b=0,S=n*us*4,m=0;m<s;m++)g.set(p.subarray(h,h+S)),h+=S,u.putImageData(l,0,b),b+=us;m<o&&(S=n*i*4,g.set(p.subarray(h,h+S)),u.putImageData(l,0,b))}else if(t.kind===_w.RGB_24BPP)for(_=us,S=n*_,m=0;m<o;m++){for(m>=s&&(_=i,S=n*_),d=0,b=S;b--;)g[d++]=p[h++],g[d++]=p[h++],g[d++]=p[h++],g[d++]=255;u.putImageData(l,0,m*us)}else throw new Error(`bad image kind: ${t.kind}`)}function OM(u,t){if(t.bitmap){u.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,i=e%us,s=(e-i)/us,o=i===0?s:s+1,l=u.createImageData(n,us);let h=0;const d=t.data,p=l.data;for(let g=0;g<o;g++){const m=g<s?us:i;({srcPos:h}=Gz({src:d,srcPos:h,dest:p,width:n,height:m,nonBlackColor:0})),u.putImageData(l,0,g*us)}}function by(u,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)u[n]!==void 0&&(t[n]=u[n]);u.setLineDash!==void 0&&(t.setLineDash(u.getLineDash()),t.lineDashOffset=u.lineDashOffset)}function S_(u){if(u.strokeStyle=u.fillStyle="#000000",u.fillRule="nonzero",u.globalAlpha=1,u.lineWidth=1,u.lineCap="butt",u.lineJoin="miter",u.miterLimit=10,u.globalCompositeOperation="source-over",u.font="10px sans-serif",u.setLineDash!==void 0&&(u.setLineDash([]),u.lineDashOffset=0),!Ri){const{filter:t}=u;t!=="none"&&t!==""&&(u.filter="none")}}function NM(u,t){if(t)return!0;const e=Pt.singularValueDecompose2dScale(u);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*Th.PDF_TO_CSS_UNITS);return e[0]<=n&&e[1]<=n}const Yz=["butt","round","square"],Kz=["miter","round","bevel"],Qz={},$M={};var Lh,pT,gT;const $k=class $k{constructor(t,e,n,i,s,{optionalContentConfig:o,markedContentStack:l=null},h,d){E(this,Lh);this.ctx=t,this.current=new DM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new qz(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,n){const h=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ve(this.compositeCtx))}this.ctx.save(),S_(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ve(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,o=t.fnArray;let l=e||0;const h=s.length;if(h===l)return l;const d=h-l>MM&&typeof n=="function",p=d?Date.now()+Vz:0;let g=0;const m=this.commonObjs,b=this.objs;let _;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,n),l;if(_=o[l],_!==jr.dependency)this[_].apply(this,s[l]);else for(const S of s[l]){const C=S.startsWith("g_")?m:b;if(!C.has(S))return C.get(S,n),l}if(l++,l===h)return l;if(d&&++g>MM){if(Date.now()>p)return n(),l;g=0}}}endDrawing(){A(this,Lh,pT).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),A(this,Lh,gT).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,h=i,d="prescale1",p,g;for(;s>2&&l>1||o>2&&h>1;){let m=l,b=h;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),o>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/b),p=this.cachedCanvases.getCanvas(d,m,b),g=p.context,g.clearRect(0,0,m,b),g.drawImage(t,0,0,l,h,0,0,m,b),t=p.canvas,l=m,h=b,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,o=this.current.patternFill,l=Ve(e);let h,d,p,g;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),s]),h=this._cachedBitmapsMap.get(H),h||(h=new Map,this._cachedBitmapsMap.set(H,h));const j=h.get(d);if(j&&!o){const Q=Math.round(Math.min(l[0],l[2])+l[4]),V=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:j,offsetX:Q,offsetY:V}}p=j}p||(g=this.cachedCanvases.getCanvas("maskCanvas",n,i),OM(g.context,t));let m=Pt.transform(l,[1/n,0,0,-1/i,0,0]);m=Pt.transform(m,[1,0,0,1,0,-i]);const[b,_,S,C]=Pt.getAxialAlignedBoundingBox([0,0,n,i],m),T=Math.round(S-b)||1,k=Math.round(C-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",T,k),L=P.context,I=b,D=_;L.translate(-I,-D),L.transform(...m),p||(p=this._scaleImage(g.canvas,To(L)),p=p.img,h&&o&&h.set(d,p)),L.imageSmoothingEnabled=NM(Ve(L),t.interpolate),E_(L,p,0,0,p.width,p.height,0,0,n,i),L.globalCompositeOperation="source-in";const F=Pt.transform(To(L),[1,0,0,1,-I,-D]);return L.fillStyle=o?s.getPattern(e,this,F,Bi.FILL):s,L.fillRect(0,0,n,i),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(d,P.canvas)),{canvas:P.canvas,offsetX:Math.round(I),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Yz[t]}setLineJoin(t){this.ctx.lineJoin=Kz[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...Ve(this.suspendedCtx)),by(this.suspendedCtx,s),Wz(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),by(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],o=i[1],l=i[2]-s,h=i[3]-o;l===0||h===0||(this.genericComposeSMask(e.context,n,l,h,e.subtype,e.backdrop,e.transferMap,s,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,o,l,h,d,p,g){let m=t.canvas,b=h-p,_=d-g;if(o){const C=Pt.makeHexColor(...o);if(b<0||_<0||b+n>m.width||_+i>m.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,i),k=T.context;k.drawImage(m,-b,-_),k.globalCompositeOperation="destination-atop",k.fillStyle=C,k.fillRect(0,0,n,i),k.globalCompositeOperation="source-over",m=T.canvas,b=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(b,_,n,i),t.clip(T),t.globalCompositeOperation="destination-atop",t.fillStyle=C,t.fillRect(b,_,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const S=new Path2D;S.rect(h,d,n,i),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(m,b,_,n,i,h,d,n,i),e.restore()}save(){this.inSMaskMode?(by(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),by(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,s,o){this.ctx.transform(t,e,n,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,s=this.current;let o=s.x,l=s.y,h,d;const p=Ve(i),g=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,m=g?n.slice(0):null;for(let b=0,_=0,S=t.length;b<S;b++)switch(t[b]|0){case jr.rectangle:o=e[_++],l=e[_++];const C=e[_++],T=e[_++],k=o+C,P=l+T;i.moveTo(o,l),C===0||T===0?i.lineTo(k,P):(i.lineTo(k,l),i.lineTo(k,P),i.lineTo(o,P)),g||s.updateRectMinMax(p,[o,l,k,P]),i.closePath();break;case jr.moveTo:o=e[_++],l=e[_++],i.moveTo(o,l),g||s.updatePathMinMax(p,o,l);break;case jr.lineTo:o=e[_++],l=e[_++],i.lineTo(o,l),g||s.updatePathMinMax(p,o,l);break;case jr.curveTo:h=o,d=l,o=e[_+4],l=e[_+5],i.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],o,l),s.updateCurvePathMinMax(p,h,d,e[_],e[_+1],e[_+2],e[_+3],o,l,m),_+=6;break;case jr.curveTo2:h=o,d=l,i.bezierCurveTo(o,l,e[_],e[_+1],e[_+2],e[_+3]),s.updateCurvePathMinMax(p,h,d,o,l,e[_],e[_+1],e[_+2],e[_+3],m),o=e[_+2],l=e[_+3],_+=4;break;case jr.curveTo3:h=o,d=l,o=e[_+2],l=e[_+3],i.bezierCurveTo(e[_],e[_+1],o,l,o,l),s.updateCurvePathMinMax(p,h,d,e[_],e[_+1],o,l,o,l,m),_+=4;break;case jr.closePath:i.closePath();break}g&&s.updateScalingPathMinMax(p,m),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(e.save(),e.strokeStyle=n.getPattern(e,this,To(e),Bi.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let s=!1;i&&(e.save(),e.fillStyle=n.getPattern(e,this,To(e),Bi.FILL),s=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Qz}eoClip(){this.pendingClip=$M}beginText(){this.current.textMatrix=_O,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const n of t)e.setTransform(...n.transform),e.translate(n.x,n.y),n.addToPath(e,n.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var p;const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||jC,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Wt("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const s=n.loadedName||"sans-serif",o=((p=n.systemFontInfo)==null?void 0:p.css)||`"${s}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const h=n.italic?"italic":"normal";let d=e;e<RM?d=RM:e>LM&&(d=LM),this.current.fontSizeScale=e/d,this.ctx.font=`${h} ${l} ${d}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,s,o){this.current.textMatrix=[t,e,n,i,s,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i){const s=this.ctx,o=this.current,l=o.font,h=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,p=h&vi.FILL_STROKE_MASK,g=!!(h&vi.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile;let b;(l.disableFontFace||g||m)&&(b=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||m?(s.save(),s.translate(e,n),s.beginPath(),b(s,d),i&&s.setTransform(...i),(p===vi.FILL||p===vi.FILL_STROKE)&&s.fill(),(p===vi.STROKE||p===vi.FILL_STROKE)&&s.stroke(),s.restore()):((p===vi.FILL||p===vi.FILL_STROKE)&&s.fillText(t,e,n),(p===vi.STROKE||p===vi.FILL_STROKE)&&s.strokeText(t,e,n)),g&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ve(s),x:e,y:n,fontSize:d,addToPath:b})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return ee(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,h=e.wordSpacing,d=e.fontDirection,p=e.textHScale*d,g=t.length,m=n.vertical,b=m?1:-1,_=n.defaultVMetrics,S=i*e.fontMatrix[0],C=e.textRenderingMode===vi.FILL&&!n.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),d>0?s.scale(p,-1):s.scale(p,1);let T;if(e.patternFill){s.save();const D=e.fillColor.getPattern(s,this,To(s),Bi.FILL);T=Ve(s),s.restore(),s.fillStyle=D}let k=e.lineWidth;const P=e.textMatrixScale;if(P===0||k===0){const D=e.textRenderingMode&vi.FILL_STROKE_MASK;(D===vi.STROKE||D===vi.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=P;if(o!==1&&(s.scale(o,o),k/=o),s.lineWidth=k,n.isInvalidPDFjsFont){const D=[];let F=0;for(const H of t)D.push(H.unicode),F+=H.width;s.fillText(D.join(""),0,0),e.x+=F*S*p,s.restore(),this.compose();return}let L=0,I;for(I=0;I<g;++I){const D=t[I];if(typeof D=="number"){L+=b*D*i/1e3;continue}let F=!1;const H=(D.isSpace?h:0)+l,j=D.fontChar,Q=D.accent;let V,tt,Z=D.width;if(m){const ht=D.vmetric||_,J=-(D.vmetric?ht[1]:Z*.5)*S,G=ht[2]*S;Z=ht?-ht[0]:Z,V=J/o,tt=(L+G)/o}else V=L/o,tt=0;if(n.remeasure&&Z>0){const ht=s.measureText(j).width*1e3/i*o;if(Z<ht&&this.isFontSubpixelAAEnabled){const J=Z/ht;F=!0,s.save(),s.scale(J,1),V/=J}else Z!==ht&&(V+=(Z-ht)/2e3*i/o)}if(this.contentVisible&&(D.isInFont||n.missingFile)){if(C&&!Q)s.fillText(j,V,tt);else if(this.paintChar(j,V,tt,T),Q){const ht=V+i*Q.offset.x/o,J=tt-i*Q.offset.y/o;this.paintChar(Q.fontChar,ht,J,T)}}const et=m?Z*S-H*d:Z*S+H*d;L+=et,F&&s.restore()}m?e.y-=L:e.x+=L*p,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,o=n.fontDirection,l=i.vertical?1:-1,h=n.charSpacing,d=n.wordSpacing,p=n.textHScale*o,g=n.fontMatrix||jC,m=t.length,b=n.textRenderingMode===vi.INVISIBLE;let _,S,C,T;if(!(b||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(p,o),_=0;_<m;++_){if(S=t[_],typeof S=="number"){T=l*S*s/1e3,this.ctx.translate(T,0),n.x+=T*p;continue}const k=(S.isSpace?d:0)+h,P=i.charProcOperatorList[S.operatorListId];if(!P){Wt(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(s,s),e.transform(...g),this.executeOperatorList(P),this.restore()),C=Pt.applyTransform([S.width,0],g)[0]*s+k,e.translate(C,0),n.x+=C*p}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,o){this.ctx.rect(n,i,s-n,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=t[1],i=this.baseTransform||Ve(this.ctx),s={createCanvasGraphics:o=>new $k(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new fT(t,n,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=Pt.makeHexColor(t,e,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=Pt.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=Uz(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,To(e),Bi.SHADING);const i=To(e);{const{width:s,height:o}=e.canvas,[l,h,d,p]=Pt.getAxialAlignedBoundingBox([0,0,s,o],i);this.ctx.fillRect(l,h,d-l,p-h)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Me("Should not call beginInlineImage")}beginImageData(){Me("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Ve(this.ctx),e)){const n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.current.updateRectMinMax(Ve(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||YE("TODO: Support non-isolated groups."),t.knockout&&Wt("Knockout groups not supported.");const n=Ve(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Pt.getAxialAlignedBoundingBox(t.bbox,Ve(e));const s=[0,0,e.canvas.width,e.canvas.height];i=Pt.intersect(i,s)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-o,1),d=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,h,d]);let p="groupAt"+this.groupLevel;t.smask&&(p+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(p,h,d),m=g.context;m.translate(-o,-l),m.transform(...n),t.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.save()),by(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ve(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=Pt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,n,i,s){if(A(this,Lh,pT).call(this),S_(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=l;const[h,d]=Pt.singularValueDecompose2dScale(Ve(this.ctx)),{viewportScale:p}=this,g=Math.ceil(o*this.outputScaleX*p),m=Math.ceil(l*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:b,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-d,0,l*d),S_(this.ctx)}else S_(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new DM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,Lh,gT).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=Xz(t)),i.compiled)){i.compiled(n);return}const s=this._createMaskCanvas(t),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,s,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const h=Ve(l);l.transform(e,n,i,s,0,0);const d=this._createMaskCanvas(t);l.setTransform(1,0,0,1,d.offsetX-h[4],d.offsetY-h[5]);for(let p=0,g=o.length;p<g;p+=2){const m=Pt.transform(h,[e,n,i,s,o[p],o[p+1]]),[b,_]=Pt.applyTransform([0,0],m);l.drawImage(d.canvas,b,_)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:o,width:l,height:h,transform:d}=s,p=this.cachedCanvases.getCanvas("maskCanvas",l,h),g=p.context;g.save();const m=this.getObject(o,s);OM(g,m),g.globalCompositeOperation="source-in",g.fillStyle=i?n.getPattern(g,this,To(e),Bi.FILL):n,g.fillRect(0,0,l,h),g.restore(),e.save(),e.transform(...d),e.scale(1,-1),E_(e,p.canvas,0,0,l,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Wt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Wt("Dependent image isn't ready yet");return}const o=s.width,l=s.height,h=[];for(let d=0,p=i.length;d<p;d+=2)h.push({transform:[e,0,0,n,i[d],i[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(s,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!Ri){const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none")}i.scale(1/e,-1/n);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,n).context;FM(h,t),s=this.applyTransferMapsToCanvas(h)}const o=this._scaleImage(s,To(i));i.imageSmoothingEnabled=NM(Ve(i),t.interpolate),E_(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,o=t.height,h=this.cachedCanvases.getCanvas("inlineImage",s,o).context;FM(h,t),i=this.applyTransferMapsToCanvas(h)}for(const s of e)n.save(),n.transform(...s.transform),n.scale(1,-1),E_(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===$M?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ve(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let o,l;if(n===0&&i===0){const h=Math.abs(e),d=Math.abs(s);if(h===d)if(t===0)o=l=1/h;else{const p=h*t;o=l=p<1?1/p:1}else if(t===0)o=1/h,l=1/d;else{const p=h*t,g=d*t;o=p<1?1/p:1,l=g<1?1/g:1}}else{const h=Math.abs(e*s-n*i),d=Math.hypot(e,n),p=Math.hypot(i,s);if(t===0)o=p/h,l=d/h;else{const g=t*h;o=p>g?p/g:1,l=d>g?d/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,s]=this.getScaleForStroking();if(e.lineWidth=n||1,i===1&&s===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,s),o.length>0){const l=Math.max(i,s);e.setLineDash(o.map(h=>h/l)),e.lineDashOffset/=l}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Lh=new WeakSet,pT=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gT=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let gp=$k;for(const u in jr)gp.prototype[u]!==void 0&&(gp.prototype[jr[u]]=gp.prototype[u]);var s0,r0;class Ml{static get workerPort(){return r(this,s0)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");v(this,s0,t)}static get workerSrc(){return r(this,r0)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");v(this,r0,t)}}s0=new WeakMap,r0=new WeakMap,E(Ml,s0,null),E(Ml,r0,"");const x_={UNKNOWN:0,DATA:1,ERROR:2},un={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function _s(u){switch(u instanceof Error||typeof u=="object"&&u!==null||Me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new Ef(u.message);case"MissingPDFException":return new wf(u.message);case"PasswordException":return new HC(u.message,u.code);case"UnexpectedResponseException":return new KE(u.message,u.status);case"UnknownErrorException":return new BC(u.message,u.details);default:return new BC(u.message,u.toString())}}var jg,Er,rN,aN,oN,Pw;class Yy{constructor(t,e,n){E(this,Er);E(this,jg,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",A(this,Er,rN).bind(this),{signal:r(this,jg).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[s]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:l,action:t,streamId:s,data:e,desiredSize:d.desiredSize},i),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[s].pullCall=p,h.postMessage({sourceName:o,targetName:l,stream:un.PULL,streamId:s,desiredSize:d.desiredSize}),p.promise},cancel:d=>{Cn(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[s].cancelCall=p,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:o,targetName:l,stream:un.CANCEL,streamId:s,reason:_s(d)}),p.promise}},n)}destroy(){var t;(t=r(this,jg))==null||t.abort(),v(this,jg,null)}}jg=new WeakMap,Er=new WeakSet,rN=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){A(this,Er,oN).call(this,t);return}if(t.callback){const n=t.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===x_.DATA)i.resolve(t.data);else if(t.callback===x_.ERROR)i.reject(_s(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,s=this.comObj;new Promise(function(o){o(e(t.data))}).then(function(o){s.postMessage({sourceName:n,targetName:i,callback:x_.DATA,callbackId:t.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:i,callback:x_.ERROR,callbackId:t.callbackId,reason:_s(o)})});return}if(t.streamId){A(this,Er,aN).call(this,t);return}e(t.data)},aN=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this,l=this.actionHandler[t.action],h={enqueue(d,p=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=p,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:un.ENQUEUE,streamId:e,chunk:d},g)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:un.CLOSE,streamId:e}),delete o.streamSinks[e])},error(d){Cn(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:un.ERROR,streamId:e,reason:_s(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,new Promise(function(d){d(l(t.data,h))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:un.START_COMPLETE,streamId:e,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:un.START_COMPLETE,streamId:e,reason:_s(d)})})},oN=function(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,o=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case un.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(_s(t.reason));break;case un.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(_s(t.reason));break;case un.PULL:if(!l){s.postMessage({sourceName:n,targetName:i,stream:un.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,new Promise(function(h){var d;h((d=l.onPull)==null?void 0:d.call(l))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:un.PULL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:n,targetName:i,stream:un.PULL_COMPLETE,streamId:e,reason:_s(h)})});break;case un.ENQUEUE:if(Cn(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case un.CLOSE:if(Cn(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),A(this,Er,Pw).call(this,o,e);break;case un.ERROR:Cn(o,"error should have stream controller"),o.controller.error(_s(t.reason)),A(this,Er,Pw).call(this,o,e);break;case un.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(_s(t.reason)),A(this,Er,Pw).call(this,o,e);break;case un.CANCEL:if(!l)break;new Promise(function(h){var d;h((d=l.onCancel)==null?void 0:d.call(l,_s(t.reason)))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:un.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:n,targetName:i,stream:un.CANCEL_COMPLETE,streamId:e,reason:_s(h)})}),l.sinkCapability.reject(_s(t.reason)),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Pw=async function(t,e){var n,i,s;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(i=t.pullCall)==null?void 0:i.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]};var Dd,a0;class Jz{constructor({parsedData:t,rawData:e}){E(this,Dd);E(this,a0);v(this,Dd,t),v(this,a0,e)}getRaw(){return r(this,a0)}get(t){return r(this,Dd).get(t)??null}getAll(){return Ak(r(this,Dd))}has(t){return r(this,Dd).has(t)}}Dd=new WeakMap,a0=new WeakMap;const hp=Symbol("INTERNAL");var o0,l0,c0,Hg;class Zz{constructor(t,{name:e,intent:n,usage:i,rbGroups:s}){E(this,o0,!1);E(this,l0,!1);E(this,c0,!1);E(this,Hg,!0);v(this,o0,!!(t&Us.DISPLAY)),v(this,l0,!!(t&Us.PRINT)),this.name=e,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(r(this,c0))return r(this,Hg);if(!r(this,Hg))return!1;const{print:t,view:e}=this.usage;return r(this,o0)?(e==null?void 0:e.viewState)!=="OFF":r(this,l0)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==hp&&Me("Internal method `_setVisible` called."),v(this,c0,n),v(this,Hg,e)}}o0=new WeakMap,l0=new WeakMap,c0=new WeakMap,Hg=new WeakMap;var ch,pe,Bg,zg,h0,mT;class tU{constructor(t,e=Us.DISPLAY){E(this,h0);E(this,ch,null);E(this,pe,new Map);E(this,Bg,null);E(this,zg,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,v(this,zg,t.order);for(const n of t.groups)r(this,pe).set(n.id,new Zz(e,n));if(t.baseState==="OFF")for(const n of r(this,pe).values())n._setVisible(hp,!1);for(const n of t.on)r(this,pe).get(n)._setVisible(hp,!0);for(const n of t.off)r(this,pe).get(n)._setVisible(hp,!1);v(this,Bg,this.getHash())}}isVisible(t){if(r(this,pe).size===0)return!0;if(!t)return YE("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,pe).has(t.id)?r(this,pe).get(t.id).visible:(Wt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return A(this,h0,mT).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,pe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(r(this,pe).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,pe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(!r(this,pe).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,pe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(!r(this,pe).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,pe).has(e))return Wt(`Optional content group not found: ${e}`),!0;if(r(this,pe).get(e).visible)return!1}return!0}return Wt(`Unknown optional content policy ${t.policy}.`),!0}return Wt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var s;const i=r(this,pe).get(t);if(!i){Wt(`Optional content group not found: ${t}`);return}if(n&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const l of o)l!==t&&((s=r(this,pe).get(l))==null||s._setVisible(hp,!1,!0));i._setVisible(hp,!!e,!0),v(this,ch,null)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=r(this,pe).get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}v(this,ch,null)}get hasInitialVisibility(){return r(this,Bg)===null||this.getHash()===r(this,Bg)}getOrder(){return r(this,pe).size?r(this,zg)?r(this,zg).slice():[...r(this,pe).keys()]:null}getGroups(){return r(this,pe).size>0?Ak(r(this,pe)):null}getGroup(t){return r(this,pe).get(t)||null}getHash(){if(r(this,ch)!==null)return r(this,ch);const t=new XO;for(const[e,n]of r(this,pe))t.update(`${e}:${n.visible}`);return v(this,ch,t.hexdigest())}}ch=new WeakMap,pe=new WeakMap,Bg=new WeakMap,zg=new WeakMap,h0=new WeakSet,mT=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const s=t[i];let o;if(Array.isArray(s))o=A(this,h0,mT).call(this,s);else if(r(this,pe).has(s))o=r(this,pe).get(s).visible;else return Wt(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"};class eU{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Cn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(n),!0)});Cn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,i,s;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Cn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new nU(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new iU(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class nU{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=Ek(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class iU{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function sU(u){let t=!0,e=n("filename\\*","i").exec(u);if(e){e=e[1];let p=l(e);return p=unescape(p),p=h(p),p=d(p),s(p)}if(e=o(u),e){const p=d(e);return s(p)}if(e=n("filename","i").exec(u),e){e=e[1];let p=l(e);return p=d(p),s(p)}function n(p,g){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(p,g){if(p){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(p,{fatal:!0}),b=QE(g);g=m.decode(b),t=!1}catch{}}return g}function s(p){return t&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),t&&(p=i("iso-8859-1",p))),p}function o(p){const g=[];let m;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=b.exec(p))!==null;){let[,S,C,T]=m;if(S=parseInt(S,10),S in g){if(S===0)break;continue}g[S]=[C,T]}const _=[];for(let S=0;S<g.length&&S in g;++S){let[C,T]=g[S];T=l(T),C&&(T=unescape(T),S===0&&(T=h(T))),_.push(T)}return _.join("")}function l(p){if(p.startsWith('"')){const g=p.slice(1).split('\\"');for(let m=0;m<g.length;++m){const b=g[m].indexOf('"');b!==-1&&(g[m]=g[m].slice(0,b),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}p=g.join('"')}return p}function h(p){const g=p.indexOf("'");if(g===-1)return p;const m=p.slice(0,g),_=p.slice(g+1).replace(/^[^']*'/,"");return i(m,_)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,b,_){if(b==="q"||b==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),i(m,_);try{_=atob(_)}catch{}return i(m,_)})}return""}function kk(u,t){const e=new Headers;if(!u||!t||typeof t!="object")return e;for(const n in t){const i=t[n];i!==void 0&&e.append(n,i)}return e}function Pk({responseHeaders:u,isHttp:t,rangeChunkSize:e,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(u.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||n||!t||u.get("Accept-Ranges")!=="bytes"||(u.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Rk(u){const t=u.get("Content-Disposition");if(t){let e=sU(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Ek(e))return e}return null}function tS(u,t){return u===404||u===0&&t.startsWith("file:")?new wf('Missing PDF "'+t+'".'):new KE(`Unexpected server response (${u}) while retrieving PDF "${t}".`,u)}function lN(u){return u===200||u===206}function cN(u,t,e){return{method:"GET",headers:u,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function hN(u){return u instanceof Uint8Array?u.buffer:u instanceof ArrayBuffer?u:(Wt(`getArrayBuffer - unexpected data format: ${u}`),new Uint8Array(u).buffer)}class jM{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=kk(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Cn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new rU(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new aU(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class rU{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,cN(n,this._withCredentials,this._abortController)).then(s=>{if(!lN(s.status))throw tS(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:l,suggestedLength:h}=Pk({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=Rk(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ef("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:hN(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class aU{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${n-1}`);const o=i.url;fetch(o,cN(s,this._withCredentials,this._abortController)).then(l=>{if(!lN(l.status))throw tS(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:hN(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const Cx=200,Tx=206;function oU(u){const t=u.response;return typeof t!="string"?t:QE(t).buffer}class lU{constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=kk(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,n){const i={begin:t,end:e};for(const s in n)i[s]=n[s];return this.request(i)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,o]of this.headers)e.setRequestHeader(s,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Tx):i.expectedStatus=Cx,e.responseType="arraybuffer",t.onError&&(e.onerror=function(s){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var i;const n=this.pendingRequests[t];n&&((i=n.onProgress)==null||i.call(n,e))}onStateChange(t,e){var h,d,p;const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){(h=n.onError)==null||h.call(n,i.status);return}const s=i.status||Cx;if(!(s===Cx&&n.expectedStatus===Tx)&&s!==n.expectedStatus){(d=n.onError)==null||d.call(n,i.status);return}const l=oU(i);if(s===Tx){const g=i.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(g);n.onDone({begin:parseInt(m[1],10),chunk:l})}else l?n.onDone({begin:0,chunk:l}):(p=n.onError)==null||p.call(n,i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class cU{constructor(t){this._source=t,this._manager=new lU(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Cn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hU(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new uU(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class hU{constructor(t,e){this._manager=t;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),n=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map(o=>{const[l,...h]=o.split(": ");return[l,h.join(": ")]})),{allowRangeRequests:i,suggestedLength:s}=Pk({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=Rk(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=tS(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class uU{constructor(t,e,n){this._manager=t;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=tS(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const dU=/^[a-z][a-z0-9\-+.]+:/i;function fU(u){if(dU.test(u))return new URL(u);const t=kh.get("url");return new URL(t.pathToFileURL(u))}function uN(u,t,e){return u.protocol==="http:"?kh.get("http").request(u,{headers:t},e):kh.get("https").request(u,{headers:t},e)}class pU{constructor(t){this.source=t,this.url=fU(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=kk(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Cn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new yU(this):new gU(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new vU(this,t,e):new mU(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class dN{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ef("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class fN{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class gU extends dN{constructor(t){super(t);const e=Object.fromEntries(t.headers),n=i=>{if(i.statusCode===404){const h=new wf(`Missing PDF "${this._url}".`);this._storedError=h,this._headersCapability.reject(h);return}this._headersCapability.resolve(),this._setReadableStream(i);const s=new Headers(this._readableStream.headers),{allowRangeRequests:o,suggestedLength:l}=Pk({responseHeaders:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=Rk(s)};this._request=uN(this._url,e,n),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class mU extends fN{constructor(t,e,n){super(t);const i=Object.fromEntries(t.headers);i.Range=`bytes=${e}-${n-1}`;const s=o=>{if(o.statusCode===404){const l=new wf(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(o)};this._request=uN(this._url,i,s),this._request.on("error",o=>{this._storedError=o}),this._request.end()}}class yU extends dN{constructor(t){super(t);const e=kh.get("fs");e.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new wf(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}}class vU extends fN{constructor(t,e,n){super(t);const i=kh.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:n-1}))}}const bU=1e5,es=30,AU=.8;var eD,hh,ls,u0,d0,Fd,pl,f0,p0,Od,Ug,Gg,uh,Vg,g0,Wg,Nd,m0,y0,Ke,$d,jd,v0,dh,qg,Bl,pN,gN,vT,Xs,Rw,bT,mN,yN;let yT=(Ke=class{constructor({textContentSource:t,container:e,viewport:n}){E(this,Bl);E(this,hh,Promise.withResolvers());E(this,ls,null);E(this,u0,!1);E(this,d0,!!((eD=globalThis.FontInspector)!=null&&eD.enabled));E(this,Fd,null);E(this,pl,null);E(this,f0,0);E(this,p0,0);E(this,Od,null);E(this,Ug,null);E(this,Gg,0);E(this,uh,0);E(this,Vg,Object.create(null));E(this,g0,[]);E(this,Wg,null);E(this,Nd,[]);E(this,m0,new WeakMap);E(this,y0,null);var h;if(t instanceof ReadableStream)v(this,Wg,t);else if(typeof t=="object")v(this,Wg,new ReadableStream({start(d){d.enqueue(t),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,ls,v(this,Ug,e)),v(this,uh,n.scale*(globalThis.devicePixelRatio||1)),v(this,Gg,n.rotation),v(this,pl,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:l}=n.rawDims;v(this,y0,[1,0,0,-1,-o,l+s]),v(this,p0,i),v(this,f0,s),A(h=Ke,Xs,mN).call(h),gf(e,n),r(this,hh).promise.finally(()=>{r(Ke,qg).delete(this),v(this,pl,null),v(this,Vg,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ui.platform;return ee(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Od).read().then(({value:e,done:n})=>{if(n){r(this,hh).resolve();return}r(this,Fd)??v(this,Fd,e.lang),Object.assign(r(this,Vg),e.styles),A(this,Bl,pN).call(this,e.items),t()},r(this,hh).reject)};return v(this,Od,r(this,Wg).getReader()),r(Ke,qg).add(this),t(),r(this,hh).promise}update({viewport:t,onBefore:e=null}){var s;const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==r(this,Gg)&&(e==null||e(),v(this,Gg,i),gf(r(this,Ug),{rotation:i})),n!==r(this,uh)){e==null||e(),v(this,uh,n);const o={div:null,properties:null,ctx:A(s=Ke,Xs,Rw).call(s,r(this,Fd))};for(const l of r(this,Nd))o.properties=r(this,m0).get(l),o.div=l,A(this,Bl,vT).call(this,o)}}cancel(){var e;const t=new Ef("TextLayer task cancelled.");(e=r(this,Od))==null||e.cancel(t).catch(()=>{}),v(this,Od,null),r(this,hh).reject(t)}get textDivs(){return r(this,Nd)}get textContentItemsStr(){return r(this,g0)}static cleanup(){if(!(r(this,qg).size>0)){r(this,$d).clear();for(const{canvas:t}of r(this,jd).values())t.remove();r(this,jd).clear()}}},hh=new WeakMap,ls=new WeakMap,u0=new WeakMap,d0=new WeakMap,Fd=new WeakMap,pl=new WeakMap,f0=new WeakMap,p0=new WeakMap,Od=new WeakMap,Ug=new WeakMap,Gg=new WeakMap,uh=new WeakMap,Vg=new WeakMap,g0=new WeakMap,Wg=new WeakMap,Nd=new WeakMap,m0=new WeakMap,y0=new WeakMap,$d=new WeakMap,jd=new WeakMap,v0=new WeakMap,dh=new WeakMap,qg=new WeakMap,Bl=new WeakSet,pN=function(t){var i,s;if(r(this,u0))return;(s=r(this,pl)).ctx??(s.ctx=A(i=Ke,Xs,Rw).call(i,r(this,Fd)));const e=r(this,Nd),n=r(this,g0);for(const o of t){if(e.length>bU){Wt("Ignoring additional textDivs for performance reasons."),v(this,u0,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=r(this,ls);v(this,ls,document.createElement("span")),r(this,ls).classList.add("markedContent"),o.id!==null&&r(this,ls).setAttribute("id",`${o.id}`),l.append(r(this,ls))}else o.type==="endMarkedContent"&&v(this,ls,r(this,ls).parentNode);continue}n.push(o.str),A(this,Bl,gN).call(this,o)}},gN=function(t){var S;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Nd).push(e);const i=Pt.transform(r(this,y0),t.transform);let s=Math.atan2(i[1],i[0]);const o=r(this,Vg)[t.fontName];o.vertical&&(s+=Math.PI/2);let l=r(this,d0)&&o.fontSubstitution||o.fontFamily;l=Ke.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),d=h*A(S=Ke,Xs,yN).call(S,l,r(this,Fd));let p,g;s===0?(p=i[4],g=i[5]-d):(p=i[4]+d*Math.sin(s),g=i[5]-d*Math.cos(s));const m="calc(var(--scale-factor)*",b=e.style;r(this,ls)===r(this,Ug)?(b.left=`${(100*p/r(this,p0)).toFixed(2)}%`,b.top=`${(100*g/r(this,f0)).toFixed(2)}%`):(b.left=`${m}${p.toFixed(2)}px)`,b.top=`${m}${g.toFixed(2)}px)`),b.fontSize=`${m}${(r(Ke,dh)*h).toFixed(2)}px)`,b.fontFamily=l,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,d0)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),s!==0&&(n.angle=s*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),T=Math.abs(t.transform[3]);C!==T&&Math.max(C,T)/Math.min(C,T)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?t.height:t.width),r(this,m0).set(e,n),r(this,pl).div=e,r(this,pl).properties=n,A(this,Bl,vT).call(this,r(this,pl)),n.hasText&&r(this,ls).append(e),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),r(this,ls).append(C)}},vT=function(t){var l;const{div:e,properties:n,ctx:i}=t,{style:s}=e;let o="";if(r(Ke,dh)>1&&(o=`scale(${1/r(Ke,dh)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=s,{canvasWidth:d,fontSize:p}=n;A(l=Ke,Xs,bT).call(l,i,p*r(this,uh),h);const{width:g}=i.measureText(e.textContent);g>0&&(o=`scaleX(${d*r(this,uh)/g}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(s.transform=o)},Xs=new WeakSet,Rw=function(t=null){let e=r(this,jd).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,jd).set(t,e),r(this,v0).set(e,{size:0,family:""})}return e},bT=function(t,e,n){const i=r(this,v0).get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)},mN=function(){if(r(this,dh)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),v(this,dh,t.getBoundingClientRect().height),t.remove()},yN=function(t,e){const n=r(this,$d).get(t);if(n)return n;const i=A(this,Xs,Rw).call(this,e);i.canvas.width=i.canvas.height=es,A(this,Xs,bT).call(this,i,es,t);const s=i.measureText("");let o=s.fontBoundingBoxAscent,l=Math.abs(s.fontBoundingBoxDescent);if(o){const p=o/(o+l);return r(this,$d).set(t,p),i.canvas.width=i.canvas.height=0,p}i.strokeStyle="red",i.clearRect(0,0,es,es),i.strokeText("g",0,0);let h=i.getImageData(0,0,es,es).data;l=0;for(let p=h.length-1-3;p>=0;p-=4)if(h[p]>0){l=Math.ceil(p/4/es);break}i.clearRect(0,0,es,es),i.strokeText("A",0,es),h=i.getImageData(0,0,es,es).data,o=0;for(let p=0,g=h.length;p<g;p+=4)if(h[p]>0){o=es-Math.floor(p/4/es);break}i.canvas.width=i.canvas.height=0;const d=o?o/(o+l):AU;return r(this,$d).set(t,d),d},E(Ke,Xs),E(Ke,$d,new Map),E(Ke,jd,new Map),E(Ke,v0,new WeakMap),E(Ke,dh,null),E(Ke,qg,new Set),Ke);class uv{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function i(s){var h;if(!s)return;let o=null;const l=s.name;if(l==="#text")o=s.value;else if(uv.shouldBuildText(l))(h=s==null?void 0:s.attributes)!=null&&h.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&e.push({str:o}),!!s.children)for(const d of s.children)i(d)}return i(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const _U=65536,wU=100,EU=5e3,SU=Ri?Oz:Iz,xU=Ri?Nz:ZO,CU=Ri?Fz:Dz,TU=Ri?$z:iN;function kU(u={}){typeof u=="string"||u instanceof URL?u={url:u}:(u instanceof ArrayBuffer||ArrayBuffer.isView(u))&&(u={data:u});const t=new AT,{docId:e}=t,n=u.url?PU(u.url):null,i=u.data?RU(u.data):null,s=u.httpHeaders||null,o=u.withCredentials===!0,l=u.password??null,h=u.range instanceof vN?u.range:null,d=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:_U;let p=u.worker instanceof mp?u.worker:null;const g=u.verbosity,m=typeof u.docBaseUrl=="string"&&!ZE(u.docBaseUrl)?u.docBaseUrl:null,b=typeof u.cMapUrl=="string"?u.cMapUrl:null,_=u.cMapPacked!==!1,S=u.CMapReaderFactory||xU,C=typeof u.standardFontDataUrl=="string"?u.standardFontDataUrl:null,T=u.StandardFontDataFactory||TU,k=u.stopAtErrors!==!0,P=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,L=u.isEvalSupported!==!1,I=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!Ri,D=typeof u.isChrome=="boolean"?u.isChrome:!Ui.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),F=Number.isInteger(u.canvasMaxAreaInBytes)?u.canvasMaxAreaInBytes:-1,H=typeof u.disableFontFace=="boolean"?u.disableFontFace:Ri,j=u.fontExtraProperties===!0,Q=u.enableXfa===!0,V=u.ownerDocument||globalThis.document,tt=u.disableRange===!0,Z=u.disableStream===!0,et=u.disableAutoFetch===!0,ht=u.pdfBug===!0,J=u.CanvasFactory||SU,G=u.FilterFactory||CU,q=u.enableHWA===!0,U=h?h.length:u.length??NaN,N=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!Ri&&!H,M=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:S===ZO&&T===iN&&b&&C&&zy(b,document.baseURI)&&zy(C,document.baseURI);u.canvasFactory&&TM("`canvasFactory`-instance option, please use `CanvasFactory` instead."),u.filterFactory&&TM("`filterFactory`-instance option, please use `FilterFactory` instead.");const B=null;hz(g);const Y={canvasFactory:new J({ownerDocument:V,enableHWA:q}),filterFactory:new G({docId:e,ownerDocument:V}),cMapReaderFactory:M?null:new S({baseUrl:b,isCompressed:_}),standardFontDataFactory:M?null:new T({baseUrl:C})};if(!p){const at={verbosity:g,port:Ml.workerPort};p=at.port?mp.fromPort(at):new mp(at),t._worker=p}const it={docId:e,apiVersion:"4.8.69",data:i,password:l,disableAutoFetch:et,rangeChunkSize:d,length:U,docBaseUrl:m,enableXfa:Q,evaluatorOptions:{maxImageSize:P,disableFontFace:H,ignoreErrors:k,isEvalSupported:L,isOffscreenCanvasSupported:I,isChrome:D,canvasMaxAreaInBytes:F,fontExtraProperties:j,useSystemFonts:N,cMapUrl:M?b:null,standardFontDataUrl:M?C:null}},dt={disableFontFace:H,fontExtraProperties:j,ownerDocument:V,pdfBug:ht,styleElement:B,loadingParams:{disableAutoFetch:et,enableXfa:Q}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const at=p.messageHandler.sendWithPromise("GetDocRequest",it,i?[i.buffer]:null);let nt;if(h)nt=new eU(h,{disableRange:tt,disableStream:Z});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let vt;Ri?vt=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&zy(n)?jM:pU:vt=zy(n)?jM:cU,nt=new vt({url:n,length:U,httpHeaders:s,withCredentials:o,rangeChunkSize:d,disableRange:tt,disableStream:Z})}return at.then(vt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ut=new Yy(e,vt,p.port),xt=new DU(ut,t,nt,dt,Y);t._transport=xt,ut.send("Ready",null)})}).catch(t._capability.reject),t}function PU(u){if(u instanceof URL)return u.href;try{return new URL(u,window.location).href}catch{if(Ri&&typeof u=="string")return u}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function RU(u){if(Ri&&typeof Buffer<"u"&&u instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return QE(u);if(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="object"&&!isNaN(u==null?void 0:u.length))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function HM(u){return typeof u=="object"&&Number.isInteger(u==null?void 0:u.num)&&u.num>=0&&Number.isInteger(u==null?void 0:u.gen)&&u.gen>=0}var LE;const ME=class ME{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${he(ME,LE)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,n;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};LE=new WeakMap,E(ME,LE,0);let AT=ME;class vN{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class LU{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var fh,gl,Ar,up,Lw;class MU{constructor(t,e,n,i=!1){E(this,Ar);E(this,fh,null);E(this,gl,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new CM:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new bN,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new tA({viewBox:this.view,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=Ac.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:d=null,printAnnotationStorage:p=null,isEditing:g=!1}){var L,I;(L=this._stats)==null||L.time("Overall");const m=this._transport.getRenderingIntent(n,i,p,g),{renderingIntent:b,cacheKey:_}=m;v(this,gl,!1),A(this,Ar,Lw).call(this),l||(l=this._transport.getOptionalContentConfig(b));let S=this._intentStates.get(_);S||(S=Object.create(null),this._intentStates.set(_,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const C=!!(b&Us.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(m));const T=D=>{var F;S.renderTasks.delete(k),(this._maybeCleanupAfterRender||C)&&v(this,gl,!0),A(this,Ar,up).call(this,!C),D?(k.capability.reject(D),this._abortOperatorList({intentState:S,reason:D instanceof Error?D:new Error(D)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new wT({callback:T,params:{canvasContext:t,viewport:e,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:d});(S.renderTasks||(S.renderTasks=new Set)).add(k);const P=k.task;return Promise.all([S.displayReadyCapability.promise,l]).then(([D,F])=>{var H;if(this.destroyed){T();return}if((H=this._stats)==null||H.time("Rendering"),!(F.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:D,optionalContentConfig:F}),k.operatorListChanged()}).catch(T),P}getOperatorList({intent:t="display",annotationMode:e=Ac.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var d;function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,n,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>uv.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,i){function s(){o.read().then(function({value:h,done:d}){if(d){n(l);return}l.lang??(l.lang=h.lang),Object.assign(l.styles,h.styles),l.items.push(...h.items),s()},i)}const o=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),v(this,gl,!1),A(this,Ar,Lw).call(this),Promise.all(t)}cleanup(t=!1){v(this,gl,!0);const e=A(this,Ar,up).call(this,!1);return t&&e&&this._stats&&(this._stats=new CM),e}_startRenderPage(t,e){var i,s;const n=this._intentStates.get(e);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&A(this,Ar,up).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:o}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},o).getReader(),d=this._intentStates.get(e);d.streamReader=h;const p=()=>{h.read().then(({value:g,done:m})=>{if(m){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,d),p())},g=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const m of d.renderTasks)m.operatorListChanged();A(this,Ar,up).call(this,!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(g);else if(d.opListReadCapability)d.opListReadCapability.reject(g);else throw g}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof wk){let i=wU;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Ef(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}fh=new WeakMap,gl=new WeakMap,Ar=new WeakSet,up=function(t=!1){if(A(this,Ar,Lw).call(this),!r(this,gl)||this.destroyed)return!1;if(t)return v(this,fh,setTimeout(()=>{v(this,fh,null),A(this,Ar,up).call(this,!1)},EU)),!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,gl,!1),!0},Lw=function(){r(this,fh)&&(clearTimeout(r(this,fh)),v(this,fh,null))};var ml,IE;class IU{constructor(){E(this,ml,new Map);E(this,IE,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};r(this,IE).then(()=>{for(const[i]of r(this,ml))i.call(this,n)})}addEventListener(t,e,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Wt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}r(this,ml).set(e,i)}removeEventListener(t,e){const n=r(this,ml).get(e);n==null||n(),r(this,ml).delete(e)}terminate(){for(const[,t]of r(this,ml))t==null||t();r(this,ml).clear()}}ml=new WeakMap,IE=new WeakMap;var DE,Hd,Bd,Xg,Mw,Yg,Iw;const Fe=class Fe{constructor({name:t=null,port:e=null,verbosity:n=uz()}={}){E(this,Xg);var i;if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=r(Fe,Bd))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(Fe,Bd)||v(Fe,Bd,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Ri?Promise.all([kh.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Yy("main","worker",t),this._messageHandler.on("ready",function(){}),A(this,Xg,Mw).call(this)}_initialize(){if(r(Fe,Hd)||r(Fe,Yg,Iw)){this._setupFakeWorker();return}let{workerSrc:t}=Fe;try{Fe._isSameOrigin(window.location.href,t)||(t=Fe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Yy("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),n.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}this._messageHandler=n,this._port=e,this._webWorker=e,A(this,Xg,Mw).call(this)}),n.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};o();return}catch{YE("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(Fe,Hd)||(Wt("Setting up fake worker."),v(Fe,Hd,!0)),Fe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new IU;this._port=e;const n=`fake${he(Fe,DE)._++}`,i=new Yy(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new Yy(n,n+"_worker",e),A(this,Xg,Mw).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=r(Fe,Bd))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var n;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(n=r(this,Bd))==null?void 0:n.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Fe(t)}static get workerSrc(){if(Ml.workerSrc)return Ml.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ee(this,"_setupFakeWorkerGlobal",(async()=>r(this,Yg,Iw)?r(this,Yg,Iw):(await import(this.workerSrc)).WorkerMessageHandler)())}};DE=new WeakMap,Hd=new WeakMap,Bd=new WeakMap,Xg=new WeakSet,Mw=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Yg=new WeakSet,Iw=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},E(Fe,Yg),E(Fe,DE,0),E(Fe,Hd,!1),E(Fe,Bd),Ri&&(v(Fe,Hd,!0),Ml.workerSrc||(Ml.workerSrc="./pdf.worker.mjs")),Fe._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},Fe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let mp=Fe;var yl,eo,Kg,Qg,no,zd,Ky;class DU{constructor(t,e,n,i,s){E(this,zd);E(this,yl,new Map);E(this,eo,new Map);E(this,Kg,new Map);E(this,Qg,new Map);E(this,no,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new bN,this.fontLoader=new Lz({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ee(this,"annotationStorage",new Ck)}getRenderingIntent(t,e=Ac.ENABLE,n=null,i=!1,s=!1){let o=Us.DISPLAY,l=lT;switch(t){case"any":o=Us.ANY;break;case"display":break;case"print":o=Us.PRINT;break;default:Wt(`getRenderingIntent - invalid intent: ${t}`)}const h=o&Us.PRINT&&n instanceof KO?n:this.annotationStorage;switch(e){case Ac.DISABLE:o+=Us.ANNOTATIONS_DISABLE;break;case Ac.ENABLE:break;case Ac.ENABLE_FORMS:o+=Us.ANNOTATIONS_FORMS;break;case Ac.ENABLE_STORAGE:o+=Us.ANNOTATIONS_STORAGE,l=h.serializable;break;default:Wt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=Us.IS_EDITING),s&&(o+=Us.OPLIST);const{ids:d,hash:p}=h.modifiedIds,g=[o,l.hash,p];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:l,modifiedIds:d}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=r(this,no))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of r(this,eo).values())t.push(i._destroy());r(this,eo).clear(),r(this,Kg).clear(),r(this,Qg).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i;this.commonObjs.clear(),this.fontLoader.clear(),r(this,yl).clear(),this.filterFactory.destroy(),yT.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Ef("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,i)=>{Cn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}Cn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async n=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((l=e.onProgress)==null||l.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var d;(d=e.onProgress)==null||d.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),t.on("GetRangeReader",(n,i)=>{Cn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:l}){if(l){i.close();return}Cn(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new LU(n,this))}),t.on("DocException",function(n){let i;switch(n.name){case"PasswordException":i=new HC(n.message,n.code);break;case"InvalidPDFException":i=new wO(n.message);break;case"MissingPDFException":i=new wf(n.message);break;case"UnexpectedResponseException":i=new KE(n.message,n.status);break;case"UnknownErrorException":i=new BC(n.message,n.details);break;default:Me("DocException - expected a valid Error.")}e._capability.reject(i)}),t.on("PasswordRequest",n=>{if(v(this,no,Promise.withResolvers()),e.onPassword){const i=s=>{s instanceof Error?r(this,no).reject(s):r(this,no).resolve({password:s})};try{e.onPassword(i,n.code)}catch(s){r(this,no).reject(s)}}else r(this,no).reject(new HC(n.message,n.code));return r(this,no).promise}),t.on("DataLoaded",n=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;r(this,eo).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:l,fontExtraProperties:h,pdfBug:d}=this._params;if("error"in s){const b=s.error;Wt(`Error during font loading: ${b}`),this.commonObjs.resolve(n,b);break}const p=d&&((o=globalThis.FontInspector)!=null&&o.enabled)?(b,_)=>globalThis.FontInspector.fontAdded(b,_):null,g=new Mz(s,{disableFontFace:l,inspectFont:p});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h&&g.data&&(g.data=null),this.commonObjs.resolve(n,g)});break;case"CopyLocalImage":const{imageRef:m}=s;Cn(m,"The imageRef must be defined.");for(const b of r(this,eo).values())for(const[,_]of b.objs)if((_==null?void 0:_.ref)===m)return _.dataLen?(this.commonObjs.resolve(n,structuredClone(_)),_.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([n,i,s,o])=>{var h;if(this.destroyed)return;const l=r(this,eo).get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){(h=o==null?void 0:o.bitmap)==null||h.close();return}switch(s){case"Image":l.objs.resolve(n,o),(o==null?void 0:o.dataLen)>az&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",n=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),t.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Wt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=r(this,Kg).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&r(this,Qg).set(s.refStr,t);const o=new MU(e,s,this,this._params.pdfBug);return r(this,eo).set(e,o),o});return r(this,Kg).set(e,i),i}getPageIndex(t){return HM(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return A(this,zd,Ky).call(this,"GetFieldObjects")}hasJSActions(){return A(this,zd,Ky).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,zd,Ky).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return A(this,zd,Ky).call(this,"GetOptionalContentConfig").then(e=>new tU(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,yl).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new Jz(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return r(this,yl).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,eo).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,yl).clear(),this.filterFactory.destroy(!0),yT.cleanup()}}cachedPageNumber(t){if(!HM(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,Qg).get(e)??null}}yl=new WeakMap,eo=new WeakMap,Kg=new WeakMap,Qg=new WeakMap,no=new WeakMap,zd=new WeakSet,Ky=function(t,e=null){const n=r(this,yl).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return r(this,yl).set(t,i),i};const C_=Symbol("INITIAL_DATA");var ia,b0,_T;class bN{constructor(){E(this,b0);E(this,ia,Object.create(null))}get(t,e=null){if(e){const i=A(this,b0,_T).call(this,t);return i.promise.then(()=>e(i.data)),null}const n=r(this,ia)[t];if(!n||n.data===C_)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=r(this,ia)[t];return!!e&&e.data!==C_}resolve(t,e=null){const n=A(this,b0,_T).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in r(this,ia)){const{data:n}=r(this,ia)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}v(this,ia,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,ia)){const{data:e}=r(this,ia)[t];e!==C_&&(yield[t,e])}}}ia=new WeakMap,b0=new WeakSet,_T=function(t){var e;return(e=r(this,ia))[t]||(e[t]={...Promise.withResolvers(),data:C_})};var ph;class FU{constructor(t){E(this,ph,null);v(this,ph,t),this.onContinue=null}get promise(){return r(this,ph).capability.promise}cancel(t=0){r(this,ph).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,ph).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,ph);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}ph=new WeakMap;var gh,Ud;const ou=class ou{constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:l,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:g=!1,pageColors:m=null}){E(this,gh,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new FU(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var l,h;if(this.cancelled)return;if(this._canvas){if(r(ou,Ud).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(ou,Ud).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:s,background:o}=this.params;this.gfx=new gp(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(t=null,e=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),r(this,gh)&&(window.cancelAnimationFrame(r(this,gh)),v(this,gh,null)),r(ou,Ud).delete(this._canvas),this.callback(t||new wk(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,gh,window.requestAnimationFrame(()=>{v(this,gh,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(ou,Ud).delete(this._canvas),this.callback())))}};gh=new WeakMap,Ud=new WeakMap,E(ou,Ud,new WeakSet);let wT=ou;const OU="4.8.69",NU="3634dab10";function BM(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function Ay(u){return Math.max(0,Math.min(255,255*u))}class zM{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ay(t),[t,t,t]}static G_HTML([t]){const e=BM(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Ay)}static RGB_HTML(t){return`#${t.map(BM).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[Ay(1-Math.min(1,t+i)),Ay(1-Math.min(1,n+i)),Ay(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,s=1-e,o=1-n,l=Math.min(i,s,o);return["CMYK",i,s,o,l]}}class $U{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Me("Abstract method `_createSVG` called.")}}class Lk extends $U{_createSVG(t){return document.createElementNS(Io,t)}}class AN{static setupStorage(t,e,n,i,s){const o=i.getValue(e,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?t.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const l of n.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const h=l.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:s}){const{attributes:o}=e,l=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[h,d]of Object.entries(o))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!l||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}l&&s.addLinkAttributes(t,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(t,o.dataId,e,n)}static render(t){var g,m;const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:n});const l=s!=="richText",h=t.div;if(h.append(o),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=b}l&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const b=document.createTextNode(i.value);o.append(b),l&&uv.shouldBuildText(i.name)&&d.push(b)}return{textDivs:d}}const p=[[i,-1,o]];for(;p.length>0;){const[b,_,S]=p.at(-1);if(_+1===b.children.length){p.pop();continue}const C=b.children[++p.at(-1)[1]];if(C===null)continue;const{name:T}=C;if(T==="#text"){const P=document.createTextNode(C.value);d.push(P),S.append(P);continue}const k=(g=C==null?void 0:C.attributes)!=null&&g.xmlns?document.createElementNS(C.attributes.xmlns,T):document.createElement(T);if(S.append(k),C.attributes&&this.setAttributes({html:k,element:C,storage:e,intent:s,linkService:n}),((m=C.children)==null?void 0:m.length)>0)p.push([C,-1,k]);else if(C.value){const P=document.createTextNode(C.value);l&&uv.shouldBuildText(T)&&d.push(P),k.append(P)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const nA=1e3,jU=9,yf=new WeakSet;function Dl(u){return{width:u[2]-u[0],height:u[3]-u[1]}}class HU{static create(t){switch(t.data.annotationType){case bn.LINK:return new _N(t);case bn.TEXT:return new BU(t);case bn.WIDGET:switch(t.data.fieldType){case"Tx":return new zU(t);case"Btn":return t.data.radioButton?new SN(t):t.data.checkBox?new GU(t):new VU(t);case"Ch":return new WU(t);case"Sig":return new UU(t)}return new Sf(t);case bn.POPUP:return new ST(t);case bn.FREETEXT:return new PN(t);case bn.LINE:return new XU(t);case bn.SQUARE:return new YU(t);case bn.CIRCLE:return new KU(t);case bn.POLYLINE:return new RN(t);case bn.CARET:return new JU(t);case bn.INK:return new Mk(t);case bn.POLYGON:return new QU(t);case bn.HIGHLIGHT:return new LN(t);case bn.UNDERLINE:return new ZU(t);case bn.SQUIGGLY:return new tG(t);case bn.STRIKEOUT:return new eG(t);case bn.STAMP:return new MN(t);case bn.FILEATTACHMENT:return new nG(t);default:return new an(t)}}}var Gd,Jg,Zg,A0,ET;const jk=class jk{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){E(this,A0);E(this,Gd,null);E(this,Jg,!1);E(this,Zg,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t!=null&&t.str||e!=null&&e.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return jk._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;r(this,Gd)||v(this,Gd,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&A(this,A0,ET).call(this,e),(n=r(this,Zg))==null||n.popup.updateEdited(t)}resetEdited(){var t;r(this,Gd)&&(A(this,A0,ET).call(this,r(this,Gd).rect),(t=r(this,Zg))==null||t.popup.resetEdited(),v(this,Gd,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Sf||(s.tabIndex=nA);const{style:o}=s;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof ST){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:l,height:h}=Dl(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;o.borderRadius=k}else if(this instanceof SN){const k=`calc(${l}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;o.borderRadius=k}switch(e.borderStyle.style){case vy.SOLID:o.borderStyle="solid";break;case vy.DASHED:o.borderStyle="dashed";break;case vy.BEVELED:Wt("Unimplemented border style: beveled");break;case vy.INSET:Wt("Unimplemented border style: inset");break;case vy.UNDERLINE:o.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(v(this,Jg,!0),o.borderColor=Pt.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const d=Pt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:g,pageX:m,pageY:b}=i.rawDims;o.left=`${100*(d[0]-m)/p}%`,o.top=`${100*(d[1]-b)/g}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(o.width=`${100*l/p}%`,o.height=`${100*h/g}%`):this.setRotation(_,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:o}=Dl(this.data.rect);let l,h;t%180===0?(l=100*s/n,h=100*o/i):(l=100*o/n,h=100*s/i),e.style.width=`${l}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,i)=>{const s=i.detail[e],o=s[0],l=s.slice(1);i.target.style[n]=zM[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:zM[`${o}_rgb`](l)})};return ee(this,"_commonActions",{display:e=>{const{display:n}=e.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const o=n[i];if(o){const l={detail:{[i]:s},target:t};o(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,T,k]=t.subarray(2,6);if(i===S&&s===C&&e===T&&n===k)return}const{style:o}=this.container;let l;if(r(this,Jg)){const{borderColor:S,borderWidth:C}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=i-e,d=s-n,{svgFactory:p}=this,g=p.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const m=p.createElement("defs");g.append(m);const b=p.createElement("clipPath"),_=`clippath_${this.data.id}`;b.setAttribute("id",_),b.setAttribute("clipPathUnits","objectBoundingBox"),m.append(b);for(let S=2,C=t.length;S<C;S+=8){const T=t[S],k=t[S+1],P=t[S+2],L=t[S+3],I=p.createElement("rect"),D=(P-e)/h,F=(s-k)/d,H=(T-P)/h,j=(k-L)/d;I.setAttribute("x",D),I.setAttribute("y",F),I.setAttribute("width",H),I.setAttribute("height",j),b.append(I),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${F}" width="${H}" height="${j}"/>`)}r(this,Jg)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(g),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,e=v(this,Zg,new ST({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Me("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:o,exportValues:l}of i){if(s===-1||o===e)continue;const h=typeof l=="string"?l:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!yf.has(d)){Wt(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==e&&yf.has(i)&&n.push({id:o,exportValue:s,domElement:i})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};Gd=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,A0=new WeakSet,ET=function(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:h}}}}=this;n==null||n.splice(0,4,...t);const{width:d,height:p}=Dl(t);e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(o-t[3]+h)/o}%`,i===0?(e.width=`${100*d/s}%`,e.height=`${100*p/o}%`):this.setRotation(i)};let an=jk;var Vs,eu,wN,EN;class _N extends an{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});E(this,Vs);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(n.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(A(this,Vs,wN).call(this,i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(A(this,Vs,EN).call(this,i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&A(this,Vs,eu).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),A(this,Vs,eu).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=i.get(s);o&&(e[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),A(this,Vs,eu).call(this)}_bindResetFormAction(e,n){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),A(this,Vs,eu).call(this),!this._fieldObjects){Wt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var g;i==null||i();const{fields:s,refs:o,include:l}=n,h=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const b of s){const _=this._fieldObjects[b]||[];for(const{id:S}of _)m.add(S)}for(const b of Object.values(this._fieldObjects))for(const _ of b)m.has(_.id)===l&&h.push(_)}else for(const m of Object.values(this._fieldObjects))h.push(...m);const d=this.annotationStorage,p=[];for(const m of h){const{id:b}=m;switch(p.push(b),m.type){case"text":{const S=m.defaultValue||"";d.setValue(b,{value:S});break}case"checkbox":case"radiobutton":{const S=m.defaultValue===m.exportValues;d.setValue(b,{value:S});break}case"combobox":case"listbox":{const S=m.defaultValue||"";d.setValue(b,{value:S});break}default:continue}const _=document.querySelector(`[data-element-id="${b}"]`);if(_){if(!yf.has(_)){Wt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;_.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}Vs=new WeakSet,eu=function(){this.container.setAttribute("data-internal-link","")},wN=function(e,n,i=null){e.href=this.linkService.getAnchorUrl(""),n.description&&(e.title=n.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},A(this,Vs,eu).call(this)},EN=function(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),A(this,Vs,eu).call(this)};class BU extends an{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Sf extends an{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ui.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(n,o=>{var l;if(n==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}s&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(t,e,n,i){var s,o,l;for(const[h,d]of n)(d==="Action"||(s=this.data.actions)!=null&&s[d])&&((d==="Focus"||d==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,d,i),d==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):d==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Pt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||jU,s=t.style;let o;const l=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l),p=Math.round(d/(wx*i))||1,g=d/p;o=Math.min(i,h(g/wx))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,h(d/wx))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=Pt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class zU extends Sf{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=n),s.setValue(o.id,{[i]:n})}render(){var i,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let l=o.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&l.length>h&&(l=l.slice(0,h));let d=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const p={userValue:l,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=d??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",d??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),yf.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=nA,this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",m=>{t.setValue(e,{value:m.target.value}),this.setPropertyOnSiblings(n,"value",m.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue??"";n.value=p.userValue=b,p.formattedValue=null});let g=m=>{const{formattedValue:b}=p;b!=null&&(m.target.value=b),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{var S;if(p.focused)return;const{target:_}=b;p.userValue&&(_.value=p.userValue),p.lastCommittedValue=_.value,p.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const _={value(S){p.userValue=S.detail.value??"",t.setValue(e,{value:p.userValue.toString()}),S.target.value=p.userValue},formattedValue(S){const{formattedValue:C}=S.detail;p.formattedValue=C,C!=null&&S.target!==document.activeElement&&(S.target.value=C),t.setValue(e,{formattedValue:C})},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:C}=S.detail,{target:T}=S;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let k=p.userValue;!k||k.length<=C||(k=k.slice(0,C),T.value=p.userValue=k,t.setValue(e,{value:k}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(_,b)}),n.addEventListener("keydown",b=>{var C;p.commitKey=1;let _=-1;if(b.key==="Escape"?_=0:b.key==="Enter"&&!this.data.multiLine?_=2:b.key==="Tab"&&(p.commitKey=3),_===-1)return;const{value:S}=b.target;p.lastCommittedValue!==S&&(p.lastCommittedValue=S,p.userValue=S,(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:_,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const m=g;g=null,n.addEventListener("blur",b=>{var S,C;if(!p.focused||!b.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(p.focused=!1);const{value:_}=b.target;p.userValue=_,p.lastCommittedValue!==_&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:p.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),m(b)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",b=>{var I;p.lastCommittedValue=null;const{data:_,target:S}=b,{value:C,selectionStart:T,selectionEnd:k}=S;let P=T,L=k;switch(b.inputType){case"deleteWordBackward":{const D=C.substring(0,T).match(/\w*[^\w]*$/);D&&(P-=D[0].length);break}case"deleteWordForward":{const D=C.substring(T).match(/^[^\w]*\w*/);D&&(L+=D[0].length);break}case"deleteContentBackward":T===k&&(P-=1);break;case"deleteContentForward":T===k&&(L+=1);break}b.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:_||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(g&&n.addEventListener("blur",g),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class UU extends Sf{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class GU extends Sf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return yf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=nA,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const d of this._getElementsByName(l,n)){const p=h&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue||"Off";o.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const l={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class SN extends Sf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,n))t.setValue(o.id,{value:!1});const s=document.createElement("input");if(yf.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=nA,s.addEventListener("change",o=>{const{name:l,checked:h}=o.target;for(const d of this._getElementsByName(l,n))t.setValue(d.id,{value:!1});t.setValue(n,{value:h})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue;o.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const h={value:d=>{const p=o===d.detail.value;for(const g of this._getElementsByName(d.target.name)){const m=p&&g.id===n;g.domElement&&(g.domElement.checked=m),t.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class VU extends _N{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class WU extends Sf{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");yf.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=nA;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===g});for(const p of this.data.options){const g=document.createElement("option");g.textContent=p.displayValue,g.value=p.exportValue,n.value.includes(p.exportValue)&&(g.setAttribute("selected",!0),s=!1),i.append(g)}let o=null;if(s){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),o=()=>{p.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=p=>{const g=p?"value":"textContent",{options:m,multiple:b}=i;return b?Array.prototype.filter.call(m,_=>_.selected).map(_=>_[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let h=l(!1);const d=p=>{const g=p.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const g={value(m){o==null||o();const b=m.detail.value,_=new Set(Array.isArray(b)?b:[b]);for(const S of i.options)S.selected=_.has(S.value);t.setValue(e,{value:l(!0)}),h=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const b=i.options,_=m.detail.remove;b[_].selected=!1,i.remove(_),b.length>0&&Array.prototype.findIndex.call(b,C=>C.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),h=l(!1)},insert(m){const{index:b,displayValue:_,exportValue:S}=m.detail.insert,C=i.children[b],T=document.createElement("option");T.textContent=_,T.value=S,C?C.before(T):i.append(T),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},items(m){const{items:b}=m.detail;for(;i.length!==0;)i.remove(0);for(const _ of b){const{displayValue:S,exportValue:C}=_,T=document.createElement("option");T.textContent=S,T.value=C,i.append(T)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:d(m)}),h=l(!1)},indices(m){const b=new Set(m.detail.indices);for(const _ of m.target.options)_.selected=b.has(_.index);t.setValue(e,{value:l(!0)}),h=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,p)}),i.addEventListener("input",p=>{var b;const g=l(!0),m=l(!1);t.setValue(e,{value:g}),p.preventDefault(),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ST extends an{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:an._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new qU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(n=>`${_k}${n}`).join(",")),this.container}}var tm,FE,OE,em,Vd,Xe,vl,nm,_0,w0,im,bl,sa,Al,E0,_l,S0,Wd,qd,_e,Dw,xT,xN,CN,TN,kN,Fw,Ow,CT;class qU{constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:h,rect:d,parentRect:p,open:g}){E(this,_e);E(this,tm,A(this,_e,TN).bind(this));E(this,FE,A(this,_e,CT).bind(this));E(this,OE,A(this,_e,Ow).bind(this));E(this,em,A(this,_e,Fw).bind(this));E(this,Vd,null);E(this,Xe,null);E(this,vl,null);E(this,nm,null);E(this,_0,null);E(this,w0,null);E(this,im,null);E(this,bl,!1);E(this,sa,null);E(this,Al,null);E(this,E0,null);E(this,_l,null);E(this,S0,null);E(this,Wd,null);E(this,qd,!1);var m;v(this,Xe,t),v(this,S0,i),v(this,vl,o),v(this,_l,l),v(this,w0,h),v(this,Vd,e),v(this,E0,d),v(this,im,p),v(this,_0,n),v(this,nm,Sk.toDateObject(s)),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup());for(const b of this.trigger)b.addEventListener("click",r(this,em)),b.addEventListener("mouseenter",r(this,OE)),b.addEventListener("mouseleave",r(this,FE)),b.classList.add("popupTriggerArea");for(const b of n)(m=b.container)==null||m.addEventListener("keydown",r(this,tm));r(this,Xe).hidden=!0,g&&A(this,_e,Fw).call(this)}render(){if(r(this,sa))return;const t=v(this,sa,document.createElement("div"));if(t.className="popup",r(this,Vd)){const s=t.style.outlineColor=Pt.makeHexColor(...r(this,Vd));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=Pt.makeHexColor(...r(this,Vd).map(l=>Math.floor(.7*(255-l)+l)))}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),{dir:n.dir,str:n.textContent}=r(this,S0),t.append(e),r(this,nm)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,nm).valueOf()})),e.append(s)}const i=r(this,_e,Dw);if(i)AN.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(r(this,vl));t.append(s)}r(this,Xe).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){const l=i[s];n.append(document.createTextNode(l)),s<o-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:e}){var n;r(this,Wd)||v(this,Wd,{contentsObj:r(this,vl),richText:r(this,_l)}),t&&v(this,Al,null),e&&(v(this,_l,A(this,_e,CN).call(this,e)),v(this,vl,null)),(n=r(this,sa))==null||n.remove(),v(this,sa,null)}resetEdited(){var t;r(this,Wd)&&({contentsObj:he(this,vl)._,richText:he(this,_l)._}=r(this,Wd),v(this,Wd,null),(t=r(this,sa))==null||t.remove(),v(this,sa,null),v(this,Al,null))}forceHide(){v(this,qd,this.isVisible),r(this,qd)&&(r(this,Xe).hidden=!0)}maybeShow(){r(this,qd)&&(r(this,sa)||A(this,_e,Ow).call(this),v(this,qd,!1),r(this,Xe).hidden=!1)}get isVisible(){return r(this,Xe).hidden===!1}}tm=new WeakMap,FE=new WeakMap,OE=new WeakMap,em=new WeakMap,Vd=new WeakMap,Xe=new WeakMap,vl=new WeakMap,nm=new WeakMap,_0=new WeakMap,w0=new WeakMap,im=new WeakMap,bl=new WeakMap,sa=new WeakMap,Al=new WeakMap,E0=new WeakMap,_l=new WeakMap,S0=new WeakMap,Wd=new WeakMap,qd=new WeakMap,_e=new WeakSet,Dw=function(){const t=r(this,_l),e=r(this,vl);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,_l).html||null},xT=function(){var t,e,n;return((n=(e=(t=r(this,_e,Dw))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},xN=function(){var t,e,n;return((n=(e=(t=r(this,_e,Dw))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},CN=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:r(this,_e,xN),fontSize:r(this,_e,xT)?`calc(${r(this,_e,xT)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return n},TN=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,bl))&&A(this,_e,Fw).call(this)},kN=function(){if(r(this,Al)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=r(this,w0);let o=!!r(this,im),l=o?r(this,im):r(this,E0);for(const _ of r(this,_0))if(!l||Pt.intersect(_.data.rect,l)!==null){l=_.data.rect,o=!0;break}const h=Pt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),p=o?l[2]-l[0]+5:0,g=h[0]+p,m=h[1];v(this,Al,[100*(g-i)/e,100*(m-s)/n]);const{style:b}=r(this,Xe);b.left=`${r(this,Al)[0]}%`,b.top=`${r(this,Al)[1]}%`},Fw=function(){v(this,bl,!r(this,bl)),r(this,bl)?(A(this,_e,Ow).call(this),r(this,Xe).addEventListener("click",r(this,em)),r(this,Xe).addEventListener("keydown",r(this,tm))):(A(this,_e,CT).call(this),r(this,Xe).removeEventListener("click",r(this,em)),r(this,Xe).removeEventListener("keydown",r(this,tm)))},Ow=function(){r(this,sa)||this.render(),this.isVisible?r(this,bl)&&r(this,Xe).classList.add("focused"):(A(this,_e,kN).call(this),r(this,Xe).hidden=!1,r(this,Xe).style.zIndex=parseInt(r(this,Xe).style.zIndex)+1e3)},CT=function(){r(this,Xe).classList.remove("focused"),!(r(this,bl)||!this.isVisible)&&(r(this,Xe).hidden=!0,r(this,Xe).style.zIndex=parseInt(r(this,Xe).style.zIndex)-1e3)};class PN extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Ut.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var x0;class XU extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,x0,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:i}=Dl(e.rect),s=this.svgFactory.create(n,i,!0),o=v(this,x0,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,x0)}addHighlightArea(){this.container.classList.add("highlightArea")}}x0=new WeakMap;var C0;class YU extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,C0,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:i}=Dl(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,C0,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",n-o),l.setAttribute("height",i-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,C0)}addHighlightArea(){this.container.classList.add("highlightArea")}}C0=new WeakMap;var T0;class KU extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,T0,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:i}=Dl(e.rect),s=this.svgFactory.create(n,i,!0),o=e.borderStyle.width,l=v(this,T0,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",n/2),l.setAttribute("cy",i/2),l.setAttribute("rx",n/2-o/2),l.setAttribute("ry",i/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,T0)}addHighlightArea(){this.container.classList.add("highlightArea")}}T0=new WeakMap;var k0;class RN extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,k0,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:i,popupRef:s}}=this;if(!n)return this.container;const{width:o,height:l}=Dl(e),h=this.svgFactory.create(o,l,!0);let d=[];for(let g=0,m=n.length;g<m;g+=2){const b=n[g]-e[0],_=e[3]-n[g+1];d.push(`${b},${_}`)}d=d.join(" ");const p=v(this,k0,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",d),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),h.append(p),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,k0)}addHighlightArea(){this.container.classList.add("highlightArea")}}k0=new WeakMap;class QU extends RN{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class JU extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var P0;class Mk extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});E(this,P0,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ut.HIGHLIGHT:Ut.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:n,borderStyle:i,popupRef:s}}=this,{width:o,height:l}=Dl(e),h=this.svgFactory.create(o,l,!0);for(const d of n){let p=[];for(let m=0,b=d.length;m<b;m+=2){const _=d[m]-e[0],S=e[3]-d[m+1];p.push(`${_},${S}`)}p=p.join(" ");const g=this.svgFactory.createElement(this.svgElementName);r(this,P0).push(g),g.setAttribute("points",p),g.setAttribute("stroke-width",i.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),h.append(g)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return r(this,P0)}addHighlightArea(){this.container.classList.add("highlightArea")}}P0=new WeakMap;class LN extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ut.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class ZU extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class tG extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class eG extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class MN extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ut.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var R0,L0,TT;class nG extends an{constructor(e){var i;super(e,{isRenderable:!0});E(this,L0);E(this,R0,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,L0,TT).bind(this)),v(this,R0,i);const{isMac:s}=Ui.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&A(this,L0,TT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return r(this,R0)}addHighlightArea(){this.container.classList.add("highlightArea")}}R0=new WeakMap,L0=new WeakSet,TT=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var M0,Xd,Yd,I0,bf,IN,kT,nD;let iG=(nD=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:l}){E(this,bf);E(this,M0,null);E(this,Xd,null);E(this,Yd,new Map);E(this,I0,null);this.div=t,v(this,M0,e),v(this,Xd,n),v(this,I0,l||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return r(this,Yd).size>0}async render(t){var o;const{annotations:e}=t,n=this.div;gf(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Lk,annotationStorage:t.annotationStorage||new Ck,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const h=l.annotationType===bn.POPUP;if(h){const g=i.get(l.id);if(!g)continue;s.elements=g}else{const{width:g,height:m}=Dl(l.rect);if(g<=0||m<=0)continue}s.data=l;const d=HU.create(s);if(!d.isRenderable)continue;if(!h&&l.popupRef){const g=i.get(l.popupRef);g?g.push(d):i.set(l.popupRef,[d])}const p=d.render();l.hidden&&(p.style.visibility="hidden"),await A(this,bf,IN).call(this,p,l.id),d._isEditable&&(r(this,Yd).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}A(this,bf,kT).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,gf(e,{rotation:t.rotation}),A(this,bf,kT).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,Yd).values())}getEditableAnnotation(t){return r(this,Yd).get(t)}},M0=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,I0=new WeakMap,bf=new WeakSet,IN=async function(t,e){var o,l;const n=t.firstChild||t,i=n.id=`${_k}${e}`,s=await((o=r(this,I0))==null?void 0:o.getAriaAttributes(i));if(s)for(const[h,d]of s)n.setAttribute(h,d);this.div.append(t),(l=r(this,M0))==null||l.moveElementInDOM(this.div,t,n,!1)},kT=function(){if(!r(this,Xd))return;const t=this.div;for(const[e,n]of r(this,Xd)){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n)}r(this,Xd).clear()},nD);const T_=/\r\n?|\n/g;var ra,Os,D0,Kd,Ns,gn,DN,FN,ON,Nw,$l,$w,jw,NN,RT,$N;const Te=class Te extends me{constructor(e){super({...e,name:"freeTextEditor"});E(this,gn);E(this,ra);E(this,Os,"");E(this,D0,`${this.id}-editor`);E(this,Kd,null);E(this,Ns);v(this,ra,e.color||Te._defaultColor||me._defaultLineColor),v(this,Ns,e.fontSize||Te._defaultFontSize)}static get _keyboardManager(){const e=Te.prototype,n=o=>o.isEmpty(),i=mf.TRANSLATE_SMALL,s=mf.TRANSLATE_BIG;return ee(this,"_keyboardManager",new eA([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(e,n){me.initialize(e,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Nt.FREETEXT_SIZE:Te._defaultFontSize=n;break;case Nt.FREETEXT_COLOR:Te._defaultColor=n;break}}updateParams(e,n){switch(e){case Nt.FREETEXT_SIZE:A(this,gn,DN).call(this,n);break;case Nt.FREETEXT_COLOR:A(this,gn,FN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,Te._defaultFontSize],[Nt.FREETEXT_COLOR,Te._defaultColor||me._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,r(this,Ns)],[Nt.FREETEXT_COLOR,r(this,ra)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-Te._internalPadding*e,-(Te._internalPadding+r(this,Ns))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ut.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,Kd,new AbortController);const e=this._uiManager.combinedSignal(r(this,Kd));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,D0)),this._isDraggable=!0,(e=r(this,Kd))==null||e.abort(),v(this,Kd,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Os),n=v(this,Os,A(this,gn,ON).call(this).trimEnd());if(e===n)return;const i=s=>{if(v(this,Os,s),!s){this.remove();return}A(this,gn,jw).call(this),this._uiManager.rebuild(this),A(this,gn,Nw).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(e)},mustExec:!1}),A(this,gn,Nw).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Te._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,D0)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${r(this,Ns)}px * var(--scale-factor))`,i.color=r(this,ra),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),eE(this,this.div,["dblclick","keydown"]),this.width){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[h,d]=this.getInitialTranslation();[h,d]=this.pageTranslationToScreen(h,d);const[p,g]=this.pageDimensions,[m,b]=this.pageTranslation;let _,S;switch(this.rotation){case 0:_=e+(l[0]-m)/p,S=n+this.height-(l[1]-b)/g;break;case 90:_=e+(l[0]-m)/p,S=n-(l[1]-b)/g,[h,d]=[d,-h];break;case 180:_=e-this.width+(l[0]-m)/p,S=n-(l[1]-b)/g,[h,d]=[-h,-d];break;case 270:_=e+(l[0]-m-this.height*g)/p,S=n+(l[1]-b-this.width*p)/g,[h,d]=[-d,h];break}this.setAt(_*s,S*o,h,d)}else this.setAt(e*s,n*o,this.width*s,this.height*o);A(this,gn,jw).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var _,S,C;const n=e.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const s=A(_=Te,$l,RT).call(_,n.getData("text")||"").replaceAll(T_,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:h,startOffset:d}=l,p=[],g=[];if(h.nodeType===Node.TEXT_NODE){const T=h.parentElement;if(g.push(h.nodeValue.slice(d).replaceAll(T_,"")),T!==this.editorDiv){let k=p;for(const P of this.editorDiv.childNodes){if(P===T){k=g;continue}k.push(A(S=Te,$l,$w).call(S,P))}}p.push(h.nodeValue.slice(0,d).replaceAll(T_,""))}else if(h===this.editorDiv){let T=p,k=0;for(const P of this.editorDiv.childNodes)k++===d&&(T=g),T.push(A(C=Te,$l,$w).call(C,P))}v(this,Os,`${p.join(`
`)}${s}${g.join(`
`)}`),A(this,gn,jw).call(this);const m=new Range;let b=p.reduce((T,k)=>T+k.length,0);for(const{firstChild:T}of this.editorDiv.childNodes)if(T.nodeType===Node.TEXT_NODE){const k=T.nodeValue.length;if(b<=k){m.setStart(T,b),m.setEnd(T,b);break}b-=k}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,i){var l;let s=null;if(e instanceof PN){const{data:{defaultAppearanceData:{fontSize:h,fontColor:d},rect:p,rotation:g,id:m,popupRef:b},textContent:_,textPosition:S,parent:{page:{pageNumber:C}}}=e;if(!_||_.length===0)return null;s=e={annotationType:Ut.FREETEXT,color:Array.from(d),fontSize:h,value:_.join(`
`),position:S,pageIndex:C-1,rect:p.slice(0),rotation:g,id:m,deleted:!1,popupRef:b}}const o=await super.deserialize(e,n,i);return v(o,Ns,e.fontSize),v(o,ra,Pt.makeHexColor(...e.color)),v(o,Os,A(l=Te,$l,RT).call(l,e.value)),o.annotationElementId=e.id||null,o._initialData=s,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Te._internalPadding*this.parentScale,i=this.getRect(n,n),s=me._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,ra)),o={annotationType:Ut.FREETEXT,color:s,fontSize:r(this,Ns),value:A(this,gn,NN).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!A(this,gn,$N).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${r(this,Ns)}px * var(--scale-factor))`,i.color=r(this,ra),n.replaceChildren();for(const o of r(this,Os).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}const s=Te._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:r(this,Os)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};ra=new WeakMap,Os=new WeakMap,D0=new WeakMap,Kd=new WeakMap,Ns=new WeakMap,gn=new WeakSet,DN=function(e){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-r(this,Ns))*this.parentScale),v(this,Ns,s),A(this,gn,Nw).call(this)},i=r(this,Ns);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},FN=function(e){const n=s=>{v(this,ra,this.editorDiv.style.color=s)},i=r(this,ra);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ON=function(){var i;const e=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(A(i=Te,$l,$w).call(i,s)),n=s);return e.join(`
`)},Nw=function(){const[e,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,h=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/n):(this.width=i.height/e,this.height=i.width/n),this.fixAndSetPosition()},$l=new WeakSet,$w=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(T_,"")},jw=function(){if(this.editorDiv.replaceChildren(),!!r(this,Os))for(const e of r(this,Os).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},NN=function(){return r(this,Os).replaceAll(" "," ")},RT=function(e){return e.replaceAll(" "," ")},$N=function(e){const{value:n,fontSize:i,color:s,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==n||e.fontSize!==i||e.color.some((l,h)=>l!==s[h])||e.pageIndex!==o},E(Te,$l),lt(Te,"_freeTextDefaultContent",""),lt(Te,"_internalPadding",0),lt(Te,"_defaultColor",null),lt(Te,"_defaultFontSize",10),lt(Te,"_type","freetext"),lt(Te,"_editorType",Ut.FREETEXT);let PT=Te,jN=class{toSVGPath(){Me("Abstract method `toSVGPath` must be implemented.")}get box(){Me("Abstract getter `box` must be implemented.")}serialize(t,e){Me("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Me("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Me("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}};var $s,aa,sm,rm,io,Yt,Qd,Jd,F0,O0,am,om,mh,N0,NE,$E,kn,Qy,HN,BN,zN,UN,GN,VN;const Fo=class Fo{constructor({x:t,y:e},n,i,s,o,l=0){E(this,kn);E(this,$s);E(this,aa,[]);E(this,sm);E(this,rm);E(this,io,[]);E(this,Yt,new Float64Array(18));E(this,Qd);E(this,Jd);E(this,F0);E(this,O0);E(this,am);E(this,om);E(this,mh,[]);v(this,$s,n),v(this,om,s*i),v(this,rm,o),r(this,Yt).set([NaN,NaN,NaN,NaN,t,e],6),v(this,sm,l),v(this,O0,r(Fo,N0)*i),v(this,F0,r(Fo,$E)*i),v(this,am,i),r(this,mh).push(t,e)}isEmpty(){return isNaN(r(this,Yt)[8])}add({x:t,y:e}){var j;v(this,Qd,t),v(this,Jd,e);const[n,i,s,o]=r(this,$s);let[l,h,d,p]=r(this,Yt).subarray(8,12);const g=t-d,m=e-p,b=Math.hypot(g,m);if(b<r(this,F0))return!1;const _=b-r(this,O0),S=_/b,C=S*g,T=S*m;let k=l,P=h;l=d,h=p,d+=C,p+=T,(j=r(this,mh))==null||j.push(t,e);const L=-T/_,I=C/_,D=L*r(this,om),F=I*r(this,om);return r(this,Yt).set(r(this,Yt).subarray(2,8),0),r(this,Yt).set([d+D,p+F],4),r(this,Yt).set(r(this,Yt).subarray(14,18),12),r(this,Yt).set([d-D,p-F],16),isNaN(r(this,Yt)[6])?(r(this,io).length===0&&(r(this,Yt).set([l+D,h+F],2),r(this,io).push(NaN,NaN,NaN,NaN,(l+D-n)/s,(h+F-i)/o),r(this,Yt).set([l-D,h-F],14),r(this,aa).push(NaN,NaN,NaN,NaN,(l-D-n)/s,(h-F-i)/o)),r(this,Yt).set([k,P,l,h,d,p],6),!this.isEmpty()):(r(this,Yt).set([k,P,l,h,d,p],6),Math.abs(Math.atan2(P-h,k-l)-Math.atan2(T,C))<Math.PI/2?([l,h,d,p]=r(this,Yt).subarray(2,6),r(this,io).push(NaN,NaN,NaN,NaN,((l+d)/2-n)/s,((h+p)/2-i)/o),[l,h,k,P]=r(this,Yt).subarray(14,18),r(this,aa).push(NaN,NaN,NaN,NaN,((k+l)/2-n)/s,((P+h)/2-i)/o),!0):([k,P,l,h,d,p]=r(this,Yt).subarray(0,6),r(this,io).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+d)/6-n)/s,((5*h+p)/6-i)/o,((l+d)/2-n)/s,((h+p)/2-i)/o),[d,p,l,h,k,P]=r(this,Yt).subarray(12,18),r(this,aa).push(((k+5*l)/6-n)/s,((P+5*h)/6-i)/o,((5*l+d)/6-n)/s,((5*h+p)/6-i)/o,((l+d)/2-n)/s,((h+p)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,io),e=r(this,aa);if(isNaN(r(this,Yt)[6])&&!this.isEmpty())return A(this,kn,HN).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);A(this,kn,zN).call(this,n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return A(this,kn,BN).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,i,s,o){return new WN(t,e,n,i,s,o)}getOutlines(){var g;const t=r(this,io),e=r(this,aa),n=r(this,Yt),[i,s,o,l]=r(this,$s),h=new Float64Array((((g=r(this,mh))==null?void 0:g.length)??0)+2);for(let m=0,b=h.length-2;m<b;m+=2)h[m]=(r(this,mh)[m]-i)/o,h[m+1]=(r(this,mh)[m+1]-s)/l;if(h[h.length-2]=(r(this,Qd)-i)/o,h[h.length-1]=(r(this,Jd)-s)/l,isNaN(n[6])&&!this.isEmpty())return A(this,kn,UN).call(this,h);const d=new Float64Array(r(this,io).length+24+r(this,aa).length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=A(this,kn,VN).call(this,d,p);for(let m=e.length-6;m>=6;m-=6)for(let b=0;b<6;b+=2){if(isNaN(e[m+b])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=e[m+b],d[p+1]=e[m+b+1],p+=2}return A(this,kn,GN).call(this,d,p),this.newFreeDrawOutline(d,h,r(this,$s),r(this,am),r(this,sm),r(this,rm))}};$s=new WeakMap,aa=new WeakMap,sm=new WeakMap,rm=new WeakMap,io=new WeakMap,Yt=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,F0=new WeakMap,O0=new WeakMap,am=new WeakMap,om=new WeakMap,mh=new WeakMap,N0=new WeakMap,NE=new WeakMap,$E=new WeakMap,kn=new WeakSet,Qy=function(){const t=r(this,Yt).subarray(4,6),e=r(this,Yt).subarray(16,18),[n,i,s,o]=r(this,$s);return[(r(this,Qd)+(t[0]-e[0])/2-n)/s,(r(this,Jd)+(t[1]-e[1])/2-i)/o,(r(this,Qd)+(e[0]-t[0])/2-n)/s,(r(this,Jd)+(e[1]-t[1])/2-i)/o]},HN=function(){const[t,e,n,i]=r(this,$s),[s,o,l,h]=A(this,kn,Qy).call(this);return`M${(r(this,Yt)[2]-t)/n} ${(r(this,Yt)[3]-e)/i} L${(r(this,Yt)[4]-t)/n} ${(r(this,Yt)[5]-e)/i} L${s} ${o} L${l} ${h} L${(r(this,Yt)[16]-t)/n} ${(r(this,Yt)[17]-e)/i} L${(r(this,Yt)[14]-t)/n} ${(r(this,Yt)[15]-e)/i} Z`},BN=function(t){const e=r(this,aa);t.push(`L${e[4]} ${e[5]} Z`)},zN=function(t){const[e,n,i,s]=r(this,$s),o=r(this,Yt).subarray(4,6),l=r(this,Yt).subarray(16,18),[h,d,p,g]=A(this,kn,Qy).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-n)/s} L${h} ${d} L${p} ${g} L${(l[0]-e)/i} ${(l[1]-n)/s}`)},UN=function(t){const e=r(this,Yt),[n,i,s,o]=r(this,$s),[l,h,d,p]=A(this,kn,Qy).call(this),g=new Float64Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/o],0),this.newFreeDrawOutline(g,t,r(this,$s),r(this,am),r(this,sm),r(this,rm))},GN=function(t,e){const n=r(this,aa);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},VN=function(t,e){const n=r(this,Yt).subarray(4,6),i=r(this,Yt).subarray(16,18),[s,o,l,h]=r(this,$s),[d,p,g,m]=A(this,kn,Qy).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/l,(n[1]-o)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/h],e),e+=24},E(Fo,N0,8),E(Fo,NE,2),E(Fo,$E,r(Fo,N0)+r(Fo,NE));let iE=Fo;var lm,Zd,wl,$0,js,j0,sn,fs,Jy,Zy,qN;class WN extends jN{constructor(e,n,i,s,o,l){super();E(this,fs);E(this,lm);E(this,Zd,null);E(this,wl);E(this,$0);E(this,js);E(this,j0);E(this,sn);v(this,sn,e),v(this,js,n),v(this,lm,i),v(this,j0,s),v(this,wl,o),v(this,$0,l),A(this,fs,qN).call(this,l);const{x:h,y:d,width:p,height:g}=r(this,Zd);for(let m=0,b=e.length;m<b;m+=2)e[m]=(e[m]-h)/p,e[m+1]=(e[m+1]-d)/g;for(let m=0,b=n.length;m<b;m+=2)n[m]=(n[m]-h)/p,n[m+1]=(n[m+1]-d)/g}toSVGPath(){const e=[`M${r(this,sn)[4]} ${r(this,sn)[5]}`];for(let n=6,i=r(this,sn).length;n<i;n+=6){if(isNaN(r(this,sn)[n])){e.push(`L${r(this,sn)[n+4]} ${r(this,sn)[n+5]}`);continue}e.push(`C${r(this,sn)[n]} ${r(this,sn)[n+1]} ${r(this,sn)[n+2]} ${r(this,sn)[n+3]} ${r(this,sn)[n+4]} ${r(this,sn)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,i,s],o){const l=i-e,h=s-n;let d,p;switch(o){case 0:d=A(this,fs,Jy).call(this,r(this,sn),e,s,l,-h),p=A(this,fs,Jy).call(this,r(this,js),e,s,l,-h);break;case 90:d=A(this,fs,Zy).call(this,r(this,sn),e,n,l,h),p=A(this,fs,Zy).call(this,r(this,js),e,n,l,h);break;case 180:d=A(this,fs,Jy).call(this,r(this,sn),i,n,-l,h),p=A(this,fs,Jy).call(this,r(this,js),i,n,-l,h);break;case 270:d=A(this,fs,Zy).call(this,r(this,sn),i,s,-l,-h),p=A(this,fs,Zy).call(this,r(this,js),i,s,-l,-h);break}return{outline:Array.from(d),points:[Array.from(p)]}}get box(){return r(this,Zd)}newOutliner(e,n,i,s,o,l=0){return new iE(e,n,i,s,o,l)}getNewOutline(e,n){const{x:i,y:s,width:o,height:l}=r(this,Zd),[h,d,p,g]=r(this,lm),m=o*p,b=l*g,_=i*p+h,S=s*g+d,C=this.newOutliner({x:r(this,js)[0]*m+_,y:r(this,js)[1]*b+S},r(this,lm),r(this,j0),e,r(this,$0),n??r(this,wl));for(let T=2;T<r(this,js).length;T+=2)C.add({x:r(this,js)[T]*m+_,y:r(this,js)[T+1]*b+S});return C.getOutlines()}get mustRemoveSelfIntersections(){return!0}}lm=new WeakMap,Zd=new WeakMap,wl=new WeakMap,$0=new WeakMap,js=new WeakMap,j0=new WeakMap,sn=new WeakMap,fs=new WeakSet,Jy=function(e,n,i,s,o){const l=new Float64Array(e.length);for(let h=0,d=e.length;h<d;h+=2)l[h]=n+e[h]*s,l[h+1]=i+e[h+1]*o;return l},Zy=function(e,n,i,s,o){const l=new Float64Array(e.length);for(let h=0,d=e.length;h<d;h+=2)l[h]=n+e[h+1]*s,l[h+1]=i+e[h]*o;return l},qN=function(e){const n=r(this,sn);let i=n[4],s=n[5],o=i,l=s,h=i,d=s,p=i,g=s;const m=e?Math.max:Math.min;for(let T=6,k=n.length;T<k;T+=6){if(isNaN(n[T]))o=Math.min(o,n[T+4]),l=Math.min(l,n[T+5]),h=Math.max(h,n[T+4]),d=Math.max(d,n[T+5]),g<n[T+5]?(p=n[T+4],g=n[T+5]):g===n[T+5]&&(p=m(p,n[T+4]));else{const P=Pt.bezierBoundingBox(i,s,...n.slice(T,T+6));o=Math.min(o,P[0]),l=Math.min(l,P[1]),h=Math.max(h,P[2]),d=Math.max(d,P[3]),g<P[3]?(p=P[2],g=P[3]):g===P[3]&&(p=m(p,P[2]))}i=n[T+4],s=n[T+5]}const b=o-r(this,wl),_=l-r(this,wl),S=h-o+2*r(this,wl),C=d-l+2*r(this,wl);v(this,Zd,{x:b,y:_,width:S,height:C,lastPoint:[p,g]})};var H0,yh,oa,qi,XN,Hw,YN,KN,LT;class UM{constructor(t,e=0,n=0,i=!0){E(this,qi);E(this,H0);E(this,yh,[]);E(this,oa,[]);let s=1/0,o=-1/0,l=1/0,h=-1/0;const d=10**-4;for(const{x:C,y:T,width:k,height:P}of t){const L=Math.floor((C-e)/d)*d,I=Math.ceil((C+k+e)/d)*d,D=Math.floor((T-e)/d)*d,F=Math.ceil((T+P+e)/d)*d,H=[L,D,F,!0],j=[I,D,F,!1];r(this,yh).push(H,j),s=Math.min(s,L),o=Math.max(o,I),l=Math.min(l,D),h=Math.max(h,F)}const p=o-s+2*n,g=h-l+2*n,m=s-n,b=l-n,_=r(this,yh).at(i?-1:-2),S=[_[0],_[2]];for(const C of r(this,yh)){const[T,k,P]=C;C[0]=(T-m)/p,C[1]=(k-b)/g,C[2]=(P-b)/g}v(this,H0,{x:m,y:b,width:p,height:g,lastPoint:S})}getOutlines(){r(this,yh).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of r(this,yh))e[3]?(t.push(...A(this,qi,LT).call(this,e)),A(this,qi,YN).call(this,e)):(A(this,qi,KN).call(this,e),t.push(...A(this,qi,LT).call(this,e)));return A(this,qi,XN).call(this,t)}}H0=new WeakMap,yh=new WeakMap,oa=new WeakMap,qi=new WeakSet,XN=function(t){const e=[],n=new Set;for(const o of t){const[l,h,d]=o;e.push([l,h,o],[l,d,o])}e.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=e.length;o<l;o+=2){const h=e[o][2],d=e[o+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let s;for(;n.size>0;){const o=n.values().next().value;let[l,h,d,p,g]=o;n.delete(o);let m=l,b=h;for(s=[l,d],i.push(s);;){let _;if(n.has(p))_=p;else if(n.has(g))_=g;else break;n.delete(_),[l,h,d,p,g]=_,m!==l&&(s.push(m,b,l,b===h?h:d),m=l),b=b===h?d:h}s.push(m,b)}return new sG(i,r(this,H0))},Hw=function(t){const e=r(this,oa);let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,o=e[s][0];if(o===t)return s;o<t?n=s+1:i=s-1}return i+1},YN=function([,t,e]){const n=A(this,qi,Hw).call(this,t);r(this,oa).splice(n,0,[t,e])},KN=function([,t,e]){const n=A(this,qi,Hw).call(this,t);for(let i=n;i<r(this,oa).length;i++){const[s,o]=r(this,oa)[i];if(s!==t)break;if(s===t&&o===e){r(this,oa).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,o]=r(this,oa)[i];if(s!==t)break;if(s===t&&o===e){r(this,oa).splice(i,1);return}}},LT=function(t){const[e,n,i]=t,s=[[e,n,i]],o=A(this,qi,Hw).call(this,i);for(let l=0;l<o;l++){const[h,d]=r(this,oa)[l];for(let p=0,g=s.length;p<g;p++){const[,m,b]=s[p];if(!(d<=m||b<=h)){if(m>=h){if(b>d)s[p][1]=d;else{if(g===1)return[];s.splice(p,1),p--,g--}continue}s[p][2]=h,b>d&&s.push([e,d,b])}}}return s};var B0,cm;class sG extends jN{constructor(e,n){super();E(this,B0);E(this,cm);v(this,cm,e),v(this,B0,n)}toSVGPath(){const e=[];for(const n of r(this,cm)){let[i,s]=n;e.push(`M${i} ${s}`);for(let o=2;o<n.length;o+=2){const l=n[o],h=n[o+1];l===i?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${l}`),i=l)}e.push("Z")}return e.join(" ")}serialize([e,n,i,s],o){const l=[],h=i-e,d=s-n;for(const p of r(this,cm)){const g=new Array(p.length);for(let m=0;m<p.length;m+=2)g[m]=e+p[m]*h,g[m+1]=s-p[m+1]*d;l.push(g)}return l}get box(){return r(this,B0)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}B0=new WeakMap,cm=new WeakMap;class MT extends iE{newFreeDrawOutline(t,e,n,i,s,o){return new rG(t,e,n,i,s,o)}get classNamesForDrawing(){return["highlight","free"]}}class rG extends WN{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,n,i,s,o=0){return new MT(t,e,n,i,s,o)}}var la,tf,hm,En,z0,um,U0,G0,vh,ca,dm,V0,be,IT,DT,FT,nu,QN,vc;const is=class is{constructor({editor:t=null,uiManager:e=null}){E(this,be);E(this,la,null);E(this,tf,null);E(this,hm);E(this,En,null);E(this,z0,!1);E(this,um,!1);E(this,U0,null);E(this,G0);E(this,vh,null);E(this,ca,null);E(this,dm);var n;t?(v(this,um,!1),v(this,dm,Nt.HIGHLIGHT_COLOR),v(this,U0,t)):(v(this,um,!0),v(this,dm,Nt.HIGHLIGHT_DEFAULT_COLOR)),v(this,ca,(t==null?void 0:t._uiManager)||e),v(this,G0,r(this,ca)._eventBus),v(this,hm,(t==null?void 0:t.color)||((n=r(this,ca))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),r(is,V0)||v(is,V0,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ee(this,"_keyboardManager",new eA([[["Escape","mac+Escape"],is.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],is.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],is.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],is.prototype._moveToPrevious],[["Home","mac+Home"],is.prototype._moveToBeginning],[["End","mac+End"],is.prototype._moveToEnd]]))}renderButton(){const t=v(this,la,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,ca)._signal;t.addEventListener("click",A(this,be,nu).bind(this),{signal:e}),t.addEventListener("keydown",A(this,be,FT).bind(this),{signal:e});const n=v(this,tf,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=r(this,hm),t.append(n),t}renderMainDropdown(){const t=v(this,En,A(this,be,IT).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,la)){A(this,be,nu).call(this,t);return}const e=t.target.getAttribute("data-color");e&&A(this,be,DT).call(this,e,t)}_moveToNext(t){var e,n;if(!r(this,be,vc)){A(this,be,nu).call(this,t);return}if(t.target===r(this,la)){(e=r(this,En).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=r(this,En))==null?void 0:e.firstChild)||t.target===r(this,la)){r(this,be,vc)&&this._hideDropdownFromKeyboard();return}r(this,be,vc)||A(this,be,nu).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!r(this,be,vc)){A(this,be,nu).call(this,t);return}(e=r(this,En).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,be,vc)){A(this,be,nu).call(this,t);return}(e=r(this,En).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,En))==null||t.classList.add("hidden"),(e=r(this,vh))==null||e.abort(),v(this,vh,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,um)){if(!r(this,be,vc)){(t=r(this,U0))==null||t.unselect();return}this.hideDropdown(),r(this,la).focus({preventScroll:!0,focusVisible:r(this,z0)})}}updateColor(t){if(r(this,tf)&&(r(this,tf).style.backgroundColor=t),!r(this,En))return;const e=r(this,ca).highlightColors.values();for(const n of r(this,En).children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,la))==null||t.remove(),v(this,la,null),v(this,tf,null),(e=r(this,En))==null||e.remove(),v(this,En,null)}};la=new WeakMap,tf=new WeakMap,hm=new WeakMap,En=new WeakMap,z0=new WeakMap,um=new WeakMap,U0=new WeakMap,G0=new WeakMap,vh=new WeakMap,ca=new WeakMap,dm=new WeakMap,V0=new WeakMap,be=new WeakSet,IT=function(){const t=document.createElement("div"),e=r(this,ca)._signal;t.addEventListener("contextmenu",Sr,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of r(this,ca).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",r(is,V0)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===r(this,hm)),s.addEventListener("click",A(this,be,DT).bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",A(this,be,FT).bind(this),{signal:e}),t},DT=function(t,e){e.stopPropagation(),r(this,G0).dispatch("switchannotationeditorparams",{source:this,type:r(this,dm),value:t})},FT=function(t){is._keyboardManager.exec(this,t)},nu=function(t){if(r(this,be,vc)){this.hideDropdown();return}if(v(this,z0,t.detail===0),r(this,vh)||(v(this,vh,new AbortController),window.addEventListener("pointerdown",A(this,be,QN).bind(this),{signal:r(this,ca).combinedSignal(r(this,vh))})),r(this,En)){r(this,En).classList.remove("hidden");return}const e=v(this,En,A(this,be,IT).call(this));r(this,la).append(e)},QN=function(t){var e;(e=r(this,En))!=null&&e.contains(t.target)||this.hideDropdown()},vc=function(){return r(this,En)&&!r(this,En).classList.contains("hidden")},E(is,V0,null);let sE=is;var fm,W0,El,ef,pm,fr,q0,X0,nf,ha,Ci,cs,gm,Sl,Sn,mm,pr,Y0,Bt,OT,Bw,JN,ZN,t2,NT,iu,_r,dp,e2,zw,tv,n2,i2,s2,r2,a2;const oe=class oe extends me{constructor(e){super({...e,name:"highlightEditor"});E(this,Bt);E(this,fm,null);E(this,W0,0);E(this,El);E(this,ef,null);E(this,pm,null);E(this,fr,null);E(this,q0,null);E(this,X0,0);E(this,nf,null);E(this,ha,null);E(this,Ci,null);E(this,cs,!1);E(this,gm,null);E(this,Sl);E(this,Sn,null);E(this,mm,"");E(this,pr);E(this,Y0,"");this.color=e.color||oe._defaultColor,v(this,pr,e.thickness||oe._defaultThickness),v(this,Sl,e.opacity||oe._defaultOpacity),v(this,El,e.boxes||null),v(this,Y0,e.methodOfCreation||""),v(this,mm,e.text||""),this._isDraggable=!1,e.highlightId>-1?(v(this,cs,!0),A(this,Bt,Bw).call(this,e),A(this,Bt,iu).call(this)):r(this,El)&&(v(this,fm,e.anchorNode),v(this,W0,e.anchorOffset),v(this,q0,e.focusNode),v(this,X0,e.focusOffset),A(this,Bt,OT).call(this),A(this,Bt,iu).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=oe.prototype;return ee(this,"_keyboardManager",new eA([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,cs)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,pr),methodOfCreation:r(this,Y0)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var i;me.initialize(e,n),oe._defaultColor||(oe._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Nt.HIGHLIGHT_DEFAULT_COLOR:oe._defaultColor=n;break;case Nt.HIGHLIGHT_THICKNESS:oe._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return r(this,gm)}updateParams(e,n){switch(e){case Nt.HIGHLIGHT_COLOR:A(this,Bt,JN).call(this,n);break;case Nt.HIGHLIGHT_THICKNESS:A(this,Bt,ZN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_DEFAULT_COLOR,oe._defaultColor],[Nt.HIGHLIGHT_THICKNESS,oe._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||oe._defaultColor],[Nt.HIGHLIGHT_THICKNESS,r(this,pr)||oe._defaultThickness],[Nt.HIGHLIGHT_FREE,r(this,cs)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(v(this,pm,new sE({editor:this})),e.addColorPicker(r(this,pm))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,Bt,tv).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,A(this,Bt,tv).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){A(this,Bt,NT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,Bt,iu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let n=!1;this.parent&&!e?A(this,Bt,NT).call(this):e&&(A(this,Bt,iu).call(this,e),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var s,o,l;const{drawLayer:n}=this.parent;let i;r(this,cs)?(e=(e-this.rotation+360)%360,i=A(s=oe,_r,dp).call(s,r(this,ha).box,e)):i=A(o=oe,_r,dp).call(o,this,e),n.rotate(r(this,Ci),e),n.rotate(r(this,Sn),e),n.updateBox(r(this,Ci),i),n.updateBox(r(this,Sn),A(l=oe,_r,dp).call(l,r(this,fr).box,e))}render(){if(this.div)return this.div;const e=super.render();r(this,mm)&&(e.setAttribute("aria-label",r(this,mm)),e.setAttribute("role","mark")),r(this,cs)?e.classList.add("free"):this.div.addEventListener("keydown",A(this,Bt,e2).bind(this),{signal:this._uiManager._signal});const n=v(this,nf,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=r(this,ef);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),eE(this,r(this,nf),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(r(this,Sn),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(r(this,Sn),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:A(this,Bt,zw).call(this,!0);break;case 1:case 3:A(this,Bt,zw).call(this,!1);break}}select(){var e,n;super.select(),r(this,Sn)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,Sn),"hovered"),(n=this.parent)==null||n.drawLayer.addClass(r(this,Sn),"selected"))}unselect(){var e;super.unselect(),r(this,Sn)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,Sn),"selected"),r(this,cs)||A(this,Bt,zw).call(this,!1))}get _mustFixPosition(){return!r(this,cs)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(r(this,Ci),e),this.parent.drawLayer.show(r(this,Sn),e))}static startHighlighting(e,n,{target:i,x:s,y:o}){const{x:l,y:h,width:d,height:p}=i.getBoundingClientRect(),g=new AbortController,m=e.combinedSignal(g),b=S=>{S.preventDefault(),S.stopPropagation()},_=S=>{g.abort(),A(this,_r,r2).call(this,e,S)};window.addEventListener("blur",_,{signal:m}),window.addEventListener("pointerup",_,{signal:m}),window.addEventListener("pointerdown",b,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Sr,{signal:m}),i.addEventListener("pointermove",A(this,_r,s2).bind(this,e),{signal:m}),this._freeHighlight=new MT({x:s,y:o},[l,h,d,p],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(e,n,i){var S,C,T,k;let s=null;if(e instanceof LN){const{data:{quadPoints:P,rect:L,rotation:I,id:D,color:F,opacity:H,popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:Ut.HIGHLIGHT,color:Array.from(F),opacity:H,quadPoints:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}else if(e instanceof Mk){const{data:{inkLists:P,rect:L,rotation:I,id:D,color:F,borderStyle:{rawWidth:H},popupRef:j},parent:{page:{pageNumber:Q}}}=e;s=e={annotationType:Ut.HIGHLIGHT,color:Array.from(F),thickness:H,inkLists:P,boxes:null,pageIndex:Q-1,rect:L.slice(0),rotation:I,id:D,deleted:!1,popupRef:j}}const{color:o,quadPoints:l,inkLists:h,opacity:d}=e,p=await super.deserialize(e,n,i);p.color=Pt.makeHexColor(...o),v(p,Sl,d||1),h&&v(p,pr,e.thickness),p.annotationElementId=e.id||null,p._initialData=s;const[g,m]=p.pageDimensions,[b,_]=p.pageTranslation;if(l){const P=v(p,El,[]);for(let L=0;L<l.length;L+=8)P.push({x:(l[L]-b)/g,y:1-(l[L+1]-_)/m,width:(l[L+2]-l[L])/g,height:(l[L+1]-l[L+5])/m});A(S=p,Bt,OT).call(S),A(C=p,Bt,iu).call(C),p.rotate(p.rotation)}else if(h){v(p,cs,!0);const P=h[0],L={x:P[0]-b,y:m-(P[1]-_)},I=new MT(L,[0,0,g,m],1,r(p,pr)/2,!0,.001);for(let H=0,j=P.length;H<j;H+=2)L.x=P[H]-b,L.y=m-(P[H+1]-_),I.add(L);const{id:D,clipPathId:F}=n.drawLayer.draw(I,p.color,p._defaultOpacity,!0);A(T=p,Bt,Bw).call(T,{highlightOutlines:I.getOutlines(),highlightId:D,clipPathId:F}),A(k=p,Bt,iu).call(k)}return p}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=me._colorManager.convert(this.color),s={annotationType:Ut.HIGHLIGHT,color:i,opacity:r(this,Sl),thickness:r(this,pr),quadPoints:A(this,Bt,n2).call(this),outlines:A(this,Bt,i2).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:A(this,Bt,tv).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!A(this,Bt,a2).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};fm=new WeakMap,W0=new WeakMap,El=new WeakMap,ef=new WeakMap,pm=new WeakMap,fr=new WeakMap,q0=new WeakMap,X0=new WeakMap,nf=new WeakMap,ha=new WeakMap,Ci=new WeakMap,cs=new WeakMap,gm=new WeakMap,Sl=new WeakMap,Sn=new WeakMap,mm=new WeakMap,pr=new WeakMap,Y0=new WeakMap,Bt=new WeakSet,OT=function(){const e=new UM(r(this,El),.001);v(this,ha,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=r(this,ha).box;const n=new UM(r(this,El),.0025,.001,this._uiManager.direction==="ltr");v(this,fr,n.getOutlines());const{lastPoint:i}=r(this,fr).box;v(this,gm,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Bw=function({highlightOutlines:e,highlightId:n,clipPathId:i}){var g,m;if(v(this,ha,e),v(this,fr,e.getNewOutline(r(this,pr)/2+1.5,.0025)),n>=0)v(this,Ci,n),v(this,ef,i),this.parent.drawLayer.finalizeLine(n,e),v(this,Sn,this.parent.drawLayer.drawOutline(r(this,fr)));else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(r(this,Ci),e),this.parent.drawLayer.updateBox(r(this,Ci),A(g=oe,_r,dp).call(g,r(this,ha).box,(b-this.rotation+360)%360)),this.parent.drawLayer.updateLine(r(this,Sn),r(this,fr)),this.parent.drawLayer.updateBox(r(this,Sn),A(m=oe,_r,dp).call(m,r(this,fr).box,b))}const{x:o,y:l,width:h,height:d}=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=h,this.height=d;break;case 90:{const[b,_]=this.parentDimensions;this.x=l,this.y=1-o,this.width=h*_/b,this.height=d*b/_;break}case 180:this.x=1-o,this.y=1-l,this.width=h,this.height=d;break;case 270:{const[b,_]=this.parentDimensions;this.x=1-l,this.y=o,this.width=h*_/b,this.height=d*b/_;break}}const{lastPoint:p}=r(this,fr).box;v(this,gm,[(p[0]-o)/h,(p[1]-l)/d])},JN=function(e){const n=(o,l)=>{var h,d,p;this.color=o,(h=this.parent)==null||h.drawLayer.changeColor(r(this,Ci),o),(d=r(this,pm))==null||d.updateColor(o),v(this,Sl,l),(p=this.parent)==null||p.drawLayer.changeOpacity(r(this,Ci),l)},i=this.color,s=r(this,Sl);this.addCommands({cmd:n.bind(this,e,oe._defaultOpacity),undo:n.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},ZN=function(e){const n=r(this,pr),i=s=>{v(this,pr,s),A(this,Bt,t2).call(this,s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},t2=function(e){if(!r(this,cs))return;A(this,Bt,Bw).call(this,{highlightOutlines:r(this,ha).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},NT=function(){r(this,Ci)===null||!this.parent||(this.parent.drawLayer.remove(r(this,Ci)),v(this,Ci,null),this.parent.drawLayer.remove(r(this,Sn)),v(this,Sn,null))},iu=function(e=this.parent){r(this,Ci)===null&&({id:he(this,Ci)._,clipPathId:he(this,ef)._}=e.drawLayer.draw(r(this,ha),this.color,r(this,Sl)),v(this,Sn,e.drawLayer.drawOutline(r(this,fr))),r(this,nf)&&(r(this,nf).style.clipPath=r(this,ef)))},_r=new WeakSet,dp=function({x:e,y:n,width:i,height:s},o){switch(o){case 90:return{x:1-n-s,y:e,width:s,height:i};case 180:return{x:1-e-i,y:1-n-s,width:i,height:s};case 270:return{x:n,y:1-e-i,width:s,height:i}}return{x:e,y:n,width:i,height:s}},e2=function(e){oe._keyboardManager.exec(this,e)},zw=function(e){if(!r(this,fm))return;const n=window.getSelection();e?n.setPosition(r(this,fm),r(this,W0)):n.setPosition(r(this,q0),r(this,X0))},tv=function(){return r(this,cs)?this.rotation:0},n2=function(){if(r(this,cs))return null;const[e,n]=this.pageDimensions,[i,s]=this.pageTranslation,o=r(this,El),l=new Float32Array(o.length*8);let h=0;for(const{x:d,y:p,width:g,height:m}of o){const b=d*e+i,_=(1-p-m)*n+s;l[h]=l[h+4]=b,l[h+1]=l[h+3]=_,l[h+2]=l[h+6]=b+g*e,l[h+5]=l[h+7]=_+m*n,h+=8}return l},i2=function(e){return r(this,ha).serialize(e,A(this,Bt,tv).call(this))},s2=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},r2=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},a2=function(e){const{color:n}=this._initialData;return e.color.some((i,s)=>i!==n[s])},E(oe,_r),lt(oe,"_defaultColor",null),lt(oe,"_defaultOpacity",1),lt(oe,"_defaultThickness",12),lt(oe,"_type","highlight"),lt(oe,"_editorType",Ut.HIGHLIGHT),lt(oe,"_freeHighlightId",-1),lt(oe,"_freeHighlight",null),lt(oe,"_freeHighlightClipId","");let rE=oe;var sf,rf,so,xl,gr,af,of,lf,Cl,ym,cf,hf,bh,ft,o2,l2,c2,h2,jT,u2,HT,d2,f2,p2,g2,m2,su,BT,zT,UT,Uw,Gw,fp,GT,Vw,zl,y2,VT,v2,b2,WT,Ww,ev;const He=class He extends me{constructor(e){super({...e,name:"inkEditor"});E(this,ft);E(this,sf,0);E(this,rf,0);E(this,so,null);E(this,xl,new Path2D);E(this,gr,!1);E(this,af,null);E(this,of,!1);E(this,lf,!1);E(this,Cl,null);E(this,ym,null);E(this,cf,0);E(this,hf,0);E(this,bh,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,n){me.initialize(e,n)}static updateDefaultParams(e,n){switch(e){case Nt.INK_THICKNESS:He._defaultThickness=n;break;case Nt.INK_COLOR:He._defaultColor=n;break;case Nt.INK_OPACITY:He._defaultOpacity=n/100;break}}updateParams(e,n){switch(e){case Nt.INK_THICKNESS:A(this,ft,o2).call(this,n);break;case Nt.INK_COLOR:A(this,ft,l2).call(this,n);break;case Nt.INK_OPACITY:A(this,ft,c2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Nt.INK_THICKNESS,He._defaultThickness],[Nt.INK_COLOR,He._defaultColor||me._defaultLineColor],[Nt.INK_OPACITY,Math.round(He._defaultOpacity*100)]]}get propertiesToUpdate(){return[[Nt.INK_THICKNESS,this.thickness||He._defaultThickness],[Nt.INK_COLOR,this.color||He._defaultColor||me._defaultLineColor],[Nt.INK_OPACITY,Math.round(100*(this.opacity??He._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(A(this,ft,Uw).call(this),A(this,ft,Gw).call(this)),this.isAttachedToDOM||(this.parent.add(this),A(this,ft,fp).call(this)),A(this,ft,ev).call(this)))}remove(){var e;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,so)&&(clearTimeout(r(this,so)),v(this,so,null)),(e=r(this,Cl))==null||e.disconnect(),v(this,Cl,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,n]=this.parentDimensions,i=this.width*e,s=this.height*n;this.setDimensions(i,s)}enableEditMode(){r(this,gr)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,A(this,ft,BT).call(this))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),A(this,ft,zT).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){r(this,gr)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),v(this,gr,!0),this.div.classList.add("disabled"),A(this,ft,ev).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||r(this,gr)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),A(this,ft,u2).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),A(this,ft,HT).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),A(this,ft,UT).call(this,e)}canvasPointerleave(e){A(this,ft,UT).call(this,e)}get isResizable(){return!this.isEmpty()&&r(this,gr)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,s,o,l]=A(this,ft,h2).call(this);if(this.setAt(i,s,0,0),this.setDims(o,l),A(this,ft,Uw).call(this),this.width){const[h,d]=this.parentDimensions;this.setAspectRatio(this.width*h,this.height*d),this.setAt(e*h,n*d,this.width*h,this.height*d),v(this,lf,!0),A(this,ft,fp).call(this),this.setDims(this.width*h,this.height*d),A(this,ft,su).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return A(this,ft,Gw).call(this),this.div}setDimensions(e,n){const i=Math.round(e),s=Math.round(n);if(r(this,cf)===i&&r(this,hf)===s)return;v(this,cf,i),v(this,hf,s),this.canvas.style.visibility="hidden";const[o,l]=this.parentDimensions;this.width=e/o,this.height=n/l,this.fixAndSetPosition(),r(this,gr)&&A(this,ft,GT).call(this,e,n),A(this,ft,fp).call(this),A(this,ft,su).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(e,n,i){var C,T,k;if(e instanceof Mk)return null;const s=await super.deserialize(e,n,i);s.thickness=e.thickness,s.color=Pt.makeHexColor(...e.color),s.opacity=e.opacity;const[o,l]=s.pageDimensions,h=s.width*o,d=s.height*l,p=s.parentScale,g=e.thickness/2;v(s,gr,!0),v(s,cf,Math.round(h)),v(s,hf,Math.round(d));const{paths:m,rect:b,rotation:_}=e;for(let{bezier:P}of m){P=A(C=He,zl,v2).call(C,P,b,_);const L=[];s.paths.push(L);let I=p*(P[0]-g),D=p*(P[1]-g);for(let H=2,j=P.length;H<j;H+=6){const Q=p*(P[H]-g),V=p*(P[H+1]-g),tt=p*(P[H+2]-g),Z=p*(P[H+3]-g),et=p*(P[H+4]-g),ht=p*(P[H+5]-g);L.push([[I,D],[Q,V],[tt,Z],[et,ht]]),I=et,D=ht}const F=A(this,zl,y2).call(this,L);s.bezierPath2D.push(F)}const S=A(T=s,ft,WT).call(T);return v(s,rf,Math.max(me.MIN_SIZE,S[2]-S[0])),v(s,sf,Math.max(me.MIN_SIZE,S[3]-S[1])),A(k=s,ft,GT).call(k,h,d),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),n=me._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Ut.INK,color:n,thickness:this.thickness,opacity:this.opacity,paths:A(this,ft,b2).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};sf=new WeakMap,rf=new WeakMap,so=new WeakMap,xl=new WeakMap,gr=new WeakMap,af=new WeakMap,of=new WeakMap,lf=new WeakMap,Cl=new WeakMap,ym=new WeakMap,cf=new WeakMap,hf=new WeakMap,bh=new WeakMap,ft=new WeakSet,o2=function(e){const n=s=>{this.thickness=s,A(this,ft,ev).call(this)},i=this.thickness;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},l2=function(e){const n=s=>{this.color=s,A(this,ft,su).call(this)},i=this.color;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},c2=function(e){const n=s=>{this.opacity=s,A(this,ft,su).call(this)};e/=100;const i=this.opacity;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},h2=function(){const{parentRotation:e,parentDimensions:[n,i]}=this;switch(e){case 90:return[0,i,i,n];case 180:return[n,i,n,i];case 270:return[n,0,i,n];default:return[0,0,n,i]}},jT=function(){const{ctx:e,color:n,opacity:i,thickness:s,parentScale:o,scaleFactor:l}=this;e.lineWidth=s*o/l,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${n}${Tz(i)}`},u2=function(e,n){this.canvas.addEventListener("contextmenu",Sr,{signal:this._uiManager._signal}),A(this,ft,zT).call(this),v(this,af,new AbortController);const i=this._uiManager.combinedSignal(r(this,af));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:i}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:i}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:i}),this.isEditing=!0,r(this,lf)||(v(this,lf,!0),A(this,ft,fp).call(this),this.thickness||(this.thickness=He._defaultThickness),this.color||(this.color=He._defaultColor||me._defaultLineColor),this.opacity??(this.opacity=He._defaultOpacity)),this.currentPath.push([e,n]),v(this,of,!1),A(this,ft,jT).call(this),v(this,bh,()=>{A(this,ft,p2).call(this),r(this,bh)&&window.requestAnimationFrame(r(this,bh))}),window.requestAnimationFrame(r(this,bh))},HT=function(e,n){const[i,s]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===i&&n===s)return;const o=this.currentPath;let l=r(this,xl);if(o.push([e,n]),v(this,of,!0),o.length<=2){l.moveTo(...o[0]),l.lineTo(e,n);return}o.length===3&&(v(this,xl,l=new Path2D),l.moveTo(...o[0])),A(this,ft,g2).call(this,l,...o.at(-3),...o.at(-2),e,n)},d2=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);r(this,xl).lineTo(...e)},f2=function(e,n){v(this,bh,null),e=Math.min(Math.max(e,0),this.canvas.width),n=Math.min(Math.max(n,0),this.canvas.height),A(this,ft,HT).call(this,e,n),A(this,ft,d2).call(this);let i;if(this.currentPath.length!==1)i=A(this,ft,m2).call(this);else{const d=[e,n];i=[[d,d.slice(),d.slice(),d]]}const s=r(this,xl),o=this.currentPath;this.currentPath=[],v(this,xl,new Path2D);const l=()=>{this.allRawPaths.push(o),this.paths.push(i),this.bezierPath2D.push(s),this._uiManager.rebuild(this)},h=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(A(this,ft,Uw).call(this),A(this,ft,Gw).call(this)),A(this,ft,ev).call(this))};this.addCommands({cmd:l,undo:h,mustExec:!0})},p2=function(){if(!r(this,of))return;v(this,of,!1);const e=Math.ceil(this.thickness*this.parentScale),n=this.currentPath.slice(-3),i=n.map(l=>l[0]),s=n.map(l=>l[1]);Math.min(...i)-e,Math.max(...i)+e,Math.min(...s)-e,Math.max(...s)+e;const{ctx:o}=this;o.save(),o.clearRect(0,0,this.canvas.width,this.canvas.height);for(const l of this.bezierPath2D)o.stroke(l);o.stroke(r(this,xl)),o.restore()},g2=function(e,n,i,s,o,l,h){const d=(n+s)/2,p=(i+o)/2,g=(s+l)/2,m=(o+h)/2;e.bezierCurveTo(d+2*(s-d)/3,p+2*(o-p)/3,g+2*(s-g)/3,m+2*(o-m)/3,g,m)},m2=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const n=[];let i,[s,o]=e[0];for(i=1;i<e.length-2;i++){const[b,_]=e[i],[S,C]=e[i+1],T=(b+S)/2,k=(_+C)/2,P=[s+2*(b-s)/3,o+2*(_-o)/3],L=[T+2*(b-T)/3,k+2*(_-k)/3];n.push([[s,o],P,L,[T,k]]),[s,o]=[T,k]}const[l,h]=e[i],[d,p]=e[i+1],g=[s+2*(l-s)/3,o+2*(h-o)/3],m=[d+2*(l-d)/3,p+2*(h-p)/3];return n.push([[s,o],g,m,[d,p]]),n},su=function(){if(this.isEmpty()){A(this,ft,Vw).call(this);return}A(this,ft,jT).call(this);const{canvas:e,ctx:n}=this;n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height),A(this,ft,Vw).call(this);for(const i of this.bezierPath2D)n.stroke(i)},BT=function(){if(r(this,ym))return;v(this,ym,new AbortController);const e=this._uiManager.combinedSignal(r(this,ym));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})},zT=function(){var e;(e=this.pointerdownAC)==null||e.abort(),this.pointerdownAC=null},UT=function(e){var n;(n=r(this,af))==null||n.abort(),v(this,af,null),A(this,ft,BT).call(this),r(this,so)&&clearTimeout(r(this,so)),v(this,so,setTimeout(()=>{v(this,so,null),this.canvas.removeEventListener("contextmenu",Sr)},10)),A(this,ft,f2).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Uw=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Gw=function(){v(this,Cl,new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&this.setDimensions(n.width,n.height)})),r(this,Cl).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,Cl))==null||e.disconnect(),v(this,Cl,null)},{once:!0})},fp=function(){if(!r(this,lf))return;const[e,n]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*n),A(this,ft,Vw).call(this)},GT=function(e,n){const i=A(this,ft,Ww).call(this),s=(e-i)/r(this,rf),o=(n-i)/r(this,sf);this.scaleFactor=Math.min(s,o)},Vw=function(){const e=A(this,ft,Ww).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},zl=new WeakSet,y2=function(e){const n=new Path2D;for(let i=0,s=e.length;i<s;i++){const[o,l,h,d]=e[i];i===0&&n.moveTo(...o),n.bezierCurveTo(l[0],l[1],h[0],h[1],d[0],d[1])}return n},VT=function(e,n,i){const[s,o,l,h]=n;switch(i){case 0:for(let d=0,p=e.length;d<p;d+=2)e[d]+=s,e[d+1]=h-e[d+1];break;case 90:for(let d=0,p=e.length;d<p;d+=2){const g=e[d];e[d]=e[d+1]+s,e[d+1]=g+o}break;case 180:for(let d=0,p=e.length;d<p;d+=2)e[d]=l-e[d],e[d+1]+=o;break;case 270:for(let d=0,p=e.length;d<p;d+=2){const g=e[d];e[d]=l-e[d+1],e[d+1]=h-g}break;default:throw new Error("Invalid rotation")}return e},v2=function(e,n,i){const[s,o,l,h]=n;switch(i){case 0:for(let d=0,p=e.length;d<p;d+=2)e[d]-=s,e[d+1]=h-e[d+1];break;case 90:for(let d=0,p=e.length;d<p;d+=2){const g=e[d];e[d]=e[d+1]-o,e[d+1]=g-s}break;case 180:for(let d=0,p=e.length;d<p;d+=2)e[d]=l-e[d],e[d+1]-=o;break;case 270:for(let d=0,p=e.length;d<p;d+=2){const g=e[d];e[d]=h-e[d+1],e[d+1]=l-g}break;default:throw new Error("Invalid rotation")}return e},b2=function(e,n,i,s){var p,g;const o=[],l=this.thickness/2,h=e*n+l,d=e*i+l;for(const m of this.paths){const b=[],_=[];for(let S=0,C=m.length;S<C;S++){const[T,k,P,L]=m[S];if(T[0]===L[0]&&T[1]===L[1]&&C===1){const Z=e*T[0]+h,et=e*T[1]+d;b.push(Z,et),_.push(Z,et);break}const I=e*T[0]+h,D=e*T[1]+d,F=e*k[0]+h,H=e*k[1]+d,j=e*P[0]+h,Q=e*P[1]+d,V=e*L[0]+h,tt=e*L[1]+d;S===0&&(b.push(I,D),_.push(I,D)),b.push(F,H,j,Q,V,tt),_.push(F,H),S===C-1&&_.push(V,tt)}o.push({bezier:A(p=He,zl,VT).call(p,b,s,this.rotation),points:A(g=He,zl,VT).call(g,_,s,this.rotation)})}return o},WT=function(){let e=1/0,n=-1/0,i=1/0,s=-1/0;for(const o of this.paths)for(const[l,h,d,p]of o){const g=Pt.bezierBoundingBox(...l,...h,...d,...p);e=Math.min(e,g[0]),i=Math.min(i,g[1]),n=Math.max(n,g[2]),s=Math.max(s,g[3])}return[e,i,n,s]},Ww=function(){return r(this,gr)?Math.ceil(this.thickness*this.parentScale):0},ev=function(e=!1){if(this.isEmpty())return;if(!r(this,gr)){A(this,ft,su).call(this);return}const n=A(this,ft,WT).call(this),i=A(this,ft,Ww).call(this);v(this,rf,Math.max(me.MIN_SIZE,n[2]-n[0])),v(this,sf,Math.max(me.MIN_SIZE,n[3]-n[1]));const s=Math.ceil(i+r(this,rf)*this.scaleFactor),o=Math.ceil(i+r(this,sf)*this.scaleFactor),[l,h]=this.parentDimensions;this.width=s/l,this.height=o/h,this.setAspectRatio(s,o);const d=this.translationX,p=this.translationY;this.translationX=-n[0],this.translationY=-n[1],A(this,ft,fp).call(this),A(this,ft,su).call(this),v(this,cf,s),v(this,hf,o),this.setDims(s,o);const g=e?i/this.scaleFactor/2:0;this.translate(d-this.translationX-g,p-this.translationY-g)},E(He,zl),lt(He,"_defaultColor",null),lt(He,"_defaultOpacity",1),lt(He,"_defaultThickness",1),lt(He,"_type","ink"),lt(He,"_editorType",Ut.INK);let $T=He;var Ge,ri,Ah,Tl,_h,vm,ro,kl,ao,Hs,bm,Zt,nv,iv,qw,XT,A2,Xw,YT,Yw,_2,w2;const ov=class ov extends me{constructor(e){super({...e,name:"stampEditor"});E(this,Zt);E(this,Ge,null);E(this,ri,null);E(this,Ah,null);E(this,Tl,null);E(this,_h,null);E(this,vm,"");E(this,ro,null);E(this,kl,null);E(this,ao,null);E(this,Hs,!1);E(this,bm,!1);v(this,Tl,e.bitmapUrl),v(this,_h,e.bitmapFile)}static initialize(e,n){me.initialize(e,n)}static get supportedTypes(){return ee(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return ee(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,n){n.pasteEditor(Ut.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=e||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const d=h.output;return await this.setGuessedAltText(d),n&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var e,n;r(this,ri)&&(v(this,Ge,null),this._uiManager.imageManager.deleteId(r(this,ri)),(e=r(this,ro))==null||e.remove(),v(this,ro,null),(n=r(this,kl))==null||n.disconnect(),v(this,kl,null),r(this,ao)&&(clearTimeout(r(this,ao)),v(this,ao,null))),super.remove()}rebuild(){if(!this.parent){r(this,ri)&&A(this,Zt,qw).call(this);return}super.rebuild(),this.div!==null&&(r(this,ri)&&r(this,ro)===null&&A(this,Zt,qw).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,Ah)||r(this,Ge)||r(this,Tl)||r(this,_h)||r(this,ri))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;if(this.width&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,Ge)?A(this,Zt,XT).call(this):A(this,Zt,qw).call(this),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(e*i,n*s,this.width*i,this.height*s)}return this.div}copyCanvas(e,n,i=!1){var b;e||(e=224);const{width:s,height:o}=r(this,Ge),l=new UC;let h=r(this,Ge),d=s,p=o,g=null;if(n){if(s>n||o>n){const H=Math.min(n/s,n/o);d=Math.floor(s*H),p=Math.floor(o*H)}g=document.createElement("canvas");const _=g.width=Math.ceil(d*l.sx),S=g.height=Math.ceil(p*l.sy);r(this,Hs)||(h=A(this,Zt,Xw).call(this,_,S));const C=g.getContext("2d");C.filter=this._uiManager.hcmFilter;let T="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(b=window.matchMedia)!=null&&b.call(window,"(prefers-color-scheme: dark)").matches&&(T="#8f8f9d",k="#42414d");const P=15,L=P*l.sx,I=P*l.sy,D=new OffscreenCanvas(L*2,I*2),F=D.getContext("2d");F.fillStyle=T,F.fillRect(0,0,L*2,I*2),F.fillStyle=k,F.fillRect(0,0,L,I),F.fillRect(L,I,L,I),C.fillStyle=C.createPattern(D,"repeat"),C.fillRect(0,0,_,S),C.drawImage(h,0,0,h.width,h.height,0,0,_,S)}let m=null;if(i){let _,S;if(l.symmetric&&h.width<e&&h.height<e)_=h.width,S=h.height;else if(h=r(this,Ge),s>e||o>e){const k=Math.min(e/s,e/o);_=Math.floor(s*k),S=Math.floor(o*k),r(this,Hs)||(h=A(this,Zt,Xw).call(this,_,S))}const T=new OffscreenCanvas(_,S).getContext("2d",{willReadFrequently:!0});T.drawImage(h,0,0,h.width,h.height,0,0,_,S),m={width:_,height:S,data:T.getImageData(0,0,_,S).data}}return{canvas:g,width:d,height:p,imageData:m}}getImageForAltText(){return r(this,ro)}static async deserialize(e,n,i){var S;let s=null;if(e instanceof MN){const{data:{rect:C,rotation:T,id:k,structParent:P,popupRef:L},container:I,parent:{page:{pageNumber:D}}}=e,F=I.querySelector("canvas"),H=i.imageManager.getFromCanvas(I.id,F);F.remove();const j=((S=await n._structTree.getAriaAttributes(`${_k}${k}`))==null?void 0:S.get("aria-label"))||"";s=e={annotationType:Ut.STAMP,bitmapId:H.id,bitmap:H.bitmap,pageIndex:D-1,rect:C.slice(0),rotation:T,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:P,popupRef:L}}const o=await super.deserialize(e,n,i),{rect:l,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:g,accessibilityData:m}=e;p&&i.imageManager.isValidId(p)?(v(o,ri,p),h&&v(o,Ge,h)):v(o,Tl,d),v(o,Hs,g);const[b,_]=o.pageDimensions;return o.width=(l[2]-l[0])/b,o.height=(l[3]-l[1])/_,o.annotationElementId=e.id||null,m&&(o.altTextData=m),o._initialData=s,v(o,bm,!!s),o}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Ut.STAMP,bitmapId:r(this,ri),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,Hs),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=A(this,Zt,Yw).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const h=A(this,Zt,w2).call(this,i);if(h.isSame)return null;h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const l=r(this,Hs)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(r(this,ri)))n.stamps.set(r(this,ri),{area:l,serialized:i}),i.bitmap=A(this,Zt,Yw).call(this,!1);else if(r(this,Hs)){const h=n.stamps.get(r(this,ri));l>h.area&&(h.area=l,h.serialized.bitmap.close(),h.serialized.bitmap=A(this,Zt,Yw).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};Ge=new WeakMap,ri=new WeakMap,Ah=new WeakMap,Tl=new WeakMap,_h=new WeakMap,vm=new WeakMap,ro=new WeakMap,kl=new WeakMap,ao=new WeakMap,Hs=new WeakMap,bm=new WeakMap,Zt=new WeakSet,nv=function(e,n=!1){if(!e){this.remove();return}v(this,Ge,e.bitmap),n||(v(this,ri,e.id),v(this,Hs,e.isSvg)),e.file&&v(this,vm,e.file.name),A(this,Zt,XT).call(this)},iv=function(){if(v(this,Ah,null),this._uiManager.enableWaiting(!1),!!r(this,ro)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Ge)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Ge)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},qw=function(){if(r(this,ri)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,ri)).then(i=>A(this,Zt,nv).call(this,i,!0)).finally(()=>A(this,Zt,iv).call(this));return}if(r(this,Tl)){const i=r(this,Tl);v(this,Tl,null),this._uiManager.enableWaiting(!0),v(this,Ah,this._uiManager.imageManager.getFromUrl(i).then(s=>A(this,Zt,nv).call(this,s)).finally(()=>A(this,Zt,iv).call(this)));return}if(r(this,_h)){const i=r(this,_h);v(this,_h,null),this._uiManager.enableWaiting(!0),v(this,Ah,this._uiManager.imageManager.getFromFile(i).then(s=>A(this,Zt,nv).call(this,s)).finally(()=>A(this,Zt,iv).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=ov.supportedTypesStr;const n=this._uiManager._signal;v(this,Ah,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,Zt,nv).call(this,s)}i()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>A(this,Zt,iv).call(this))),e.click()},XT=function(){const{div:e}=this;let{width:n,height:i}=r(this,Ge);const[s,o]=this.pageDimensions,l=.75;if(this.width)n=this.width*s,i=this.height*o;else if(n>l*s||i>l*o){const g=Math.min(l*s/n,l*o/i);n*=g,i*=g}const[h,d]=this.parentDimensions;this.setDims(n*h/s,i*d/o),this._uiManager.enableWaiting(!1);const p=v(this,ro,document.createElement("canvas"));p.setAttribute("role","img"),this.addContainer(p),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),A(this,Zt,YT).call(this,n,i),A(this,Zt,_2).call(this),r(this,bm)||(this.parent.addUndoableEditor(this),v(this,bm,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,vm)&&p.setAttribute("aria-label",r(this,vm))},A2=function(e,n){var l;const[i,s]=this.parentDimensions;this.width=e/i,this.height=n/s,(l=this._initialOptions)!=null&&l.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,r(this,ao)!==null&&clearTimeout(r(this,ao)),v(this,ao,setTimeout(()=>{v(this,ao,null),A(this,Zt,YT).call(this,e,n)},200))},Xw=function(e,n){const{width:i,height:s}=r(this,Ge);let o=i,l=s,h=r(this,Ge);for(;o>2*e||l>2*n;){const d=o,p=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*n&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(h,0,0,d,p,0,0,o,l),h=g.transferToImageBitmap()}return h},YT=function(e,n){const i=new UC,s=Math.ceil(e*i.sx),o=Math.ceil(n*i.sy),l=r(this,ro);if(!l||l.width===s&&l.height===o)return;l.width=s,l.height=o;const h=r(this,Hs)?r(this,Ge):A(this,Zt,Xw).call(this,s,o),d=l.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,s,o)},Yw=function(e){if(e){if(r(this,Hs)){const s=this._uiManager.imageManager.getSvgUrl(r(this,ri));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=r(this,Ge),n.getContext("2d").drawImage(r(this,Ge),0,0),n.toDataURL()}if(r(this,Hs)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*Th.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Th.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(r(this,Ge),0,0,r(this,Ge).width,r(this,Ge).height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(r(this,Ge))},_2=function(){this._uiManager._signal&&(v(this,kl,new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&A(this,Zt,A2).call(this,n.width,n.height)})),r(this,kl).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,kl))==null||e.disconnect(),v(this,kl,null)},{once:!0}))},w2=function(e){var d;const{rect:n,pageIndex:i,accessibilityData:{altText:s}}=this._initialData,o=e.rect.every((p,g)=>Math.abs(p-n[g])<1),l=e.pageIndex===i,h=(((d=e.accessibilityData)==null?void 0:d.alt)||"")===s;return{isSame:o&&l&&h,isSameAltText:h}},lt(ov,"_type","stamp"),lt(ov,"_editorType",Ut.STAMP);let qT=ov;var uf,Am,oo,wh,Pl,Bs,Eh,_m,wm,Ti,Rl,Lt,Sh,li,E2,QT,JT,ZT,Kw;const Nr=class Nr{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:h,viewport:d,l10n:p}){E(this,li);E(this,uf);E(this,Am,!1);E(this,oo,null);E(this,wh,null);E(this,Pl,null);E(this,Bs,new Map);E(this,Eh,!1);E(this,_m,!1);E(this,wm,!1);E(this,Ti,null);E(this,Rl,null);E(this,Lt);const g=[...r(Nr,Sh).values()];if(!Nr._initialized){Nr._initialized=!0;for(const m of g)m.initialize(p,t)}t.registerEditorTypes(g),v(this,Lt,t),this.pageIndex=e,this.div=n,v(this,uf,s),v(this,oo,o),this.viewport=d,v(this,Ti,h),this.drawLayer=l,this._structTree=i,r(this,Lt).addLayer(this)}get isEmpty(){return r(this,Bs).size===0}get isInvisible(){return this.isEmpty&&r(this,Lt).getMode()===Ut.NONE}updateToolbar(t){r(this,Lt).updateToolbar(t)}updateMode(t=r(this,Lt).getMode()){switch(A(this,li,Kw).call(this),t){case Ut.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ut.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Ut.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of r(Nr,Sh).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,Ti))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(r(this,Lt).getMode()!==Ut.INK)return;if(!t){for(const n of r(this,Bs).values())if(n.isEmpty()){n.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){r(this,Lt).setEditingState(t)}addCommands(t){r(this,Lt).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,oo))==null||e.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of r(this,Bs).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(r(this,Lt).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!r(this,oo))return;const e=r(this,oo).getEditableAnnotations();for(const n of e){if(n.hide(),r(this,Lt).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}}disable(){var i;v(this,wm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of r(this,Bs).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(i=this.getEditableAnnotation(s.annotationElementId))==null||i.show(),s.remove()}if(r(this,oo)){const s=r(this,oo).getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(r(this,Lt).isDeletedAnnotationElement(l))continue;let h=e.get(l);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=t.get(l),h&&(r(this,Lt).addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}A(this,li,Kw).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of r(Nr,Sh).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,wm,!1)}getEditableAnnotation(t){var e;return((e=r(this,oo))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,Lt).getActive()!==t&&r(this,Lt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,Ti))!=null&&t.div&&!r(this,Rl)){v(this,Rl,new AbortController);const e=r(this,Lt).combinedSignal(r(this,Rl));r(this,Ti).div.addEventListener("pointerdown",A(this,li,E2).bind(this),{signal:e}),r(this,Ti).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,Ti))!=null&&t.div&&r(this,Rl)&&(r(this,Rl).abort(),v(this,Rl,null),r(this,Ti).div.classList.remove("highlighting"))}enableClick(){if(r(this,wh))return;v(this,wh,new AbortController);const t=r(this,Lt).combinedSignal(r(this,wh));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){var t;(t=r(this,wh))==null||t.abort(),v(this,wh,null)}attach(t){r(this,Bs).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,Lt).isDeletedAnnotationElement(e)&&r(this,Lt).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,Bs).delete(t.id),(e=r(this,uf))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,wm)&&t.annotationElementId&&r(this,Lt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,Lt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,r(this,_m)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,Lt).addDeletedAnnotationElement(t.annotationElementId),me.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,Lt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),r(this,Lt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,Pl)&&(t._focusEventsAllowed=!1,v(this,Pl,setTimeout(()=>{v(this,Pl,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,Lt)._signal}),e.focus())},0))),t._structTreeParentId=(n=r(this,uf))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return r(this,Lt).getId()}combinedSignal(t){return r(this,Lt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,li,QT))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,Lt).updateToolbar(t),r(this,Lt).updateMode(t);const{offsetX:n,offsetY:i}=A(this,li,ZT).call(this),s=this.getNextId(),o=A(this,li,JT).call(this,{parent:this,id:s,x:n,y:i,uiManager:r(this,Lt),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=r(Nr,Sh).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,Lt)))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),s=A(this,li,JT).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:r(this,Lt),isCentered:e,...n});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(A(this,li,ZT).call(this),!0)}setSelected(t){r(this,Lt).setSelected(t)}toggleSelected(t){r(this,Lt).toggleSelected(t)}unselect(t){r(this,Lt).unselect(t)}pointerup(t){const{isMac:e}=Ui.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,Eh)){if(v(this,Eh,!1),!r(this,Am)){v(this,Am,!0);return}if(r(this,Lt).getMode()===Ut.STAMP){r(this,Lt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(r(this,Lt).getMode()===Ut.HIGHLIGHT&&this.enableTextSelection(),r(this,Eh)){v(this,Eh,!1);return}const{isMac:e}=Ui.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;v(this,Eh,!0);const n=r(this,Lt).getActive();v(this,Am,!n||n.isEmpty())}findNewParent(t,e,n){const i=r(this,Lt).findParent(e,n);return i===null||i===this?!1:(i.changeParent(t),!0)}destroy(){var t,e;((t=r(this,Lt).getActive())==null?void 0:t.parent)===this&&(r(this,Lt).commitOrRemove(),r(this,Lt).setActiveEditor(null)),r(this,Pl)&&(clearTimeout(r(this,Pl)),v(this,Pl,null));for(const n of r(this,Bs).values())(e=r(this,uf))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,r(this,Bs).clear(),r(this,Lt).removeLayer(this)}render({viewport:t}){this.viewport=t,gf(this.div,t);for(const e of r(this,Lt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,Lt).commitOrRemove(),A(this,li,Kw).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,gf(this.div,{rotation:n}),e!==n)for(const i of r(this,Bs).values())i.rotate(n);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,Lt).viewParameters.realScale}};uf=new WeakMap,Am=new WeakMap,oo=new WeakMap,wh=new WeakMap,Pl=new WeakMap,Bs=new WeakMap,Eh=new WeakMap,_m=new WeakMap,wm=new WeakMap,Ti=new WeakMap,Rl=new WeakMap,Lt=new WeakMap,Sh=new WeakMap,li=new WeakSet,E2=function(t){r(this,Lt).unselectAll();const{target:e}=t;if(e===r(this,Ti).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,Ti).div.contains(e)){const{isMac:n}=Ui.platform;if(t.button!==0||t.ctrlKey&&n)return;r(this,Lt).showAllEditors("highlight",!0,!0),r(this,Ti).div.classList.add("free"),this.toggleDrawing(),rE.startHighlighting(this,r(this,Lt).direction==="ltr",{target:r(this,Ti).div,x:t.x,y:t.y}),r(this,Ti).div.addEventListener("pointerup",()=>{r(this,Ti).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,Lt)._signal}),t.preventDefault()}},QT=function(){return r(Nr,Sh).get(r(this,Lt).getMode())},JT=function(t){const e=r(this,li,QT);return e?new e.prototype.constructor(t):null},ZT=function(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),o=Math.max(0,e),l=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+i),d=(s+l)/2-t,p=(o+h)/2-e,[g,m]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:g,offsetY:m}},Kw=function(){v(this,_m,!0);for(const t of r(this,Bs).values())t.isEmpty()&&t.remove();v(this,_m,!1)},lt(Nr,"_initialized",!1),E(Nr,Sh,new Map([PT,$T,qT,rE].map(t=>[t._editorType,t])));let KT=Nr;var lo,K0,dn,Ll,Q0,ek,Af,nk,S2;const Qn=class Qn{constructor({pageIndex:t}){E(this,Af);E(this,lo,null);E(this,K0,0);E(this,dn,new Map);E(this,Ll,new Map);this.pageIndex=t}setParent(t){if(!r(this,lo)){v(this,lo,t);return}if(r(this,lo)!==t){if(r(this,dn).size>0)for(const e of r(this,dn).values())e.remove(),t.append(e);v(this,lo,t)}}static get _svgFactory(){return ee(this,"_svgFactory",new Lk)}draw(t,e,n,i=!1){const s=he(this,K0)._++,o=A(this,Af,nk).call(this,t.box);o.classList.add(...t.classNamesForDrawing);const l=Qn._svgFactory.createElement("defs");o.append(l);const h=Qn._svgFactory.createElement("path");l.append(h);const d=`path_p${this.pageIndex}_${s}`;h.setAttribute("id",d),h.setAttribute("d",t.toSVGPath()),i&&r(this,Ll).set(s,h);const p=A(this,Af,S2).call(this,l,d),g=Qn._svgFactory.createElement("use");return o.append(g),o.setAttribute("fill",e),o.setAttribute("fill-opacity",n),g.setAttribute("href",`#${d}`),r(this,dn).set(s,o),{id:s,clipPathId:`url(#${p})`}}drawOutline(t){const e=he(this,K0)._++,n=A(this,Af,nk).call(this,t.box);n.classList.add(...t.classNamesForOutlining);const i=Qn._svgFactory.createElement("defs");n.append(i);const s=Qn._svgFactory.createElement("path");i.append(s);const o=`path_p${this.pageIndex}_${e}`;s.setAttribute("id",o),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let l;if(t.mustRemoveSelfIntersections){const p=Qn._svgFactory.createElement("mask");i.append(p),l=`mask_p${this.pageIndex}_${e}`,p.setAttribute("id",l),p.setAttribute("maskUnits","objectBoundingBox");const g=Qn._svgFactory.createElement("rect");p.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const m=Qn._svgFactory.createElement("use");p.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const h=Qn._svgFactory.createElement("use");n.append(h),h.setAttribute("href",`#${o}`),l&&h.setAttribute("mask",`url(#${l})`);const d=h.cloneNode();return n.append(d),h.classList.add("mainOutline"),d.classList.add("secondaryOutline"),r(this,dn).set(e,n),e}finalizeLine(t,e){const n=r(this,Ll).get(t);r(this,Ll).delete(t),this.updateBox(t,e.box),n.setAttribute("d",e.toSVGPath())}updateLine(t,e){r(this,dn).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){r(this,Ll).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var n;A(n=Qn,Q0,ek).call(n,r(this,dn).get(t),e)}show(t,e){r(this,dn).get(t).classList.toggle("hidden",!e)}rotate(t,e){r(this,dn).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){r(this,dn).get(t).setAttribute("fill",e)}changeOpacity(t,e){r(this,dn).get(t).setAttribute("fill-opacity",e)}addClass(t,e){r(this,dn).get(t).classList.add(e)}removeClass(t,e){r(this,dn).get(t).classList.remove(e)}getSVGRoot(t){return r(this,dn).get(t)}remove(t){r(this,Ll).delete(t),r(this,lo)!==null&&(r(this,dn).get(t).remove(),r(this,dn).delete(t))}destroy(){v(this,lo,null);for(const t of r(this,dn).values())t.remove();r(this,dn).clear(),r(this,Ll).clear()}};lo=new WeakMap,K0=new WeakMap,dn=new WeakMap,Ll=new WeakMap,Q0=new WeakSet,ek=function(t,{x:e=0,y:n=0,width:i=1,height:s=1}={}){const{style:o}=t;o.top=`${100*n}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},Af=new WeakSet,nk=function(t){var n;const e=Qn._svgFactory.create(1,1,!0);return r(this,lo).append(e),e.setAttribute("aria-hidden",!0),A(n=Qn,Q0,ek).call(n,e,t),e},S2=function(t,e){const n=Qn._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=Qn._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i},E(Qn,Q0);let tk=Qn;var aG=$t.AbortException,oG=$t.AnnotationEditorLayer,lG=$t.AnnotationEditorParamsType,cG=$t.AnnotationEditorType,hG=$t.AnnotationEditorUIManager,uG=$t.AnnotationLayer,dG=$t.AnnotationMode,fG=$t.ColorPicker,pG=$t.DOMSVGFactory,gG=$t.DrawLayer,mG=$t.FeatureTest,yG=$t.GlobalWorkerOptions,vG=$t.ImageKind,bG=$t.InvalidPDFException,AG=$t.MissingPDFException,_G=$t.OPS,wG=$t.OutputScale,EG=$t.PDFDataRangeTransport,SG=$t.PDFDateString,xG=$t.PDFWorker,CG=$t.PasswordResponses,TG=$t.PermissionFlag,kG=$t.PixelsPerInch,PG=$t.RenderingCancelledException,RG=$t.TextLayer,LG=$t.UnexpectedResponseException,MG=$t.Util,IG=$t.VerbosityLevel,DG=$t.XfaLayer,FG=$t.build,OG=$t.createValidAbsoluteUrl,NG=$t.fetchData,$G=$t.getDocument,jG=$t.getFilenameFromUrl,HG=$t.getPdfFilenameFromUrl,BG=$t.getXfaPageViewport,zG=$t.isDataScheme,UG=$t.isPdfFile,GG=$t.noContextMenu,VG=$t.normalizeUnicode,WG=$t.setLayerDimensions,qG=$t.shadow,XG=$t.version;const YG=Object.freeze(Object.defineProperty({__proto__:null,AbortException:aG,AnnotationEditorLayer:oG,AnnotationEditorParamsType:lG,AnnotationEditorType:cG,AnnotationEditorUIManager:hG,AnnotationLayer:uG,AnnotationMode:dG,ColorPicker:fG,DOMSVGFactory:pG,DrawLayer:gG,FeatureTest:mG,GlobalWorkerOptions:yG,ImageKind:vG,InvalidPDFException:bG,MissingPDFException:AG,OPS:_G,OutputScale:wG,PDFDataRangeTransport:EG,PDFDateString:SG,PDFWorker:xG,PasswordResponses:CG,PermissionFlag:TG,PixelsPerInch:kG,RenderingCancelledException:PG,TextLayer:RG,UnexpectedResponseException:LG,Util:MG,VerbosityLevel:IG,XfaLayer:DG,build:FG,createValidAbsoluteUrl:OG,fetchData:NG,getDocument:$G,getFilenameFromUrl:jG,getPdfFilenameFromUrl:HG,getXfaPageViewport:BG,isDataScheme:zG,isPdfFile:UG,noContextMenu:GG,normalizeUnicode:VG,setLayerDimensions:WG,shadow:qG,version:XG},Symbol.toStringTag,{value:"Module"})),iA=kj(YG);var Ca={},k_={},GM;function Ik(){return GM||(GM=1,function(u){var t=k_.__spreadArray||function(n,i,s){if(s||arguments.length===2)for(var o=0,l=i.length,h;o<l;o++)(h||!(o in i))&&(h||(h=Array.prototype.slice.call(i,0,o)),h[o]=i[o]);return n.concat(h||Array.prototype.slice.call(i))};Object.defineProperty(u,"__esModule",{value:!0}),u.allEvents=u.changeEvents=u.otherEvents=u.transitionEvents=u.animationEvents=u.wheelEvents=u.uiEvents=u.pointerEvents=u.touchEvents=u.selectionEvents=u.dragEvents=u.mouseEvents=u.mediaEvents=u.keyboardEvents=u.imageEvents=u.formEvents=u.focusEvents=u.compositionEvents=u.clipboardEvents=void 0,u.clipboardEvents=["onCopy","onCut","onPaste"],u.compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],u.focusEvents=["onFocus","onBlur"],u.formEvents=["onInput","onInvalid","onReset","onSubmit"],u.imageEvents=["onLoad","onError"],u.keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],u.mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],u.mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],u.dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],u.selectionEvents=["onSelect"],u.touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],u.pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],u.uiEvents=["onScroll"],u.wheelEvents=["onWheel"],u.animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],u.transitionEvents=["onTransitionEnd"],u.otherEvents=["onToggle"],u.changeEvents=["onChange"],u.allEvents=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t([],u.clipboardEvents,!0),u.compositionEvents,!0),u.focusEvents,!0),u.formEvents,!0),u.imageEvents,!0),u.keyboardEvents,!0),u.mediaEvents,!0),u.mouseEvents,!0),u.dragEvents,!0),u.selectionEvents,!0),u.touchEvents,!0),u.pointerEvents,!0),u.uiEvents,!0),u.wheelEvents,!0),u.animationEvents,!0),u.transitionEvents,!0),u.changeEvents,!0),u.otherEvents,!0);function e(n,i){var s={};return u.allEvents.forEach(function(o){var l=n[o];l&&(i?s[o]=function(h){return l(h,i(o))}:s[o]=l)}),s}u.default=e}(k_)),k_}var P_={},VM;function Sm(){if(VM)return P_;VM=1,Object.defineProperty(P_,"__esModule",{value:!0});function u(t){var e=!1,n=new Promise(function(i,s){t.then(function(o){return!e&&i(o)}).catch(function(o){return!e&&s(o)})});return{promise:n,cancel:function(){e=!0}}}return P_.default=u,P_}var R_={exports:{}},WM;function xm(){if(WM)return R_.exports;WM=1;function u(e){var n,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(n=0;n<o;n++)e[n]&&(i=u(e[n]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function t(){for(var e,n,i=0,s="",o=arguments.length;i<o;i++)(e=arguments[i])&&(n=u(e))&&(s&&(s+=" "),s+=n);return s}return R_.exports=t,R_.exports.clsx=t,R_.exports}var kx,qM;function ga(){if(qM)return kx;qM=1;var u="Invariant failed";function t(e,n){if(!e)throw new Error(u)}return kx=t,kx}var Px,XM;function Dh(){if(XM)return Px;XM=1;var u=function(){};return Px=u,Px}var Rx={},YM;function KG(){if(YM)return Rx;YM=1;var u=Object.prototype.hasOwnProperty;function t(n,i,s){for(s of n.keys())if(e(s,i))return s}function e(n,i){var s,o,l;if(n===i)return!0;if(n&&i&&(s=n.constructor)===i.constructor){if(s===Date)return n.getTime()===i.getTime();if(s===RegExp)return n.toString()===i.toString();if(s===Array){if((o=n.length)===i.length)for(;o--&&e(n[o],i[o]););return o===-1}if(s===Set){if(n.size!==i.size)return!1;for(o of n)if(l=o,l&&typeof l=="object"&&(l=t(i,l),!l)||!i.has(l))return!1;return!0}if(s===Map){if(n.size!==i.size)return!1;for(o of n)if(l=o[0],l&&typeof l=="object"&&(l=t(i,l),!l)||!e(o[1],i.get(l)))return!1;return!0}if(s===ArrayBuffer)n=new Uint8Array(n),i=new Uint8Array(i);else if(s===DataView){if((o=n.byteLength)===i.byteLength)for(;o--&&n.getInt8(o)===i.getInt8(o););return o===-1}if(ArrayBuffer.isView(n)){if((o=n.byteLength)===i.byteLength)for(;o--&&n[o]===i[o];);return o===-1}if(!s||typeof n=="object"){o=0;for(s in n)if(u.call(n,s)&&++o&&!u.call(i,s)||!(s in i)||!e(n[s],i[s]))return!1;return Object.keys(i).length===o}}return n!==n&&i!==i}return Rx.dequal=e,Rx}var L_={},KM;function x2(){if(KM)return L_;KM=1,Object.defineProperty(L_,"__esModule",{value:!0});const t=(0,Rn().createContext)(null);return L_.default=t,L_}var M_={},QM;function C2(){if(QM)return M_;QM=1,Object.defineProperty(M_,"__esModule",{value:!0}),M_.default=t;const u=xr();function t({children:e,type:n}){return(0,u.jsx)("div",{className:`react-pdf__message react-pdf__message--${n}`,children:e})}return M_}var _y={},JM;function QG(){if(JM)return _y;JM=1;var u=_y.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(_y,"__esModule",{value:!0});const t=u(ga()),e="noopener noreferrer nofollow";let n=class{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(s){this.pdfDocument=s}setViewer(s){this.pdfViewer=s}setExternalLinkRel(s){this.externalLinkRel=s}setExternalLinkTarget(s){this.externalLinkTarget=s}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(s){(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=s}get rotation(){return 0}set rotation(s){}goToDestination(s){return new Promise(o=>{(0,t.default)(this.pdfDocument,"PDF document not loaded."),(0,t.default)(s,"Destination is not specified."),typeof s=="string"?this.pdfDocument.getDestination(s).then(o):Array.isArray(s)?o(s):s.then(o)}).then(o=>{(0,t.default)(Array.isArray(o),`"${o}" is not a valid destination array.`);const l=o[0];new Promise(h=>{(0,t.default)(this.pdfDocument,"PDF document not loaded."),l instanceof Object?this.pdfDocument.getPageIndex(l).then(d=>{h(d)}).catch(()=>{(0,t.default)(!1,`"${l}" is not a valid page reference.`)}):typeof l=="number"?h(l):(0,t.default)(!1,`"${l}" is not a valid destination reference.`)}).then(h=>{const d=h+1;(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),(0,t.default)(d>=1&&d<=this.pagesCount,`"${d}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:o,pageIndex:h,pageNumber:d})})})}navigateTo(s){this.goToDestination(s)}goToPage(s){const o=s-1;(0,t.default)(this.pdfViewer,"PDF viewer is not initialized."),(0,t.default)(s>=1&&s<=this.pagesCount,`"${s}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:o,pageNumber:s})}addLinkAttributes(s,o,l){s.href=o,s.rel=this.externalLinkRel||e,s.target=l?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}};return _y.default=n,_y}var I_={},ZM;function T2(){if(ZM)return I_;ZM=1,Object.defineProperty(I_,"__esModule",{value:!0});const u={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};return I_.default=u,I_}var D_={},tI;function fo(){return tI||(tI=1,function(u){var t=D_.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(u,"__esModule",{value:!0}),u.isLocalFileSystem=u.isBrowser=void 0,u.isDefined=i,u.isProvided=s,u.isString=o,u.isArrayBuffer=l,u.isBlob=h,u.isDataURI=d,u.dataURItoByteString=p,u.getDevicePixelRatio=g,u.displayCORSWarning=b,u.displayWorkerWarning=_,u.cancelRunningTask=S,u.makePageCallback=C,u.isCancelException=T,u.loadFromFile=k;const e=t(ga()),n=t(Dh());u.isBrowser=typeof window<"u",u.isLocalFileSystem=u.isBrowser&&window.location.protocol==="file:";function i(P){return typeof P<"u"}function s(P){return i(P)&&P!==null}function o(P){return typeof P=="string"}function l(P){return P instanceof ArrayBuffer}function h(P){return(0,e.default)(u.isBrowser,"isBlob can only be used in a browser environment"),P instanceof Blob}function d(P){return o(P)&&/^data:/.test(P)}function p(P){(0,e.default)(d(P),"Invalid data URI.");const[L="",I=""]=P.split(",");return L.split(";").indexOf("base64")!==-1?atob(I):unescape(I)}function g(){return u.isBrowser&&window.devicePixelRatio||1}const m="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function b(){(0,n.default)(!u.isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${m}`)}function _(){(0,n.default)(!u.isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${m}`)}function S(P){P!=null&&P.cancel&&P.cancel()}function C(P,L){return Object.defineProperty(P,"width",{get(){return this.view[2]*L},configurable:!0}),Object.defineProperty(P,"height",{get(){return this.view[3]*L},configurable:!0}),Object.defineProperty(P,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(P,"originalHeight",{get(){return this.view[3]},configurable:!0}),P}function T(P){return P.name==="RenderingCancelledException"}function k(P){return new Promise((L,I)=>{const D=new FileReader;D.onload=()=>{if(!D.result)return I(new Error("Error while reading a file."));L(D.result)},D.onerror=F=>{if(!F.target)return I(new Error("Error while reading a file."));const{error:H}=F.target;if(!H)return I(new Error("Error while reading a file."));switch(H.code){case H.NOT_FOUND_ERR:return I(new Error("Error while reading a file: File not found."));case H.SECURITY_ERR:return I(new Error("Error while reading a file: Security error."));case H.ABORT_ERR:return I(new Error("Error while reading a file: Aborted."));default:return I(new Error("Error while reading a file."))}},D.readAsArrayBuffer(P)})}}(D_)),D_}var F_={},eI;function Cm(){if(eI)return F_;eI=1,Object.defineProperty(F_,"__esModule",{value:!0}),F_.default=e;const u=Rn();function t(n,i){switch(i.type){case"RESOLVE":return{value:i.value,error:void 0};case"REJECT":return{value:!1,error:i.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function e(){return(0,u.useReducer)(t,{value:void 0,error:void 0})}return F_}var nI;function JG(){if(nI)return Ca;nI=1;var u=Ca.__createBinding||(Object.create?function(j,Q,V,tt){tt===void 0&&(tt=V);var Z=Object.getOwnPropertyDescriptor(Q,V);(!Z||("get"in Z?!Q.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return Q[V]}}),Object.defineProperty(j,tt,Z)}:function(j,Q,V,tt){tt===void 0&&(tt=V),j[tt]=Q[V]}),t=Ca.__setModuleDefault||(Object.create?function(j,Q){Object.defineProperty(j,"default",{enumerable:!0,value:Q})}:function(j,Q){j.default=Q}),e=Ca.__importStar||function(j){if(j&&j.__esModule)return j;var Q={};if(j!=null)for(var V in j)V!=="default"&&Object.prototype.hasOwnProperty.call(j,V)&&u(Q,j,V);return t(Q,j),Q},n=Ca.__awaiter||function(j,Q,V,tt){function Z(et){return et instanceof V?et:new V(function(ht){ht(et)})}return new(V||(V=Promise))(function(et,ht){function J(U){try{q(tt.next(U))}catch(N){ht(N)}}function G(U){try{q(tt.throw(U))}catch(N){ht(N)}}function q(U){U.done?et(U.value):Z(U.value).then(J,G)}q((tt=tt.apply(j,Q||[])).next())})},i=Ca.__rest||function(j,Q){var V={};for(var tt in j)Object.prototype.hasOwnProperty.call(j,tt)&&Q.indexOf(tt)<0&&(V[tt]=j[tt]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Z=0,tt=Object.getOwnPropertySymbols(j);Z<tt.length;Z++)Q.indexOf(tt[Z])<0&&Object.prototype.propertyIsEnumerable.call(j,tt[Z])&&(V[tt[Z]]=j[tt[Z]]);return V},s=Ca.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(Ca,"__esModule",{value:!0});const o=xr(),l=Rn(),h=s(Ik()),d=s(Sm()),p=s(xm()),g=s(ga()),m=s(Dh()),b=KG(),_=e(iA),S=s(x2()),C=s(C2()),T=s(QG()),k=s(T2()),P=fo(),L=s(Cm()),{PDFDataRangeTransport:I}=_,D=(j,Q)=>{switch(Q){case k.default.NEED_PASSWORD:{const V=prompt("Enter the password to open this PDF file.");j(V);break}case k.default.INCORRECT_PASSWORD:{const V=prompt("Invalid password. Please try again.");j(V);break}}};function F(j){return typeof j=="object"&&j!==null&&("data"in j||"range"in j||"url"in j)}const H=(0,l.forwardRef)(function(Q,V){var{children:tt,className:Z,error:et="Failed to load PDF file.",externalLinkRel:ht,externalLinkTarget:J,file:G,inputRef:q,imageResourcesPath:U,loading:N="Loading PDF…",noData:M="No PDF file specified.",onItemClick:B,onLoadError:Y,onLoadProgress:it,onLoadSuccess:dt,onPassword:at=D,onSourceError:nt,onSourceSuccess:vt,options:ut,renderMode:xt,rotate:Qt}=Q,Se=i(Q,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[Ie,xe]=(0,L.default)(),{value:on,error:ci}=Ie,[hi,Cr]=(0,L.default)(),{value:ln,error:Ys}=hi,Li=(0,l.useRef)(new T.default),ps=(0,l.useRef)([]),ma=(0,l.useRef)(void 0),Tr=(0,l.useRef)(void 0);G&&G!==ma.current&&F(G)&&((0,m.default)(!(0,b.dequal)(G,ma.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),ma.current=G),ut&&ut!==Tr.current&&((0,m.default)(!(0,b.dequal)(ut,Tr.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Tr.current=ut);const po=(0,l.useRef)({scrollPageIntoView:Je=>{const{dest:Xn,pageNumber:Mi,pageIndex:Ln=Mi-1}=Je;if(B){B({dest:Xn,pageIndex:Ln,pageNumber:Mi});return}const ms=ps.current[Ln];if(ms){ms.scrollIntoView();return}(0,m.default)(!1,`An internal link leading to page ${Mi} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});(0,l.useImperativeHandle)(V,()=>({linkService:Li,pages:ps,viewer:po}),[]);function go(){vt&&vt()}function Ul(){ci&&((0,m.default)(!1,ci.toString()),nt&&nt(ci))}function Gl(){xe({type:"RESET"})}(0,l.useEffect)(Gl,[G,xe]);const kr=(0,l.useCallback)(()=>n(this,void 0,void 0,function*(){if(!G)return null;if(typeof G=="string")return(0,P.isDataURI)(G)?{data:(0,P.dataURItoByteString)(G)}:((0,P.displayCORSWarning)(),{url:G});if(G instanceof I)return{range:G};if((0,P.isArrayBuffer)(G))return{data:G};if(P.isBrowser&&(0,P.isBlob)(G))return{data:yield(0,P.loadFromFile)(G)};if((0,g.default)(typeof G=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),(0,g.default)(F(G),"Invalid parameter object: need either .data, .range or .url"),"url"in G&&typeof G.url=="string"){if((0,P.isDataURI)(G.url)){const{url:Je}=G,Xn=i(G,["url"]),Mi=(0,P.dataURItoByteString)(Je);return Object.assign({data:Mi},Xn)}(0,P.displayCORSWarning)()}return G}),[G]);(0,l.useEffect)(()=>{const Je=(0,d.default)(kr());return Je.promise.then(Xn=>{xe({type:"RESOLVE",value:Xn})}).catch(Xn=>{xe({type:"REJECT",error:Xn})}),()=>{(0,P.cancelRunningTask)(Je)}},[kr,xe]),(0,l.useEffect)(()=>{if(!(typeof on>"u")){if(on===!1){Ul();return}go()}},[on]);function ye(){ln&&(dt&&dt(ln),ps.current=new Array(ln.numPages),Li.current.setDocument(ln))}function Pr(){Ys&&((0,m.default)(!1,Ys.toString()),Y&&Y(Ys))}(0,l.useEffect)(function(){Cr({type:"RESET"})},[Cr,on]),(0,l.useEffect)(function(){if(!on)return;const Xn=ut?Object.assign(Object.assign({},on),ut):on,Mi=_.getDocument(Xn);it&&(Mi.onProgress=it),at&&(Mi.onPassword=at);const Ln=Mi,ms=Ln.promise.then(Wl=>{Cr({type:"RESOLVE",value:Wl})}).catch(Wl=>{Ln.destroyed||Cr({type:"REJECT",error:Wl})});return()=>{ms.finally(()=>Ln.destroy())}},[ut,Cr,on]),(0,l.useEffect)(()=>{if(!(typeof ln>"u")){if(ln===!1){Pr();return}ye()}},[ln]),(0,l.useEffect)(function(){Li.current.setViewer(po.current),Li.current.setExternalLinkRel(ht),Li.current.setExternalLinkTarget(J)},[ht,J]);const Vl=(0,l.useCallback)((Je,Xn)=>{ps.current[Je]=Xn},[]),ui=(0,l.useCallback)(Je=>{delete ps.current[Je]},[]),gs=(0,l.useMemo)(()=>({imageResourcesPath:U,linkService:Li.current,onItemClick:B,pdf:ln,registerPage:Vl,renderMode:xt,rotate:Qt,unregisterPage:ui}),[U,B,ln,Vl,xt,Qt,ui]),ya=(0,l.useMemo)(()=>(0,h.default)(Se,()=>ln),[Se,ln]);function qn(){return(0,o.jsx)(S.default.Provider,{value:gs,children:tt})}function Fh(){return G?ln==null?(0,o.jsx)(C.default,{type:"loading",children:typeof N=="function"?N():N}):ln===!1?(0,o.jsx)(C.default,{type:"error",children:typeof et=="function"?et():et}):qn():(0,o.jsx)(C.default,{type:"no-data",children:typeof M=="function"?M():M})}return(0,o.jsx)("div",Object.assign({className:(0,p.default)("react-pdf__Document",Z),ref:q,style:{"--scale-factor":"1"}},ya,{children:Fh()}))});return Ca.default=H,Ca}var Kf={},O_={},iI;function k2(){if(iI)return O_;iI=1,Object.defineProperty(O_,"__esModule",{value:!0});const t=(0,Rn().createContext)(null);return O_.default=t,O_}var Kh={},N_={},sI;function ZG(){if(sI)return N_;sI=1,Object.defineProperty(N_,"__esModule",{value:!0});let u=class{constructor({num:e,gen:n}){this.num=e,this.gen=n}toString(){let e=`${this.num}R`;return this.gen!==0&&(e+=this.gen),e}};return N_.default=u,N_}var $_={},rI;function tV(){if(rI)return $_;rI=1,Object.defineProperty($_,"__esModule",{value:!0}),$_.default=e;const u=Rn(),t=fo();function e(n){const i=(0,u.useRef)(void 0),s=i.current;return(0,t.isDefined)(s)?()=>s:()=>{const o=n();return i.current=o,o}}return $_}var wy={},aI;function Tm(){if(aI)return wy;aI=1;var u=wy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(wy,"__esModule",{value:!0}),wy.default=n;const t=Rn(),e=u(x2());function n(){return(0,t.useContext)(e.default)}return wy}var Ey={},oI;function P2(){if(oI)return Ey;oI=1;var u=Ey.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.default=n;const t=Rn(),e=u(k2());function n(){return(0,t.useContext)(e.default)}return Ey}var lI;function eV(){if(lI)return Kh;lI=1;var u=Kh.__awaiter||function(p,g,m,b){function _(S){return S instanceof m?S:new m(function(C){C(S)})}return new(m||(m=Promise))(function(S,C){function T(L){try{P(b.next(L))}catch(I){C(I)}}function k(L){try{P(b.throw(L))}catch(I){C(I)}}function P(L){L.done?S(L.value):_(L.value).then(T,k)}P((b=b.apply(p,g||[])).next())})},t=Kh.__rest||function(p,g){var m={};for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&g.indexOf(b)<0&&(m[b]=p[b]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,b=Object.getOwnPropertySymbols(p);_<b.length;_++)g.indexOf(b[_])<0&&Object.prototype.propertyIsEnumerable.call(p,b[_])&&(m[b[_]]=p[b[_]]);return m},e=Kh.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(Kh,"__esModule",{value:!0}),Kh.default=d;const n=xr(),i=e(ga()),s=e(ZG()),o=e(tV()),l=e(Tm()),h=e(P2());function d(p){const g=(0,l.default)(),m=(0,h.default)();(0,i.default)(m,"Unable to find Outline context.");const b=Object.assign(Object.assign(Object.assign({},g),m),p),{item:_,linkService:S,onItemClick:C,pdf:T}=b,k=t(b,["item","linkService","onItemClick","pdf"]);(0,i.default)(T,"Attempted to load an outline, but no document was specified. Wrap <Outline /> in a <Document /> or pass explicit `pdf` prop.");const P=(0,o.default)(()=>typeof _.dest=="string"?T.getDestination(_.dest):_.dest),L=(0,o.default)(()=>u(this,void 0,void 0,function*(){const H=yield P();if(!H)throw new Error("Destination not found.");const[j]=H;return T.getPageIndex(new s.default(j))})),I=(0,o.default)(()=>u(this,void 0,void 0,function*(){return(yield L())+1}));function D(H){H.preventDefault(),(0,i.default)(C||S,"Either onItemClick callback or linkService must be defined in order to navigate to an outline item."),C?Promise.all([P(),L(),I()]).then(([j,Q,V])=>{C({dest:j,pageIndex:Q,pageNumber:V})}):S&&S.goToDestination(_.dest)}function F(){if(!_.items||!_.items.length)return null;const{items:H}=_;return(0,n.jsx)("ul",{children:H.map((j,Q)=>(0,n.jsx)(d,Object.assign({item:j,pdf:T},k),typeof j.dest=="string"?j.dest:Q))})}return(0,n.jsxs)("li",{children:[(0,n.jsx)("a",{href:"#",onClick:D,children:_.title}),F()]})}return Kh}var cI;function nV(){if(cI)return Kf;cI=1;var u=Kf.__rest||function(S,C){var T={};for(var k in S)Object.prototype.hasOwnProperty.call(S,k)&&C.indexOf(k)<0&&(T[k]=S[k]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,k=Object.getOwnPropertySymbols(S);P<k.length;P++)C.indexOf(k[P])<0&&Object.prototype.propertyIsEnumerable.call(S,k[P])&&(T[k[P]]=S[k[P]]);return T},t=Kf.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.default=_;const e=xr(),n=Rn(),i=t(Sm()),s=t(Ik()),o=t(xm()),l=t(ga()),h=t(Dh()),d=t(k2()),p=t(eV()),g=fo(),m=t(Tm()),b=t(Cm());function _(S){const C=(0,m.default)(),T=Object.assign(Object.assign({},C),S),{className:k,inputRef:P,onItemClick:L,onLoadError:I,onLoadSuccess:D,pdf:F}=T,H=u(T,["className","inputRef","onItemClick","onLoadError","onLoadSuccess","pdf"]);(0,l.default)(F,"Attempted to load an outline, but no document was specified. Wrap <Outline /> in a <Document /> or pass explicit `pdf` prop.");const[j,Q]=(0,b.default)(),{value:V,error:tt}=j;function Z(){typeof V>"u"||V===!1||D&&D(V)}function et(){tt&&((0,h.default)(!1,tt.toString()),I&&I(tt))}(0,n.useEffect)(function(){Q({type:"RESET"})},[Q,F]),(0,n.useEffect)(function(){if(!F)return;const U=(0,i.default)(F.getOutline()),N=U;return U.promise.then(M=>{Q({type:"RESOLVE",value:M})}).catch(M=>{Q({type:"REJECT",error:M})}),()=>(0,g.cancelRunningTask)(N)},[Q,F]),(0,n.useEffect)(()=>{if(V!==void 0){if(V===!1){et();return}Z()}},[V]);const ht=(0,n.useMemo)(()=>({onItemClick:L}),[L]),J=(0,n.useMemo)(()=>(0,s.default)(H,()=>V),[H,V]);if(!V)return null;function G(){return V?(0,e.jsx)("ul",{children:V.map((q,U)=>(0,e.jsx)(p.default,{item:q,pdf:F},typeof q.dest=="string"?q.dest:U))}):null}return(0,e.jsx)("div",Object.assign({className:(0,o.default)("react-pdf__Outline",k),ref:P},J,{children:(0,e.jsx)(d.default.Provider,{value:ht,children:G()})}))}return Kf}var Qf={},j_={},hI;function R2(){if(hI)return j_;hI=1,Object.defineProperty(j_,"__esModule",{value:!0});function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter(Boolean);if(n.length<=1){var i=n[0];return i||null}return function(o){n.forEach(function(l){typeof l=="function"?l(o):l&&(l.current=o)})}}return j_.default=u,j_}var H_={},uI;function L2(){if(uI)return H_;uI=1,Object.defineProperty(H_,"__esModule",{value:!0});const t=(0,Rn().createContext)(null);return H_.default=t,H_}var fc={},Sy={},B_={},ko={},Qh={},dI;function iV(){return dI||(dI=1,Object.defineProperty(Qh,"__esModule",{value:!0}),Qh.HEADING_PATTERN=Qh.PDF_ROLE_TO_HTML_ROLE=void 0,Qh.PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Qh.HEADING_PATTERN=/^H(\d+)$/),Qh}var fI;function sV(){if(fI)return ko;fI=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.isPdfRole=t,ko.isStructTreeNode=e,ko.isStructTreeNodeWithOnlyContentChild=n,ko.getRoleAttributes=i,ko.getBaseAttributes=s,ko.getAttributes=o;const u=iV();function t(l){return l in u.PDF_ROLE_TO_HTML_ROLE}function e(l){return"children"in l}function n(l){return e(l)?l.children.length===1&&0 in l.children&&"id"in l.children[0]:!1}function i(l){const h={};if(e(l)){const{role:d}=l,p=d.match(u.HEADING_PATTERN);if(p)h.role="heading",h["aria-level"]=Number(p[1]);else if(t(d)){const g=u.PDF_ROLE_TO_HTML_ROLE[d];g&&(h.role=g)}}return h}function s(l){const h={};if(e(l)){if(l.alt!==void 0&&(h["aria-label"]=l.alt),l.lang!==void 0&&(h.lang=l.lang),n(l)){const[d]=l.children;if(d){const p=s(d);return Object.assign(Object.assign({},h),p)}}}else"id"in l&&(h["aria-owns"]=l.id);return h}function o(l){return l?Object.assign(Object.assign({},i(l)),s(l)):null}return ko}var pI;function rV(){if(pI)return B_;pI=1,Object.defineProperty(B_,"__esModule",{value:!0}),B_.default=n;const u=xr(),t=Rn(),e=sV();function n({className:i,node:s}){const o=(0,t.useMemo)(()=>(0,e.getAttributes)(s),[s]),l=(0,t.useMemo)(()=>!(0,e.isStructTreeNode)(s)||(0,e.isStructTreeNodeWithOnlyContentChild)(s)?null:s.children.map((h,d)=>(0,u.jsx)(n,{node:h},d)),[s]);return(0,u.jsx)("span",Object.assign({className:i},o,{children:l}))}return B_}var xy={},gI;function sA(){if(gI)return xy;gI=1;var u=xy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xy,"__esModule",{value:!0}),xy.default=n;const t=Rn(),e=u(L2());function n(){return(0,t.useContext)(e.default)}return xy}var mI;function aV(){if(mI)return Sy;mI=1;var u=Sy.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.default=p;const t=xr(),e=Rn(),n=u(Sm()),i=u(ga()),s=u(Dh()),o=u(rV()),l=u(sA()),h=u(Cm()),d=fo();function p(){const g=(0,l.default)();(0,i.default)(g,"Unable to find Page context.");const{onGetStructTreeError:m,onGetStructTreeSuccess:b}=g,[_,S]=(0,h.default)(),{value:C,error:T}=_,{customTextRenderer:k,page:P}=g;function L(){C&&b&&b(C)}function I(){T&&((0,s.default)(!1,T.toString()),m&&m(T))}return(0,e.useEffect)(function(){S({type:"RESET"})},[S,P]),(0,e.useEffect)(function(){if(k||!P)return;const F=(0,n.default)(P.getStructTree()),H=F;return F.promise.then(j=>{S({type:"RESOLVE",value:j})}).catch(j=>{S({type:"REJECT",error:j})}),()=>(0,d.cancelRunningTask)(H)},[k,P,S]),(0,e.useEffect)(()=>{if(C!==void 0){if(C===!1){I();return}L()}},[C]),C?(0,t.jsx)(o.default,{className:"react-pdf__Page__structTree structTree",node:C}):null}return Sy}var yI;function oV(){if(yI)return fc;yI=1;var u=fc.__createBinding||(Object.create?function(S,C,T,k){k===void 0&&(k=T);var P=Object.getOwnPropertyDescriptor(C,T);(!P||("get"in P?!C.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return C[T]}}),Object.defineProperty(S,k,P)}:function(S,C,T,k){k===void 0&&(k=T),S[k]=C[T]}),t=fc.__setModuleDefault||(Object.create?function(S,C){Object.defineProperty(S,"default",{enumerable:!0,value:C})}:function(S,C){S.default=C}),e=fc.__importStar||function(S){if(S&&S.__esModule)return S;var C={};if(S!=null)for(var T in S)T!=="default"&&Object.prototype.hasOwnProperty.call(S,T)&&u(C,S,T);return t(C,S),C},n=fc.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(fc,"__esModule",{value:!0}),fc.default=_;const i=xr(),s=Rn(),o=n(R2()),l=n(ga()),h=n(Dh()),d=e(iA),p=n(aV()),g=n(sA()),m=fo(),b=d.AnnotationMode;function _(S){const C=(0,g.default)();(0,l.default)(C,"Unable to find Page context.");const T=Object.assign(Object.assign({},C),S),{_className:k,canvasBackground:P,devicePixelRatio:L=(0,m.getDevicePixelRatio)(),onRenderError:I,onRenderSuccess:D,page:F,renderForms:H,renderTextLayer:j,rotate:Q,scale:V}=T,{canvasRef:tt}=S;(0,l.default)(F,"Attempted to render page canvas, but no page was specified.");const Z=(0,s.useRef)(null);function et(){F&&D&&D((0,m.makePageCallback)(F,V))}function ht(U){(0,m.isCancelException)(U)||((0,h.default)(!1,U.toString()),I&&I(U))}const J=(0,s.useMemo)(()=>F.getViewport({scale:V*L,rotation:Q}),[L,F,Q,V]),G=(0,s.useMemo)(()=>F.getViewport({scale:V,rotation:Q}),[F,Q,V]);(0,s.useEffect)(function(){if(!F)return;F.cleanup();const{current:N}=Z;if(!N)return;N.width=J.width,N.height=J.height,N.style.width=`${Math.floor(G.width)}px`,N.style.height=`${Math.floor(G.height)}px`,N.style.visibility="hidden";const M={annotationMode:H?b.ENABLE_FORMS:b.ENABLE,canvasContext:N.getContext("2d",{alpha:!1}),viewport:J};P&&(M.background=P);const B=F.render(M),Y=B;return B.promise.then(()=>{N.style.visibility="",et()}).catch(ht),()=>(0,m.cancelRunningTask)(Y)},[P,F,H,J,G]);const q=(0,s.useCallback)(()=>{const{current:U}=Z;U&&(U.width=0,U.height=0)},[]);return(0,s.useEffect)(()=>q,[q]),(0,i.jsx)("canvas",{className:`${k}__canvas`,dir:"ltr",ref:(0,o.default)(tt,Z),style:{display:"block",userSelect:"none"},children:j?(0,i.jsx)(p.default,{}):null})}return fc}var pc={},vI;function lV(){if(vI)return pc;vI=1;var u=pc.__createBinding||(Object.create?function(C,T,k,P){P===void 0&&(P=k);var L=Object.getOwnPropertyDescriptor(T,k);(!L||("get"in L?!T.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return T[k]}}),Object.defineProperty(C,P,L)}:function(C,T,k,P){P===void 0&&(P=k),C[P]=T[k]}),t=pc.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),e=pc.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var k in C)k!=="default"&&Object.prototype.hasOwnProperty.call(C,k)&&u(T,C,k);return t(T,C),T},n=pc.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(pc,"__esModule",{value:!0}),pc.default=S;const i=xr(),s=Rn(),o=n(Sm()),l=n(xm()),h=n(ga()),d=n(Dh()),p=e(iA),g=n(sA()),m=n(Cm()),b=fo();function _(C){return"str"in C}function S(){const C=(0,g.default)();(0,h.default)(C,"Unable to find Page context.");const{customTextRenderer:T,onGetTextError:k,onGetTextSuccess:P,onRenderTextLayerError:L,onRenderTextLayerSuccess:I,page:D,pageIndex:F,pageNumber:H,rotate:j,scale:Q}=C;(0,h.default)(D,"Attempted to load page text content, but no page was specified.");const[V,tt]=(0,m.default)(),{value:Z,error:et}=V,ht=(0,s.useRef)(null);(0,d.default)(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function J(){Z&&P&&P(Z)}function G(){et&&((0,d.default)(!1,et.toString()),k&&k(et))}(0,s.useEffect)(function(){tt({type:"RESET"})},[D,tt]),(0,s.useEffect)(function(){if(!D)return;const it=(0,o.default)(D.getTextContent()),dt=it;return it.promise.then(at=>{tt({type:"RESOLVE",value:at})}).catch(at=>{tt({type:"REJECT",error:at})}),()=>(0,b.cancelRunningTask)(dt)},[D,tt]),(0,s.useEffect)(()=>{if(Z!==void 0){if(Z===!1){G();return}J()}},[Z]);const q=(0,s.useCallback)(()=>{I&&I()},[I]),U=(0,s.useCallback)(Y=>{(0,d.default)(!1,Y.toString()),L&&L(Y)},[L]);function N(){const Y=ht.current;Y&&Y.classList.add("selecting")}function M(){const Y=ht.current;Y&&Y.classList.remove("selecting")}const B=(0,s.useMemo)(()=>D.getViewport({scale:Q,rotation:j}),[D,j,Q]);return(0,s.useLayoutEffect)(function(){if(!D||!Z)return;const{current:it}=ht;if(!it)return;it.innerHTML="";const dt=D.streamTextContent({includeMarkedContent:!0}),at={container:it,textContentSource:dt,viewport:B},nt=new p.TextLayer(at),vt=nt;return nt.render().then(()=>{const ut=document.createElement("div");ut.className="endOfContent",it.append(ut);const xt=it.querySelectorAll('[role="presentation"]');if(T){let Qt=0;Z.items.forEach((Se,Ie)=>{if(!_(Se))return;const xe=xt[Qt];if(!xe)return;const on=T(Object.assign({pageIndex:F,pageNumber:H,itemIndex:Ie},Se));xe.innerHTML=on,Qt+=Se.str&&Se.hasEOL?2:1})}q()}).catch(U),()=>(0,b.cancelRunningTask)(vt)},[T,U,q,D,F,H,Z,B]),(0,i.jsx)("div",{className:(0,l.default)("react-pdf__Page__textContent","textLayer"),onMouseUp:M,onMouseDown:N,ref:ht})}return pc}var gc={},bI;function cV(){if(bI)return gc;bI=1;var u=gc.__createBinding||(Object.create?function(C,T,k,P){P===void 0&&(P=k);var L=Object.getOwnPropertyDescriptor(T,k);(!L||("get"in L?!T.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return T[k]}}),Object.defineProperty(C,P,L)}:function(C,T,k,P){P===void 0&&(P=k),C[P]=T[k]}),t=gc.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),e=gc.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var k in C)k!=="default"&&Object.prototype.hasOwnProperty.call(C,k)&&u(T,C,k);return t(T,C),T},n=gc.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(gc,"__esModule",{value:!0}),gc.default=S;const i=xr(),s=Rn(),o=n(Sm()),l=n(xm()),h=n(ga()),d=n(Dh()),p=e(iA),g=n(Tm()),m=n(sA()),b=n(Cm()),_=fo();function S(){const C=(0,g.default)(),T=(0,m.default)();(0,h.default)(T,"Unable to find Page context.");const k=Object.assign(Object.assign({},C),T),{imageResourcesPath:P,linkService:L,onGetAnnotationsError:I,onGetAnnotationsSuccess:D,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:H,page:j,pdf:Q,renderForms:V,rotate:tt,scale:Z=1}=k;(0,h.default)(Q,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),(0,h.default)(j,"Attempted to load page annotations, but no page was specified."),(0,h.default)(L,"Attempted to load page annotations, but no linkService was specified.");const[et,ht]=(0,b.default)(),{value:J,error:G}=et,q=(0,s.useRef)(null);(0,d.default)(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function U(){J&&D&&D(J)}function N(){G&&((0,d.default)(!1,G.toString()),I&&I(G))}(0,s.useEffect)(function(){ht({type:"RESET"})},[ht,j]),(0,s.useEffect)(function(){if(!j)return;const dt=(0,o.default)(j.getAnnotations()),at=dt;return dt.promise.then(nt=>{ht({type:"RESOLVE",value:nt})}).catch(nt=>{ht({type:"REJECT",error:nt})}),()=>{(0,_.cancelRunningTask)(at)}},[ht,j]),(0,s.useEffect)(()=>{if(J!==void 0){if(J===!1){N();return}U()}},[J]);function M(){H&&H()}function B(it){(0,d.default)(!1,`${it}`),F&&F(it)}const Y=(0,s.useMemo)(()=>j.getViewport({scale:Z,rotation:tt}),[j,tt,Z]);return(0,s.useEffect)(function(){if(!Q||!j||!L||!J)return;const{current:dt}=q;if(!dt)return;const at=Y.clone({dontFlip:!0}),nt={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:dt,l10n:null,page:j,structTreeLayer:null,viewport:at},vt={annotations:J,annotationStorage:Q.annotationStorage,div:dt,imageResourcesPath:P,linkService:L,page:j,renderForms:V,viewport:at};dt.innerHTML="";try{new p.AnnotationLayer(nt).render(vt),M()}catch(ut){B(ut)}return()=>{}},[J,P,L,j,Q,V,Y]),(0,i.jsx)("div",{className:(0,l.default)("react-pdf__Page__annotations","annotationLayer"),ref:q})}return gc}var AI;function M2(){if(AI)return Qf;AI=1;var u=Qf.__rest||function(L,I){var D={};for(var F in L)Object.prototype.hasOwnProperty.call(L,F)&&I.indexOf(F)<0&&(D[F]=L[F]);if(L!=null&&typeof Object.getOwnPropertySymbols=="function")for(var H=0,F=Object.getOwnPropertySymbols(L);H<F.length;H++)I.indexOf(F[H])<0&&Object.prototype.propertyIsEnumerable.call(L,F[H])&&(D[F[H]]=L[F[H]]);return D},t=Qf.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.default=P;const e=xr(),n=Rn(),i=t(Sm()),s=t(Ik()),o=t(xm()),l=t(R2()),h=t(ga()),d=t(Dh()),p=t(L2()),g=t(C2()),m=t(oV()),b=t(lV()),_=t(cV()),S=fo(),C=t(Tm()),T=t(Cm()),k=1;function P(L){const I=(0,C.default)(),D=Object.assign(Object.assign({},I),L),{_className:F="react-pdf__Page",_enableRegisterUnregisterPage:H=!0,canvasBackground:j,canvasRef:Q,children:V,className:tt,customRenderer:Z,customTextRenderer:et,devicePixelRatio:ht,error:J="Failed to load the page.",height:G,inputRef:q,loading:U="Loading page…",noData:N="No page specified.",onGetAnnotationsError:M,onGetAnnotationsSuccess:B,onGetStructTreeError:Y,onGetStructTreeSuccess:it,onGetTextError:dt,onGetTextSuccess:at,onLoadError:nt,onLoadSuccess:vt,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:xt,onRenderError:Qt,onRenderSuccess:Se,onRenderTextLayerError:Ie,onRenderTextLayerSuccess:xe,pageIndex:on,pageNumber:ci,pdf:hi,registerPage:Cr,renderAnnotationLayer:ln=!0,renderForms:Ys=!1,renderMode:Li="canvas",renderTextLayer:ps=!0,rotate:ma,scale:Tr=k,unregisterPage:po,width:go}=D,Ul=u(D,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Gl,kr]=(0,T.default)(),{value:ye,error:Pr}=Gl,Vl=(0,n.useRef)(null);(0,h.default)(hi,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const ui=(0,S.isProvided)(ci)?ci-1:on??null,gs=ci??((0,S.isProvided)(on)?on+1:null),ya=ma??(ye?ye.rotate:null),qn=(0,n.useMemo)(()=>{if(!ye)return null;let mo=1;const ql=Tr??k;if(go||G){const Oh=ye.getViewport({scale:1,rotation:ya});go?mo=go/Oh.width:G&&(mo=G/Oh.height)}return ql*mo},[G,ye,ya,Tr,go]);(0,n.useEffect)(function(){return()=>{(0,S.isProvided)(ui)&&H&&po&&po(ui)}},[H,hi,ui,po]);function Fh(){if(vt){if(!ye||!qn)return;vt((0,S.makePageCallback)(ye,qn))}if(H&&Cr){if(!(0,S.isProvided)(ui)||!Vl.current)return;Cr(ui,Vl.current)}}function Je(){Pr&&((0,d.default)(!1,Pr.toString()),nt&&nt(Pr))}(0,n.useEffect)(function(){kr({type:"RESET"})},[kr,hi,ui]),(0,n.useEffect)(function(){if(!hi||!gs)return;const ql=(0,i.default)(hi.getPage(gs)),Oh=ql;return ql.promise.then(yo=>{kr({type:"RESOLVE",value:yo})}).catch(yo=>{kr({type:"REJECT",error:yo})}),()=>(0,S.cancelRunningTask)(Oh)},[kr,hi,gs]),(0,n.useEffect)(()=>{if(ye!==void 0){if(ye===!1){Je();return}Fh()}},[ye,qn]);const Xn=(0,n.useMemo)(()=>ye&&(0,S.isProvided)(ui)&&gs&&(0,S.isProvided)(ya)&&(0,S.isProvided)(qn)?{_className:F,canvasBackground:j,customTextRenderer:et,devicePixelRatio:ht,onGetAnnotationsError:M,onGetAnnotationsSuccess:B,onGetStructTreeError:Y,onGetStructTreeSuccess:it,onGetTextError:dt,onGetTextSuccess:at,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:xt,onRenderError:Qt,onRenderSuccess:Se,onRenderTextLayerError:Ie,onRenderTextLayerSuccess:xe,page:ye,pageIndex:ui,pageNumber:gs,renderForms:Ys,renderTextLayer:ps,rotate:ya,scale:qn}:null,[F,j,et,ht,M,B,Y,it,dt,at,ut,xt,Qt,Se,Ie,xe,ye,ui,gs,Ys,ps,ya,qn]),Mi=(0,n.useMemo)(()=>(0,s.default)(Ul,()=>ye&&(qn?(0,S.makePageCallback)(ye,qn):void 0)),[Ul,ye,qn]),Ln=`${ui}@${qn}/${ya}`;function ms(){switch(Li){case"custom":return(0,h.default)(Z,'renderMode was set to "custom", but no customRenderer was passed.'),(0,e.jsx)(Z,{},`${Ln}_custom`);case"none":return null;case"canvas":default:return(0,e.jsx)(m.default,{canvasRef:Q},`${Ln}_canvas`)}}function Wl(){return ps?(0,e.jsx)(b.default,{},`${Ln}_text`):null}function rA(){return ln?(0,e.jsx)(_.default,{},`${Ln}_annotations`):null}function aA(){return(0,e.jsxs)(p.default.Provider,{value:Xn,children:[ms(),Wl(),rA(),V]})}function oA(){return gs?hi===null||ye===void 0||ye===null?(0,e.jsx)(g.default,{type:"loading",children:typeof U=="function"?U():U}):hi===!1||ye===!1?(0,e.jsx)(g.default,{type:"error",children:typeof J=="function"?J():J}):aA():(0,e.jsx)(g.default,{type:"no-data",children:typeof N=="function"?N():N})}return(0,e.jsx)("div",Object.assign({className:(0,o.default)(F,tt),"data-page-number":gs,ref:(0,l.default)(q,Vl),style:{"--scale-factor":`${qn}`,backgroundColor:j||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Mi,{children:oA()}))}return Qf}var Jf={},_I;function hV(){if(_I)return Jf;_I=1;var u=Jf.__rest||function(d,p){var g={};for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&p.indexOf(m)<0&&(g[m]=d[m]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,m=Object.getOwnPropertySymbols(d);b<m.length;b++)p.indexOf(m[b])<0&&Object.prototype.propertyIsEnumerable.call(d,m[b])&&(g[m[b]]=d[m[b]]);return g},t=Jf.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.default=h;const e=xr(),n=t(xm()),i=t(ga()),s=t(M2()),o=fo(),l=t(Tm());function h(d){const p=(0,l.default)(),g=Object.assign(Object.assign({},p),d),{className:m,linkService:b,onItemClick:_,pageIndex:S,pageNumber:C,pdf:T}=g;(0,i.default)(T,"Attempted to load a thumbnail, but no document was specified. Wrap <Thumbnail /> in a <Document /> or pass explicit `pdf` prop.");const k=(0,o.isProvided)(C)?C-1:S??null,P=C??((0,o.isProvided)(S)?S+1:null);function L(D){D.preventDefault(),!(!(0,o.isProvided)(k)||!P)&&((0,i.default)(_||b,"Either onItemClick callback or linkService must be defined in order to navigate to an outline item."),_?_({pageIndex:k,pageNumber:P}):b&&b.goToPage(P))}const I=u(d,["className","onItemClick"]);return(0,e.jsx)("a",{className:(0,n.default)("react-pdf__Thumbnail",m),href:P?"#":void 0,onClick:L,children:(0,e.jsx)(s.default,Object.assign({},I,{_className:"react-pdf__Thumbnail__page",_enableRegisterUnregisterPage:!1,renderAnnotationLayer:!1,renderTextLayer:!1}))})}return Jf}var wI;function uV(){if(wI)return Re;wI=1;var u=Re.__createBinding||(Object.create?function(_,S,C,T){T===void 0&&(T=C);var k=Object.getOwnPropertyDescriptor(S,C);(!k||("get"in k?!S.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return S[C]}}),Object.defineProperty(_,T,k)}:function(_,S,C,T){T===void 0&&(T=C),_[T]=S[C]}),t=Re.__setModuleDefault||(Object.create?function(_,S){Object.defineProperty(_,"default",{enumerable:!0,value:S})}:function(_,S){_.default=S}),e=Re.__importStar||function(_){if(_&&_.__esModule)return _;var S={};if(_!=null)for(var C in _)C!=="default"&&Object.prototype.hasOwnProperty.call(_,C)&&u(S,_,C);return t(S,_),S},n=Re.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(Re,"__esModule",{value:!0}),Re.PasswordResponses=Re.usePageContext=Re.useOutlineContext=Re.useDocumentContext=Re.Thumbnail=Re.Page=Re.Outline=Re.Document=Re.pdfjs=void 0;const i=e(iA);Re.pdfjs=i;const s=n(JG());Re.Document=s.default;const o=n(nV());Re.Outline=o.default;const l=n(M2());Re.Page=l.default;const h=n(hV());Re.Thumbnail=h.default;const d=n(Tm());Re.useDocumentContext=d.default;const p=n(P2());Re.useOutlineContext=p.default;const g=n(sA());Re.usePageContext=g.default;const m=n(T2());return Re.PasswordResponses=m.default,(0,fo().displayWorkerWarning)(),i.GlobalWorkerOptions.workerSrc="pdf.worker.mjs",Re}var EI;function dV(){if(EI)return yy;EI=1;var u=yy.__awaiter||function(n,i,s,o){function l(h){return h instanceof s?h:new s(function(d){d(h)})}return new(s||(s=Promise))(function(h,d){function p(b){try{m(o.next(b))}catch(_){d(_)}}function g(b){try{m(o.throw(b))}catch(_){d(_)}}function m(b){b.done?h(b.value):l(b.value).then(p,g)}m((o=o.apply(n,i||[])).next())})};Object.defineProperty(yy,"__esModule",{value:!0});const t=uV();t.pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${t.pdfjs.version}/pdf.worker.mjs`;const e=n=>u(void 0,void 0,void 0,function*(){const i=URL.createObjectURL(n),s=t.pdfjs.getDocument(i);let o="";try{const l=yield s.promise,h=l.numPages;for(let d=1;d<=h;d++){const m=(yield(yield l.getPage(d)).getTextContent()).items.map(b=>"str"in b?b.str:"").join(" ");o+=m}}catch(l){throw new Error(`Failed to extract text from PDF: ${l}`)}finally{URL.revokeObjectURL(i),s.destroy()}return o});return yy.default=e,yy}var fV=dV();const pV=iD(fV);yO.workerSrc="../pdf.worker.mjs";const gV=async(u,t)=>{if(!u){alert("Please upload a PDF or image file first.");return}if(t==="Unknown"){alert("Please upload a supported file type (PDF or Image).");return}let e="",n,i;if(pV(u).then(s=>{e=s,i=e.split(" ").filter(o=>o.trim()!==""),console.log(i)}).catch(s=>console.log(s+"Failed to extract text from pdf")),t==="PDF")try{const s=await u.arrayBuffer(),o=await v3(s).promise,l=o.numPages;for(let h=1;h<=l;h++){const d=await o.getPage(h),p=d.getViewport({scale:1}),g=document.createElement("canvas"),m=g.getContext("2d");if(!m)continue;g.height=p.height,g.width=p.width;const b={canvasContext:m,viewport:p};await d.render(b).promise,n=g.toDataURL("image/png");const{data:_}=await EM.recognize(n,"pol",{});e+=_.text}}catch(s){console.error("Error processing PDF:",s)}else if(t==="Image"){const s=URL.createObjectURL(u);try{const{data:o}=await EM.recognize(s,"pol",{logger:h=>console.log(h)});i=o.text.split(`
`).filter(h=>h.trim()!=="")}catch(o){console.error("Error recognizing text from image:",o)}}return{dataUrl:n,lines:i}};yO.workerSrc="../pdf.worker.mjs";const mV=()=>{const[u,t]=Qe.useState(null),[e,n]=Qe.useState([]),[i,s]=Qe.useState(!1),[o,l]=Qe.useState(""),[h,d]=Qe.useState(""),[p,g]=Qe.useState(null),m=_=>{const S=b3(_);S&&(d(S.fileType),t(S.file))},b=async()=>{if(u){s(!0);const _=await gV(u,h);_&&_.dataUrl&&_.lines&&(l(_.dataUrl),n(_.lines),s(!1))}};return Qe.useEffect(()=>{if(u){const _=async()=>{const C=new FormData;C.append("file",u);try{console.log("wysyłam");const T=await fetch("http://localhost:3000/ask",{method:"POST",body:C});if(T.ok){const k=await T.json();return console.log("Plik wysłany pomyślnie:",k),k.data}else console.error("Błąd podczas wysyłania:",T.statusText)}catch(T){console.error("Wystąpił błąd:",T)}};(async()=>{const C=await _();if(C){console.log(C);const T=Jt.jsxs(Jt.Fragment,{children:[Jt.jsxs("div",{children:[Jt.jsx("p",{children:"Nazwa Firmy:"}),Jt.jsx("p",{children:C.name})]}),Jt.jsxs("div",{children:[Jt.jsx("p",{children:"Numer fakury:"}),Jt.jsx("p",{children:C.invoiceNo})]}),Jt.jsxs("div",{children:[Jt.jsx("p",{children:"Data fakury:"}),Jt.jsx("p",{children:C.invoiceDate})]}),Jt.jsxs("div",{children:[Jt.jsx("p",{children:"Kwota:"}),Jt.jsx("p",{children:C.value})]}),Jt.jsxs("div",{children:[Jt.jsx("p",{children:"Termin płatności:"}),Jt.jsx("p",{children:C.paymentDate})]})]});g(T)}})()}},[e,u,g]),Jt.jsxs("div",{className:"App",children:[Jt.jsx("h1",{children:"Extract Text from PDF or Image"}),Jt.jsx("input",{type:"file",accept:".pdf,image/*",onChange:m}),Jt.jsx("button",{onClick:b,disabled:i,children:i?"Processing...":"Extract Text"}),p&&Jt.jsxs("div",{children:[Jt.jsx("h2",{children:"Found Invoice Data:"}),p]}),Jt.jsxs("div",{children:[Jt.jsx("h2",{children:"Extracted Text:"}),!!e&&e.map((_,S)=>Jt.jsx("button",{onClick:C=>console.log(C.target),children:_},S))]}),!!e&&Jt.jsx("img",{src:o,alt:"Canvas to Image"})]})};Oj.createRoot(document.getElementById("root")).render(Jt.jsx(Qe.StrictMode,{children:Jt.jsx(fD,{children:Jt.jsx(mV,{})})}));
